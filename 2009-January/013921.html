<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r28927 - in haiku/trunk: headers/libs/png	src/libs/png
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-January/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r28927%20-%20in%20haiku/trunk%3A%20headers/libs/png%0A%09src/libs/png&In-Reply-To=%3C200901171843.n0HIhB8E012467%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013920.html">
   <LINK REL="Next"  HREF="013922.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r28927 - in haiku/trunk: headers/libs/png	src/libs/png</H1>
    <B>korli at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r28927%20-%20in%20haiku/trunk%3A%20headers/libs/png%0A%09src/libs/png&In-Reply-To=%3C200901171843.n0HIhB8E012467%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r28927 - in haiku/trunk: headers/libs/png	src/libs/png">korli at mail.berlios.de
       </A><BR>
    <I>Sat Jan 17 19:43:11 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="013920.html">[Haiku-commits] r28926 - haiku/trunk/src/data/etc/timezones
</A></li>
        <LI>Next message: <A HREF="013922.html">[Haiku-commits] r28928 - in haiku/trunk: headers/os/net	src/kits/network/libnetapi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13921">[ date ]</a>
              <a href="thread.html#13921">[ thread ]</a>
              <a href="subject.html#13921">[ subject ]</a>
              <a href="author.html#13921">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: korli
Date: 2009-01-17 19:43:09 +0100 (Sat, 17 Jan 2009)
New Revision: 28927
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=28927&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=28927&amp;view=rev</A>

Modified:
   haiku/trunk/headers/libs/png/png.h
   haiku/trunk/headers/libs/png/pngconf.h
   haiku/trunk/src/libs/png/png.c
   haiku/trunk/src/libs/png/pngerror.c
   haiku/trunk/src/libs/png/pngget.c
   haiku/trunk/src/libs/png/pngread.c
   haiku/trunk/src/libs/png/pngrio.c
   haiku/trunk/src/libs/png/pngrtran.c
   haiku/trunk/src/libs/png/pngrutil.c
   haiku/trunk/src/libs/png/pngset.c
   haiku/trunk/src/libs/png/pngtrans.c
   haiku/trunk/src/libs/png/pngwrite.c
   haiku/trunk/src/libs/png/pngwtran.c
   haiku/trunk/src/libs/png/pngwutil.c
Log:
updated libpng to 1.2.34


Modified: haiku/trunk/headers/libs/png/png.h
===================================================================
--- haiku/trunk/headers/libs/png/png.h	2009-01-17 18:32:21 UTC (rev 28926)
+++ haiku/trunk/headers/libs/png/png.h	2009-01-17 18:43:09 UTC (rev 28927)
@@ -1,6 +1,6 @@
 /* png.h - header file for PNG reference library
  *
- * libpng version 1.2.33 - October 31, 2008
+ * libpng version 1.2.34 - December 18, 2008
  * Copyright (c) 1998-2008 Glenn Randers-Pehrson
  * (Version 0.96 Copyright (c) 1996, 1997 Andreas Dilger)
  * (Version 0.88 Copyright (c) 1995, 1996 Guy Eric Schalnat, Group 42, Inc.)
@@ -8,7 +8,7 @@
  * Authors and maintainers:
  *  libpng versions 0.71, May 1995, through 0.88, January 1996: Guy Schalnat
  *  libpng versions 0.89c, June 1996, through 0.96, May 1997: Andreas Dilger
- *  libpng versions 0.97, January 1998, through 1.2.33 - October 31, 2008: Glenn
+ *  libpng versions 0.97, January 1998, through 1.2.34 - December 18, 2008: Glenn
  *  See also &quot;Contributing Authors&quot;, below.
  *
  * Note about libpng version numbers:
@@ -212,6 +212,11 @@
  *    1.0.41rc01              10    10041  10.so.0.41[.0]
  *    1.2.33                  13    10233  12.so.0.33[.0]
  *    1.0.41                  10    10041  10.so.0.41[.0]
+ *    1.2.34beta01-07         13    10234  12.so.0.34[.0]
+ *    1.0.42rc01              10    10042  10.so.0.42[.0]
+ *    1.2.34rc01              13    10234  12.so.0.34[.0]
+ *    1.0.42                  10    10042  10.so.0.42[.0]
+ *    1.2.34                  13    10234  12.so.0.34[.0]
  *
  *    Henceforth the source version will match the shared-library major
  *    and minor numbers; the shared-library major version number will be
@@ -241,7 +246,7 @@
  * If you modify libpng you may insert additional notices immediately following
  * this sentence.
  *
- * libpng versions 1.2.6, August 15, 2004, through 1.2.33, October 31, 2008, are
+ * libpng versions 1.2.6, August 15, 2004, through 1.2.34, December 18, 2008, are
  * Copyright (c) 2004, 2006-2008 Glenn Randers-Pehrson, and are
  * distributed according to the same disclaimer and license as libpng-1.2.5
  * with the following individual added to the list of Contributing Authors:
@@ -353,13 +358,13 @@
  * Y2K compliance in libpng:
  * =========================
  *
- *    October 31, 2008
+ *    December 18, 2008
  *
  *    Since the PNG Development group is an ad-hoc body, we can't make
  *    an official declaration.
  *
  *    This is your unofficial assurance that libpng from version 0.71 and
- *    upward through 1.2.33 are Y2K compliant.  It is my belief that earlier
+ *    upward through 1.2.34 are Y2K compliant.  It is my belief that earlier
  *    versions were also Y2K compliant.
  *
  *    Libpng only has three year fields.  One is a 2-byte unsigned integer
@@ -415,9 +420,9 @@
  */
 
 /* Version information for png.h - this should match the version in png.c */
-#define PNG_LIBPNG_VER_STRING &quot;1.2.33&quot;
+#define PNG_LIBPNG_VER_STRING &quot;1.2.34&quot;
 #define PNG_HEADER_VERSION_STRING \
-   &quot; libpng version 1.2.33 - October 31, 2008\n&quot;
+   &quot; libpng version 1.2.34 - December 18, 2008\n&quot;
 
 #define PNG_LIBPNG_VER_SONUM   0
 #define PNG_LIBPNG_VER_DLLNUM  13
@@ -425,7 +430,7 @@
 /* These should match the first 3 components of PNG_LIBPNG_VER_STRING: */
 #define PNG_LIBPNG_VER_MAJOR   1
 #define PNG_LIBPNG_VER_MINOR   2
-#define PNG_LIBPNG_VER_RELEASE 33
+#define PNG_LIBPNG_VER_RELEASE 34
 /* This should match the numeric part of the final component of
  * PNG_LIBPNG_VER_STRING, omitting any leading zero: */
 
@@ -453,7 +458,7 @@
  * Versions 0.7 through 1.0.0 were in the range 0 to 100 here (only
  * version 1.0.0 was mis-numbered 100 instead of 10000).  From
  * version 1.0.1 it's    xxyyzz, where x=major, y=minor, z=release */
-#define PNG_LIBPNG_VER 10233 /* 1.2.33 */
+#define PNG_LIBPNG_VER 10234 /* 1.2.34 */
 
 #ifndef PNG_VERSION_INFO_ONLY
 /* include the compression library's header */
@@ -1154,7 +1159,10 @@
 #define PNG_TRANSFORM_SWAP_ALPHA     0x0100    /* read and write */
 #define PNG_TRANSFORM_SWAP_ENDIAN    0x0200    /* read and write */
 #define PNG_TRANSFORM_INVERT_ALPHA   0x0400    /* read and write */
-#define PNG_TRANSFORM_STRIP_FILLER   0x0800    /* WRITE only */
+#define PNG_TRANSFORM_STRIP_FILLER   0x0800    /* WRITE only, deprecated */
+/* Added to libpng-1.2.34 */
+#define PNG_TRANSFORM_STRIP_FILLER_BEFORE 0x0800  /* WRITE only */
+#define PNG_TRANSFORM_STRIP_FILLER_AFTER  0x1000  /* WRITE only */
 
 /* Flags for MNG supported features */
 #define PNG_FLAG_MNG_EMPTY_PLTE     0x01
@@ -1474,7 +1482,7 @@
 /* This triggers a compiler error in png.c, if png.c and png.h
  * do not agree upon the version number.
  */
-typedef png_structp version_1_2_33;
+typedef png_structp version_1_2_34;
 
 typedef png_struct FAR * FAR * png_structpp;
 
@@ -2526,33 +2534,80 @@
 #if !defined(PNG_DEBUG_FILE) &amp;&amp; defined(_MSC_VER)
 #include &lt;crtdbg.h&gt;
 #if (PNG_DEBUG &gt; 1)
-#define png_debug(l,m)  _RPT0(_CRT_WARN,m)
-#define png_debug1(l,m,p1)  _RPT1(_CRT_WARN,m,p1)
-#define png_debug2(l,m,p1,p2) _RPT2(_CRT_WARN,m,p1,p2)
+#ifndef _DEBUG
+#  define _DEBUG
 #endif
+#ifndef png_debug
+#define png_debug(l,m)  _RPT0(_CRT_WARN,m PNG_STRING_NEWLINE)
+#endif
+#ifndef png_debug1
+#define png_debug1(l,m,p1)  _RPT1(_CRT_WARN,m PNG_STRING_NEWLINE,p1)
+#endif
+#ifndef png_debug2
+#define png_debug2(l,m,p1,p2) _RPT2(_CRT_WARN,m PNG_STRING_NEWLINE,p1,p2)
+#endif
+#endif
 #else /* PNG_DEBUG_FILE || !_MSC_VER */
 #ifndef PNG_DEBUG_FILE
 #define PNG_DEBUG_FILE stderr
 #endif /* PNG_DEBUG_FILE */
 #if (PNG_DEBUG &gt; 1)
+#ifndef png_debug
+/* Note: [&quot;%s&quot;m PNG_STRING_NEWLINE] probably does not work on
+ * non-ISO compilers */
+#ifdef __STDC__
 #define png_debug(l,m) \
 { \
      int num_tabs=l; \
-     fprintf(PNG_DEBUG_FILE,&quot;%s&quot;m,(num_tabs==1 ? &quot;\t&quot; : \
+     fprintf(PNG_DEBUG_FILE,&quot;%s&quot;m PNG_STRING_NEWLINE,(num_tabs==1 ? &quot;\t&quot; : \
        (num_tabs==2 ? &quot;\t\t&quot;:(num_tabs&gt;2 ? &quot;\t\t\t&quot;:&quot;&quot;)))); \
 }
+#endif
+#ifndef png_debug1
 #define png_debug1(l,m,p1) \
 { \
      int num_tabs=l; \
-     fprintf(PNG_DEBUG_FILE,&quot;%s&quot;m,(num_tabs==1 ? &quot;\t&quot; : \
+     fprintf(PNG_DEBUG_FILE,&quot;%s&quot;m PNG_STRING_NEWLINE,(num_tabs==1 ? &quot;\t&quot; : \
        (num_tabs==2 ? &quot;\t\t&quot;:(num_tabs&gt;2 ? &quot;\t\t\t&quot;:&quot;&quot;))),p1); \
 }
+#endif
+#ifndef png_debug2
 #define png_debug2(l,m,p1,p2) \
 { \
      int num_tabs=l; \
-     fprintf(PNG_DEBUG_FILE,&quot;%s&quot;m,(num_tabs==1 ? &quot;\t&quot; : \
+     fprintf(PNG_DEBUG_FILE,&quot;%s&quot;m PNG_STRING_NEWLINE,(num_tabs==1 ? &quot;\t&quot; : \
        (num_tabs==2 ? &quot;\t\t&quot;:(num_tabs&gt;2 ? &quot;\t\t\t&quot;:&quot;&quot;))),p1,p2); \
 }
+#endif
+#else /* __STDC __ */
+#ifndef png_debug
+#define png_debug(l,m) \
+     int num_tabs=l; \
+     char format[256]; \
+     snprintf(format,256,&quot;%s%s%s&quot;,(num_tabs==1 ? &quot;\t&quot; : \
+       (num_tabs==2 ? &quot;\t\t&quot;:(num_tabs&gt;2 ? &quot;\t\t\t&quot;:&quot;&quot;))), \
+       m,PNG_STRING_NEWLINE); \
+     fprintf(PNG_DEBUG_FILE,format);
+#endif
+#ifndef png_debug1
+#define png_debug1(l,m,p1) \
+     int num_tabs=l; \
+     char format[256]; \
+     snprintf(format,256,&quot;%s%s%s&quot;,(num_tabs==1 ? &quot;\t&quot; : \
+       (num_tabs==2 ? &quot;\t\t&quot;:(num_tabs&gt;2 ? &quot;\t\t\t&quot;:&quot;&quot;))), \
+       m,PNG_STRING_NEWLINE); \
+     fprintf(PNG_DEBUG_FILE,format,p1);
+#endif
+#ifndef png_debug2
+#define png_debug2(l,m,p1,p2) \
+     int num_tabs=l; \
+     char format[256]; \
+     snprintf(format,256,&quot;%s%s%s&quot;,(num_tabs==1 ? &quot;\t&quot; : \
+       (num_tabs==2 ? &quot;\t\t&quot;:(num_tabs&gt;2 ? &quot;\t\t\t&quot;:&quot;&quot;))), \
+       m,PNG_STRING_NEWLINE); \
+     fprintf(PNG_DEBUG_FILE,format,p1,p2);
+#endif
+#endif /* __STDC __ */
 #endif /* (PNG_DEBUG &gt; 1) */
 #endif /* _MSC_VER */
 #endif /* (PNG_DEBUG &gt; 0) */
@@ -3584,6 +3639,15 @@
 /* Read the chunk header (length + type name) */
 PNG_EXTERN png_uint_32 png_read_chunk_header PNGARG((png_structp png_ptr));
 
+/* Added at libpng version 1.2.34 */
+#if defined(PNG_cHRM_SUPPORTED)
+PNG_EXTERN int png_check_cHRM_fixed  PNGARG((png_structp png_ptr,
+   png_fixed_point int_white_x, png_fixed_point int_white_y,
+   png_fixed_point int_red_x, png_fixed_point int_red_y, png_fixed_point
+   int_green_x, png_fixed_point int_green_y, png_fixed_point int_blue_x,
+   png_fixed_point int_blue_y));
+#endif
+
 /* Maintainer: Put new private prototypes here ^ and in libpngpf.3 */
 
 #endif /* PNG_INTERNAL */

Modified: haiku/trunk/headers/libs/png/pngconf.h
===================================================================
--- haiku/trunk/headers/libs/png/pngconf.h	2009-01-17 18:32:21 UTC (rev 28926)
+++ haiku/trunk/headers/libs/png/pngconf.h	2009-01-17 18:43:09 UTC (rev 28927)
@@ -1,7 +1,7 @@
 
 /* pngconf.h - machine configurable file for libpng
  *
- * libpng version 1.2.33 - October 31, 2008
+ * libpng version 1.2.34 - December 18, 2008
  * For conditions of distribution and use, see copyright notice in png.h
  * Copyright (c) 1998-2008 Glenn Randers-Pehrson
  * (Version 0.96 Copyright (c) 1996, 1997 Andreas Dilger)
@@ -798,6 +798,12 @@
 #  define PNG_USER_HEIGHT_MAX 1000000L
 #endif
 
+
+/* Added at libpng-1.2.34 and 1.4.0 */
+#ifndef PNG_STRING_NEWLINE
+#define PNG_STRING_NEWLINE &quot;\n&quot;
+#endif
+
 /* These are currently experimental features, define them if you want */
 
 /* very little testing */

Modified: haiku/trunk/src/libs/png/png.c
===================================================================
--- haiku/trunk/src/libs/png/png.c	2009-01-17 18:32:21 UTC (rev 28926)
+++ haiku/trunk/src/libs/png/png.c	2009-01-17 18:43:09 UTC (rev 28927)
@@ -1,7 +1,7 @@
 
 /* png.c - location for general purpose libpng functions
  *
- * Last changed in libpng 1.2.30 [August 15, 2008]
+ * Last changed in libpng 1.2.34 [December 18, 2008]
  * For conditions of distribution and use, see copyright notice in png.h
  * Copyright (c) 1998-2008 Glenn Randers-Pehrson
  * (Version 0.96 Copyright (c) 1996, 1997 Andreas Dilger)
@@ -13,7 +13,7 @@
 #include &quot;png.h&quot;
 
 /* Generate a compiler error if there is an old png.h in the search path. */
-typedef version_1_2_33 Your_png_h_is_not_version_1_2_33;
+typedef version_1_2_34 Your_png_h_is_not_version_1_2_34;
 
 /* Version information for C files.  This had better match the version
  * string defined in png.h.  */
@@ -93,7 +93,7 @@
 png_set_sig_bytes(png_structp png_ptr, int num_bytes)
 {
    if (png_ptr == NULL) return;
-   png_debug(1, &quot;in png_set_sig_bytes\n&quot;);
+   png_debug(1, &quot;in png_set_sig_bytes&quot;);
    if (num_bytes &gt; 8)
       png_error(png_ptr, &quot;Too many bytes for PNG signature.&quot;);
 
@@ -240,7 +240,7 @@
 {
    png_infop info_ptr;
 
-   png_debug(1, &quot;in png_create_info_struct\n&quot;);
+   png_debug(1, &quot;in png_create_info_struct&quot;);
    if (png_ptr == NULL) return (NULL);
 #ifdef PNG_USER_MEM_SUPPORTED
    info_ptr = (png_infop)png_create_struct_2(PNG_STRUCT_INFO,
@@ -265,7 +265,7 @@
    png_infop info_ptr = NULL;
    if (png_ptr == NULL) return;
 
-   png_debug(1, &quot;in png_destroy_info_struct\n&quot;);
+   png_debug(1, &quot;in png_destroy_info_struct&quot;);
    if (info_ptr_ptr != NULL)
       info_ptr = *info_ptr_ptr;
 
@@ -304,7 +304,7 @@
 
    if (info_ptr == NULL) return;
 
-   png_debug(1, &quot;in png_info_init_3\n&quot;);
+   png_debug(1, &quot;in png_info_init_3&quot;);
 
    if (png_sizeof(png_info) &gt; png_info_struct_size)
      {
@@ -322,7 +322,7 @@
 png_data_freer(png_structp png_ptr, png_infop info_ptr,
    int freer, png_uint_32 mask)
 {
-   png_debug(1, &quot;in png_data_freer\n&quot;);
+   png_debug(1, &quot;in png_data_freer&quot;);
    if (png_ptr == NULL || info_ptr == NULL)
       return;
    if (freer == PNG_DESTROY_WILL_FREE_DATA)
@@ -339,7 +339,7 @@
 png_free_data(png_structp png_ptr, png_infop info_ptr, png_uint_32 mask,
    int num)
 {
-   png_debug(1, &quot;in png_free_data\n&quot;);
+   png_debug(1, &quot;in png_free_data&quot;);
    if (png_ptr == NULL || info_ptr == NULL)
       return;
 
@@ -593,7 +593,7 @@
 void /* PRIVATE */
 png_info_destroy(png_structp png_ptr, png_infop info_ptr)
 {
-   png_debug(1, &quot;in png_info_destroy\n&quot;);
+   png_debug(1, &quot;in png_info_destroy&quot;);
 
    png_free_data(png_ptr, info_ptr, PNG_FREE_ALL, -1);
 
@@ -632,7 +632,7 @@
 void PNGAPI
 png_init_io(png_structp png_ptr, png_FILE_p fp)
 {
-   png_debug(1, &quot;in png_init_io\n&quot;);
+   png_debug(1, &quot;in png_init_io&quot;);
    if (png_ptr == NULL) return;
    png_ptr-&gt;io_ptr = (png_voidp)fp;
 }
@@ -694,7 +694,7 @@
 png_get_copyright(png_structp png_ptr)
 {
    png_ptr = png_ptr;  /* silence compiler warning about unused png_ptr */
-   return ((png_charp) &quot;\n libpng version 1.2.33 - October 31, 2008\n\
+   return ((png_charp) &quot;\n libpng version 1.2.34 - December 18, 2008\n\
    Copyright (c) 1998-2008 Glenn Randers-Pehrson\n\
    Copyright (c) 1996-1997 Andreas Dilger\n\
    Copyright (c) 1995-1996 Guy Eric Schalnat, Group 42, Inc.\n&quot;);
@@ -796,4 +796,116 @@
   return ((png_size_t)size);
 }
 #endif /* PNG_SIZE_T */
+
+/* Added at libpng version 1.2.34 and 1.4.0 (moved from pngset.c) */
+#if defined(PNG_cHRM_SUPPORTED)
+#if !defined(PNG_NO_CHECK_cHRM)
+/*
+ Multiply two 32-bit numbers, V1 and V2, using 32-bit
+ arithmetic, to produce a 64 bit result in the HI/LO words.
+
+          A B
+        x C D
+       ------
+      AD || BD
+AC || CB || 0
+
+ where A and B are the high and low 16-bit words of V1,
+ C and D are the 16-bit words of V2, AD is the product of
+ A and D, and X || Y is (X &lt;&lt; 16) + Y.
+*/
+
+void png_64bit_product (long v1, long v2, unsigned long *hi_product,
+   unsigned long *lo_product)
+{
+ int a, b, c, d;
+ long lo, hi, x, y;
+
+ a = (v1 &gt;&gt; 16) &amp; 0xffff;
+ b = v1 &amp; 0xffff;
+ c = (v2 &gt;&gt; 16) &amp; 0xffff;
+ d = v2 &amp; 0xffff;
+
+ lo = b * d;                   /* BD */
+ x = a * d + c * b;            /* AD + CB */
+ y = ((lo &gt;&gt; 16) &amp; 0xffff) + x;
+
+ lo = (lo &amp; 0xffff) | ((y &amp; 0xffff) &lt;&lt; 16);
+ hi = (y &gt;&gt; 16) &amp; 0xffff;
+
+ hi += a * c;                  /* AC */
+
+ *hi_product = (unsigned long)hi;
+ *lo_product = (unsigned long)lo;
+}
+int /* private */
+png_check_cHRM_fixed(png_structp png_ptr,
+   png_fixed_point white_x, png_fixed_point white_y, png_fixed_point red_x,
+   png_fixed_point red_y, png_fixed_point green_x, png_fixed_point green_y,
+   png_fixed_point blue_x, png_fixed_point blue_y)
+{
+   int ret = 1;
+   unsigned long xy_hi,xy_lo,yx_hi,yx_lo;
+
+   png_debug(1, &quot;in function png_check_cHRM_fixed&quot;);
+   if (png_ptr == NULL)
+      return 0;
+
+   if (white_x &lt; 0 || white_y &lt;= 0 ||
+         red_x &lt; 0 ||   red_y &lt;  0 ||
+       green_x &lt; 0 || green_y &lt;  0 ||
+        blue_x &lt; 0 ||  blue_y &lt;  0)
+   {
+      png_warning(png_ptr,
+        &quot;Ignoring attempt to set negative chromaticity value&quot;);
+      ret = 0;
+   }
+   if (white_x &gt; (png_fixed_point) PNG_UINT_31_MAX ||
+       white_y &gt; (png_fixed_point) PNG_UINT_31_MAX ||
+         red_x &gt; (png_fixed_point) PNG_UINT_31_MAX ||
+         red_y &gt; (png_fixed_point) PNG_UINT_31_MAX ||
+       green_x &gt; (png_fixed_point) PNG_UINT_31_MAX ||
+       green_y &gt; (png_fixed_point) PNG_UINT_31_MAX ||
+        blue_x &gt; (png_fixed_point) PNG_UINT_31_MAX ||
+        blue_y &gt; (png_fixed_point) PNG_UINT_31_MAX )
+   {
+      png_warning(png_ptr,
+        &quot;Ignoring attempt to set chromaticity value exceeding 21474.83&quot;);
+      ret = 0;
+   }
+   if (white_x &gt; 100000L - white_y)
+   {
+      png_warning(png_ptr, &quot;Invalid cHRM white point&quot;);
+      ret = 0;
+   }
+   if (red_x &gt; 100000L - red_y)
+   {
+      png_warning(png_ptr, &quot;Invalid cHRM red point&quot;);
+      ret = 0;
+   }
+   if (green_x &gt; 100000L - green_y)
+   {
+      png_warning(png_ptr, &quot;Invalid cHRM green point&quot;);
+      ret = 0;
+   }
+   if (blue_x &gt; 100000L - blue_y)
+   {
+      png_warning(png_ptr, &quot;Invalid cHRM blue point&quot;);
+      ret = 0;
+   }
+
+   png_64bit_product(green_x - red_x, blue_y - red_y, &amp;xy_hi, &amp;xy_lo);
+   png_64bit_product(green_y - red_y, blue_x - red_x, &amp;yx_hi, &amp;yx_lo);
+
+   if (xy_hi == yx_hi &amp;&amp; xy_lo == yx_lo)
+   {
+      png_warning(png_ptr,
+         &quot;Ignoring attempt to set cHRM RGB triangle with zero area&quot;);
+      ret = 0;
+   }
+
+   return ret;
+}
+#endif /* NO_PNG_CHECK_cHRM */
+#endif /* PNG_cHRM_SUPPORTED */
 #endif /* defined(PNG_READ_SUPPORTED) || defined(PNG_WRITE_SUPPORTED) */

Modified: haiku/trunk/src/libs/png/pngerror.c
===================================================================
--- haiku/trunk/src/libs/png/pngerror.c	2009-01-17 18:32:21 UTC (rev 28926)
+++ haiku/trunk/src/libs/png/pngerror.c	2009-01-17 18:43:09 UTC (rev 28927)
@@ -1,7 +1,7 @@
 
 /* pngerror.c - stub functions for i/o and memory allocation
  *
- * Last changed in libpng 1.2.30 [August 15, 2008]
+ * Last changed in libpng 1.2.34 [December 18, 2008]
  * For conditions of distribution and use, see copyright notice in png.h
  * Copyright (c) 1998-2008 Glenn Randers-Pehrson
  * (Version 0.96 Copyright (c) 1996, 1997 Andreas Dilger)
@@ -116,9 +116,9 @@
                   break;
        }
      }
-     if (png_ptr != NULL &amp;&amp; png_ptr-&gt;warning_fn != NULL)
-        (*(png_ptr-&gt;warning_fn))(png_ptr, warning_message + offset);
    }
+   if (png_ptr != NULL &amp;&amp; png_ptr-&gt;warning_fn != NULL)
+      (*(png_ptr-&gt;warning_fn))(png_ptr, warning_message + offset);
    else
       png_default_warning(png_ptr, warning_message + offset);
 }

Modified: haiku/trunk/src/libs/png/pngget.c
===================================================================
--- haiku/trunk/src/libs/png/pngget.c	2009-01-17 18:32:21 UTC (rev 28926)
+++ haiku/trunk/src/libs/png/pngget.c	2009-01-17 18:43:09 UTC (rev 28927)
@@ -120,7 +120,7 @@
 #if defined(PNG_pHYs_SUPPORTED)
    if (info_ptr-&gt;valid &amp; PNG_INFO_pHYs)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;png_get_x_pixels_per_meter&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;png_get_x_pixels_per_meter&quot;);
       if (info_ptr-&gt;phys_unit_type != PNG_RESOLUTION_METER)
           return (0);
       else return (info_ptr-&gt;x_pixels_per_unit);
@@ -138,7 +138,7 @@
 #if defined(PNG_pHYs_SUPPORTED)
    if (info_ptr-&gt;valid &amp; PNG_INFO_pHYs)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;png_get_y_pixels_per_meter&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;png_get_y_pixels_per_meter&quot;);
       if (info_ptr-&gt;phys_unit_type != PNG_RESOLUTION_METER)
           return (0);
       else return (info_ptr-&gt;y_pixels_per_unit);
@@ -156,7 +156,7 @@
 #if defined(PNG_pHYs_SUPPORTED)
    if (info_ptr-&gt;valid &amp; PNG_INFO_pHYs)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;png_get_pixels_per_meter&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;png_get_pixels_per_meter&quot;);
       if (info_ptr-&gt;phys_unit_type != PNG_RESOLUTION_METER ||
          info_ptr-&gt;x_pixels_per_unit != info_ptr-&gt;y_pixels_per_unit)
           return (0);
@@ -176,7 +176,7 @@
 #if defined(PNG_pHYs_SUPPORTED)
    if (info_ptr-&gt;valid &amp; PNG_INFO_pHYs)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;png_get_aspect_ratio&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;png_get_aspect_ratio&quot;);
       if (info_ptr-&gt;x_pixels_per_unit == 0)
          return ((float)0.0);
       else
@@ -197,7 +197,7 @@
 #if defined(PNG_oFFs_SUPPORTED)
    if (info_ptr-&gt;valid &amp; PNG_INFO_oFFs)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;png_get_x_offset_microns&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;png_get_x_offset_microns&quot;);
       if (info_ptr-&gt;offset_unit_type != PNG_OFFSET_MICROMETER)
           return (0);
       else return (info_ptr-&gt;x_offset);
@@ -215,7 +215,7 @@
 #if defined(PNG_oFFs_SUPPORTED)
    if (info_ptr-&gt;valid &amp; PNG_INFO_oFFs)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;png_get_y_offset_microns&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;png_get_y_offset_microns&quot;);
       if (info_ptr-&gt;offset_unit_type != PNG_OFFSET_MICROMETER)
           return (0);
       else return (info_ptr-&gt;y_offset);
@@ -233,7 +233,7 @@
 #if defined(PNG_oFFs_SUPPORTED)
    if (info_ptr-&gt;valid &amp; PNG_INFO_oFFs)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;png_get_x_offset_microns&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;png_get_x_offset_microns&quot;);
       if (info_ptr-&gt;offset_unit_type != PNG_OFFSET_PIXEL)
           return (0);
       else return (info_ptr-&gt;x_offset);
@@ -251,7 +251,7 @@
 #if defined(PNG_oFFs_SUPPORTED)
    if (info_ptr-&gt;valid &amp; PNG_INFO_oFFs)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;png_get_y_offset_microns&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;png_get_y_offset_microns&quot;);
       if (info_ptr-&gt;offset_unit_type != PNG_OFFSET_PIXEL)
           return (0);
       else return (info_ptr-&gt;y_offset);
@@ -307,7 +307,7 @@
 
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_pHYs))
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;pHYs&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;pHYs&quot;);
       if (res_x != NULL)
       {
          *res_x = info_ptr-&gt;x_pixels_per_unit;
@@ -364,7 +364,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_bKGD)
       &amp;&amp; background != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;bKGD&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;bKGD&quot;);
       *background = &amp;(info_ptr-&gt;background);
       return (PNG_INFO_bKGD);
    }
@@ -381,7 +381,7 @@
 {
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_cHRM))
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;cHRM&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;cHRM&quot;);
       if (white_x != NULL)
          *white_x = (double)info_ptr-&gt;x_white;
       if (white_y != NULL)
@@ -412,7 +412,7 @@
 {
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_cHRM))
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;cHRM&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;cHRM&quot;);
       if (white_x != NULL)
          *white_x = info_ptr-&gt;int_x_white;
       if (white_y != NULL)
@@ -444,7 +444,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_gAMA)
       &amp;&amp; file_gamma != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;gAMA&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;gAMA&quot;);
       *file_gamma = (double)info_ptr-&gt;gamma;
       return (PNG_INFO_gAMA);
    }
@@ -459,7 +459,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_gAMA)
       &amp;&amp; int_file_gamma != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;gAMA&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;gAMA&quot;);
       *int_file_gamma = info_ptr-&gt;int_gamma;
       return (PNG_INFO_gAMA);
    }
@@ -475,7 +475,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_sRGB)
       &amp;&amp; file_srgb_intent != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;sRGB&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;sRGB&quot;);
       *file_srgb_intent = (int)info_ptr-&gt;srgb_intent;
       return (PNG_INFO_sRGB);
    }
@@ -492,7 +492,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_iCCP)
       &amp;&amp; name != NULL &amp;&amp; profile != NULL &amp;&amp; proflen != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;iCCP&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;iCCP&quot;);
       *name = info_ptr-&gt;iccp_name;
       *profile = info_ptr-&gt;iccp_profile;
       /* compression_type is a dummy so the API won't have to change
@@ -526,7 +526,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_hIST)
       &amp;&amp; hist != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;hIST&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;hIST&quot;);
       *hist = info_ptr-&gt;hist;
       return (PNG_INFO_hIST);
    }
@@ -544,7 +544,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; width != NULL &amp;&amp; height != NULL &amp;&amp;
       bit_depth != NULL &amp;&amp; color_type != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;IHDR&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;IHDR&quot;);
       *width = info_ptr-&gt;width;
       *height = info_ptr-&gt;height;
       *bit_depth = info_ptr-&gt;bit_depth;
@@ -588,7 +588,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_oFFs)
       &amp;&amp; offset_x != NULL &amp;&amp; offset_y != NULL &amp;&amp; unit_type != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;oFFs&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;oFFs&quot;);
       *offset_x = info_ptr-&gt;x_offset;
       *offset_y = info_ptr-&gt;y_offset;
       *unit_type = (int)info_ptr-&gt;offset_unit_type;
@@ -608,7 +608,7 @@
       &amp;&amp; purpose != NULL &amp;&amp; X0 != NULL &amp;&amp; X1 != NULL &amp;&amp; type != NULL &amp;&amp;
       nparams != NULL &amp;&amp; units != NULL &amp;&amp; params != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;pCAL&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;pCAL&quot;);
       *purpose = info_ptr-&gt;pcal_purpose;
       *X0 = info_ptr-&gt;pcal_X0;
       *X1 = info_ptr-&gt;pcal_X1;
@@ -668,7 +668,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp;
       (info_ptr-&gt;valid &amp; PNG_INFO_pHYs))
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;pHYs&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;pHYs&quot;);
       if (res_x != NULL)
       {
          *res_x = info_ptr-&gt;x_pixels_per_unit;
@@ -696,10 +696,10 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_PLTE)
        &amp;&amp; palette != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;PLTE&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;PLTE&quot;);
       *palette = info_ptr-&gt;palette;
       *num_palette = info_ptr-&gt;num_palette;
-      png_debug1(3, &quot;num_palette = %d\n&quot;, *num_palette);
+      png_debug1(3, &quot;num_palette = %d&quot;, *num_palette);
       return (PNG_INFO_PLTE);
    }
    return (0);
@@ -712,7 +712,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_sBIT)
       &amp;&amp; sig_bit != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;sBIT&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;sBIT&quot;);
       *sig_bit = &amp;(info_ptr-&gt;sig_bit);
       return (PNG_INFO_sBIT);
    }
@@ -727,7 +727,7 @@
 {
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; info_ptr-&gt;num_text &gt; 0)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;,
+      png_debug1(1, &quot;in %s retrieval function&quot;,
          (png_ptr-&gt;chunk_name[0] == '\0' ? &quot;text&quot;
              : (png_const_charp)png_ptr-&gt;chunk_name));
       if (text_ptr != NULL)
@@ -749,7 +749,7 @@
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_tIME)
        &amp;&amp; mod_time != NULL)
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;tIME&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;tIME&quot;);
       *mod_time = &amp;(info_ptr-&gt;mod_time);
       return (PNG_INFO_tIME);
    }
@@ -765,7 +765,7 @@
    png_uint_32 retval = 0;
    if (png_ptr != NULL &amp;&amp; info_ptr != NULL &amp;&amp; (info_ptr-&gt;valid &amp; PNG_INFO_tRNS))
    {
-      png_debug1(1, &quot;in %s retrieval function\n&quot;, &quot;tRNS&quot;);
+      png_debug1(1, &quot;in %s retrieval function&quot;, &quot;tRNS&quot;);
       if (info_ptr-&gt;color_type == PNG_COLOR_TYPE_PALETTE)
       {
           if (trans != NULL)

Modified: haiku/trunk/src/libs/png/pngread.c
===================================================================
--- haiku/trunk/src/libs/png/pngread.c	2009-01-17 18:32:21 UTC (rev 28926)
+++ haiku/trunk/src/libs/png/pngread.c	2009-01-17 18:43:09 UTC (rev 28927)
@@ -47,7 +47,7 @@
 
    int i;
 
-   png_debug(1, &quot;in png_create_read_struct\n&quot;);
+   png_debug(1, &quot;in png_create_read_struct&quot;);
 #ifdef PNG_USER_MEM_SUPPORTED
    png_ptr = (png_structp)png_create_struct_2(PNG_STRUCT_PNG,
       (png_malloc_ptr)malloc_fn, (png_voidp)mem_ptr);
@@ -263,7 +263,7 @@
      }
    } while (png_libpng_ver[i++]);
 
-   png_debug(1, &quot;in png_read_init_3\n&quot;);
+   png_debug(1, &quot;in png_read_init_3&quot;);
 
 #ifdef PNG_SETJMP_SUPPORTED
    /* save jump buffer and error functions */
@@ -327,7 +327,7 @@
 png_read_info(png_structp png_ptr, png_infop info_ptr)
 {
    if (png_ptr == NULL || info_ptr == NULL) return;
-   png_debug(1, &quot;in png_read_info\n&quot;);
+   png_debug(1, &quot;in png_read_info&quot;);
    /* If we haven't checked all of the PNG signature bytes, do so now. */
    if (png_ptr-&gt;sig_bytes &lt; 8)
    {
@@ -533,7 +533,7 @@
 void PNGAPI
 png_read_update_info(png_structp png_ptr, png_infop info_ptr)
 {
-   png_debug(1, &quot;in png_read_update_info\n&quot;);
+   png_debug(1, &quot;in png_read_update_info&quot;);
    if (png_ptr == NULL) return;
    if (!(png_ptr-&gt;flags &amp; PNG_FLAG_ROW_INIT))
       png_read_start_row(png_ptr);
@@ -552,7 +552,7 @@
 void PNGAPI
 png_start_read_image(png_structp png_ptr)
 {
-   png_debug(1, &quot;in png_start_read_image\n&quot;);
+   png_debug(1, &quot;in png_start_read_image&quot;);
    if (png_ptr == NULL) return;
    if (!(png_ptr-&gt;flags &amp; PNG_FLAG_ROW_INIT))
       png_read_start_row(png_ptr);
@@ -571,7 +571,7 @@
 #endif
    int ret;
    if (png_ptr == NULL) return;
-   png_debug2(1, &quot;in png_read_row (row %lu, pass %d)\n&quot;,
+   png_debug2(1, &quot;in png_read_row (row %lu, pass %d)&quot;,
       png_ptr-&gt;row_number, png_ptr-&gt;pass);
    if (!(png_ptr-&gt;flags &amp; PNG_FLAG_ROW_INIT))
       png_read_start_row(png_ptr);
@@ -822,7 +822,7 @@
    png_bytepp rp;
    png_bytepp dp;
 
-   png_debug(1, &quot;in png_read_rows\n&quot;);
+   png_debug(1, &quot;in png_read_rows&quot;);
    if (png_ptr == NULL) return;
    rp = row;
    dp = display_row;
@@ -871,7 +871,7 @@
    int pass, j;
    png_bytepp rp;
 
-   png_debug(1, &quot;in png_read_image\n&quot;);
+   png_debug(1, &quot;in png_read_image&quot;);
    if (png_ptr == NULL) return;
 
 #ifdef PNG_READ_INTERLACING_SUPPORTED
@@ -907,7 +907,7 @@
 void PNGAPI
 png_read_end(png_structp png_ptr, png_infop info_ptr)
 {
-   png_debug(1, &quot;in png_read_end\n&quot;);
+   png_debug(1, &quot;in png_read_end&quot;);
    if (png_ptr == NULL) return;
    png_crc_finish(png_ptr, 0); /* Finish off CRC from last IDAT chunk */
 
@@ -1087,7 +1087,7 @@
    png_voidp mem_ptr = NULL;
 #endif
 
-   png_debug(1, &quot;in png_destroy_read_struct\n&quot;);
+   png_debug(1, &quot;in png_destroy_read_struct&quot;);
    if (png_ptr_ptr != NULL)
       png_ptr = *png_ptr_ptr;
    if (png_ptr == NULL)
@@ -1161,7 +1161,7 @@
    png_free_ptr free_fn;
 #endif
 
-   png_debug(1, &quot;in png_read_destroy\n&quot;);
+   png_debug(1, &quot;in png_read_destroy&quot;);
    if (info_ptr != NULL)
       png_info_destroy(png_ptr, info_ptr);
 

Modified: haiku/trunk/src/libs/png/pngrio.c
===================================================================
--- haiku/trunk/src/libs/png/pngrio.c	2009-01-17 18:32:21 UTC (rev 28926)
+++ haiku/trunk/src/libs/png/pngrio.c	2009-01-17 18:43:09 UTC (rev 28927)
@@ -27,7 +27,7 @@
 void /* PRIVATE */
 png_read_data(png_structp png_ptr, png_bytep data, png_size_t length)
 {
-   png_debug1(4, &quot;reading %d bytes\n&quot;, (int)length);
+   png_debug1(4, &quot;reading %d bytes&quot;, (int)length);
    if (png_ptr-&gt;read_data_fn != NULL)
       (*(png_ptr-&gt;read_data_fn))(png_ptr, data, length);
    else

Modified: haiku/trunk/src/libs/png/pngrtran.c
===================================================================
--- haiku/trunk/src/libs/png/pngrtran.c	2009-01-17 18:32:21 UTC (rev 28926)
+++ haiku/trunk/src/libs/png/pngrtran.c	2009-01-17 18:43:09 UTC (rev 28927)
@@ -21,7 +21,7 @@
 void PNGAPI
 png_set_crc_action(png_structp png_ptr, int crit_action, int ancil_action)
 {
-   png_debug(1, &quot;in png_set_crc_action\n&quot;);
+   png_debug(1, &quot;in png_set_crc_action&quot;);
    /* Tell libpng how we react to CRC errors in critical chunks */
    if (png_ptr == NULL) return;
    switch (crit_action)
@@ -80,7 +80,7 @@
    png_color_16p background_color, int background_gamma_code,
    int need_expand, double background_gamma)
 {
-   png_debug(1, &quot;in png_set_background\n&quot;);
+   png_debug(1, &quot;in png_set_background&quot;);
    if (png_ptr == NULL) return;
    if (background_gamma_code == PNG_BACKGROUND_GAMMA_UNKNOWN)
    {
@@ -102,7 +102,7 @@
 void PNGAPI
 png_set_strip_16(png_structp png_ptr)
 {
-   png_debug(1, &quot;in png_set_strip_16\n&quot;);
+   png_debug(1, &quot;in png_set_strip_16&quot;);
    if (png_ptr == NULL) return;
    png_ptr-&gt;transformations |= PNG_16_TO_8;
 }
@@ -112,7 +112,7 @@
 void PNGAPI
 png_set_strip_alpha(png_structp png_ptr)
 {
-   png_debug(1, &quot;in png_set_strip_alpha\n&quot;);
+   png_debug(1, &quot;in png_set_strip_alpha&quot;);
    if (png_ptr == NULL) return;
    png_ptr-&gt;flags |= PNG_FLAG_STRIP_ALPHA;
 }
@@ -142,7 +142,7 @@
    int num_palette, int maximum_colors, png_uint_16p histogram,
    int full_dither)
 {
-   png_debug(1, &quot;in png_set_dither\n&quot;);
+   png_debug(1, &quot;in png_set_dither&quot;);
    if (png_ptr == NULL) return;
    png_ptr-&gt;transformations |= PNG_DITHER;
 
@@ -526,7 +526,7 @@
 void PNGAPI
 png_set_gamma(png_structp png_ptr, double scrn_gamma, double file_gamma)
 {
-   png_debug(1, &quot;in png_set_gamma\n&quot;);
+   png_debug(1, &quot;in png_set_gamma&quot;);
    if (png_ptr == NULL) return;
    if ((fabs(scrn_gamma * file_gamma - 1.0) &gt; PNG_GAMMA_THRESHOLD) ||
        (png_ptr-&gt;color_type &amp; PNG_COLOR_MASK_ALPHA) ||
@@ -545,7 +545,7 @@
 void PNGAPI
 png_set_expand(png_structp png_ptr)
 {
-   png_debug(1, &quot;in png_set_expand\n&quot;);
+   png_debug(1, &quot;in png_set_expand&quot;);
    if (png_ptr == NULL) return;
    png_ptr-&gt;transformations |= (PNG_EXPAND | PNG_EXPAND_tRNS);
    png_ptr-&gt;flags &amp;= ~PNG_FLAG_ROW_INIT;
@@ -572,7 +572,7 @@
 void PNGAPI
 png_set_palette_to_rgb(png_structp png_ptr)
 {
-   png_debug(1, &quot;in png_set_palette_to_rgb\n&quot;);
+   png_debug(1, &quot;in png_set_palette_to_rgb&quot;);
    if (png_ptr == NULL) return;
    png_ptr-&gt;transformations |= (PNG_EXPAND | PNG_EXPAND_tRNS);
    png_ptr-&gt;flags &amp;= ~PNG_FLAG_ROW_INIT;
@@ -583,7 +583,7 @@
 void PNGAPI
 png_set_expand_gray_1_2_4_to_8(png_structp png_ptr)
 {
-   png_debug(1, &quot;in png_set_expand_gray_1_2_4_to_8\n&quot;);
+   png_debug(1, &quot;in png_set_expand_gray_1_2_4_to_8&quot;);
    if (png_ptr == NULL) return;
    png_ptr-&gt;transformations |= PNG_EXPAND;
    png_ptr-&gt;flags &amp;= ~PNG_FLAG_ROW_INIT;
@@ -596,7 +596,7 @@
 void PNGAPI
 png_set_gray_1_2_4_to_8(png_structp png_ptr)
 {
-   png_debug(1, &quot;in png_set_gray_1_2_4_to_8\n&quot;);
+   png_debug(1, &quot;in png_set_gray_1_2_4_to_8&quot;);
    if (png_ptr == NULL) return;
    png_ptr-&gt;transformations |= (PNG_EXPAND | PNG_EXPAND_tRNS);
 }
@@ -607,7 +607,7 @@
 void PNGAPI
 png_set_tRNS_to_alpha(png_structp png_ptr)
 {
-   png_debug(1, &quot;in png_set_tRNS_to_alpha\n&quot;);
+   png_debug(1, &quot;in png_set_tRNS_to_alpha&quot;);
    png_ptr-&gt;transformations |= (PNG_EXPAND | PNG_EXPAND_tRNS);
    png_ptr-&gt;flags &amp;= ~PNG_FLAG_ROW_INIT;
 }
@@ -617,7 +617,7 @@
 void PNGAPI
 png_set_gray_to_rgb(png_structp png_ptr)
 {
-   png_debug(1, &quot;in png_set_gray_to_rgb\n&quot;);
+   png_debug(1, &quot;in png_set_gray_to_rgb&quot;);
    png_ptr-&gt;transformations |= PNG_GRAY_TO_RGB;
    png_ptr-&gt;flags &amp;= ~PNG_FLAG_ROW_INIT;
 }
@@ -644,7 +644,7 @@
 png_set_rgb_to_gray_fixed(png_structp png_ptr, int error_action,
    png_fixed_point red, png_fixed_point green)
 {
-   png_debug(1, &quot;in png_set_rgb_to_gray\n&quot;);
+   png_debug(1, &quot;in png_set_rgb_to_gray&quot;);
    if (png_ptr == NULL) return;
    switch(error_action)
    {
@@ -697,7 +697,7 @@
 png_set_read_user_transform_fn(png_structp png_ptr, png_user_transform_ptr
    read_user_transform_fn)
 {
-   png_debug(1, &quot;in png_set_read_user_transform_fn\n&quot;);
+   png_debug(1, &quot;in png_set_read_user_transform_fn&quot;);
    if (png_ptr == NULL) return;
 #if defined(PNG_READ_USER_TRANSFORM_SUPPORTED)
    png_ptr-&gt;transformations |= PNG_USER_TRANSFORM;
@@ -717,7 +717,7 @@
 void /* PRIVATE */
 png_init_read_transformations(png_structp png_ptr)
 {
-   png_debug(1, &quot;in png_init_read_transformations\n&quot;);
+   png_debug(1, &quot;in png_init_read_transformations&quot;);
 #if defined(PNG_USELESS_TESTS_SUPPORTED)
    if (png_ptr != NULL)
 #endif
@@ -1124,7 +1124,7 @@
 void /* PRIVATE */
 png_read_transform_info(png_structp png_ptr, png_infop info_ptr)
 {
-   png_debug(1, &quot;in png_read_transform_info\n&quot;);
+   png_debug(1, &quot;in png_read_transform_info&quot;);
 #if defined(PNG_READ_EXPAND_SUPPORTED)
    if (png_ptr-&gt;transformations &amp; PNG_EXPAND)
    {
@@ -1268,7 +1268,7 @@
 void /* PRIVATE */
 png_do_read_transformations(png_structp png_ptr)
 {

[... truncated: 2103 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013920.html">[Haiku-commits] r28926 - haiku/trunk/src/data/etc/timezones
</A></li>
	<LI>Next message: <A HREF="013922.html">[Haiku-commits] r28928 - in haiku/trunk: headers/os/net	src/kits/network/libnetapi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13921">[ date ]</a>
              <a href="thread.html#13921">[ thread ]</a>
              <a href="subject.html#13921">[ subject ]</a>
              <a href="author.html#13921">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
