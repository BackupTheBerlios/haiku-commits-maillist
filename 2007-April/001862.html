<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r20860 - in haiku/trunk/src:	add-ons/kernel/file_systems/bfs tools tools/bfs_shell
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2007-April/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r20860%20-%20in%20haiku/trunk/src%3A%0A%09add-ons/kernel/file_systems/bfs%20tools%20tools/bfs_shell&In-Reply-To=%3C9c46321e0704270612x76ec68d8r5e4f39457b644a54%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001861.html">
   <LINK REL="Next"  HREF="001863.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r20860 - in haiku/trunk/src:	add-ons/kernel/file_systems/bfs tools tools/bfs_shell</H1>
    <B>Hugo Santos</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r20860%20-%20in%20haiku/trunk/src%3A%0A%09add-ons/kernel/file_systems/bfs%20tools%20tools/bfs_shell&In-Reply-To=%3C9c46321e0704270612x76ec68d8r5e4f39457b644a54%40mail.gmail.com%3E"
       TITLE="[Haiku-commits] r20860 - in haiku/trunk/src:	add-ons/kernel/file_systems/bfs tools tools/bfs_shell">hugosantos at gmail.com
       </A><BR>
    <I>Fri Apr 27 15:12:44 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001861.html">[Haiku-commits] r20860 - in haiku/trunk/src:	add-ons/kernel/file_systems/bfs tools tools/bfs_shell
</A></li>
        <LI>Next message: <A HREF="001863.html">[Haiku-commits] r20860 - in haiku/trunk/src:	add-ons/kernel/file_systems/bfs tools tools/bfs_shell
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1862">[ date ]</a>
              <a href="thread.html#1862">[ thread ]</a>
              <a href="subject.html#1862">[ subject ]</a>
              <a href="author.html#1862">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Ingo,

  Unfortunely this change is breaking the build. The error message is
a bit cryptic in gcc 2.95 but gcc 4.x is clearer. It seems Volume.h in
src/system/boot/loader/file_systems/bfs/ includes &quot;bfs.h&quot; inside
namespace BFS { ... } which mostly breaks a bunch of stuff.

  Is anyone else working on fixing this?

  Hugo

On 4/27/07, bonefish at BerliOS &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">bonefish at mail.berlios.de</A>&gt; wrote:
&gt;<i> Author: bonefish
</I>&gt;<i> Date: 2007-04-27 14:25:49 +0200 (Fri, 27 Apr 2007)
</I>&gt;<i> New Revision: 20860
</I>&gt;<i> ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=20860&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=20860&amp;view=rev</A>
</I>&gt;<i>
</I>&gt;<i> Added:
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/system_dependencies.h
</I>&gt;<i>    haiku/trunk/src/tools/bfs_shell/
</I>&gt;<i>    haiku/trunk/src/tools/bfs_shell/Jamfile
</I>&gt;<i> Modified:
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Attribute.cpp
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/BPlusTree.cpp
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/BPlusTree.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/BlockAllocator.cpp
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/CachedBlock.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Chain.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Debug.cpp
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Debug.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Index.cpp
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Index.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Inode.cpp
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Inode.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Journal.cpp
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Journal.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Lock.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Query.cpp
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Query.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Utility.cpp
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Utility.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Volume.cpp
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/Volume.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs_control.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs_endian.h
</I>&gt;<i>    haiku/trunk/src/add-ons/kernel/file_systems/bfs/kernel_interface.cpp
</I>&gt;<i>    haiku/trunk/src/tools/Jamfile
</I>&gt;<i> Log:
</I>&gt;<i> * Prepared the BFS sources to be used with the new FS shell:
</I>&gt;<i>   - Moved all inclusions of system headers into a new
</I>&gt;<i>     system_dependencies.h header, which conditionally either includes
</I>&gt;<i>     these or the FS shell headers.
</I>&gt;<i>   - Fixed compiler warnings related to printf-like functions (int32 is
</I>&gt;<i>     int, not long on non-BeOS platforms).
</I>&gt;<i> * Build a new bfs_shell. Compiles and links, but does nothing ATM.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Attribute.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Attribute.cpp       2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Attribute.cpp       2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -6,7 +6,6 @@
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  #include &quot;Attribute.h&quot;
</I>&gt;<i> -#include &lt;stdlib.h&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  // ToDo: clean this up, find a better separation between Inode and this class
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/BPlusTree.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/BPlusTree.cpp       2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/BPlusTree.cpp       2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -13,15 +13,7 @@
</I>&gt;<i>  #include &quot;Inode.h&quot;
</I>&gt;<i>  #include &quot;Utility.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;util/kernel_cpp.h&gt;
</I>&gt;<i> -#include &lt;util/Stack.h&gt;
</I>&gt;<i> -#include &lt;TypeConstants.h&gt;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;string.h&gt;
</I>&gt;<i> -#include &lt;stdlib.h&gt;
</I>&gt;<i> -#include &lt;stdio.h&gt;
</I>&gt;<i> -
</I>&gt;<i> -
</I>&gt;<i>  #ifdef DEBUG
</I>&gt;<i>  class NodeChecker {
</I>&gt;<i>         public:
</I>&gt;<i> @@ -795,8 +787,8 @@
</I>&gt;<i>                         duplicate_array *array = duplicate-&gt;FragmentAt(bplustree_node::FragmentIndex(oldValue));
</I>&gt;<i>                         if (array-&gt;count &gt; NUM_FRAGMENT_VALUES
</I>&gt;<i>                                 || array-&gt;count &lt; 1) {
</I>&gt;<i> -                               FATAL((&quot;insertDuplicate: Invalid array[%ld] size in fragment %Ld == %Ld!\n&quot;,
</I>&gt;<i> -                                       bplustree_node::FragmentIndex(oldValue),
</I>&gt;<i> +                               FATAL((&quot;insertDuplicate: Invalid array[%d] size in fragment %Ld == %Ld!\n&quot;,
</I>&gt;<i> +                                       (int)bplustree_node::FragmentIndex(oldValue),
</I>&gt;<i>                                         bplustree_node::FragmentOffset(oldValue),
</I>&gt;<i>                                         array-&gt;count));
</I>&gt;<i>                                 return B_BAD_DATA;
</I>&gt;<i> @@ -1365,8 +1357,8 @@
</I>&gt;<i>
</I>&gt;<i>                 if (array-&gt;count &gt; NUM_FRAGMENT_VALUES
</I>&gt;<i>                         || array-&gt;count &lt; 1) {
</I>&gt;<i> -                       FATAL((&quot;removeDuplicate: Invalid array[%ld] size in fragment %Ld == %Ld!\n&quot;,
</I>&gt;<i> -                               bplustree_node::FragmentIndex(oldValue), duplicateOffset, array-&gt;count));
</I>&gt;<i> +                       FATAL((&quot;removeDuplicate: Invalid array[%d] size in fragment %Ld == %Ld!\n&quot;,
</I>&gt;<i> +                               (int)bplustree_node::FragmentIndex(oldValue), duplicateOffset, array-&gt;count));
</I>&gt;<i>                         return B_BAD_DATA;
</I>&gt;<i>                 }
</I>&gt;<i>                 if (!array-&gt;Remove(value)) {
</I>&gt;<i> @@ -1549,8 +1541,8 @@
</I>&gt;<i>         uint8 *key = node-&gt;KeyAt(index, &amp;length);
</I>&gt;<i>         if (key + length + sizeof(off_t) + sizeof(uint16) &gt; (uint8 *)node + fNodeSize
</I>&gt;<i>                 || length &gt; BPLUSTREE_MAX_KEY_LENGTH) {
</I>&gt;<i> -               FATAL((&quot;Key length to long: %s, %u (inode at %ld,%u)\n&quot;, key, length,
</I>&gt;<i> -                       fStream-&gt;BlockRun().allocation_group, fStream-&gt;BlockRun().start));
</I>&gt;<i> +               FATAL((&quot;Key length to long: %s, %u (inode at %d,%u)\n&quot;, key, length,
</I>&gt;<i> +                       (int)fStream-&gt;BlockRun().allocation_group, fStream-&gt;BlockRun().start));
</I>&gt;<i>                 fStream-&gt;GetVolume()-&gt;Panic();
</I>&gt;<i>                 return;
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/BPlusTree.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/BPlusTree.h 2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/BPlusTree.h 2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -14,9 +14,7 @@
</I>&gt;<i>  #include &quot;Journal.h&quot;
</I>&gt;<i>  #include &quot;Chain.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;string.h&gt;
</I>&gt;<i>
</I>&gt;<i> -
</I>&gt;<i>  //****************** on-disk structures ********************
</I>&gt;<i>
</I>&gt;<i>  struct bplustree_node;
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/BlockAllocator.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/BlockAllocator.cpp  2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/BlockAllocator.cpp  2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -12,9 +12,7 @@
</I>&gt;<i>  #include &quot;BPlusTree.h&quot;
</I>&gt;<i>  #include &quot;bfs_control.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;util/Stack.h&gt;
</I>&gt;<i> -#include &lt;util/kernel_cpp.h&gt;
</I>&gt;<i> -#include &lt;stdlib.h&gt;
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i>  #ifdef USER
</I>&gt;<i>  #      define spawn_kernel_thread spawn_thread
</I>&gt;<i> @@ -161,7 +159,7 @@
</I>&gt;<i>  #endif
</I>&gt;<i>
</I>&gt;<i>         if (uint32(start + numBlocks) &gt; fNumBits) {
</I>&gt;<i> -               FATAL((&quot;Allocation::Allocate(): tried to allocate too many blocks: %u (numBlocks = %lu)!\n&quot;, numBlocks, fNumBits));
</I>&gt;<i> +               FATAL((&quot;Allocation::Allocate(): tried to allocate too many blocks: %u (numBlocks = %u)!\n&quot;, numBlocks, (unsigned)fNumBits));
</I>&gt;<i>                 DIE((&quot;Allocation::Allocate(): tried to allocate too many blocks&quot;));
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i> @@ -195,7 +193,7 @@
</I>&gt;<i>  #endif
</I>&gt;<i>
</I>&gt;<i>         if (uint32(start + numBlocks) &gt; fNumBits) {
</I>&gt;<i> -               FATAL((&quot;Allocation::Free(): tried to free too many blocks: %u (numBlocks = %lu)!\n&quot;, numBlocks, fNumBits));
</I>&gt;<i> +               FATAL((&quot;Allocation::Free(): tried to free too many blocks: %u (numBlocks = %u)!\n&quot;, numBlocks, (unsigned)fNumBits));
</I>&gt;<i>                 DIE((&quot;Allocation::Free(): tried to free too many blocks&quot;));
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i> @@ -736,13 +734,13 @@
</I>&gt;<i>                 || start &gt; fGroups[group].NumBits()
</I>&gt;<i>                 || uint32(start + length) &gt; fGroups[group].NumBits()
</I>&gt;<i>                 || length == 0) {
</I>&gt;<i> -               FATAL((&quot;tried to free an invalid block_run (%ld, %u, %u)\n&quot;, group, start, length));
</I>&gt;<i> +               FATAL((&quot;tried to free an invalid block_run (%d, %u, %u)\n&quot;, (int)group, start, length));
</I>&gt;<i>                 DEBUGGER((&quot;tried to free invalid block_run&quot;));
</I>&gt;<i>                 return B_BAD_VALUE;
</I>&gt;<i>         }
</I>&gt;<i>         // check if someone tries to free reserved areas at the beginning of the drive
</I>&gt;<i>         if (group == 0 &amp;&amp; start &lt; uint32(fVolume-&gt;Log().Start() + fVolume-&gt;Log().Length())) {
</I>&gt;<i> -               FATAL((&quot;tried to free a reserved block_run (%ld, %u, %u)\n&quot;, group, start, length));
</I>&gt;<i> +               FATAL((&quot;tried to free a reserved block_run (%d, %u, %u)\n&quot;, (int)group, start, length));
</I>&gt;<i>                 DEBUGGER((&quot;tried to free reserved block&quot;));
</I>&gt;<i>                 return B_BAD_VALUE;
</I>&gt;<i>         }
</I>&gt;<i> @@ -1161,8 +1159,8 @@
</I>&gt;<i>                                         control-&gt;stats.already_set++;
</I>&gt;<i>                                 } else {
</I>&gt;<i>                                         if (firstSet != -1) {
</I>&gt;<i> -                                               FATAL((&quot;%s: block_run(%ld, %u, %u): blocks %Ld - %Ld are already set!\n&quot;,
</I>&gt;<i> -                                                       type, run.AllocationGroup(), run.Start(), run.Length(), firstSet, firstGroupBlock + offset - 1));
</I>&gt;<i> +                                               FATAL((&quot;%s: block_run(%d, %u, %u): blocks %Ld - %Ld are already set!\n&quot;,
</I>&gt;<i> +                                                       type, (int)run.AllocationGroup(), run.Start(), run.Length(), firstSet, firstGroupBlock + offset - 1));
</I>&gt;<i>                                                 firstSet = -1;
</I>&gt;<i>                                         }
</I>&gt;<i>                                         _SetCheckBitmapAt(firstGroupBlock + offset);
</I>&gt;<i> @@ -1176,7 +1174,7 @@
</I>&gt;<i>                         if (firstMissing != -1)
</I>&gt;<i>                                 PRINT((&quot;%s: block_run(%ld, %u, %u): blocks %Ld - %Ld are not allocated!\n&quot;, type, run.AllocationGroup(), run.Start(), run.Length(), firstMissing, firstGroupBlock + pos + block * bitsPerBlock - 1));
</I>&gt;<i>                         if (firstSet != -1)
</I>&gt;<i> -                               FATAL((&quot;%s: block_run(%ld, %u, %u): blocks %Ld - %Ld are already set!\n&quot;, type, run.AllocationGroup(), run.Start(), run.Length(), firstSet, firstGroupBlock + pos + block * bitsPerBlock - 1));
</I>&gt;<i> +                               FATAL((&quot;%s: block_run(%d, %u, %u): blocks %Ld - %Ld are already set!\n&quot;, type, (int)run.AllocationGroup(), run.Start(), run.Length(), firstSet, firstGroupBlock + pos + block * bitsPerBlock - 1));
</I>&gt;<i>                 }
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/CachedBlock.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/CachedBlock.h       2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/CachedBlock.h       2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -7,15 +7,8 @@
</I>&gt;<i>  #define CACHED_BLOCK_H
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#include &lt;KernelExport.h&gt;
</I>&gt;<i> -#ifdef USER
</I>&gt;<i> -//#    include &quot;myfs.h&quot;
</I>&gt;<i> -#      include &lt;stdio.h&gt;
</I>&gt;<i> -#endif
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;string.h&gt;
</I>&gt;<i> -#include &lt;unistd.h&gt;
</I>&gt;<i> -
</I>&gt;<i>  #include &quot;Volume.h&quot;
</I>&gt;<i>  #include &quot;Journal.h&quot;
</I>&gt;<i>  #include &quot;Lock.h&quot;
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Chain.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Chain.h     2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Chain.h     2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -7,7 +7,7 @@
</I>&gt;<i>  ** This file may be used under the terms of the OpenBeOS License.
</I>&gt;<i>  */
</I>&gt;<i>
</I>&gt;<i> -#include &lt;null.h&gt;
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i>  /** The Link class you want to use with the Chain class needs to have
</I>&gt;<i>   *     a &quot;fNext&quot; member which is accessable from within the Chain class.
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Debug.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Debug.cpp   2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Debug.cpp   2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -11,10 +11,6 @@
</I>&gt;<i>  #include &quot;BPlusTree.h&quot;
</I>&gt;<i>  #include &quot;Inode.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;KernelExport.h&gt;
</I>&gt;<i> -
</I>&gt;<i> -#include &lt;time.h&gt;
</I>&gt;<i> -
</I>&gt;<i>  #define Print __out
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> @@ -40,7 +36,7 @@
</I>&gt;<i>  void
</I>&gt;<i>  dump_block_run(const char *prefix, const block_run &amp;run)
</I>&gt;<i>  {
</I>&gt;<i> -       Print(&quot;%s(%ld, %d, %d)\n&quot;, prefix, run.allocation_group, run.start, run.length);
</I>&gt;<i> +       Print(&quot;%s(%d, %d, %d)\n&quot;, prefix, (int)run.allocation_group, run.start, run.length);
</I>&gt;<i>  }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> @@ -49,22 +45,22 @@
</I>&gt;<i>  {
</I>&gt;<i>         Print(&quot;disk_super_block:\n&quot;);
</I>&gt;<i>         Print(&quot;  name           = %s\n&quot;, superBlock-&gt;name);
</I>&gt;<i> -       Print(&quot;  magic1         = %#08lx (%s) %s\n&quot;, superBlock-&gt;magic1, get_tupel(superBlock-&gt;magic1), (superBlock-&gt;magic1 == SUPER_BLOCK_MAGIC1 ? &quot;valid&quot; : &quot;INVALID&quot;));
</I>&gt;<i> -       Print(&quot;  fs_byte_order  = %#08lx (%s)\n&quot;, superBlock-&gt;fs_byte_order, get_tupel(superBlock-&gt;fs_byte_order));
</I>&gt;<i> -       Print(&quot;  block_size     = %lu\n&quot;, superBlock-&gt;block_size);
</I>&gt;<i> -       Print(&quot;  block_shift    = %lu\n&quot;, superBlock-&gt;block_shift);
</I>&gt;<i> +       Print(&quot;  magic1         = %#08x (%s) %s\n&quot;, (int)superBlock-&gt;magic1, get_tupel(superBlock-&gt;magic1), (superBlock-&gt;magic1 == SUPER_BLOCK_MAGIC1 ? &quot;valid&quot; : &quot;INVALID&quot;));
</I>&gt;<i> +       Print(&quot;  fs_byte_order  = %#08x (%s)\n&quot;, (int)superBlock-&gt;fs_byte_order, get_tupel(superBlock-&gt;fs_byte_order));
</I>&gt;<i> +       Print(&quot;  block_size     = %u\n&quot;, (unsigned)superBlock-&gt;block_size);
</I>&gt;<i> +       Print(&quot;  block_shift    = %u\n&quot;, (unsigned)superBlock-&gt;block_shift);
</I>&gt;<i>         Print(&quot;  num_blocks     = %Lu\n&quot;, superBlock-&gt;num_blocks);
</I>&gt;<i>         Print(&quot;  used_blocks    = %Lu\n&quot;, superBlock-&gt;used_blocks);
</I>&gt;<i> -       Print(&quot;  inode_size     = %lu\n&quot;, superBlock-&gt;inode_size);
</I>&gt;<i> -       Print(&quot;  magic2         = %#08lx (%s) %s\n&quot;, superBlock-&gt;magic2, get_tupel(superBlock-&gt;magic2), (superBlock-&gt;magic2 == (int)SUPER_BLOCK_MAGIC2 ? &quot;valid&quot; : &quot;INVALID&quot;));
</I>&gt;<i> -       Print(&quot;  blocks_per_ag  = %lu\n&quot;, superBlock-&gt;blocks_per_ag);
</I>&gt;<i> -       Print(&quot;  ag_shift       = %lu (%ld bytes)\n&quot;, superBlock-&gt;ag_shift, 1L &lt;&lt; superBlock-&gt;ag_shift);
</I>&gt;<i> -       Print(&quot;  num_ags        = %lu\n&quot;, superBlock-&gt;num_ags);
</I>&gt;<i> -       Print(&quot;  flags          = %#08lx (%s)\n&quot;, superBlock-&gt;flags, get_tupel(superBlock-&gt;flags));
</I>&gt;<i> +       Print(&quot;  inode_size     = %u\n&quot;, (unsigned)superBlock-&gt;inode_size);
</I>&gt;<i> +       Print(&quot;  magic2         = %#08x (%s) %s\n&quot;, (int)superBlock-&gt;magic2, get_tupel(superBlock-&gt;magic2), (superBlock-&gt;magic2 == (int)SUPER_BLOCK_MAGIC2 ? &quot;valid&quot; : &quot;INVALID&quot;));
</I>&gt;<i> +       Print(&quot;  blocks_per_ag  = %u\n&quot;, (unsigned)superBlock-&gt;blocks_per_ag);
</I>&gt;<i> +       Print(&quot;  ag_shift       = %u (%ld bytes)\n&quot;, (unsigned)superBlock-&gt;ag_shift, 1L &lt;&lt; superBlock-&gt;ag_shift);
</I>&gt;<i> +       Print(&quot;  num_ags        = %u\n&quot;, (unsigned)superBlock-&gt;num_ags);
</I>&gt;<i> +       Print(&quot;  flags          = %#08x (%s)\n&quot;, (int)superBlock-&gt;flags, get_tupel(superBlock-&gt;flags));
</I>&gt;<i>         dump_block_run(&quot;  log_blocks     = &quot;, superBlock-&gt;log_blocks);
</I>&gt;<i>         Print(&quot;  log_start      = %Lu\n&quot;, superBlock-&gt;log_start);
</I>&gt;<i>         Print(&quot;  log_end        = %Lu\n&quot;, superBlock-&gt;log_end);
</I>&gt;<i> -       Print(&quot;  magic3         = %#08lx (%s) %s\n&quot;, superBlock-&gt;magic3, get_tupel(superBlock-&gt;magic3), (superBlock-&gt;magic3 == SUPER_BLOCK_MAGIC3 ? &quot;valid&quot; : &quot;INVALID&quot;));
</I>&gt;<i> +       Print(&quot;  magic3         = %#08x (%s) %s\n&quot;, (int)superBlock-&gt;magic3, get_tupel(superBlock-&gt;magic3), (superBlock-&gt;magic3 == SUPER_BLOCK_MAGIC3 ? &quot;valid&quot; : &quot;INVALID&quot;));
</I>&gt;<i>         dump_block_run(&quot;  root_dir       = &quot;, superBlock-&gt;root_dir);
</I>&gt;<i>         dump_block_run(&quot;  indices        = &quot;, superBlock-&gt;indices);
</I>&gt;<i>  }
</I>&gt;<i> @@ -99,30 +95,30 @@
</I>&gt;<i>  dump_inode(const bfs_inode *inode)
</I>&gt;<i>  {
</I>&gt;<i>         Print(&quot;inode:\n&quot;);
</I>&gt;<i> -       Print(&quot;  magic1             = %08lx (%s) %s\n&quot;, inode-&gt;magic1,
</I>&gt;<i> +       Print(&quot;  magic1             = %08x (%s) %s\n&quot;, (int)inode-&gt;magic1,
</I>&gt;<i>                 get_tupel(inode-&gt;magic1), (inode-&gt;magic1 == INODE_MAGIC1 ? &quot;valid&quot; : &quot;INVALID&quot;));
</I>&gt;<i>         dump_block_run( &quot;  inode_num          = &quot;, inode-&gt;inode_num);
</I>&gt;<i> -       Print(&quot;  uid                = %lu\n&quot;, inode-&gt;uid);
</I>&gt;<i> -       Print(&quot;  gid                = %lu\n&quot;, inode-&gt;gid);
</I>&gt;<i> -       Print(&quot;  mode               = %08lx\n&quot;, inode-&gt;mode);
</I>&gt;<i> -       Print(&quot;  flags              = %08lx\n&quot;, inode-&gt;flags);
</I>&gt;<i> +       Print(&quot;  uid                = %u\n&quot;, (unsigned)inode-&gt;uid);
</I>&gt;<i> +       Print(&quot;  gid                = %u\n&quot;, (unsigned)inode-&gt;gid);
</I>&gt;<i> +       Print(&quot;  mode               = %08x\n&quot;, (int)inode-&gt;mode);
</I>&gt;<i> +       Print(&quot;  flags              = %08x\n&quot;, (int)inode-&gt;flags);
</I>&gt;<i>         Print(&quot;  create_time        = %Ld (%Ld)\n&quot;, inode-&gt;create_time,
</I>&gt;<i>                 inode-&gt;create_time &gt;&gt; INODE_TIME_SHIFT);
</I>&gt;<i>         Print(&quot;  last_modified_time = %Ld (%Ld)\n&quot;, inode-&gt;last_modified_time,
</I>&gt;<i>                 inode-&gt;last_modified_time &gt;&gt; INODE_TIME_SHIFT);
</I>&gt;<i>         dump_block_run( &quot;  parent             = &quot;, inode-&gt;parent);
</I>&gt;<i>         dump_block_run( &quot;  attributes         = &quot;, inode-&gt;attributes);
</I>&gt;<i> -       Print(&quot;  type               = %lu\n&quot;, inode-&gt;type);
</I>&gt;<i> -       Print(&quot;  inode_size         = %lu\n&quot;, inode-&gt;inode_size);
</I>&gt;<i> -       Print(&quot;  etc                = %#08lx\n&quot;, inode-&gt;etc);
</I>&gt;<i> +       Print(&quot;  type               = %u\n&quot;, (unsigned)inode-&gt;type);
</I>&gt;<i> +       Print(&quot;  inode_size         = %u\n&quot;, (unsigned)inode-&gt;inode_size);
</I>&gt;<i> +       Print(&quot;  etc                = %#08x\n&quot;, (int)inode-&gt;etc);
</I>&gt;<i>         Print(&quot;  short_symlink      = %s\n&quot;,
</I>&gt;<i>                 S_ISLNK(inode-&gt;mode) &amp;&amp; (inode-&gt;flags &amp; INODE_LONG_SYMLINK) == 0 ?
</I>&gt;<i>                         inode-&gt;short_symlink : &quot;-&quot;);
</I>&gt;<i>         dump_data_stream(&amp;(inode-&gt;data));
</I>&gt;<i> -       Print(&quot;  --\n  pad[0]             = %08lx\n&quot;, inode-&gt;pad[0]);
</I>&gt;<i> -       Print(&quot;  pad[1]             = %08lx\n&quot;, inode-&gt;pad[1]);
</I>&gt;<i> -       Print(&quot;  pad[2]             = %08lx\n&quot;, inode-&gt;pad[2]);
</I>&gt;<i> -       Print(&quot;  pad[3]             = %08lx\n&quot;, inode-&gt;pad[3]);
</I>&gt;<i> +       Print(&quot;  --\n  pad[0]             = %08x\n&quot;, (int)inode-&gt;pad[0]);
</I>&gt;<i> +       Print(&quot;  pad[1]             = %08x\n&quot;, (int)inode-&gt;pad[1]);
</I>&gt;<i> +       Print(&quot;  pad[2]             = %08x\n&quot;, (int)inode-&gt;pad[2]);
</I>&gt;<i> +       Print(&quot;  pad[3]             = %08x\n&quot;, (int)inode-&gt;pad[3]);
</I>&gt;<i>  }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> @@ -130,11 +126,11 @@
</I>&gt;<i>  dump_bplustree_header(const bplustree_header *header)
</I>&gt;<i>  {
</I>&gt;<i>         Print(&quot;bplustree_header:\n&quot;);
</I>&gt;<i> -       Print(&quot;  magic                = %#08lx (%s) %s\n&quot;, header-&gt;magic,
</I>&gt;<i> +       Print(&quot;  magic                = %#08x (%s) %s\n&quot;, (int)header-&gt;magic,
</I>&gt;<i>                 get_tupel(header-&gt;magic), (header-&gt;magic == BPLUSTREE_MAGIC ? &quot;valid&quot; : &quot;INVALID&quot;));
</I>&gt;<i> -       Print(&quot;  node_size            = %lu\n&quot;, header-&gt;node_size);
</I>&gt;<i> -       Print(&quot;  max_number_of_levels = %lu\n&quot;, header-&gt;max_number_of_levels);
</I>&gt;<i> -       Print(&quot;  data_type            = %lu\n&quot;, header-&gt;data_type);
</I>&gt;<i> +       Print(&quot;  node_size            = %u\n&quot;, (unsigned)header-&gt;node_size);
</I>&gt;<i> +       Print(&quot;  max_number_of_levels = %u\n&quot;, (unsigned)header-&gt;max_number_of_levels);
</I>&gt;<i> +       Print(&quot;  data_type            = %u\n&quot;, (unsigned)header-&gt;data_type);
</I>&gt;<i>         Print(&quot;  root_node_pointer    = %Ld\n&quot;, header-&gt;root_node_pointer);
</I>&gt;<i>         Print(&quot;  free_node_pointer    = %Ld\n&quot;, header-&gt;free_node_pointer);
</I>&gt;<i>         Print(&quot;  maximum_size         = %Lu\n&quot;, header-&gt;maximum_size);
</I>&gt;<i> @@ -203,7 +199,7 @@
</I>&gt;<i>                 uint16 length;
</I>&gt;<i>                 char buffer[256], *key = (char *)node-&gt;KeyAt(i, &amp;length);
</I>&gt;<i>                 if (length &gt; 255 || length == 0) {
</I>&gt;<i> -                       Print(&quot;  %2ld. Invalid length (%u)!!\n&quot;, i, length);
</I>&gt;<i> +                       Print(&quot;  %2d. Invalid length (%u)!!\n&quot;, (int)i, length);
</I>&gt;<i>                         dump_block((char *)node, header-&gt;node_size/*, sizeof(off_t)*/);
</I>&gt;<i>                         break;
</I>&gt;<i>                 }
</I>&gt;<i> @@ -212,15 +208,15 @@
</I>&gt;<i>
</I>&gt;<i>                 off_t *value = node-&gt;Values() + i;
</I>&gt;<i>                 if ((uint32)value &lt; (uint32)node || (uint32)value &gt; (uint32)node + header-&gt;node_size)
</I>&gt;<i> -                       Print(&quot;  %2ld. Invalid Offset!!\n&quot;, i);
</I>&gt;<i> +                       Print(&quot;  %2d. Invalid Offset!!\n&quot;, (int)i);
</I>&gt;<i>                 else {
</I>&gt;<i> -                       Print(&quot;  %2ld. &quot;, i);
</I>&gt;<i> +                       Print(&quot;  %2d. &quot;, (int)i);
</I>&gt;<i>                         if (header-&gt;data_type == BPLUSTREE_STRING_TYPE)
</I>&gt;<i>                                 Print(&quot;\&quot;%s\&quot;&quot;, buffer);
</I>&gt;<i>                         else if (header-&gt;data_type == BPLUSTREE_INT32_TYPE)
</I>&gt;<i> -                               Print(&quot;int32 = %ld (0x%lx)&quot;, *(int32 *)&amp;buffer, *(int32 *)&amp;buffer);
</I>&gt;<i> +                               Print(&quot;int32 = %d (0x%x)&quot;, (int)*(int32 *)&amp;buffer, (int)*(int32 *)&amp;buffer);
</I>&gt;<i>                         else if (header-&gt;data_type == BPLUSTREE_UINT32_TYPE)
</I>&gt;<i> -                               Print(&quot;uint32 = %lu (0x%lx)&quot;, *(uint32 *)&amp;buffer, *(uint32 *)&amp;buffer);
</I>&gt;<i> +                               Print(&quot;uint32 = %u (0x%x)&quot;, (unsigned)*(uint32 *)&amp;buffer, (unsigned)*(uint32 *)&amp;buffer);
</I>&gt;<i>                         else if (header-&gt;data_type == BPLUSTREE_INT64_TYPE)
</I>&gt;<i>                                 Print(&quot;int64 = %Ld (0x%Lx)&quot;, *(int64 *)&amp;buffer, *(int64 *)&amp;buffer);
</I>&gt;<i>                         else
</I>&gt;<i> @@ -230,7 +226,7 @@
</I>&gt;<i>                         Print(&quot; (%d bytes) -&gt; %Ld&quot;, length, offset);
</I>&gt;<i>                         if (volume != NULL) {
</I>&gt;<i>                                 block_run run = volume-&gt;ToBlockRun(offset);
</I>&gt;<i> -                               Print(&quot; (%ld, %d)&quot;, run.allocation_group, run.start);
</I>&gt;<i> +                               Print(&quot; (%d, %d)&quot;, (int)run.allocation_group, run.start);
</I>&gt;<i>                         }
</I>&gt;<i>                         if (bplustree_node::LinkType(*value) == BPLUSTREE_DUPLICATE_FRAGMENT)
</I>&gt;<i>                                 Print(&quot; (duplicate fragment %Ld)\n&quot;, *value &amp; 0x3ff);
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Debug.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Debug.h     2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Debug.h     2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -7,17 +7,11 @@
</I>&gt;<i>  #define DEBUG_H
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#include &lt;KernelExport.h&gt;
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#ifdef DEBUG
</I>&gt;<i> -#      include &lt;string.h&gt;
</I>&gt;<i> -#endif
</I>&gt;<i> -
</I>&gt;<i>  #ifdef USER
</I>&gt;<i> -#      include &lt;stdio.h&gt;
</I>&gt;<i>  #      define __out printf
</I>&gt;<i>  #else
</I>&gt;<i> -#      include &lt;null.h&gt;
</I>&gt;<i>  #      define __out dprintf
</I>&gt;<i>  #endif
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Index.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Index.cpp   2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Index.cpp   2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -12,8 +12,6 @@
</I>&gt;<i>  #include &quot;Inode.h&quot;
</I>&gt;<i>  #include &quot;BPlusTree.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;util/kernel_cpp.h&gt;
</I>&gt;<i> -#include &lt;TypeConstants.h&gt;
</I>&gt;<i>
</I>&gt;<i>  // B_MIME_STRING_TYPE is defined in storage/Mime.h, but we
</I>&gt;<i>  // don't need the whole file here; the type can't change anyway
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Index.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Index.h     2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Index.h     2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -7,7 +7,7 @@
</I>&gt;<i>  #define INDEX_H
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#include &lt;KernelExport.h&gt;
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i>  class Transaction;
</I>&gt;<i>  class Volume;
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Inode.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Inode.cpp   2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Inode.cpp   2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -11,13 +11,7 @@
</I>&gt;<i>  #include &quot;BPlusTree.h&quot;
</I>&gt;<i>  #include &quot;Index.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;fs_cache.h&gt;
</I>&gt;<i> -#include &lt;util/kernel_cpp.h&gt;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;string.h&gt;
</I>&gt;<i> -#include &lt;stdio.h&gt;
</I>&gt;<i> -
</I>&gt;<i> -
</I>&gt;<i>  class InodeAllocator {
</I>&gt;<i>         public:
</I>&gt;<i>                 InodeAllocator(Transaction &amp;transaction);
</I>&gt;<i> @@ -183,8 +177,8 @@
</I>&gt;<i>         memcpy(&amp;fNode, node.Node(), sizeof(bfs_inode));
</I>&gt;<i>
</I>&gt;<i>         char lockName[B_OS_NAME_LENGTH];
</I>&gt;<i> -       snprintf(lockName, sizeof(lockName), &quot;bfs inode %ld.%d&quot;,
</I>&gt;<i> -               BlockRun().AllocationGroup(), BlockRun().Start());
</I>&gt;<i> +       snprintf(lockName, sizeof(lockName), &quot;bfs inode %d.%d&quot;,
</I>&gt;<i> +               (int)BlockRun().AllocationGroup(), BlockRun().Start());
</I>&gt;<i>         fLock.Initialize(lockName);
</I>&gt;<i>
</I>&gt;<i>         // these two will help to maintain the indices
</I>&gt;<i> @@ -210,8 +204,8 @@
</I>&gt;<i>                 volume, &amp;transaction, id, this));
</I>&gt;<i>
</I>&gt;<i>         char lockName[B_OS_NAME_LENGTH];
</I>&gt;<i> -       snprintf(lockName, sizeof(lockName), &quot;bfs inode+%ld.%d&quot;,
</I>&gt;<i> -               run.AllocationGroup(), run.Start());
</I>&gt;<i> +       snprintf(lockName, sizeof(lockName), &quot;bfs inode+%d.%d&quot;,
</I>&gt;<i> +               (int)run.AllocationGroup(), run.Start());
</I>&gt;<i>         fLock.Initialize(lockName);
</I>&gt;<i>
</I>&gt;<i>         NodeGetter node(volume, transaction, this, true);
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Inode.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Inode.h     2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Inode.h     2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -6,19 +6,12 @@
</I>&gt;<i>  #define INODE_H
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#include &lt;KernelExport.h&gt;
</I>&gt;<i> -#ifdef USER
</I>&gt;<i> -//#    include &quot;myfs.h&quot;
</I>&gt;<i> -#      include &lt;stdio.h&gt;
</I>&gt;<i> -#endif
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i>  #ifndef _IMPEXP_KERNEL
</I>&gt;<i>  #      define _IMPEXP_KERNEL
</I>&gt;<i>  #endif
</I>&gt;<i>
</I>&gt;<i> -#include &lt;string.h&gt;
</I>&gt;<i> -#include &lt;unistd.h&gt;
</I>&gt;<i> -
</I>&gt;<i>  #include &quot;Volume.h&quot;
</I>&gt;<i>  #include &quot;Journal.h&quot;
</I>&gt;<i>  #include &quot;Lock.h&quot;
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Journal.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Journal.cpp 2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Journal.cpp 2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -9,12 +9,7 @@
</I>&gt;<i>  #include &quot;Inode.h&quot;
</I>&gt;<i>  #include &quot;Debug.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;Drivers.h&gt;
</I>&gt;<i> -#include &lt;util/kernel_cpp.h&gt;
</I>&gt;<i> -#include &lt;util/Stack.h&gt;
</I>&gt;<i> -#include &lt;errno.h&gt;
</I>&gt;<i>
</I>&gt;<i> -
</I>&gt;<i>  struct run_array {
</I>&gt;<i>         int32           count;
</I>&gt;<i>         union {
</I>&gt;<i> @@ -337,8 +332,8 @@
</I>&gt;<i>         if (array-&gt;MaxRuns() != maxRuns
</I>&gt;<i>                 || array-&gt;CountRuns() &gt; maxRuns
</I>&gt;<i>                 || array-&gt;CountRuns() &lt;= 0) {
</I>&gt;<i> -               dprintf(&quot;run count: %ld, array max: %ld, max runs: %ld\n&quot;,
</I>&gt;<i> -                       array-&gt;CountRuns(), array-&gt;MaxRuns(), maxRuns);
</I>&gt;<i> +               dprintf(&quot;run count: %d, array max: %d, max runs: %d\n&quot;,
</I>&gt;<i> +                       (int)array-&gt;CountRuns(), (int)array-&gt;MaxRuns(), (int)maxRuns);
</I>&gt;<i>                 FATAL((&quot;Log entry has broken header!\n&quot;));
</I>&gt;<i>                 return B_ERROR;
</I>&gt;<i>         }
</I>&gt;<i> @@ -433,7 +428,7 @@
</I>&gt;<i>
</I>&gt;<i>                 status_t status = _ReplayRunArray(&amp;start);
</I>&gt;<i>                 if (status &lt; B_OK) {
</I>&gt;<i> -                       FATAL((&quot;replaying log entry from %ld failed: %s\n&quot;, start, strerror(status)));
</I>&gt;<i> +                       FATAL((&quot;replaying log entry from %d failed: %s\n&quot;, (int)start, strerror(status)));
</I>&gt;<i>                         return B_ERROR;
</I>&gt;<i>                 }
</I>&gt;<i>                 start = start % fLogSize;
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Journal.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Journal.h   2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Journal.h   2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -7,14 +7,8 @@
</I>&gt;<i>  #define JOURNAL_H
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#include &lt;KernelExport.h&gt;
</I>&gt;<i> -#include &lt;util/DoublyLinkedList.h&gt;
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#ifdef USER
</I>&gt;<i> -//#    include &quot;myfs.h&quot;
</I>&gt;<i> -#      include &lt;stdio.h&gt;
</I>&gt;<i> -#endif
</I>&gt;<i> -
</I>&gt;<i>  #ifndef _IMPEXP_KERNEL
</I>&gt;<i>  #      define _IMPEXP_KERNEL
</I>&gt;<i>  #endif
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Lock.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Lock.h      2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Lock.h      2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -7,9 +7,8 @@
</I>&gt;<i>  #ifndef LOCK_H
</I>&gt;<i>  #define LOCK_H
</I>&gt;<i>
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;KernelExport.h&gt;
</I>&gt;<i> -#include &lt;stdio.h&gt;
</I>&gt;<i>  #include &quot;Utility.h&quot;
</I>&gt;<i>  #include &quot;Debug.h&quot;
</I>&gt;<i>
</I>&gt;<i> @@ -165,7 +164,7 @@
</I>&gt;<i>                 {
</I>&gt;<i>                         thread_id thread = find_thread(NULL);
</I>&gt;<i>                         if (thread != fOwner) {
</I>&gt;<i> -                               panic(&quot;RecursiveLock unlocked by %ld, owned by %ld\n&quot;, thread, fOwner);
</I>&gt;<i> +                               panic(&quot;RecursiveLock unlocked by %d, owned by %d\n&quot;, (int)thread, (int)fOwner);
</I>&gt;<i>                         }
</I>&gt;<i>
</I>&gt;<i>                         if (--fOwnerCount == 0) {
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Query.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Query.cpp   2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Query.cpp   2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -17,18 +17,7 @@
</I>&gt;<i>  #include &quot;BPlusTree.h&quot;
</I>&gt;<i>  #include &quot;Index.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;util/kernel_cpp.h&gt;
</I>&gt;<i> -#include &lt;SupportDefs.h&gt;
</I>&gt;<i> -#include &lt;NodeMonitor.h&gt;
</I>&gt;<i> -#include &lt;TypeConstants.h&gt;
</I>&gt;<i> -#include &lt;AppDefs.h&gt;
</I>&gt;<i> -#include &lt;fs_query.h&gt;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;malloc.h&gt;
</I>&gt;<i> -#include &lt;stdio.h&gt;
</I>&gt;<i> -#include &lt;string.h&gt;
</I>&gt;<i> -
</I>&gt;<i> -
</I>&gt;<i>  // The parser has a very static design, but it will do what is required.
</I>&gt;<i>  //
</I>&gt;<i>  // ParseOr(), ParseAnd(), ParseEquation() are guarantying the operator
</I>&gt;<i> @@ -698,7 +687,7 @@
</I>&gt;<i>                         fSize = sizeof(double);
</I>&gt;<i>                         break;
</I>&gt;<i>                 default:
</I>&gt;<i> -                       FATAL((&quot;query value conversion to 0x%lx requested!\n&quot;, type));
</I>&gt;<i> +                       FATAL((&quot;query value conversion to 0x%x requested!\n&quot;, (int)type));
</I>&gt;<i>                         // should we fail here or just do a safety int32 conversion?
</I>&gt;<i>                         return B_ERROR;
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Query.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Query.h     2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Query.h     2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -6,13 +6,11 @@
</I>&gt;<i>  #ifndef QUERY_H
</I>&gt;<i>  #define QUERY_H
</I>&gt;<i>
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i>  #include &quot;Chain.h&quot;
</I>&gt;<i>  #include &quot;Index.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;util/Stack.h&gt;
</I>&gt;<i> -#include &lt;SupportDefs.h&gt;
</I>&gt;<i> -
</I>&gt;<i>  class Volume;
</I>&gt;<i>  class Term;
</I>&gt;<i>  class Equation;
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Utility.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Utility.cpp 2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Utility.cpp 2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -8,12 +8,7 @@
</I>&gt;<i>  #include &quot;Utility.h&quot;
</I>&gt;<i>  #include &quot;Debug.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;util/kernel_cpp.h&gt;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;stdlib.h&gt;
</I>&gt;<i> -#include &lt;string.h&gt;
</I>&gt;<i> -
</I>&gt;<i> -
</I>&gt;<i>  bool
</I>&gt;<i>  sorted_array::FindInternal(off_t value, int32 &amp;index) const
</I>&gt;<i>  {
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Utility.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Utility.h   2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Utility.h   2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -7,7 +7,7 @@
</I>&gt;<i>  #define UTILITY_H
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#include &lt;SupportDefs.h&gt;
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  // Simple array, used for the duplicate handling in the B+Tree,
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Volume.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Volume.cpp  2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Volume.cpp  2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -11,18 +11,7 @@
</I>&gt;<i>  #include &quot;Inode.h&quot;
</I>&gt;<i>  #include &quot;Query.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;util/kernel_cpp.h&gt;
</I>&gt;<i> -#include &lt;KernelExport.h&gt;
</I>&gt;<i> -#include &lt;Drivers.h&gt;
</I>&gt;<i> -#include &lt;fs_volume.h&gt;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;ctype.h&gt;
</I>&gt;<i> -#include &lt;errno.h&gt;
</I>&gt;<i> -#include &lt;stdio.h&gt;
</I>&gt;<i> -#include &lt;stdlib.h&gt;
</I>&gt;<i> -#include &lt;string.h&gt;
</I>&gt;<i> -
</I>&gt;<i> -
</I>&gt;<i>  static const int32 kDesiredAllocationGroups = 56;
</I>&gt;<i>         // This is the number of allocation groups that will be tried
</I>&gt;<i>         // to be given for newly initialized disks.
</I>&gt;<i> @@ -444,7 +433,7 @@
</I>&gt;<i>                 || run.length == 0
</I>&gt;<i>                 || uint32(run.Length() + run.Start()) &gt; (1UL &lt;&lt; AllocationGroupShift())) {
</I>&gt;<i>                 Panic();
</I>&gt;<i> -               FATAL((&quot;*** invalid run(%ld,%d,%d)\n&quot;, run.AllocationGroup(), run.Start(), run.Length()));
</I>&gt;<i> +               FATAL((&quot;*** invalid run(%d,%d,%d)\n&quot;, (int)run.AllocationGroup(), run.Start(), run.Length()));
</I>&gt;<i>                 return B_BAD_DATA;
</I>&gt;<i>         }
</I>&gt;<i>         return B_OK;
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/Volume.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/Volume.h    2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/Volume.h    2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -7,9 +7,7 @@
</I>&gt;<i>  #define VOLUME_H
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#include &lt;KernelExport.h&gt;
</I>&gt;<i> -#include &lt;fs_interface.h&gt;
</I>&gt;<i> -#include &lt;fs_cache.h&gt;
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i>  #include &quot;bfs.h&quot;
</I>&gt;<i>  #include &quot;BlockAllocator.h&quot;
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs.h       2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs.h       2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -9,15 +9,10 @@
</I>&gt;<i>  #define BFS_H
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#include &lt;SupportDefs.h&gt;
</I>&gt;<i> -
</I>&gt;<i>  #include &quot;bfs_endian.h&quot;
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#ifndef B_BEOS_VERSION_DANO
</I>&gt;<i> -#      define B_BAD_DATA B_ERROR
</I>&gt;<i> -#endif
</I>&gt;<i> -
</I>&gt;<i>  // ToDo: temporary fix! (missing but public ioctls)
</I>&gt;<i>  #define IOCTL_FILE_UNCACHED_IO 10000
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs_control.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs_control.h       2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs_control.h       2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -7,7 +7,7 @@
</I>&gt;<i>  */
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#include &lt;fs_interface.h&gt;
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  /* ioctl to check the version of BFS used - parameter is a uint32 *
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs_endian.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs_endian.h        2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/bfs_endian.h        2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -6,7 +6,7 @@
</I>&gt;<i>  #define BFS_ENDIAN_H
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -#include &lt;ByteOrder.h&gt;
</I>&gt;<i> +#include &quot;system_dependencies.h&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  #if !defined(BFS_LITTLE_ENDIAN_ONLY) &amp;&amp; !defined(BFS_BIG_ENDIAN_ONLY)
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/add-ons/kernel/file_systems/bfs/kernel_interface.cpp
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/kernel_interface.cpp        2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/kernel_interface.cpp        2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -14,22 +14,7 @@
</I>&gt;<i>  #include &quot;Attribute.h&quot;
</I>&gt;<i>  #include &quot;bfs_control.h&quot;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;util/kernel_cpp.h&gt;
</I>&gt;<i>
</I>&gt;<i> -#include &lt;string.h&gt;
</I>&gt;<i> -#include &lt;stdio.h&gt;
</I>&gt;<i> -
</I>&gt;<i> -#include &lt;KernelExport.h&gt;
</I>&gt;<i> -#include &lt;NodeMonitor.h&gt;
</I>&gt;<i> -#include &lt;fs_interface.h&gt;
</I>&gt;<i> -#include &lt;fs_cache.h&gt;
</I>&gt;<i> -
</I>&gt;<i> -#include &lt;fs_attr.h&gt;
</I>&gt;<i> -#include &lt;fs_info.h&gt;
</I>&gt;<i> -#include &lt;fs_index.h&gt;
</I>&gt;<i> -#include &lt;fs_query.h&gt;
</I>&gt;<i> -#include &lt;fs_volume.h&gt;
</I>&gt;<i> -
</I>&gt;<i>  #define BFS_IO_SIZE    65536
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> @@ -1265,8 +1250,8 @@
</I>&gt;<i>                 if (needsTrimming) {
</I>&gt;<i>                         status = inode-&gt;TrimPreallocation(transaction);
</I>&gt;<i>                         if (status &lt; B_OK) {
</I>&gt;<i> -                               FATAL((&quot;Could not trim preallocated blocks: inode %Ld, transaction %ld: %s!\n&quot;,
</I>&gt;<i> -                                       inode-&gt;ID(), transaction.ID(), strerror(status)));
</I>&gt;<i> +                               FATAL((&quot;Could not trim preallocated blocks: inode %Ld, transaction %d: %s!\n&quot;,
</I>&gt;<i> +                                       inode-&gt;ID(), (int)transaction.ID(), strerror(status)));
</I>&gt;<i>
</I>&gt;<i>                                 // we still want this transaction to succeed
</I>&gt;<i>                                 status = B_OK;
</I>&gt;<i>
</I>&gt;<i> Added: haiku/trunk/src/add-ons/kernel/file_systems/bfs/system_dependencies.h
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/add-ons/kernel/file_systems/bfs/system_dependencies.h       2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/add-ons/kernel/file_systems/bfs/system_dependencies.h       2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -0,0 +1,46 @@
</I>&gt;<i> +/*
</I>&gt;<i> + * Copyright 2007, Ingo Weinhold, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">bonefish at cs.tu-berlin.de.</A>
</I>&gt;<i> + * Distributed under the terms of the MIT License.
</I>&gt;<i> + */
</I>&gt;<i> +
</I>&gt;<i> +#ifndef _SYSTEM_DEPENDENCIES_H
</I>&gt;<i> +#define _SYSTEM_DEPENDENCIES_H
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +#ifdef BFS_SHELL
</I>&gt;<i> +
</I>&gt;<i> +#include &quot;fssh_api_wrapper.h&quot;
</I>&gt;<i> +
</I>&gt;<i> +#else  // !BFS_SHELL
</I>&gt;<i> +
</I>&gt;<i> +#include &lt;ctype.h&gt;
</I>&gt;<i> +#include &lt;errno.h&gt;
</I>&gt;<i> +#include &lt;null.h&gt;
</I>&gt;<i> +#include &lt;string.h&gt;
</I>&gt;<i> +#include &lt;stdio.h&gt;
</I>&gt;<i> +#include &lt;stdlib.h&gt;
</I>&gt;<i> +#include &lt;time.h&gt;
</I>&gt;<i> +#include &lt;unistd.h&gt;
</I>&gt;<i> +
</I>&gt;<i> +#include &lt;fs_attr.h&gt;
</I>&gt;<i> +#include &lt;fs_cache.h&gt;
</I>&gt;<i> +#include &lt;fs_index.h&gt;
</I>&gt;<i> +#include &lt;fs_info.h&gt;
</I>&gt;<i> +#include &lt;fs_interface.h&gt;
</I>&gt;<i> +#include &lt;fs_query.h&gt;
</I>&gt;<i> +#include &lt;fs_volume.h&gt;
</I>&gt;<i> +#include &lt;ByteOrder.h&gt;
</I>&gt;<i> +#include &lt;Drivers.h&gt;
</I>&gt;<i> +#include &lt;KernelExport.h&gt;
</I>&gt;<i> +#include &lt;NodeMonitor.h&gt;
</I>&gt;<i> +#include &lt;SupportDefs.h&gt;
</I>&gt;<i> +#include &lt;TypeConstants.h&gt;
</I>&gt;<i> +
</I>&gt;<i> +#include &lt;util/DoublyLinkedList.h&gt;
</I>&gt;<i> +#include &lt;util/kernel_cpp.h&gt;
</I>&gt;<i> +#include &lt;util/Stack.h&gt;
</I>&gt;<i> +
</I>&gt;<i> +#endif // !BFS_SHELL
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +#endif // _SYSTEM_DEPENDENCIES_H
</I>&gt;<i>
</I>&gt;<i> Modified: haiku/trunk/src/tools/Jamfile
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/tools/Jamfile       2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/tools/Jamfile       2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -59,6 +59,7 @@
</I>&gt;<i>                 UpdateMimeInfoThread.cpp MimeUpdateThread.cpp database_support.cpp
</I>&gt;<i>         ] = [ FDirName $(HAIKU_TOP) src build libbe storage mime ] ;
</I>&gt;<i>
</I>&gt;<i> +SubInclude HAIKU_TOP src tools bfs_shell ;
</I>&gt;<i>  SubInclude HAIKU_TOP src tools copy_to_bfs_image ;
</I>&gt;<i>  SubInclude HAIKU_TOP src tools cppunit ;
</I>&gt;<i>  SubInclude HAIKU_TOP src tools docbook ;
</I>&gt;<i>
</I>&gt;<i> Added: haiku/trunk/src/tools/bfs_shell/Jamfile
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- haiku/trunk/src/tools/bfs_shell/Jamfile     2007-04-27 12:17:22 UTC (rev 20859)
</I>&gt;<i> +++ haiku/trunk/src/tools/bfs_shell/Jamfile     2007-04-27 12:25:49 UTC (rev 20860)
</I>&gt;<i> @@ -0,0 +1,40 @@
</I>&gt;<i> +SubDir HAIKU_TOP src tools bfs_shell ;
</I>&gt;<i> +
</I>&gt;<i> +SEARCH_SOURCE += [ FDirName $(HAIKU_TOP) src add-ons kernel file_systems bfs ] ;
</I>&gt;<i> +
</I>&gt;<i> +# set some additional defines
</I>&gt;<i> +{
</I>&gt;<i> +       local defines =
</I>&gt;<i> +               #BFS_BIG_ENDIAN_ONLY
</I>&gt;<i> +               BFS_SHELL
</I>&gt;<i> +               ;
</I>&gt;<i> +
</I>&gt;<i> +       if $(DEBUG) = 0 {
</I>&gt;<i> +               # the gcc on BeOS doesn't compile BFS correctly with -O2 or more
</I>&gt;<i> +               OPTIM = -O1 ;
</I>&gt;<i> +       }
</I>&gt;<i> +
</I>&gt;<i> +       defines = [ FDefines $(defines) ] ;
</I>&gt;<i> +       SubDirCcFlags $(defines) -Wall -Wno-multichar ;
</I>&gt;<i> +       SubDirC++Flags $(defines) -Wall -Wno-multichar -fno-rtti ;
</I>&gt;<i> +}
</I>&gt;<i> +
</I>&gt;<i> +UsePrivateHeaders fs_shell ;
</I>&gt;<i> +
</I>&gt;<i> +BuildPlatformMain &lt;build2&gt;bfs_shell
</I>&gt;<i> +       :
</I>&gt;<i> +       BlockAllocator.cpp
</I>&gt;<i> +       BPlusTree.cpp
</I>&gt;<i> +       Attribute.cpp
</I>&gt;<i> +       Debug.cpp
</I>&gt;<i> +       Index.cpp
</I>&gt;<i> +       Inode.cpp
</I>&gt;<i> +       Journal.cpp
</I>&gt;<i> +       Query.cpp
</I>&gt;<i> +       Utility.cpp
</I>&gt;<i> +       Volume.cpp
</I>&gt;<i> +
</I>&gt;<i> +       kernel_interface.cpp
</I>&gt;<i> +
</I>&gt;<i> +       : &lt;build2&gt;fs_shell.a $(HOST_LIBSUPC++) $(HOST_LIBROOT)
</I>&gt;<i> +;
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Haiku-commits mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">Haiku-commits at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">https://lists.berlios.de/mailman/listinfo/haiku-commits</A>
</I>&gt;<i>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001861.html">[Haiku-commits] r20860 - in haiku/trunk/src:	add-ons/kernel/file_systems/bfs tools tools/bfs_shell
</A></li>
	<LI>Next message: <A HREF="001863.html">[Haiku-commits] r20860 - in haiku/trunk/src:	add-ons/kernel/file_systems/bfs tools tools/bfs_shell
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1862">[ date ]</a>
              <a href="thread.html#1862">[ thread ]</a>
              <a href="subject.html#1862">[ subject ]</a>
              <a href="author.html#1862">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
