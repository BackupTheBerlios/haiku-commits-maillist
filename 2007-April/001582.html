<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r20684 - haiku/trunk/src/preferences/filetypes
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2007-April/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r20684%20-%20haiku/trunk/src/preferences/filetypes&In-Reply-To=%3C200704142237.l3EMb440004288%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001581.html">
   <LINK REL="Next"  HREF="001584.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r20684 - haiku/trunk/src/preferences/filetypes</H1>
    <B>stippi at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r20684%20-%20haiku/trunk/src/preferences/filetypes&In-Reply-To=%3C200704142237.l3EMb440004288%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r20684 - haiku/trunk/src/preferences/filetypes">stippi at mail.berlios.de
       </A><BR>
    <I>Sun Apr 15 00:37:04 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001581.html">[Haiku-commits] r20683 - in haiku/trunk: headers/os/app	src/kits/interface
</A></li>
        <LI>Next message: <A HREF="001584.html">[Haiku-commits] r20684 - haiku/trunk/src/preferences/filetypes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1582">[ date ]</a>
              <a href="thread.html#1582">[ thread ]</a>
              <a href="subject.html#1582">[ subject ]</a>
              <a href="author.html#1582">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: stippi
Date: 2007-04-15 00:36:56 +0200 (Sun, 15 Apr 2007)
New Revision: 20684
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=20684&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=20684&amp;view=rev</A>

Modified:
   haiku/trunk/src/preferences/filetypes/FileTypes.icons.rdef
   haiku/trunk/src/preferences/filetypes/FileTypes.rdef
   haiku/trunk/src/preferences/filetypes/IconView.cpp
Log:
* added vector icons for application and supported types
* added &quot;icon heap&quot; icon
* implemented loading vector icon for &quot;icon heap&quot;


Modified: haiku/trunk/src/preferences/filetypes/FileTypes.icons.rdef
===================================================================
--- haiku/trunk/src/preferences/filetypes/FileTypes.icons.rdef	2007-04-14 18:11:42 UTC (rev 20683)
+++ haiku/trunk/src/preferences/filetypes/FileTypes.icons.rdef	2007-04-14 22:36:56 UTC (rev 20684)
@@ -2,6 +2,35 @@
  * FileTypes.icons.rdef
  */
 
+#ifdef HAIKU_TARGET_PLATFORM_HAIKU
+
+resource(0, &quot;BEOS:application/x-be-resource&quot;) #'VICN' array {
+	$&quot;6E63696607050102000603399E0F3D9C0ABF82B23B84A94B88504870C900A5B1&quot;
+	$&quot;FFBCEAF1FFFFB3B8FF020106023E49240000000000003CAAAA4940004A3000FF&quot;
+	$&quot;C0D5FF7C896EFF040192020006023A4BAE3411A9B629883C6629495368484715&quot;
+	$&quot;00FFF9BAFFFFC104020006023A6A0E3670BCB6D8C13AD0F64A21BC4A0DF300BA&quot;
+	$&quot;DCFFFF2A20F10200060239AAD5343BA5B6E7993C629D4ABB354803A500E99797&quot;
+	$&quot;FFCE3232070606AE0BB40BBF4D33C3AFB75DC173BDEFC607C13EC804CA28BD82&quot;
+	$&quot;C118B920C51BBB40BF07B8083AB6BC0605AE02B57D3EB9B9C3EFB7BB44BBB751&quot;
+	$&quot;BD75C936CA8EC1B1402F0A093B593D5BBFCDC93E455BC516C5F160465B435D45&quot;
+	$&quot;44510A045A425E3F5A3D57400A063236323D3A41403E403739330A063A433A4A&quot;
+	$&quot;404D464A464341400A064237423E48424E3F4E394835090A03020203000A0001&quot;
+	$&quot;011001178400040A020101000A0001001001178400040A010100000A00030405&quot;
+	$&quot;061001178400040A040104000A050105000A06010600&quot;
+};
+
+resource(1, &quot;BEOS:application/octet-stream&quot;) #'VICN' array {
+	$&quot;6E6369660402000603399E0F3D9C0ABF82B23B84A94B88504870C900A5B1FFBC&quot;
+	$&quot;EAF1FFFFB3B8FF0501020106023E49240000000000003CAAAA4940004A3000FF&quot;
+	$&quot;C0D5FF7C896EFF040192040606AE0BB40BBF4D33C3AFB75DC173BDEFC607C13E&quot;
+	$&quot;C804CA28BD82C118B920C51BBB40BF07B8083AB6BC0605AE02B57D3EB9B9C3EF&quot;
+	$&quot;B7BB44BBB751BD75C936CA8EC1B1402F0A093B593D5BBFCDC93E455BC516C5F1&quot;
+	$&quot;60465B435D4544510A045A425E3F5A3D5740050A03020203000A010101100117&quot;
+	$&quot;8400040A020101000A0101001001178400040A00010000&quot;
+};
+
+#else // HAIKU_TARGET_PLATFORM_HAIKU
+
 resource(0, &quot;BEOS:L:application/x-be-resource&quot;) #'ICON' array {
 	$&quot;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF02020008FFFFFFFFFFFFFFFFFFFF&quot;
 	$&quot;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF041B17110802FFFFFFFFFFFFFFFFFF&quot;
@@ -109,3 +138,5 @@
 	$&quot;FFFFFFFFAE00000000AEAEFFFFFFFFFF&quot;
 	$&quot;FFFFFFFFFFAE00AEFFAEFFFFFFFFFFFF&quot;
 };
+
+#endif // HAIKU_TARGET_PLATFORM_HAIKU

Modified: haiku/trunk/src/preferences/filetypes/FileTypes.rdef
===================================================================
--- haiku/trunk/src/preferences/filetypes/FileTypes.rdef	2007-04-14 18:11:42 UTC (rev 20683)
+++ haiku/trunk/src/preferences/filetypes/FileTypes.rdef	2007-04-14 22:36:56 UTC (rev 20684)
@@ -27,25 +27,46 @@
 };
 
 
-resource mini_icon array {
-	$&quot;FFFFFFFFFFFFFFFF020200FFFFFFFFFF&quot;
-	$&quot;FFFFFFFFFFFFFF04151E1500FFFFFFFF&quot;
-	$&quot;FFFFFFFFFFFFFF021D1E1C00FFFFFFFF&quot;
-	$&quot;FFFFFFFF00FFFF00151B1600FFFFFFFF&quot;
-	$&quot;FFFFFF003F0000FA0000000000FFFFFF&quot;
-	$&quot;FFFF003FFD0000F9F9FAFAFAFA00FFFF&quot;
-	$&quot;FF003FFEFDFD00F9F9F9F97D7D00FFFF&quot;
-	$&quot;003F62FE89007B00F9F900007D00FFFF&quot;
-	$&quot;FF003FB0FD002F00F90060600000FFFF&quot;
-	$&quot;FF003FFE002F000000606060606000FF&quot;
-	$&quot;FF000000002F00003F3F606060D500FF&quot;
-	$&quot;002B00002F00FA00ACAC3F3FD5D500FF&quot;
-	$&quot;002B7B2CEB000000ACACACACD5D5000E&quot;
-	$&quot;FF002B2F00000E00ACACACACD5D5000E&quot;
-	$&quot;FF002B2F000E0E0F0000ACACD5000E0E&quot;
-	$&quot;FFFF00000E0F0F0F0F0F0000000E0EFF&quot;
+#ifdef HAIKU_TARGET_PLATFORM_HAIKU
+
+resource vector_icon {
+	$&quot;6E6369660C0500040169020006023CADF43D104EBF02CA3EA2224BF02046648D&quot;
+	$&quot;00FFDB97FFFCAF29020006023A6496BA3F153EBCDD3EEA91492CB5C09D5100FF&quot;
+	$&quot;F7EAFEFDD17B020006023AB3673751B2BC59783FD2D74C71F846F85900C85805&quot;
+	$&quot;FFF06306020106033AC71C0000000000003AB6DB4A6A0045300000F2F2F2FFBC&quot;
+	$&quot;A184AB7D7A7A02000602388A280000000000004000004AF00000000000C85804&quot;
+	$&quot;FFDC952F020006023B37D13A0397BB629E3CB4584A3EDF4A1E9400C6D7F5FF6B&quot;
+	$&quot;94DD020006023C71E33A0C78BA15E43C7D214B02AA49855700E3EDFFFF9EC2FF&quot;
+	$&quot;0200060239AB92381275BA365C3BEB2A4B2A844A9A5F00003CB0FF2C62D00200&quot;
+	$&quot;06033AC7B03884E3B903663B534D48B61F4958AE00FCFFDC7FF8F0BCFFF4DC8A&quot;
+	$&quot;020006023A7061B88A6E3B1AAE3CFAD946AC4F48C79100000000FFA9A06E130A&quot;
+	$&quot;053E303E4452445232452C0A043E303E444C444C360A063E304C3652324630C3&quot;
+	$&quot;BBB893452C0A044C44524452324C36020448224B22452242284225422B482E45&quot;
+	$&quot;2E4B2E4E284E2B4E250605E2024A60505A5660506054604C584A0A0346305232&quot;
+	$&quot;4A2E0A063A443A564A5E56535642463C0A043A443A564A5E4A4B0A043A444A4B&quot;
+	$&quot;5642463C0A044A4B4A5E565356420604AE342D223822382C4632524247080233&quot;
+	$&quot;33273B080231BCA9B6AFBEB40802BC10BCA92B40080237BDE8B821C0BF0802BC&quot;
+	$&quot;1DBF66B8A0C1D708023BBFF3304808023B44BA12C42E100A010105000A00010B&quot;
+	$&quot;1815FF01178400040A00010B18001501178500040A0A010B000A0B070E0D0C10&quot;
+	$&quot;0F12111815FF01178100040A0001001001178400040A020101000A030102000A&quot;
+	$&quot;040103000A060106000A0001041001178400040A050104000A00010710011784&quot;
+	$&quot;00040A070108000A09010A000A08010900&quot;
 };
 
+resource(200, &quot;icon heap&quot;) #'VICN' array {
+	$&quot;6E63696605050104019202000603399E0F3D9C0ABF82B23B84A94B885046E193&quot;
+	$&quot;00A5B1FFBCEAF1FFFFB3B8FF020106023C71C43DE4E9BCEEA63BAE5F49867748&quot;
+	$&quot;01ECFFC0D5FF7C896EFF020106023C34913DBF47BD1EE83BAC5E49EA70498C6D&quot;
+	$&quot;FFC0D5FF7C896EFF040A07485E4A5E4C5F6043573D455D475D0606AE0BB40BBC&quot;
+	$&quot;1D33C07FB72CBE903C47C13EC408CA28BA52C118B656C51BB876BF07B53E3A23&quot;
+	$&quot;0605AE02B40BBF4D33C3AFB73CC1A43D50C13EC79ECA28BD823AB6BC0605AE02&quot;
+	$&quot;B40BC27D33C6DFB75DC4A3BDEFC937C13ECB34CA28C0B23AB9EC070A01010000&quot;
+	$&quot;0A0001031001178400040A040103000A0001021001178400040A030102000A00&quot;
+	$&quot;01011001178400040A02010100&quot;
+};
+
+#else // HAIKU_TARGET_PLATFORM_HAIKU
+
 resource large_icon array {
 	$&quot;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF02020000FFFFFFFFFFFFFFFFFFFF&quot;
 	$&quot;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF041B17110802FFFFFFFFFFFFFFFFFF&quot;
@@ -81,6 +102,25 @@
 	$&quot;FFFFFFFF0000000E0F0F0F0F0F0F0F0F0F0F0F00000E0E0EFFFFFFFFFFFFFFFF&quot;
 };
 
+resource mini_icon array {
+	$&quot;FFFFFFFFFFFFFFFF020200FFFFFFFFFF&quot;
+	$&quot;FFFFFFFFFFFFFF04151E1500FFFFFFFF&quot;
+	$&quot;FFFFFFFFFFFFFF021D1E1C00FFFFFFFF&quot;
+	$&quot;FFFFFFFF00FFFF00151B1600FFFFFFFF&quot;
+	$&quot;FFFFFF003F0000FA0000000000FFFFFF&quot;
+	$&quot;FFFF003FFD0000F9F9FAFAFAFA00FFFF&quot;
+	$&quot;FF003FFEFDFD00F9F9F9F97D7D00FFFF&quot;
+	$&quot;003F62FE89007B00F9F900007D00FFFF&quot;
+	$&quot;FF003FB0FD002F00F90060600000FFFF&quot;
+	$&quot;FF003FFE002F000000606060606000FF&quot;
+	$&quot;FF000000002F00003F3F606060D500FF&quot;
+	$&quot;002B00002F00FA00ACAC3F3FD5D500FF&quot;
+	$&quot;002B7B2CEB000000ACACACACD5D5000E&quot;
+	$&quot;FF002B2F00000E00ACACACACD5D5000E&quot;
+	$&quot;FF002B2F000E0E0F0000ACACD5000E0E&quot;
+	$&quot;FFFF00000E0F0F0F0F0F0000000E0EFF&quot;
+};
+
 resource(200, &quot;icon heap&quot;) #'ICON' array {
 	$&quot;FFFFFFFFFFFFFFFFFFFFFFFF0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;
 	$&quot;FFFFFFFFFFFFFFFFFFFFFF0060600000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;
@@ -115,3 +155,5 @@
 	$&quot;FFFFFFFFFFFFFFFFFFFFFFFFAEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;
 	$&quot;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;
 };
+
+#endif // HAIKU_TARGET_PLATFORM_HAIKU

Modified: haiku/trunk/src/preferences/filetypes/IconView.cpp
===================================================================
--- haiku/trunk/src/preferences/filetypes/IconView.cpp	2007-04-14 18:11:42 UTC (rev 20683)
+++ haiku/trunk/src/preferences/filetypes/IconView.cpp	2007-04-14 22:36:56 UTC (rev 20684)
@@ -1053,13 +1053,32 @@
 
 	if (show) {
 		BResources* resources = be_app-&gt;AppResources();
-		const void* data = NULL;
-		// TODO: get vector heap icon!
-		if (resources != NULL)
-			data = resources-&gt;LoadResource('ICON', &quot;icon heap&quot;, NULL);
-		if (data != NULL) {
-			fHeapIcon = Icon::AllocateBitmap(B_LARGE_ICON, B_CMAP8);
-			memcpy(fHeapIcon-&gt;Bits(), data, fHeapIcon-&gt;BitsLength());
+		if (resources != NULL) {
+			const void* data = NULL;
+#ifdef HAIKU_TARGET_PLATFORM_HAIKU
+			size_t size;
+			data = resources-&gt;LoadResource('VICN', &quot;icon heap&quot;, &amp;size);
+			if (data != NULL) {
+				// got vector icon data
+				fHeapIcon = Icon::AllocateBitmap(B_LARGE_ICON, B_RGBA32);
+				if (BIconUtils::GetVectorIcon((const uint8*)data,
+						size, fHeapIcon) != B_OK) {
+					// bad data
+					delete fHeapIcon;
+					fHeapIcon = NULL;
+					data = NULL;
+				}
+			}
+#endif // HAIKU_TARGET_PLATFORM_HAIKU
+			if (data == NULL) {
+				// no vector icon or failed to get bitmap
+				// try bitmap icon
+				data = resources-&gt;LoadResource('ICON', &quot;icon heap&quot;, NULL);
+				if (data != NULL) {
+					fHeapIcon = Icon::AllocateBitmap(B_LARGE_ICON, B_CMAP8);
+					memcpy(fHeapIcon-&gt;Bits(), data, fHeapIcon-&gt;BitsLength());
+				}
+			}
 		}
 	} else {
 		delete fHeapIcon;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001581.html">[Haiku-commits] r20683 - in haiku/trunk: headers/os/app	src/kits/interface
</A></li>
	<LI>Next message: <A HREF="001584.html">[Haiku-commits] r20684 - haiku/trunk/src/preferences/filetypes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1582">[ date ]</a>
              <a href="thread.html#1582">[ thread ]</a>
              <a href="subject.html#1582">[ subject ]</a>
              <a href="author.html#1582">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
