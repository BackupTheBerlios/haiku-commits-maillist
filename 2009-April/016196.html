<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r30409 - in haiku/trunk/src/apps/debuganalyzer: .	gui gui/main_window gui/table gui/thread_window model	model_loader util
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-April/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r30409%20-%20in%20haiku/trunk/src/apps/debuganalyzer%3A%20.%0A%09gui%20gui/main_window%20gui/table%20gui/thread_window%20model%0A%09model_loader%20util&In-Reply-To=%3C200904251956.n3PJuX49023777%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016195.html">
   <LINK REL="Next"  HREF="016197.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r30409 - in haiku/trunk/src/apps/debuganalyzer: .	gui gui/main_window gui/table gui/thread_window model	model_loader util</H1>
    <B>bonefish at mail.berlios.de</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r30409%20-%20in%20haiku/trunk/src/apps/debuganalyzer%3A%20.%0A%09gui%20gui/main_window%20gui/table%20gui/thread_window%20model%0A%09model_loader%20util&In-Reply-To=%3C200904251956.n3PJuX49023777%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r30409 - in haiku/trunk/src/apps/debuganalyzer: .	gui gui/main_window gui/table gui/thread_window model	model_loader util">bonefish at mail.berlios.de
       </A><BR>
    <I>Sat Apr 25 21:56:33 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="016195.html">[Haiku-commits] r30408 - in haiku/trunk/src/apps/debuganalyzer: .	main_window thread_window
</A></li>
        <LI>Next message: <A HREF="016197.html">[Haiku-commits] r30409 - in haiku/trunk/src/apps/debuganalyzer: . gui gui/main_window gui/table gui/thread_window model model_loader util
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16196">[ date ]</a>
              <a href="thread.html#16196">[ thread ]</a>
              <a href="subject.html#16196">[ subject ]</a>
              <a href="author.html#16196">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: bonefish
Date: 2009-04-25 21:56:18 +0200 (Sat, 25 Apr 2009)
New Revision: 30409
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=30409&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=30409&amp;view=rev</A>

Added:
   haiku/trunk/src/apps/debuganalyzer/gui/
   haiku/trunk/src/apps/debuganalyzer/gui/AbstractGeneralPage.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/AbstractGeneralPage.h
   haiku/trunk/src/apps/debuganalyzer/gui/Jamfile
   haiku/trunk/src/apps/debuganalyzer/gui/SubWindow.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/SubWindow.h
   haiku/trunk/src/apps/debuganalyzer/gui/SubWindowManager.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/SubWindowManager.h
   haiku/trunk/src/apps/debuganalyzer/gui/main_window/
   haiku/trunk/src/apps/debuganalyzer/gui/main_window/Jamfile
   haiku/trunk/src/apps/debuganalyzer/gui/main_window/MainWindow.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/main_window/MainWindow.h
   haiku/trunk/src/apps/debuganalyzer/gui/main_window/ThreadsPage.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/main_window/ThreadsPage.h
   haiku/trunk/src/apps/debuganalyzer/gui/table/
   haiku/trunk/src/apps/debuganalyzer/gui/table/Jamfile
   haiku/trunk/src/apps/debuganalyzer/gui/table/Table.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/table/Table.h
   haiku/trunk/src/apps/debuganalyzer/gui/table/TableColumns.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/table/TableColumns.h
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/GeneralPage.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/GeneralPage.h
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/Jamfile
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/ThreadWindow.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/ThreadWindow.h
   haiku/trunk/src/apps/debuganalyzer/model/
   haiku/trunk/src/apps/debuganalyzer/model/Jamfile
   haiku/trunk/src/apps/debuganalyzer/model/Model.cpp
   haiku/trunk/src/apps/debuganalyzer/model/Model.h
   haiku/trunk/src/apps/debuganalyzer/model_loader/
   haiku/trunk/src/apps/debuganalyzer/model_loader/Jamfile
   haiku/trunk/src/apps/debuganalyzer/model_loader/ModelLoader.cpp
   haiku/trunk/src/apps/debuganalyzer/model_loader/ModelLoader.h
   haiku/trunk/src/apps/debuganalyzer/util/
   haiku/trunk/src/apps/debuganalyzer/util/DataSource.cpp
   haiku/trunk/src/apps/debuganalyzer/util/DataSource.h
   haiku/trunk/src/apps/debuganalyzer/util/Jamfile
   haiku/trunk/src/apps/debuganalyzer/util/Variant.cpp
   haiku/trunk/src/apps/debuganalyzer/util/Variant.h
Removed:
   haiku/trunk/src/apps/debuganalyzer/AbstractGeneralPage.cpp
   haiku/trunk/src/apps/debuganalyzer/AbstractGeneralPage.h
   haiku/trunk/src/apps/debuganalyzer/DataSource.cpp
   haiku/trunk/src/apps/debuganalyzer/DataSource.h
   haiku/trunk/src/apps/debuganalyzer/Model.cpp
   haiku/trunk/src/apps/debuganalyzer/Model.h
   haiku/trunk/src/apps/debuganalyzer/ModelLoader.cpp
   haiku/trunk/src/apps/debuganalyzer/ModelLoader.h
   haiku/trunk/src/apps/debuganalyzer/SubWindow.cpp
   haiku/trunk/src/apps/debuganalyzer/SubWindow.h
   haiku/trunk/src/apps/debuganalyzer/SubWindowManager.cpp
   haiku/trunk/src/apps/debuganalyzer/SubWindowManager.h
   haiku/trunk/src/apps/debuganalyzer/Table.cpp
   haiku/trunk/src/apps/debuganalyzer/Table.h
   haiku/trunk/src/apps/debuganalyzer/TableColumns.cpp
   haiku/trunk/src/apps/debuganalyzer/TableColumns.h
   haiku/trunk/src/apps/debuganalyzer/Variant.cpp
   haiku/trunk/src/apps/debuganalyzer/Variant.h
   haiku/trunk/src/apps/debuganalyzer/gui/main_window/MainWindow.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/main_window/MainWindow.h
   haiku/trunk/src/apps/debuganalyzer/gui/main_window/ThreadsPage.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/main_window/ThreadsPage.h
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/GeneralPage.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/GeneralPage.h
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/Jamfile
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/ThreadWindow.cpp
   haiku/trunk/src/apps/debuganalyzer/gui/thread_window/ThreadWindow.h
   haiku/trunk/src/apps/debuganalyzer/main_window/
   haiku/trunk/src/apps/debuganalyzer/thread_window/
Modified:
   haiku/trunk/src/apps/debuganalyzer/Jamfile
Log:
Reorganized sources.


Deleted: haiku/trunk/src/apps/debuganalyzer/AbstractGeneralPage.cpp

Deleted: haiku/trunk/src/apps/debuganalyzer/AbstractGeneralPage.h

Deleted: haiku/trunk/src/apps/debuganalyzer/DataSource.cpp

Deleted: haiku/trunk/src/apps/debuganalyzer/DataSource.h

Modified: haiku/trunk/src/apps/debuganalyzer/Jamfile
===================================================================
--- haiku/trunk/src/apps/debuganalyzer/Jamfile	2009-04-25 19:16:58 UTC (rev 30408)
+++ haiku/trunk/src/apps/debuganalyzer/Jamfile	2009-04-25 19:56:18 UTC (rev 30409)
@@ -3,29 +3,33 @@
 UsePrivateHeaders debug interface kernel shared ;
 UsePrivateSystemHeaders ;
 
-SEARCH_SOURCE += [ FDirName $(SUBDIR) main_window ] ;
+HAIKU_DEBUG_ANALYZER_HEADERS = 
+	$(SUBDIR)
+	[ FDirName $(SUBDIR) gui ]
+	[ FDirName $(SUBDIR) model ]
+	[ FDirName $(SUBDIR) model_loader ]
+	[ FDirName $(SUBDIR) util ]
+;
 
+UseHeaders $(HAIKU_DEBUG_ANALYZER_HEADERS) ;
+
+
 Application DebugAnalyzer
 	:
-	AbstractGeneralPage.cpp
-	DataSource.cpp
 	DebugAnalyzer.cpp
-	Model.cpp
-	ModelLoader.cpp
-	SubWindow.cpp
-	SubWindowManager.cpp
-	Table.cpp
-	TableColumns.cpp
-	Variant.cpp
 
 	:
-	&lt;nogrist&gt;DebugAnalyzer_MainWindow.o
-	&lt;nogrist&gt;DebugAnalyzer_ThreadWindow.o
+	&lt;nogrist&gt;DebugAnalyzer_gui.o
+	&lt;nogrist&gt;DebugAnalyzer_model.o
+	&lt;nogrist&gt;DebugAnalyzer_model_loader.o
+	&lt;nogrist&gt;DebugAnalyzer_util.o
 
 	libcolumnlistview.a libdebug.so be
 	:
 	DebugAnalyzer.rdef
 ;
 
-HaikuSubInclude main_window ;
-HaikuSubInclude thread_window ;
+HaikuSubInclude gui ;
+HaikuSubInclude model ;
+HaikuSubInclude model_loader ;
+HaikuSubInclude util ;

Deleted: haiku/trunk/src/apps/debuganalyzer/Model.cpp

Deleted: haiku/trunk/src/apps/debuganalyzer/Model.h

Deleted: haiku/trunk/src/apps/debuganalyzer/ModelLoader.cpp

Deleted: haiku/trunk/src/apps/debuganalyzer/ModelLoader.h

Deleted: haiku/trunk/src/apps/debuganalyzer/SubWindow.cpp

Deleted: haiku/trunk/src/apps/debuganalyzer/SubWindow.h

Deleted: haiku/trunk/src/apps/debuganalyzer/SubWindowManager.cpp

Deleted: haiku/trunk/src/apps/debuganalyzer/SubWindowManager.h

Deleted: haiku/trunk/src/apps/debuganalyzer/Table.cpp

Deleted: haiku/trunk/src/apps/debuganalyzer/Table.h

Deleted: haiku/trunk/src/apps/debuganalyzer/TableColumns.cpp

Deleted: haiku/trunk/src/apps/debuganalyzer/TableColumns.h

Deleted: haiku/trunk/src/apps/debuganalyzer/Variant.cpp

Deleted: haiku/trunk/src/apps/debuganalyzer/Variant.h

Copied: haiku/trunk/src/apps/debuganalyzer/gui/AbstractGeneralPage.cpp (from rev 30403, haiku/trunk/src/apps/debuganalyzer/AbstractGeneralPage.cpp)

Copied: haiku/trunk/src/apps/debuganalyzer/gui/AbstractGeneralPage.h (from rev 30403, haiku/trunk/src/apps/debuganalyzer/AbstractGeneralPage.h)

Added: haiku/trunk/src/apps/debuganalyzer/gui/Jamfile
===================================================================
--- haiku/trunk/src/apps/debuganalyzer/gui/Jamfile	2009-04-25 19:16:58 UTC (rev 30408)
+++ haiku/trunk/src/apps/debuganalyzer/gui/Jamfile	2009-04-25 19:56:18 UTC (rev 30409)
@@ -0,0 +1,23 @@
+SubDir HAIKU_TOP src apps debuganalyzer gui ;
+
+UsePrivateHeaders debug interface kernel shared ;
+UsePrivateSystemHeaders ;
+
+UseHeaders $(HAIKU_DEBUG_ANALYZER_HEADERS) ;
+
+
+MergeObject DebugAnalyzer_gui.o
+	:
+	AbstractGeneralPage.cpp
+	SubWindow.cpp
+	SubWindowManager.cpp
+	:
+	DebugAnalyzer_gui_main_window.o
+	DebugAnalyzer_gui_table.o
+	DebugAnalyzer_gui_thread_window.o
+;
+
+
+HaikuSubInclude main_window ;
+HaikuSubInclude table ;
+HaikuSubInclude thread_window ;

Copied: haiku/trunk/src/apps/debuganalyzer/gui/SubWindow.cpp (from rev 30402, haiku/trunk/src/apps/debuganalyzer/SubWindow.cpp)

Copied: haiku/trunk/src/apps/debuganalyzer/gui/SubWindow.h (from rev 30402, haiku/trunk/src/apps/debuganalyzer/SubWindow.h)

Copied: haiku/trunk/src/apps/debuganalyzer/gui/SubWindowManager.cpp (from rev 30402, haiku/trunk/src/apps/debuganalyzer/SubWindowManager.cpp)

Copied: haiku/trunk/src/apps/debuganalyzer/gui/SubWindowManager.h (from rev 30402, haiku/trunk/src/apps/debuganalyzer/SubWindowManager.h)

Copied: haiku/trunk/src/apps/debuganalyzer/gui/main_window (from rev 30388, haiku/trunk/src/apps/debuganalyzer/main_window)

Copied: haiku/trunk/src/apps/debuganalyzer/gui/main_window/Jamfile (from rev 30408, haiku/trunk/src/apps/debuganalyzer/main_window/Jamfile)
===================================================================
--- haiku/trunk/src/apps/debuganalyzer/main_window/Jamfile	2009-04-25 19:16:58 UTC (rev 30408)
+++ haiku/trunk/src/apps/debuganalyzer/gui/main_window/Jamfile	2009-04-25 19:56:18 UTC (rev 30409)
@@ -0,0 +1,13 @@
+SubDir HAIKU_TOP src apps debuganalyzer gui main_window ;
+
+UsePrivateHeaders debug interface kernel shared ;
+UsePrivateSystemHeaders ;
+
+UseHeaders $(HAIKU_DEBUG_ANALYZER_HEADERS) ;
+
+
+MergeObject DebugAnalyzer_gui_main_window.o
+	:
+	MainWindow.cpp
+	ThreadsPage.cpp
+;

Deleted: haiku/trunk/src/apps/debuganalyzer/gui/main_window/MainWindow.cpp

Copied: haiku/trunk/src/apps/debuganalyzer/gui/main_window/MainWindow.cpp (from rev 30408, haiku/trunk/src/apps/debuganalyzer/main_window/MainWindow.cpp)

Deleted: haiku/trunk/src/apps/debuganalyzer/gui/main_window/MainWindow.h

Copied: haiku/trunk/src/apps/debuganalyzer/gui/main_window/MainWindow.h (from rev 30408, haiku/trunk/src/apps/debuganalyzer/main_window/MainWindow.h)

Deleted: haiku/trunk/src/apps/debuganalyzer/gui/main_window/ThreadsPage.cpp

Copied: haiku/trunk/src/apps/debuganalyzer/gui/main_window/ThreadsPage.cpp (from rev 30408, haiku/trunk/src/apps/debuganalyzer/main_window/ThreadsPage.cpp)
===================================================================
--- haiku/trunk/src/apps/debuganalyzer/main_window/ThreadsPage.cpp	2009-04-25 19:16:58 UTC (rev 30408)
+++ haiku/trunk/src/apps/debuganalyzer/gui/main_window/ThreadsPage.cpp	2009-04-25 19:56:18 UTC (rev 30409)
@@ -0,0 +1,185 @@
+/*
+ * Copyright 2009, Ingo Weinhold, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">ingo_weinhold at gmx.de.</A>
+ * Distributed under the terms of the MIT License.
+ */
+
+#include &quot;main_window/ThreadsPage.h&quot;
+
+#include &lt;stdio.h&gt;
+
+#include &lt;new&gt;
+
+#include &quot;table/TableColumns.h&quot;
+
+
+// #pragma mark - ThreadsTableModel
+
+
+class MainWindow::ThreadsPage::ThreadsTableModel : public TableModel {
+public:
+	ThreadsTableModel(Model* model)
+		:
+		fModel(model)
+	{
+	}
+
+	virtual int32 CountColumns() const
+	{
+		return 14;
+	}
+
+	virtual int32 CountRows() const
+	{
+		return fModel-&gt;CountThreads();
+	}
+
+	virtual bool GetValueAt(int32 rowIndex, int32 columnIndex, Variant&amp; value)
+	{
+		Model::Thread* thread = fModel-&gt;ThreadAt(rowIndex);
+		if (thread == NULL)
+			return false;
+
+		switch (columnIndex) {
+			case 0:
+				value.SetTo(thread-&gt;ID());
+				return true;
+			case 1:
+				value.SetTo(thread-&gt;Name(), VARIANT_DONT_COPY_DATA);
+				return true;
+			case 2:
+			{
+				char buffer[128];
+				Model::Team* team = thread-&gt;GetTeam();
+				snprintf(buffer, sizeof(buffer), &quot;%s (%ld)&quot;, team-&gt;Name(),
+					team-&gt;ID());
+				value.SetTo(buffer);
+				return true;
+			}
+			case 3:
+				value.SetTo(thread-&gt;CreationTime());
+				return true;
+			case 4:
+				value.SetTo(thread-&gt;DeletionTime());
+				return true;
+			case 5:
+				value.SetTo(thread-&gt;Runs());
+				return true;
+			case 6:
+				value.SetTo(thread-&gt;TotalRunTime());
+				return true;
+			case 7:
+				value.SetTo(thread-&gt;Latencies());
+				return true;
+			case 8:
+				value.SetTo(thread-&gt;TotalLatency());
+				return true;
+			case 9:
+				value.SetTo(thread-&gt;Preemptions());
+				return true;
+			case 10:
+				value.SetTo(thread-&gt;TotalRerunTime());
+				return true;
+			case 11:
+				value.SetTo(thread-&gt;Waits());
+				return true;
+			case 12:
+				value.SetTo(thread-&gt;TotalWaitTime());
+				return true;
+			case 13:
+				value.SetTo(thread-&gt;UnspecifiedWaitTime());
+				return true;
+			default:
+				return false;
+		}
+	}
+
+private:
+	Model*	fModel;
+};
+
+
+// #pragma mark - ThreadsPage
+
+
+MainWindow::ThreadsPage::ThreadsPage(MainWindow* parent)
+	:
+	BGroupView(B_VERTICAL),
+	fParent(parent),
+	fThreadsTable(NULL),
+	fThreadsTableModel(NULL),
+	fModel(NULL)
+
+{
+	SetName(&quot;Threads&quot;);
+
+	fThreadsTable = new Table(&quot;threads list&quot;, 0);
+	AddChild(fThreadsTable-&gt;ToView());
+
+	fThreadsTable-&gt;AddColumn(new Int32TableColumn(0, &quot;ID&quot;, 40, 20, 1000,
+		B_TRUNCATE_MIDDLE, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new StringTableColumn(1, &quot;Name&quot;, 80, 40, 1000,
+		B_TRUNCATE_END, B_ALIGN_LEFT));
+	fThreadsTable-&gt;AddColumn(new StringTableColumn(2, &quot;Team&quot;, 80, 40, 1000,
+		B_TRUNCATE_END, B_ALIGN_LEFT));
+	fThreadsTable-&gt;AddColumn(new BigtimeTableColumn(3, &quot;Creation&quot;, 80, 40, 1000,
+		true, B_TRUNCATE_MIDDLE, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new BigtimeTableColumn(4, &quot;Deletion&quot;, 80, 40, 1000,
+		false, B_TRUNCATE_MIDDLE, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new Int64TableColumn(5, &quot;Runs&quot;, 80, 20, 1000,
+		B_TRUNCATE_END, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new BigtimeTableColumn(6, &quot;Run Time&quot;, 80, 20, 1000,
+		false, B_TRUNCATE_END, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new Int64TableColumn(7, &quot;Latencies&quot;, 80, 20, 1000,
+		B_TRUNCATE_END, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new BigtimeTableColumn(8, &quot;Latency Time&quot;, 80, 20,
+		1000, B_TRUNCATE_END, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new Int64TableColumn(9, &quot;Preemptions&quot;, 80, 20,
+		1000, B_TRUNCATE_END, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new BigtimeTableColumn(10, &quot;Preemption Time&quot;, 80,
+		20, 1000, false, B_TRUNCATE_END, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new Int64TableColumn(11, &quot;Waits&quot;, 80, 20,
+		1000, B_TRUNCATE_END, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new BigtimeTableColumn(12, &quot;Wait Time&quot;, 80,
+		20, 1000, false, B_TRUNCATE_END, B_ALIGN_RIGHT));
+	fThreadsTable-&gt;AddColumn(new BigtimeTableColumn(13, &quot;Unspecified Time&quot;, 80,
+		20, 1000, false, B_TRUNCATE_END, B_ALIGN_RIGHT));
+
+	fThreadsTable-&gt;AddTableListener(this);
+}
+
+
+MainWindow::ThreadsPage::~ThreadsPage()
+{
+	fThreadsTable-&gt;SetTableModel(NULL);
+	delete fThreadsTableModel;
+}
+
+
+void
+MainWindow::ThreadsPage::SetModel(Model* model)
+{
+	if (model == fModel)
+		return;
+
+	if (fModel != NULL) {
+		fThreadsTable-&gt;SetTableModel(NULL);
+		delete fThreadsTableModel;
+		fThreadsTableModel = NULL;
+	}
+
+	fModel = model;
+
+	if (fModel != NULL) {
+		fThreadsTableModel = new(std::nothrow) ThreadsTableModel(fModel);
+		fThreadsTable-&gt;SetTableModel(fThreadsTableModel);
+	}
+}
+
+
+void
+MainWindow::ThreadsPage::TableRowInvoked(Table* table, int32 rowIndex)
+{
+	Model::Thread* thread = fModel-&gt;ThreadAt(rowIndex);
+	if (thread != NULL)
+		fParent-&gt;OpenThreadWindow(thread);
+}

Deleted: haiku/trunk/src/apps/debuganalyzer/gui/main_window/ThreadsPage.h

Copied: haiku/trunk/src/apps/debuganalyzer/gui/main_window/ThreadsPage.h (from rev 30408, haiku/trunk/src/apps/debuganalyzer/main_window/ThreadsPage.h)
===================================================================
--- haiku/trunk/src/apps/debuganalyzer/main_window/ThreadsPage.h	2009-04-25 19:16:58 UTC (rev 30408)
+++ haiku/trunk/src/apps/debuganalyzer/gui/main_window/ThreadsPage.h	2009-04-25 19:56:18 UTC (rev 30409)
@@ -0,0 +1,38 @@
+/*
+ * Copyright 2009, Ingo Weinhold, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">ingo_weinhold at gmx.de.</A>
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef THREADS_PAGE_H
+#define THREADS_PAGE_H
+
+#include &lt;GroupView.h&gt;
+
+#include &quot;table/Table.h&quot;
+
+#include &quot;main_window/MainWindow.h&quot;
+
+
+class MainWindow::ThreadsPage : public BGroupView, private TableListener {
+public:
+								ThreadsPage(MainWindow* parent);
+	virtual						~ThreadsPage();
+
+			void				SetModel(Model* model);
+
+private:
+			class ThreadsTableModel;
+
+private:
+	// TableListener
+	virtual	void				TableRowInvoked(Table* table, int32 rowIndex);
+
+private:
+			MainWindow*			fParent;
+			Table*				fThreadsTable;
+			ThreadsTableModel*	fThreadsTableModel;
+			Model*				fModel;
+};
+
+
+
+#endif	// THREADS_PAGE_H

Added: haiku/trunk/src/apps/debuganalyzer/gui/table/Jamfile
===================================================================
--- haiku/trunk/src/apps/debuganalyzer/gui/table/Jamfile	2009-04-25 19:16:58 UTC (rev 30408)
+++ haiku/trunk/src/apps/debuganalyzer/gui/table/Jamfile	2009-04-25 19:56:18 UTC (rev 30409)
@@ -0,0 +1,13 @@
+SubDir HAIKU_TOP src apps debuganalyzer gui table ;
+
+UsePrivateHeaders debug interface kernel shared ;
+UsePrivateSystemHeaders ;
+
+UseHeaders $(HAIKU_DEBUG_ANALYZER_HEADERS) ;
+
+
+MergeObject DebugAnalyzer_gui_table.o
+	:
+	Table.cpp
+	TableColumns.cpp
+;

Copied: haiku/trunk/src/apps/debuganalyzer/gui/table/Table.cpp (from rev 30400, haiku/trunk/src/apps/debuganalyzer/Table.cpp)
===================================================================
--- haiku/trunk/src/apps/debuganalyzer/Table.cpp	2009-04-25 16:48:13 UTC (rev 30400)
+++ haiku/trunk/src/apps/debuganalyzer/gui/table/Table.cpp	2009-04-25 19:56:18 UTC (rev 30409)
@@ -0,0 +1,280 @@
+/*
+ * Copyright 2009, Ingo Weinhold, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">ingo_weinhold at gmx.de.</A>
+ * Distributed under the terms of the MIT License.
+ */
+
+#include &quot;table/Table.h&quot;
+
+#include &lt;new&gt;
+
+
+// #pragma mark - TableField
+
+class TableField : public BField {
+public:
+	TableField(int32 rowIndex)
+		:
+		fRowIndex(rowIndex)
+	{
+	}
+
+	int32 RowIndex() const
+	{
+		return fRowIndex;
+	}
+
+private:
+	int32	fRowIndex;
+};
+
+
+// #pragma mark - TableModel
+
+
+TableModel::~TableModel()
+{
+}
+
+
+// #pragma mark - TableColumn
+
+
+TableColumn::TableColumn(int32 modelIndex, float width, float minWidth,
+	float maxWidth, alignment align)
+	:
+	BColumn(width, minWidth, maxWidth, align),
+	fModel(NULL),
+	fModelIndex(modelIndex)
+{
+}
+
+
+TableColumn::~TableColumn()
+{
+}
+
+
+void
+TableColumn::SetTableModel(TableModel* model)
+{
+	fModel = model;
+}
+
+
+void
+TableColumn::DrawValue(const Variant&amp; value, BRect rect, BView* targetView)
+{
+}
+
+
+int
+TableColumn::CompareValues(const Variant&amp; a, const Variant&amp; b)
+{
+	return 0;
+}
+
+
+float
+TableColumn::GetPreferredValueWidth(const Variant&amp; value, BView* parent) const
+{
+	return Width();
+}
+
+
+void
+TableColumn::DrawField(BField* _field, BRect rect, BView* targetView)
+{
+	TableField* field = dynamic_cast&lt;TableField*&gt;(_field);
+	if (field == NULL)
+		return;
+
+	Variant value;
+	if (!fModel-&gt;GetValueAt(field-&gt;RowIndex(), fModelIndex, value))
+		return;
+	DrawValue(value, rect, targetView);
+}
+
+
+int
+TableColumn::CompareFields(BField* _field1, BField* _field2)
+{
+	TableField* field1 = dynamic_cast&lt;TableField*&gt;(_field1);
+	TableField* field2 = dynamic_cast&lt;TableField*&gt;(_field2);
+
+	if (field1 == field2)
+		return 0;
+
+	if (field1 == NULL)
+		return -1;
+	if (field2 == NULL)
+		return 1;
+
+	Variant value1;
+	bool valid1 = fModel-&gt;GetValueAt(field1-&gt;RowIndex(), fModelIndex, value1);
+	Variant value2;
+	bool valid2 = fModel-&gt;GetValueAt(field2-&gt;RowIndex(), fModelIndex, value2);
+
+	if (!valid1)
+		return valid2 ? -1 : 0;
+	if (!valid2)
+		return 1;
+
+	return CompareValues(value1, value2);
+}
+
+
+float
+TableColumn::GetPreferredWidth(BField* _field, BView* parent) const
+{
+	TableField* field = dynamic_cast&lt;TableField*&gt;(_field);
+	if (field == NULL)
+		return Width();
+
+	Variant value;
+	if (!fModel-&gt;GetValueAt(field-&gt;RowIndex(), fModelIndex, value))
+		return Width();
+	return GetPreferredValueWidth(value, parent);
+}
+
+
+// #pragma mark - TableListener
+
+
+TableListener::~TableListener()
+{
+}
+
+
+void
+TableListener::TableRowInvoked(Table* table, int32 rowIndex)
+{
+}
+
+
+// #pragma mark - Table
+
+
+Table::Table(const char* name, uint32 flags, border_style borderStyle,
+	bool showHorizontalScrollbar)
+	:
+	BColumnListView(name, flags, borderStyle, showHorizontalScrollbar),
+	fModel(NULL)
+{
+}
+
+
+Table::Table(TableModel* model, const char* name, uint32 flags,
+	border_style borderStyle, bool showHorizontalScrollbar)
+	:
+	BColumnListView(name, flags, borderStyle, showHorizontalScrollbar),
+	fModel(NULL),
+	fColumns(20, true)
+{
+	SetTableModel(model);
+}
+
+
+Table::~Table()
+{
+	for (int32 i = CountColumns() - 1; i &gt;= 0; i--)
+		RemoveColumn(ColumnAt(i));
+}
+
+
+void
+Table::SetTableModel(TableModel* model)
+{
+	if (model == fModel)
+		return;
+
+	if (fModel != NULL) {
+		Clear();
+
+		for (int32 i = 0; TableColumn* column = fColumns.ItemAt(i); i++)
+			column-&gt;SetTableModel(NULL);
+	}
+
+	fModel = model;
+
+	if (fModel == NULL)
+		return;
+
+	for (int32 i = 0; TableColumn* column = fColumns.ItemAt(i); i++)
+		column-&gt;SetTableModel(fModel);
+
+	// create the rows
+	int32 rowCount = fModel-&gt;CountRows();
+	int32 columnCount = fModel-&gt;CountColumns();
+
+	for (int32 i = 0; i &lt; rowCount; i++) {
+		// create row
+		BRow* row = new(std::nothrow) BRow();
+		if (row == NULL) {
+			// TODO: Report error!
+			return;
+		}
+
+		// add dummy fields to row
+		for (int32 columnIndex = 0; columnIndex &lt; columnCount; columnIndex++) {
+			// It would be nice to create only a single field and set it for all
+			// columns, but the row takes ultimate ownership, so it have to be
+			// individual objects.
+			TableField* field = new(std::nothrow) TableField(i);
+			if (field == NULL) {
+				// TODO: Report error!
+				return;
+			}
+
+			row-&gt;SetField(field, columnIndex);
+		}
+
+		// add row
+		AddRow(row);
+	}
+}
+
+
+void
+Table::AddColumn(TableColumn* column)
+{
+	if (column == NULL)
+		return;
+
+	if (!fColumns.AddItem(column))
+		throw std::bad_alloc();
+
+	column-&gt;SetTableModel(fModel);
+
+	BColumnListView::AddColumn(column, column-&gt;ModelIndex());
+}
+
+
+bool
+Table::AddTableListener(TableListener* listener)
+{
+	return fListeners.AddItem(listener);
+}
+
+
+void
+Table::RemoveTableListener(TableListener* listener)
+{
+	fListeners.RemoveItem(listener);
+}
+
+
+void
+Table::ItemInvoked()
+{
+	if (fListeners.IsEmpty())
+		return;
+
+	BRow* row = CurrentSelection();
+	if (row == NULL)
+		return;
+
+	int32 index = IndexOf(row);
+	int32 listenerCount = fListeners.CountItems();
+	for (int32 i = listenerCount - 1; i &gt;= 0; i--)
+		fListeners.ItemAt(i)-&gt;TableRowInvoked(this, index);
+}

Copied: haiku/trunk/src/apps/debuganalyzer/gui/table/Table.h (from rev 30400, haiku/trunk/src/apps/debuganalyzer/Table.h)

Copied: haiku/trunk/src/apps/debuganalyzer/gui/table/TableColumns.cpp (from rev 30385, haiku/trunk/src/apps/debuganalyzer/TableColumns.cpp)
===================================================================
--- haiku/trunk/src/apps/debuganalyzer/TableColumns.cpp	2009-04-24 22:45:39 UTC (rev 30385)
+++ haiku/trunk/src/apps/debuganalyzer/gui/table/TableColumns.cpp	2009-04-25 19:56:18 UTC (rev 30409)
@@ -0,0 +1,211 @@
+/*
+ * Copyright 2009, Ingo Weinhold, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">ingo_weinhold at gmx.de.</A>
+ * Distributed under the terms of the MIT License.
+ */
+
+#include &quot;table/TableColumns.h&quot;
+
+#include &lt;stdio.h&gt;
+
+
+// #pragma mark - DelagateBasedTableColumn
+
+
+DelagateBasedTableColumn::DelagateBasedTableColumn(BColumn* columnDelegate,
+	int32 modelIndex, float width, float minWidth, float maxWidth,
+	alignment align)
+	:
+	TableColumn(modelIndex, width, minWidth, maxWidth, align),
+	fColumnDelegate(columnDelegate)
+{
+}
+
+
+DelagateBasedTableColumn::~DelagateBasedTableColumn()
+{
+}
+
+
+void
+DelagateBasedTableColumn::DrawTitle(BRect rect, BView* targetView)
+{
+	fColumnDelegate-&gt;DrawTitle(rect, targetView);
+}
+
+
+void
+DelagateBasedTableColumn::GetColumnName(BString* into) const
+{
+	fColumnDelegate-&gt;GetColumnName(into);
+}
+
+
+void
+DelagateBasedTableColumn::DrawValue(const Variant&amp; value, BRect rect,
+	BView* targetView)
+{
+	fColumnDelegate-&gt;DrawField(PrepareField(value), rect, targetView);
+}
+
+
+float
+DelagateBasedTableColumn::GetPreferredValueWidth(const Variant&amp; value,
+	BView* parent) const
+{
+	return fColumnDelegate-&gt;GetPreferredWidth(PrepareField(value), parent);
+}
+
+
+// #pragma mark - StringTableColumn
+
+
+StringTableColumn::StringTableColumn(int32 modelIndex, const char* title,
+	float width, float minWidth, float maxWidth, uint32 truncate,
+	alignment align)
+	:
+	DelagateBasedTableColumn(&amp;fColumn, modelIndex, width, minWidth, maxWidth,
+		align),
+	fColumn(title, width, minWidth, maxWidth, truncate, align),
+	fField(&quot;&quot;)
+{
+}
+
+
+StringTableColumn::~StringTableColumn()
+{
+}
+
+
+BField*
+StringTableColumn::PrepareField(const Variant&amp; value) const
+{
+	fField.SetString(value.ToString());
+	fField.SetWidth(Width());
+	return &fField;
+}
+
+
+int
+StringTableColumn::CompareValues(const Variant&amp; a, const Variant&amp; b)
+{
+	return strcasecmp(a.ToString(), b.ToString());
+}
+
+
+// #pragma mark - Int32TableColumn
+
+
+Int32TableColumn::Int32TableColumn(int32 modelIndex, const char* title,
+	float width, float minWidth, float maxWidth, uint32 truncate,
+	alignment align)
+	:
+	StringTableColumn(modelIndex, title, width, minWidth, maxWidth, truncate,
+		align)
+{
+}
+
+
+BField*
+Int32TableColumn::PrepareField(const Variant&amp; value) const
+{
+	char buffer[16];
+	snprintf(buffer, sizeof(buffer), &quot;%ld&quot;, value.ToInt32());
+	return StringTableColumn::PrepareField(
+		Variant(buffer, VARIANT_DONT_COPY_DATA));
+}
+
+
+int
+Int32TableColumn::CompareValues(const Variant&amp; a, const Variant&amp; b)
+{
+	return a.ToInt32() - b.ToInt32();
+}
+
+
+// #pragma mark - Int64TableColumn
+
+
+Int64TableColumn::Int64TableColumn(int32 modelIndex, const char* title,
+	float width, float minWidth, float maxWidth, uint32 truncate,
+	alignment align)
+	:
+	StringTableColumn(modelIndex, title, width, minWidth, maxWidth, truncate,
+		align)
+{
+}
+
+
+BField*
+Int64TableColumn::PrepareField(const Variant&amp; value) const
+{
+	char buffer[32];
+	snprintf(buffer, sizeof(buffer), &quot;%lld&quot;, value.ToInt64());
+	return StringTableColumn::PrepareField(
+		Variant(buffer, VARIANT_DONT_COPY_DATA));
+}
+
+
+int
+Int64TableColumn::CompareValues(const Variant&amp; a, const Variant&amp; b)
+{
+	int64 diff = a.ToInt64() - b.ToInt64();
+	if (diff == 0)
+		return 0;
+	return diff &lt; 0 ? -1 : 1;
+}
+
+
+// #pragma mark - BigtimeTableColumn
+
+
+BigtimeTableColumn::BigtimeTableColumn(int32 modelIndex, const char* title,
+	float width, float minWidth, float maxWidth, bool invalidFirst,
+	uint32 truncate, alignment align)
+	:
+	StringTableColumn(modelIndex, title, width, minWidth, maxWidth, truncate,
+		align),
+	fInvalidFirst(invalidFirst)
+{
+}
+
+
+BField*
+BigtimeTableColumn::PrepareField(const Variant&amp; value) const
+{
+	bigtime_t time = value.ToInt64();
+	if (time &lt; 0) {
+		return StringTableColumn::PrepareField(
+			Variant(&quot;-&quot;, VARIANT_DONT_COPY_DATA));
+	}
+
+	int micros = int(time % 1000000);
+	time /= 1000000;
+	int seconds = int(time % 60);
+	time /= 60;
+	int minutes = int(time % 60);
+	time /= 60;
+
+	char buffer[64];
+	snprintf(buffer, sizeof(buffer), &quot;%02lld:%02d:%02d:%06d&quot;, time, minutes,
+		seconds, micros);
+	return StringTableColumn::PrepareField(
+		Variant(buffer, VARIANT_DONT_COPY_DATA));
+}
+
+
+int
+BigtimeTableColumn::CompareValues(const Variant&amp; _a, const Variant&amp; _b)
+{
+	bigtime_t a = _a.ToInt64();
+	bigtime_t b = _b.ToInt64();
+
+	if (a == b)
+		return 0;
+	
+	if (a &lt; 0)
+		return fInvalidFirst ? -1 : 1;
+	if (b &lt; 0)
+		return fInvalidFirst ? 1 : -1;
+
+	return a - b &lt; 0 ? -1 : 1;
+}

Copied: haiku/trunk/src/apps/debuganalyzer/gui/table/TableColumns.h (from rev 30385, haiku/trunk/src/apps/debuganalyzer/TableColumns.h)
===================================================================
--- haiku/trunk/src/apps/debuganalyzer/TableColumns.h	2009-04-24 22:45:39 UTC (rev 30385)
+++ haiku/trunk/src/apps/debuganalyzer/gui/table/TableColumns.h	2009-04-25 19:56:18 UTC (rev 30409)
@@ -0,0 +1,111 @@
+/*
+ * Copyright 2009, Ingo Weinhold, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">ingo_weinhold at gmx.de.</A>
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef TABLE_COLUMNS_H
+#define TABLE_COLUMNS_H
+
+#include &lt;ColumnTypes.h&gt;
+
+#include &quot;table/Table.h&quot;
+
+
+class DelagateBasedTableColumn : public TableColumn {
+public:
+								DelagateBasedTableColumn(
+									BColumn* columnDelegate,
+									int32 modelIndex, float width,
+									float minWidth, float maxWidth,
+									alignment align);
+	virtual						~DelagateBasedTableColumn();
+
+protected:
+	virtual	void				DrawTitle(BRect rect, BView* targetView);
+	virtual	void				GetColumnName(BString* into) const;
+
+	virtual	void				DrawValue(const Variant&amp; value, BRect rect,
+									BView* targetView);
+	virtual	float				GetPreferredValueWidth(const Variant&amp; value,
+									BView* parent) const;
+
+	virtual	BField*				PrepareField(const Variant&amp; value) const = 0;
+
+protected:
+			BColumn*			fColumnDelegate;
+};
+
+
+class StringTableColumn : public DelagateBasedTableColumn {
+public:
+								StringTableColumn(int32 modelIndex,
+									const char* title, float width,
+									float minWidth, float maxWidth,
+									uint32 truncate,
+									alignment align = B_ALIGN_LEFT);
+	virtual						~StringTableColumn();
+
+protected:
+	virtual	BField*				PrepareField(const Variant&amp; value) const;
+
+	virtual	int					CompareValues(const Variant&amp; a,
+									const Variant&amp; b);
+
+private:
+			BStringColumn		fColumn;
+	mutable	BStringField		fField;
+};
+
+
+class Int32TableColumn : public StringTableColumn {
+public:
+								Int32TableColumn(int32 modelIndex,
+									const char* title, float width,
+									float minWidth, float maxWidth,
+									uint32 truncate = B_TRUNCATE_MIDDLE,
+									alignment align = B_ALIGN_RIGHT);
+
+protected:
+	virtual	BField*				PrepareField(const Variant&amp; value) const;
+
+	virtual	int					CompareValues(const Variant&amp; a,
+									const Variant&amp; b);
+};
+

[... truncated: 149 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016195.html">[Haiku-commits] r30408 - in haiku/trunk/src/apps/debuganalyzer: .	main_window thread_window
</A></li>
	<LI>Next message: <A HREF="016197.html">[Haiku-commits] r30409 - in haiku/trunk/src/apps/debuganalyzer: . gui gui/main_window gui/table gui/thread_window model model_loader util
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16196">[ date ]</a>
              <a href="thread.html#16196">[ thread ]</a>
              <a href="subject.html#16196">[ subject ]</a>
              <a href="author.html#16196">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
