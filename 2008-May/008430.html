<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r25283 - in haiku/trunk: headers/private/kernel headers/private/kernel/util src/add-ons/kernel/drivers/arch/x86/keyboard src/add-ons/kernel/drivers/tty src/add-ons/kernel/file_cache src/add-ons/kernel/network/protocols/tcp src/libs/compat/freebsd_network src/libs/compat/freebsd_network/compat/sys src/system/kernel src/system/kernel/arch/generic src/system/kernel/cache src/system/kernel/fs src/system/kernel/util src/system/kernel/vm src/system/libroot/os
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2008-May/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r25283%20-%20in%20haiku/trunk%3A%20headers/private/kernel%0A%20headers/private/kernel/util%20src/add-ons/kernel/drivers/arch/x86/keyboard%0A%20src/add-ons/kernel/drivers/tty%20src/add-ons/kernel/file_cache%0A%20src/add-ons/kernel/network/protocols/tcp%20src/libs/compat/freebsd_network%0A%20src/libs/compat/freebsd_network/compat/sys%20src/system/kernel%0A%20src/system/kernel/arch/generic%20src/system/kernel/cache%20src/system/kernel/fs%0A%20src/system/kernel/util%20src/system/kernel/vm%20src/system/libroot/os&In-Reply-To=%3C20080502154906.570.3%40knochen-vm.1209732708.fake%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008422.html">
   <LINK REL="Next"  HREF="008439.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r25283 - in haiku/trunk: headers/private/kernel headers/private/kernel/util src/add-ons/kernel/drivers/arch/x86/keyboard src/add-ons/kernel/drivers/tty src/add-ons/kernel/file_cache src/add-ons/kernel/network/protocols/tcp src/libs/compat/freebsd_network src/libs/compat/freebsd_network/compat/sys src/system/kernel src/system/kernel/arch/generic src/system/kernel/cache src/system/kernel/fs src/system/kernel/util src/system/kernel/vm src/system/libroot/os</H1>
    <B>Ingo Weinhold</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r25283%20-%20in%20haiku/trunk%3A%20headers/private/kernel%0A%20headers/private/kernel/util%20src/add-ons/kernel/drivers/arch/x86/keyboard%0A%20src/add-ons/kernel/drivers/tty%20src/add-ons/kernel/file_cache%0A%20src/add-ons/kernel/network/protocols/tcp%20src/libs/compat/freebsd_network%0A%20src/libs/compat/freebsd_network/compat/sys%20src/system/kernel%0A%20src/system/kernel/arch/generic%20src/system/kernel/cache%20src/system/kernel/fs%0A%20src/system/kernel/util%20src/system/kernel/vm%20src/system/libroot/os&In-Reply-To=%3C20080502154906.570.3%40knochen-vm.1209732708.fake%3E"
       TITLE="[Haiku-commits] r25283 - in haiku/trunk: headers/private/kernel headers/private/kernel/util src/add-ons/kernel/drivers/arch/x86/keyboard src/add-ons/kernel/drivers/tty src/add-ons/kernel/file_cache src/add-ons/kernel/network/protocols/tcp src/libs/compat/freebsd_network src/libs/compat/freebsd_network/compat/sys src/system/kernel src/system/kernel/arch/generic src/system/kernel/cache src/system/kernel/fs src/system/kernel/util src/system/kernel/vm src/system/libroot/os">ingo_weinhold at gmx.de
       </A><BR>
    <I>Fri May  2 15:49:06 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008422.html">[Haiku-commits] r25283 - in haiku/trunk: headers/private/kernel headers/private/kernel/util src/add-ons/kernel/drivers/arch/x86/keyboard src/add-ons/kernel/drivers/tty src/add-ons/kernel/file_cache src/add-ons/kernel/network/protocols/tcp src/libs/compat/freebsd_network src/libs/compat/freebsd_network/compat/sys src/system/kernel src/system/kernel/arch/generic src/system/kernel/cache src/system/kernel/fs src/system/kernel/util src/system/kernel/vm src/system/libroot/os
</A></li>
        <LI>Next message: <A HREF="008439.html">[Haiku-commits] r25283 - in haiku/trunk: headers/private/kernel headers/private/kernel/util src/add-ons/kernel/drivers/arch/x86/keyboard src/add-ons/kernel/drivers/tty src/add-ons/kernel/file_cache src/add-ons/kernel/network/protocols/tcp src/libs/compat/freebsd_network src/libs/compat/freebsd_network/compat/sys src/system/kernel src/system/kernel/arch/generic src/system/kernel/cache src/system/kernel/fs src/system/kernel/util src/system/kernel/vm src/system/libroot/os
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8430">[ date ]</a>
              <a href="thread.html#8430">[ thread ]</a>
              <a href="subject.html#8430">[ subject ]</a>
              <a href="author.html#8430">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 2008-05-02 at 13:19:06 [+0200], Axel D&#246;rfler &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">axeld at pinc-software.de</A>&gt; 
wrote:
&gt;<i> Ingo Weinhold &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">ingo_weinhold at gmx.de</A>&gt; wrote:
</I>&gt;<i> &gt; On 2008-05-02 at 00:07:41 [+0200], bonefish at BerliOS
</I>&gt;<i> &gt; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">bonefish at mail.berlios.de</A>&gt; wrote:
</I>&gt;<i> &gt; [...]
</I>&gt;<i> &gt; &gt; Log:
</I>&gt;<i> &gt; &gt; * Removed old mutex implementation and renamed cutex to mutex.
</I>&gt;<i> &gt; BTW, this seems to make the problems with the OpenSSH &quot;forwarding&quot;
</I>&gt;<i> &gt; test less
</I>&gt;<i> &gt; likely.
</I>&gt;<i> 
</I>&gt;<i> I could finally run the test (&quot;make tests&quot; plus adding the ssh user did
</I>&gt;<i> the trick) - thanks! :-)
</I>
Oh sorry, I forgot about the user.

&gt;<i> However, what exactly happens with this test?
</I>&gt;<i> I had it wait for closing connections, but they were all left
</I>&gt;<i> established. Also, the open sockets used up more than 27 MB - which
</I>&gt;<i> doesn't really look good.
</I>
I don't know about that. At least one TCP connection and a few UNIX socket 
connections should stay open during the whole test. They are associated 
with the ssh connection that forwards the ports. I don't know exactly how 
port forwarding is implemented, but I think it just uses the one TCP 
connection. Until the forwarded ports are used, of course.

The problem I usually encounter is that an ssh and an sshd process both 
start to infinitely loop in TCPEndpoint::SendData() -&gt; WaitList::Wait() at 
some point. If they don't, the test will just pass. The test runs for a 
while and has no output (unless you enable it; cf. README.regress), so it 
helps to keep ProcessController's team menu open. The infinite loop 
situation is easily recognizable.

Regarding memory usage, the UNIX socket implementation is really 
inefficient in that respect ATM. If the sent messages are small a lot of 
memory is wasted, since it just queues the buffers (which are 2 KB 
minimum). I don't think OpenSSH uses them in a way that would explain 27 
MB, but I wouldn't completely rule that out either. I'm already in the 
process of extending the protocol interface so that the situation can be 
remedied.

CU, Ingo

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008422.html">[Haiku-commits] r25283 - in haiku/trunk: headers/private/kernel headers/private/kernel/util src/add-ons/kernel/drivers/arch/x86/keyboard src/add-ons/kernel/drivers/tty src/add-ons/kernel/file_cache src/add-ons/kernel/network/protocols/tcp src/libs/compat/freebsd_network src/libs/compat/freebsd_network/compat/sys src/system/kernel src/system/kernel/arch/generic src/system/kernel/cache src/system/kernel/fs src/system/kernel/util src/system/kernel/vm src/system/libroot/os
</A></li>
	<LI>Next message: <A HREF="008439.html">[Haiku-commits] r25283 - in haiku/trunk: headers/private/kernel headers/private/kernel/util src/add-ons/kernel/drivers/arch/x86/keyboard src/add-ons/kernel/drivers/tty src/add-ons/kernel/file_cache src/add-ons/kernel/network/protocols/tcp src/libs/compat/freebsd_network src/libs/compat/freebsd_network/compat/sys src/system/kernel src/system/kernel/arch/generic src/system/kernel/cache src/system/kernel/fs src/system/kernel/util src/system/kernel/vm src/system/libroot/os
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8430">[ date ]</a>
              <a href="thread.html#8430">[ thread ]</a>
              <a href="subject.html#8430">[ subject ]</a>
              <a href="author.html#8430">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
