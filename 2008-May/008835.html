<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r25486 - in haiku/trunk: build/jam headers/private headers/private/kernel headers/private/kernel/arch/m68k headers/private/kernel/arch/ppc headers/private/kernel/arch/x86 headers/private/kernel/disk_device_manager headers/private/kernel/posix headers/private/libroot headers/private/system headers/private/system/arch headers/private/system/arch/m68k headers/private/system/arch/ppc headers/private/system/arch/x86 headers/private/system/posix src/add-ons/input_server/devices/keyboard src/add-ons/kernel/bus_managers/agp_gart src/add-ons/kernel/bus_managers/ide src/add-ons/kernel/bus_managers/isa src/add-ons/kernel/bus_managers/scsi src/add-ons/kernel/bus_managers/usb src/add-ons/kernel/busses/scsi/ahci src/add-ons/kernel/drivers/random src/add-ons/kernel/generic/block_io src/apps/powerstatus src/bin src/bin/listdev src/bin/multiuser src/bin/network/arp src/bin/network/netstat src/bin/strace src/kits/app src/kits/debug src/kits/network src/kits/opengl src/kits/storage sr! c/kits/storage/disk_device src/kits/translation src/preferences/time src/servers/app/drawing src/servers/input src/servers/media src/servers/registrar src/system/boot/loader src/system/glue src/system/kernel/arch/m68k src/system/kernel/arch/ppc src/system/kernel/arch/x86 src/system/kernel/lib src/system/libroot src/system/libroot/os src/system/libroot/os/arch/m68k src/system/libroot/os/arch/ppc src/system/libroot/os/arch/x86 src/system/libroot/posix src/system/libroot/posix/malloc src/system/libroot/posix/pthread src/system/libroot/posix/signal src/system/libroot/posix/stdio src/system/libroot/posix/stdlib src/system/libroot/posix/string src/system/libroot/posix/string/arch/x86 src/system/libroot/posix/sys src/system/libroot/posix/time src/system/libroot/posix/unistd src/system/runtime_loader src/tools/gensyscalls
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2008-May/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r25486%20-%20in%20haiku/trunk%3A%20build/jam%20headers/private%0A%20headers/private/kernel%20headers/private/kernel/arch/m68k%0A%20headers/private/kernel/arch/ppc%20headers/private/kernel/arch/x86%0A%20headers/private/kernel/disk_device_manager%20headers/private/kernel/posix%0A%20headers/private/libroot%20headers/private/system%20headers/private/system/arch%0A%20headers/private/system/arch/m68k%20headers/private/system/arch/ppc%0A%20headers/private/system/arch/x86%20headers/private/system/posix%0A%20src/add-ons/input_server/devices/keyboard%0A%20src/add-ons/kernel/bus_managers/agp_gart%0A%20src/add-ons/kernel/bus_managers/ide%20src/add-ons/kernel/bus_managers/isa%0A%20src/add-ons/kernel/bus_managers/scsi%20src/add-ons/kernel/bus_managers/usb%0A%20src/add-ons/kernel/busses/scsi/ahci%20src/add-ons/kernel/drivers/random%0A%20src/add-ons/kernel/generic/block_io%20src/apps/powerstatus%20src/bin%0A%20src/bin/listdev%20src/bin/multiuser%20src/bin/network/arp%0A%20src/bin/network/netstat%20src/bin/strace%20src/kits/app%20src/kits/debug%0A%20src/kits/network%20src/kits/opengl%20src/kits/storage%20sr%21%0A%20c/kits/storage/disk_device%20src/kits/translation%20src/preferences/time%0A%20src/servers/app/drawing%20src/servers/input%20src/servers/media%0A%20src/servers/registrar%20src/system/boot/loader%20src/system/glue%0A%20src/system/kernel/arch/m68k%20src/system/kernel/arch/ppc%0A%20src/system/kernel/arch/x86%20src/system/kernel/lib%20src/system/libroot%0A%20src/system/libroot/os%20src/system/libroot/os/arch/m68k%0A%20src/system/libroot/os/arch/ppc%20src/system/libroot/os/arch/x86%0A%20src/system/libroot/posix%20src/system/libroot/posix/malloc%0A%20src/system/libroot/posix/pthread%20src/system/libroot/posix/signal%0A%20src/system/libroot/posix/stdio%20src/system/libroot/posix/stdlib%0A%20src/system/libroot/posix/string%20src/system/libroot/posix/string/arch/x86%0A%20src/system/libroot/posix/sys%20src/system/libroot/posix/time%0A%20src/system/libroot/posix/unistd%20src/system/runtime_loader%0A%20src/tools/gensyscalls&In-Reply-To=%3C200805140355.m4E3tTJc013523%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008840.html">
   <LINK REL="Next"  HREF="008836.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r25486 - in haiku/trunk: build/jam headers/private headers/private/kernel headers/private/kernel/arch/m68k headers/private/kernel/arch/ppc headers/private/kernel/arch/x86 headers/private/kernel/disk_device_manager headers/private/kernel/posix headers/private/libroot headers/private/system headers/private/system/arch headers/private/system/arch/m68k headers/private/system/arch/ppc headers/private/system/arch/x86 headers/private/system/posix src/add-ons/input_server/devices/keyboard src/add-ons/kernel/bus_managers/agp_gart src/add-ons/kernel/bus_managers/ide src/add-ons/kernel/bus_managers/isa src/add-ons/kernel/bus_managers/scsi src/add-ons/kernel/bus_managers/usb src/add-ons/kernel/busses/scsi/ahci src/add-ons/kernel/drivers/random src/add-ons/kernel/generic/block_io src/apps/powerstatus src/bin src/bin/listdev src/bin/multiuser src/bin/network/arp src/bin/network/netstat src/bin/strace src/kits/app src/kits/debug src/kits/network src/kits/opengl src/kits/storage sr! c/kits/storage/disk_device src/kits/translation src/preferences/time src/servers/app/drawing src/servers/input src/servers/media src/servers/registrar src/system/boot/loader src/system/glue src/system/kernel/arch/m68k src/system/kernel/arch/ppc src/system/kernel/arch/x86 src/system/kernel/lib src/system/libroot src/system/libroot/os src/system/libroot/os/arch/m68k src/system/libroot/os/arch/ppc src/system/libroot/os/arch/x86 src/system/libroot/posix src/system/libroot/posix/malloc src/system/libroot/posix/pthread src/system/libroot/posix/signal src/system/libroot/posix/stdio src/system/libroot/posix/stdlib src/system/libroot/posix/string src/system/libroot/posix/string/arch/x86 src/system/libroot/posix/sys src/system/libroot/posix/time src/system/libroot/posix/unistd src/system/runtime_loader src/tools/gensyscalls</H1>
    <B>bonefish at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r25486%20-%20in%20haiku/trunk%3A%20build/jam%20headers/private%0A%20headers/private/kernel%20headers/private/kernel/arch/m68k%0A%20headers/private/kernel/arch/ppc%20headers/private/kernel/arch/x86%0A%20headers/private/kernel/disk_device_manager%20headers/private/kernel/posix%0A%20headers/private/libroot%20headers/private/system%20headers/private/system/arch%0A%20headers/private/system/arch/m68k%20headers/private/system/arch/ppc%0A%20headers/private/system/arch/x86%20headers/private/system/posix%0A%20src/add-ons/input_server/devices/keyboard%0A%20src/add-ons/kernel/bus_managers/agp_gart%0A%20src/add-ons/kernel/bus_managers/ide%20src/add-ons/kernel/bus_managers/isa%0A%20src/add-ons/kernel/bus_managers/scsi%20src/add-ons/kernel/bus_managers/usb%0A%20src/add-ons/kernel/busses/scsi/ahci%20src/add-ons/kernel/drivers/random%0A%20src/add-ons/kernel/generic/block_io%20src/apps/powerstatus%20src/bin%0A%20src/bin/listdev%20src/bin/multiuser%20src/bin/network/arp%0A%20src/bin/network/netstat%20src/bin/strace%20src/kits/app%20src/kits/debug%0A%20src/kits/network%20src/kits/opengl%20src/kits/storage%20sr%21%0A%20c/kits/storage/disk_device%20src/kits/translation%20src/preferences/time%0A%20src/servers/app/drawing%20src/servers/input%20src/servers/media%0A%20src/servers/registrar%20src/system/boot/loader%20src/system/glue%0A%20src/system/kernel/arch/m68k%20src/system/kernel/arch/ppc%0A%20src/system/kernel/arch/x86%20src/system/kernel/lib%20src/system/libroot%0A%20src/system/libroot/os%20src/system/libroot/os/arch/m68k%0A%20src/system/libroot/os/arch/ppc%20src/system/libroot/os/arch/x86%0A%20src/system/libroot/posix%20src/system/libroot/posix/malloc%0A%20src/system/libroot/posix/pthread%20src/system/libroot/posix/signal%0A%20src/system/libroot/posix/stdio%20src/system/libroot/posix/stdlib%0A%20src/system/libroot/posix/string%20src/system/libroot/posix/string/arch/x86%0A%20src/system/libroot/posix/sys%20src/system/libroot/posix/time%0A%20src/system/libroot/posix/unistd%20src/system/runtime_loader%0A%20src/tools/gensyscalls&In-Reply-To=%3C200805140355.m4E3tTJc013523%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r25486 - in haiku/trunk: build/jam headers/private headers/private/kernel headers/private/kernel/arch/m68k headers/private/kernel/arch/ppc headers/private/kernel/arch/x86 headers/private/kernel/disk_device_manager headers/private/kernel/posix headers/private/libroot headers/private/system headers/private/system/arch headers/private/system/arch/m68k headers/private/system/arch/ppc headers/private/system/arch/x86 headers/private/system/posix src/add-ons/input_server/devices/keyboard src/add-ons/kernel/bus_managers/agp_gart src/add-ons/kernel/bus_managers/ide src/add-ons/kernel/bus_managers/isa src/add-ons/kernel/bus_managers/scsi src/add-ons/kernel/bus_managers/usb src/add-ons/kernel/busses/scsi/ahci src/add-ons/kernel/drivers/random src/add-ons/kernel/generic/block_io src/apps/powerstatus src/bin src/bin/listdev src/bin/multiuser src/bin/network/arp src/bin/network/netstat src/bin/strace src/kits/app src/kits/debug src/kits/network src/kits/opengl src/kits/storage sr! c/kits/storage/disk_device src/kits/translation src/preferences/time src/servers/app/drawing src/servers/input src/servers/media src/servers/registrar src/system/boot/loader src/system/glue src/system/kernel/arch/m68k src/system/kernel/arch/ppc src/system/kernel/arch/x86 src/system/kernel/lib src/system/libroot src/system/libroot/os src/system/libroot/os/arch/m68k src/system/libroot/os/arch/ppc src/system/libroot/os/arch/x86 src/system/libroot/posix src/system/libroot/posix/malloc src/system/libroot/posix/pthread src/system/libroot/posix/signal src/system/libroot/posix/stdio src/system/libroot/posix/stdlib src/system/libroot/posix/string src/system/libroot/posix/string/arch/x86 src/system/libroot/posix/sys src/system/libroot/posix/time src/system/libroot/posix/unistd src/system/runtime_loader src/tools/gensyscalls">bonefish at mail.berlios.de
       </A><BR>
    <I>Wed May 14 05:55:29 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="008840.html">[Haiku-commits] r25485 - in haiku/trunk: build/jam src/kits/network src/kits/network/dns/irs src/kits/network/libnetapi
</A></li>
        <LI>Next message: <A HREF="008836.html">[Haiku-commits] r25486 - in haiku/trunk: build/jam	headers/private headers/private/kernel	headers/private/kernel/arch/m68k headers/private/kernel/arch/ppc	headers/private/kernel/arch/x86	headers/private/kernel/disk_device_manager headers/private/
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8835">[ date ]</a>
              <a href="thread.html#8835">[ thread ]</a>
              <a href="subject.html#8835">[ subject ]</a>
              <a href="author.html#8835">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: bonefish
Date: 2008-05-14 05:55:16 +0200 (Wed, 14 May 2008)
New Revision: 25486
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=25486&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=25486&amp;view=rev</A>

Added:
   haiku/trunk/headers/private/system/
   haiku/trunk/headers/private/system/arch/
   haiku/trunk/headers/private/system/arch/m68k/
   haiku/trunk/headers/private/system/arch/m68k/arch_commpage_defs.h
   haiku/trunk/headers/private/system/arch/m68k/arch_config.h
   haiku/trunk/headers/private/system/arch/m68k/arch_elf.h
   haiku/trunk/headers/private/system/arch/m68k/arch_real_time_data.h
   haiku/trunk/headers/private/system/arch/ppc/
   haiku/trunk/headers/private/system/arch/ppc/arch_commpage_defs.h
   haiku/trunk/headers/private/system/arch/ppc/arch_config.h
   haiku/trunk/headers/private/system/arch/ppc/arch_elf.h
   haiku/trunk/headers/private/system/arch/ppc/arch_real_time_data.h
   haiku/trunk/headers/private/system/arch/x86/
   haiku/trunk/headers/private/system/arch/x86/apm_defs.h
   haiku/trunk/headers/private/system/arch/x86/arch_commpage_defs.h
   haiku/trunk/headers/private/system/arch/x86/arch_config.h
   haiku/trunk/headers/private/system/arch/x86/arch_elf.h
   haiku/trunk/headers/private/system/arch/x86/arch_real_time_data.h
   haiku/trunk/headers/private/system/commpage_defs.h
   haiku/trunk/headers/private/system/ddm_userland_interface_defs.h
   haiku/trunk/headers/private/system/elf32.h
   haiku/trunk/headers/private/system/generic_syscall_defs.h
   haiku/trunk/headers/private/system/posix/
   haiku/trunk/headers/private/system/posix/realtime_sem_defs.h
   haiku/trunk/headers/private/system/real_time_data.h
   haiku/trunk/headers/private/system/safemode_defs.h
   haiku/trunk/headers/private/system/syscall_process_info.h
   haiku/trunk/headers/private/system/syscalls.h
   haiku/trunk/headers/private/system/thread_defs.h
   haiku/trunk/headers/private/system/tls.h
   haiku/trunk/headers/private/system/user_runtime.h
   haiku/trunk/headers/private/system/user_thread_defs.h
   haiku/trunk/headers/private/system/vfs_defs.h
   haiku/trunk/headers/private/system/vm_defs.h
Removed:
   haiku/trunk/headers/private/kernel/arch/m68k/arch_commpage.h
   haiku/trunk/headers/private/kernel/arch/m68k/arch_config.h
   haiku/trunk/headers/private/kernel/arch/m68k/arch_elf.h
   haiku/trunk/headers/private/kernel/arch/m68k/arch_real_time_data.h
   haiku/trunk/headers/private/kernel/arch/ppc/arch_commpage.h
   haiku/trunk/headers/private/kernel/arch/ppc/arch_config.h
   haiku/trunk/headers/private/kernel/arch/ppc/arch_elf.h
   haiku/trunk/headers/private/kernel/arch/ppc/arch_real_time_data.h
   haiku/trunk/headers/private/kernel/arch/x86/arch_commpage.h
   haiku/trunk/headers/private/kernel/arch/x86/arch_config.h
   haiku/trunk/headers/private/kernel/arch/x86/arch_elf.h
   haiku/trunk/headers/private/kernel/arch/x86/arch_real_time_data.h
   haiku/trunk/headers/private/kernel/elf32.h
   haiku/trunk/headers/private/kernel/real_time_data.h
   haiku/trunk/headers/private/kernel/syscall_process_info.h
   haiku/trunk/headers/private/kernel/syscalls.h
   haiku/trunk/headers/private/kernel/tls.h
   haiku/trunk/headers/private/kernel/user_runtime.h
Modified:
   haiku/trunk/build/jam/BuildSetup
   haiku/trunk/build/jam/HeadersRules
   haiku/trunk/headers/private/kernel/arch/x86/apm.h
   haiku/trunk/headers/private/kernel/commpage.h
   haiku/trunk/headers/private/kernel/disk_device_manager/ddm_userland_interface.h
   haiku/trunk/headers/private/kernel/generic_syscall.h
   haiku/trunk/headers/private/kernel/kernel.h
   haiku/trunk/headers/private/kernel/posix/realtime_sem.h
   haiku/trunk/headers/private/kernel/safemode.h
   haiku/trunk/headers/private/kernel/thread.h
   haiku/trunk/headers/private/kernel/thread_types.h
   haiku/trunk/headers/private/kernel/vfs.h
   haiku/trunk/headers/private/kernel/vm.h
   haiku/trunk/headers/private/libroot/user_thread.h
   haiku/trunk/src/add-ons/input_server/devices/keyboard/Jamfile
   haiku/trunk/src/add-ons/kernel/bus_managers/agp_gart/Jamfile
   haiku/trunk/src/add-ons/kernel/bus_managers/ide/Jamfile
   haiku/trunk/src/add-ons/kernel/bus_managers/isa/Jamfile
   haiku/trunk/src/add-ons/kernel/bus_managers/scsi/Jamfile
   haiku/trunk/src/add-ons/kernel/bus_managers/usb/Jamfile
   haiku/trunk/src/add-ons/kernel/busses/scsi/ahci/Jamfile
   haiku/trunk/src/add-ons/kernel/drivers/random/Jamfile
   haiku/trunk/src/add-ons/kernel/generic/block_io/virtual_memory.c
   haiku/trunk/src/apps/powerstatus/Jamfile
   haiku/trunk/src/apps/powerstatus/PowerStatusView.cpp
   haiku/trunk/src/bin/Jamfile
   haiku/trunk/src/bin/fdinfo.cpp
   haiku/trunk/src/bin/listdev/Jamfile
   haiku/trunk/src/bin/listdev/dm_wrapper.c
   haiku/trunk/src/bin/multiuser/Jamfile
   haiku/trunk/src/bin/network/arp/Jamfile
   haiku/trunk/src/bin/network/arp/arp.cpp
   haiku/trunk/src/bin/network/netstat/Jamfile
   haiku/trunk/src/bin/strace/Jamfile
   haiku/trunk/src/kits/app/Jamfile
   haiku/trunk/src/kits/debug/Jamfile
   haiku/trunk/src/kits/network/Jamfile
   haiku/trunk/src/kits/opengl/GLRendererRoster.cpp
   haiku/trunk/src/kits/opengl/Jamfile
   haiku/trunk/src/kits/storage/Jamfile
   haiku/trunk/src/kits/storage/disk_device/DiskDevice.cpp
   haiku/trunk/src/kits/storage/disk_device/DiskDeviceJobGenerator.cpp
   haiku/trunk/src/kits/storage/disk_device/DiskDeviceRoster.cpp
   haiku/trunk/src/kits/storage/disk_device/DiskSystem.cpp
   haiku/trunk/src/kits/storage/disk_device/MutablePartition.cpp
   haiku/trunk/src/kits/storage/disk_device/Partition.cpp
   haiku/trunk/src/kits/storage/disk_device/PartitioningInfo.cpp
   haiku/trunk/src/kits/translation/Jamfile
   haiku/trunk/src/kits/translation/TranslatorRoster.cpp
   haiku/trunk/src/preferences/time/Jamfile
   haiku/trunk/src/servers/app/drawing/AccelerantHWInterface.cpp
   haiku/trunk/src/servers/app/drawing/Jamfile
   haiku/trunk/src/servers/input/InputServer.cpp
   haiku/trunk/src/servers/input/Jamfile
   haiku/trunk/src/servers/media/AddOnManager.cpp
   haiku/trunk/src/servers/media/Jamfile
   haiku/trunk/src/servers/registrar/Jamfile
   haiku/trunk/src/system/boot/loader/Jamfile
   haiku/trunk/src/system/glue/Jamfile
   haiku/trunk/src/system/kernel/arch/m68k/Jamfile
   haiku/trunk/src/system/kernel/arch/ppc/Jamfile
   haiku/trunk/src/system/kernel/arch/x86/Jamfile
   haiku/trunk/src/system/kernel/arch/x86/arch_interrupts.S
   haiku/trunk/src/system/kernel/lib/kernel_vsprintf.c
   haiku/trunk/src/system/libroot/Jamfile
   haiku/trunk/src/system/libroot/os/Jamfile
   haiku/trunk/src/system/libroot/os/arch/m68k/Jamfile
   haiku/trunk/src/system/libroot/os/arch/ppc/Jamfile
   haiku/trunk/src/system/libroot/os/arch/x86/Jamfile
   haiku/trunk/src/system/libroot/os/arch/x86/syscalls.inc
   haiku/trunk/src/system/libroot/os/arch/x86/time.c
   haiku/trunk/src/system/libroot/os/thread.c
   haiku/trunk/src/system/libroot/os/time.c
   haiku/trunk/src/system/libroot/posix/Jamfile
   haiku/trunk/src/system/libroot/posix/malloc/Jamfile
   haiku/trunk/src/system/libroot/posix/pthread/Jamfile
   haiku/trunk/src/system/libroot/posix/pthread/pthread.c
   haiku/trunk/src/system/libroot/posix/pthread/pthread_attr.c
   haiku/trunk/src/system/libroot/posix/semaphore.cpp
   haiku/trunk/src/system/libroot/posix/signal/Jamfile
   haiku/trunk/src/system/libroot/posix/stdio/Jamfile
   haiku/trunk/src/system/libroot/posix/stdlib/Jamfile
   haiku/trunk/src/system/libroot/posix/string/Jamfile
   haiku/trunk/src/system/libroot/posix/string/arch/x86/arch_string.S
   haiku/trunk/src/system/libroot/posix/sys/Jamfile
   haiku/trunk/src/system/libroot/posix/sys/mman.cpp
   haiku/trunk/src/system/libroot/posix/sys/wait.c
   haiku/trunk/src/system/libroot/posix/time/Jamfile
   haiku/trunk/src/system/libroot/posix/unistd/Jamfile
   haiku/trunk/src/system/libroot/posix/unistd/conf.c
   haiku/trunk/src/system/runtime_loader/Jamfile
   haiku/trunk/src/system/runtime_loader/elf.cpp
   haiku/trunk/src/tools/gensyscalls/Jamfile
Log:
* Introduced new header directory headers/private/system which is supposed
  to contain headers shared by kernel and userland (mainly libroot).
* Moved quite a few private kernel headers to the new location. Split
  several kernel headers into a shared part and one that is still kernel
  private. Adjusted all affected Jamfiles and source in the standard x86
  build accordingly. The build for other architectures and for test code
  may be broken.
* Quite a bit of userland code still includes private kernel headers.
  Mostly those are &lt;util/*&gt; headers. The ones that aren't strictly
  kernel-only should be moved to some other place (maybe
  headers/private/shared/util).


Modified: haiku/trunk/build/jam/BuildSetup
===================================================================
--- haiku/trunk/build/jam/BuildSetup	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/build/jam/BuildSetup	2008-05-14 03:55:16 UTC (rev 25486)
@@ -323,11 +323,17 @@
 	HAIKU_DEFINES += _BEOS_R5_COMPATIBLE_ ;
 }
 
+# private shared kernel/libroot headers
+HAIKU_PRIVATE_SYSTEM_HEADERS =
+	[ PrivateHeaders $(DOT) system system/arch/$(HAIKU_ARCH) ]
+;
+
 # private kernel headers to be used when compiling kernel code
 HAIKU_PRIVATE_KERNEL_HEADERS =
 	[ PrivateHeaders $(DOT) kernel libroot
 		kernel/boot/platform/$(HAIKU_BOOT_PLATFORM) ]
 	[ ArchHeaders $(HAIKU_ARCH) ]
+	$(HAIKU_PRIVATE_SYSTEM_HEADERS)
 ;
 
 # Add some grist to the libgcc objects
@@ -550,6 +556,9 @@
 # private kernel headers do be used when compiling kernel code
 HOST_PRIVATE_KERNEL_HEADERS = ;
 
+# private shared kernel/libroot headers
+HOST_PRIVATE_SYSTEM_HEADERS = ;
+
 # under BeOS use copyattr instead of cp
 if $(HOST_PLATFORM_BEOS_COMPATIBLE)
 {
@@ -748,6 +757,7 @@
 	KERNEL_DEBUG_$(HAIKU_DEBUG_LEVELS)_C++FLAGS
 
 	PRIVATE_KERNEL_HEADERS
+	PRIVATE_SYSTEM_HEADERS
 
 	LIBSTDC++ LIBSUPC++
 

Modified: haiku/trunk/build/jam/HeadersRules
===================================================================
--- haiku/trunk/build/jam/HeadersRules	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/build/jam/HeadersRules	2008-05-14 03:55:16 UTC (rev 25486)
@@ -343,6 +343,11 @@
 	UseHeaders $(TARGET_PRIVATE_KERNEL_HEADERS) : true ;
 }
 
+rule UsePrivateSystemHeaders
+{
+	UseHeaders $(TARGET_PRIVATE_SYSTEM_HEADERS) : true ;
+}
+
 rule FStandardOSHeaders
 {
 	local osIncludes = add-ons add-ons/file_system add-ons/graphics

Deleted: haiku/trunk/headers/private/kernel/arch/m68k/arch_commpage.h

Deleted: haiku/trunk/headers/private/kernel/arch/m68k/arch_config.h

Deleted: haiku/trunk/headers/private/kernel/arch/m68k/arch_elf.h

Deleted: haiku/trunk/headers/private/kernel/arch/m68k/arch_real_time_data.h

Deleted: haiku/trunk/headers/private/kernel/arch/ppc/arch_commpage.h

Deleted: haiku/trunk/headers/private/kernel/arch/ppc/arch_config.h

Deleted: haiku/trunk/headers/private/kernel/arch/ppc/arch_elf.h

Deleted: haiku/trunk/headers/private/kernel/arch/ppc/arch_real_time_data.h

Modified: haiku/trunk/headers/private/kernel/arch/x86/apm.h
===================================================================
--- haiku/trunk/headers/private/kernel/arch/x86/apm.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/arch/x86/apm.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -5,9 +5,11 @@
 #ifndef KERNEL_APM_H
 #define KERNEL_APM_H
 
-
 #include &lt;SupportDefs.h&gt;
 
+#include &lt;apm_defs.h&gt;
+
+
 struct kernel_args;
 
 
@@ -47,17 +49,6 @@
 } apm_info;
 
 
-// temporary generic syscall interface
-#define APM_SYSCALLS &quot;apm&quot;
-#define APM_GET_BATTERY_INFO	1
-
-struct battery_info {
-	bool	online;
-	int32	percent;
-	time_t	time_left;
-};
-
-
 #ifndef _BOOT_MODE
 #ifdef __cplusplus
 extern &quot;C&quot; {

Deleted: haiku/trunk/headers/private/kernel/arch/x86/arch_commpage.h

Deleted: haiku/trunk/headers/private/kernel/arch/x86/arch_config.h

Deleted: haiku/trunk/headers/private/kernel/arch/x86/arch_elf.h

Deleted: haiku/trunk/headers/private/kernel/arch/x86/arch_real_time_data.h

Modified: haiku/trunk/headers/private/kernel/commpage.h
===================================================================
--- haiku/trunk/headers/private/kernel/commpage.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/commpage.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -5,32 +5,11 @@
 #ifndef _KERNEL_COMMPAGE_H
 #define _KERNEL_COMMPAGE_H
 
-/*! Some systemwide commpage constants, used in the kernel and libroot */
+#include &lt;SupportDefs.h&gt;
 
-#ifndef _ASSEMBLER
-#	include &lt;SupportDefs.h&gt;
-#endif
+#include &lt;commpage_defs.h&gt;
 
 
-/* be careful what you put here, this file is included from assembly */
-#define COMMPAGE_ENTRY_MAGIC				0
-#define COMMPAGE_ENTRY_VERSION				1
-#define COMMPAGE_ENTRY_REAL_TIME_DATA		2
-#define COMMPAGE_ENTRY_FIRST_ARCH_SPECIFIC	3
-
-#define COMMPAGE_SIZE (0x8000)
-#define COMMPAGE_TABLE_ENTRIES 64
-
-#define COMMPAGE_SIGNATURE 'COMM'
-#define COMMPAGE_VERSION 1
-
-#define USER_COMMPAGE_ADDR	ARCH_USER_COMMPAGE_ADDR
-	// set by the architecture specific implementation
-
-#ifndef _ASSEMBLER
-
-#define USER_COMMPAGE_TABLE	((void**)(USER_COMMPAGE_ADDR))
-
 #ifdef __cplusplus
 extern &quot;C&quot; {
 #endif
@@ -46,8 +25,4 @@
 }	// extern &quot;C&quot;
 #endif
 
-#endif	// ! _ASSEMBLER
-
-#include &lt;arch_commpage.h&gt;
-
 #endif	/* _KERNEL_COMMPAGE_H */

Modified: haiku/trunk/headers/private/kernel/disk_device_manager/ddm_userland_interface.h
===================================================================
--- haiku/trunk/headers/private/kernel/disk_device_manager/ddm_userland_interface.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/disk_device_manager/ddm_userland_interface.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -12,62 +12,14 @@
 
 #include &lt;DiskDeviceDefs.h&gt;
 
+#include &lt;ddm_userland_interface_defs.h&gt;
 #include &lt;disk_device_manager.h&gt;
 
+
 #ifdef __cplusplus
 extern &quot;C&quot; {
 #endif
 
-// userland partition representation
-typedef struct user_partition_data user_partition_data;
-struct user_partition_data {
-	partition_id		id;
-	off_t				offset;
-	off_t				size;
-	off_t				content_size;
-	uint32				block_size;
-	uint32				status;
-	uint32				flags;
-	dev_t				volume;
-	int32				index;
-	int32				change_counter;	// needed?
-	disk_system_id		disk_system;
-	char				*name;
-	char				*content_name;
-	char				*type;
-	char				*content_type;
-	char				*parameters;
-	char				*content_parameters;
-	void				*user_data;
-	int32				child_count;
-	user_partition_data	*children[1];
-};
-
-// userland disk device representation
-typedef struct user_disk_device_data {
-	uint32				device_flags;
-	char				*path;
-	user_partition_data	device_partition_data;
-} user_disk_device_data;
-
-// userland disk system representation
-typedef struct user_disk_system_info {
-	disk_system_id	id;
-	char			name[B_FILE_NAME_LENGTH];	// better B_PATH_NAME_LENGTH?
-	char			short_name[B_OS_NAME_LENGTH];
-	char			pretty_name[B_OS_NAME_LENGTH];
-	uint32			flags;
-} user_disk_system_info;
-
-// userland disk device job representation
-typedef struct user_disk_device_job_info {
-	disk_job_id		id;
-	uint32			type;
-	partition_id	partition;
-	char			description[256];
-} user_disk_device_job_info;
-
-
 /*! Syscalls entries */
 
 // iterating, retrieving device/partition data

Deleted: haiku/trunk/headers/private/kernel/elf32.h

Modified: haiku/trunk/headers/private/kernel/generic_syscall.h
===================================================================
--- haiku/trunk/headers/private/kernel/generic_syscall.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/generic_syscall.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -8,18 +8,15 @@
 
 #include &lt;SupportDefs.h&gt;
 
+#include &lt;generic_syscall_defs.h&gt;
 
+
 /* If we decide to make this API public, the contents of this file
  * should be moved to KernelExport.h
  */
 
 typedef status_t (*syscall_hook)(const char *subsystem, uint32 function, void *buffer, size_t bufferSize);
 
-/* predefined functions */
-#define B_RESERVED_SYSCALL_BASE		0x80000000
-#define B_SYSCALL_INFO				(B_RESERVED_SYSCALL_BASE)
-	// gets a minimum version uint32, and fills it with the current version on return
-
 /* syscall flags */
 #define B_SYSCALL_NOT_REPLACEABLE	1
 #define B_DO_NOT_REPLACE_SYSCALL	2

Modified: haiku/trunk/headers/private/kernel/kernel.h
===================================================================
--- haiku/trunk/headers/private/kernel/kernel.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/kernel.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -34,13 +34,6 @@
 #endif
 #define KERNEL_STACK_GUARD_PAGES	1
 
-/** Size of the stack given to teams in user space */
-#define USER_MAIN_THREAD_STACK_SIZE	(16 * 1024 * 1024)	// 16 MB
-#define USER_STACK_SIZE				(256 * 1024)		// 256 kB
-#define MIN_USER_STACK_SIZE			(4 * 1024)			// 4 KB
-#define MAX_USER_STACK_SIZE			(16 * 1024 * 1024)	// 16 MB
-#define USER_STACK_GUARD_PAGES		4					// 16 kB
-
 /** Size of the environmental variables space for a process */
 #define ENV_SIZE	(B_PAGE_SIZE * 8)
 

Modified: haiku/trunk/headers/private/kernel/posix/realtime_sem.h
===================================================================
--- haiku/trunk/headers/private/kernel/posix/realtime_sem.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/posix/realtime_sem.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -11,15 +11,12 @@
 
 #include &lt;OS.h&gt;
 
+#include &lt;posix/realtime_sem_defs.h&gt;
 
+
 struct realtime_sem_context;
 
 
-#define MAX_POSIX_SEMS_PER_TEAM	128
-#define MAX_POSIX_SEMS			1024
-#define MAX_POSIX_SEM_VALUE		INT_MAX
-
-
 __BEGIN_DECLS
 
 void		realtime_sem_init();

Deleted: haiku/trunk/headers/private/kernel/real_time_data.h

Modified: haiku/trunk/headers/private/kernel/safemode.h
===================================================================
--- haiku/trunk/headers/private/kernel/safemode.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/safemode.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -5,22 +5,11 @@
 #ifndef _KERNEL_SAFEMODE_H
 #define _KERNEL_SAFEMODE_H
 
-
 #include &lt;driver_settings.h&gt;
 
+#include &lt;safemode_defs.h&gt;
 
-// these are BeOS compatible additions to the safemode
-// constants in the driver_settings.h header
 
-#define B_SAFEMODE_DISABLE_USER_ADD_ONS		&quot;disableuseraddons&quot;
-#define B_SAFEMODE_DISABLE_IDE_DMA			&quot;disableidedma&quot;
-#define B_SAFEMODE_DISABLE_ACPI				&quot;disable_acpi&quot;
-#define B_SAFEMODE_DISABLE_APM				&quot;disable_apm&quot;
-#define B_SAFEMODE_DISABLE_SMP				&quot;disable_smp&quot;
-#define B_SAFEMODE_DISABLE_HYPER_THREADING	&quot;disable_hyperthreading&quot;
-#define B_SAFEMODE_FAIL_SAFE_VIDEO_MODE		&quot;fail_safe_video_mode&quot;
-
-
 #ifdef __cplusplus
 extern &quot;C&quot; {
 #endif

Deleted: haiku/trunk/headers/private/kernel/syscall_process_info.h

Deleted: haiku/trunk/headers/private/kernel/syscalls.h

Modified: haiku/trunk/headers/private/kernel/thread.h
===================================================================
--- haiku/trunk/headers/private/kernel/thread.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/thread.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -22,21 +22,7 @@
 struct select_info;
 struct thread_creation_attributes;
 
-struct thread_creation_attributes {
-	int32 (*entry)(thread_func, void *);
-	const char*	name;
-	int32		priority;
-	void*		args1;
-	void*		args2;
-	void*		stack_address;
-	size_t		stack_size;
 
-	// when calling kernel only
-	team_id		team;
-	thread_id	thread;
-};
-
-
 #ifdef __cplusplus
 extern &quot;C&quot; {
 #endif

Modified: haiku/trunk/headers/private/kernel/thread_types.h
===================================================================
--- haiku/trunk/headers/private/kernel/thread_types.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/thread_types.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -12,6 +12,7 @@
 #include &lt;cbuf.h&gt;
 #include &lt;smp.h&gt;
 #include &lt;signal.h&gt;
+#include &lt;thread_defs.h&gt;
 #include &lt;timer.h&gt;
 #include &lt;user_debugger.h&gt;
 #include &lt;util/list.h&gt;
@@ -50,11 +51,6 @@
 	JOB_CONTROL_STATE_DEAD
 } job_control_state;
 
-#define THREAD_RETURN_EXIT			0x1
-#define THREAD_RETURN_INTERRUPTED	0x2
-#define THREAD_STOPPED				0x3
-#define THREAD_CONTINUED			0x4
-
 // The type of object a thread blocks on (thread::wait::type, set by
 // thread_prepare_to_block()).
 enum {

Deleted: haiku/trunk/headers/private/kernel/tls.h

Deleted: haiku/trunk/headers/private/kernel/user_runtime.h

Modified: haiku/trunk/headers/private/kernel/vfs.h
===================================================================
--- haiku/trunk/headers/private/kernel/vfs.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/vfs.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -21,7 +21,9 @@
 #include &lt;sys/stat.h&gt;
 #include &lt;sys/select.h&gt;
 
+#include &lt;vfs_defs.h&gt;
 
+
 #define DEFAULT_FD_TABLE_SIZE	256
 #define MAX_FD_TABLE_SIZE		8192
 #define DEFAULT_NODE_MONITORS	4096 
@@ -54,13 +56,6 @@
 	uint32		max_monitors;
 } io_context;
 
-struct fd_info {
-	int		number;
-	int32	open_mode;
-	dev_t	device;
-	ino_t	node;
-};
-
 /* macro to allocate a iovec array on the stack */
 #define IOVECS(name, size) \
 	uint8 _##name[sizeof(iovecs) + (size)*sizeof(iovec)]; \

Modified: haiku/trunk/headers/private/kernel/vm.h
===================================================================
--- haiku/trunk/headers/private/kernel/vm.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/kernel/vm.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -8,12 +8,12 @@
 #ifndef _KERNEL_VM_H
 #define _KERNEL_VM_H
 
+#include &lt;OS.h&gt;
 
 #include &lt;arch/vm.h&gt;
+#include &lt;vm_defs.h&gt;
 
-#include &lt;OS.h&gt;
 
-
 struct kernel_args;
 struct team;
 struct vm_page;
@@ -23,63 +23,6 @@
 struct vnode;
 
 
-// additional protection flags
-// Note: the VM probably won't support all combinations - it will try
-// its best, but create_area() will fail if it has to.
-// Of course, the exact behaviour will be documented somewhere...
-#define B_EXECUTE_AREA			0x04
-#define B_STACK_AREA			0x08
-	// &quot;stack&quot; protection is not available on most platforms - it's used
-	// to only commit memory as needed, and have guard pages at the
-	// bottom of the stack.
-	// &quot;execute&quot; protection is currently ignored, but nevertheless, you
-	// should use it if you require to execute code in that area.
-
-#define B_KERNEL_EXECUTE_AREA	0x40
-#define B_KERNEL_STACK_AREA		0x80
-
-#define B_USER_PROTECTION \
-	(B_READ_AREA | B_WRITE_AREA | B_EXECUTE_AREA | B_STACK_AREA)
-#define B_KERNEL_PROTECTION \
-	(B_KERNEL_READ_AREA | B_KERNEL_WRITE_AREA | B_KERNEL_EXECUTE_AREA \
-	| B_KERNEL_STACK_AREA)
-
-// TODO: These aren't really a protection flags, but since the &quot;protection&quot;
-//	field is the only flag field, we currently use it for this.
-//	A cleaner approach would be appreciated - maybe just an official generic
-//	flags region in the protection field.
-#define B_OVERCOMMITTING_AREA	0x1000
-#define B_SHARED_AREA			0x2000
-#define B_KERNEL_AREA			0x4000
-	// Usable from userland according to its protection flags, but the area
-	// itself is not deletable, resizable, etc from userland.
-
-#define B_USER_AREA_FLAGS		(B_USER_PROTECTION)
-#define B_KERNEL_AREA_FLAGS \
-	(B_KERNEL_PROTECTION | B_USER_CLONEABLE_AREA | B_OVERCOMMITTING_AREA \
-		| B_SHARED_AREA)
-
-// flags for vm_get_physical_page()
-enum {
-	PHYSICAL_PAGE_NO_WAIT = 0,
-	PHYSICAL_PAGE_CAN_WAIT,
-};
-
-// mapping argument for several internal VM functions
-enum {
-	REGION_NO_PRIVATE_MAP = 0,
-	REGION_PRIVATE_MAP
-};
-
-enum {
-	// ToDo: these are here only temporarily - it's a private
-	//	addition to the BeOS create_area() lock flags
-	B_ALREADY_WIRED	= 6,
-};
-
-#define MEMORY_TYPE_SHIFT		28
-
-
 #ifdef __cplusplus
 extern &quot;C&quot; {
 #endif

Modified: haiku/trunk/headers/private/libroot/user_thread.h
===================================================================
--- haiku/trunk/headers/private/libroot/user_thread.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/libroot/user_thread.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -8,17 +8,10 @@
 #include &lt;OS.h&gt;
 #include &lt;TLS.h&gt;
 
-#include &lt;tls.h&gt;		/* kernel header */
+#include &lt;tls.h&gt;
+#include &lt;user_thread_defs.h&gt;
 
 
-struct user_thread {
-	int32			defer_signals;		// counter; 0 == signals allowed
-	uint32			pending_signals;	// signals that are pending, when
-										// signals are deferred
-	status_t		wait_status;
-};
-
-
 static inline user_thread*
 get_user_thread()
 {

Copied: haiku/trunk/headers/private/system/arch/m68k/arch_commpage_defs.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/m68k/arch_commpage.h)
===================================================================
--- haiku/trunk/headers/private/kernel/arch/m68k/arch_commpage.h	2008-05-12 22:01:12 UTC (rev 25480)
+++ haiku/trunk/headers/private/system/arch/m68k/arch_commpage_defs.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -0,0 +1,17 @@
+/*
+ * Copyright 2007, Travis Geiselbrecht. All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef _SYSTEM_ARCH_M68K_COMMPAGE_DEFS_H
+#define _SYSTEM_ARCH_M68K_COMMPAGE_DEFS_H
+
+#ifndef _SYSTEM_COMMPAGE_DEFS_H
+#	error Must not be included directly. Include &lt;commpage_defs.h&gt; instead!
+#endif
+
+#define COMMPAGE_ENTRY_M68K_SYSCALL	(COMMPAGE_ENTRY_FIRST_ARCH_SPECIFIC + 0)
+#define COMMPAGE_ENTRY_M68K_MEMCPY	(COMMPAGE_ENTRY_FIRST_ARCH_SPECIFIC + 1)
+
+#define ARCH_USER_COMMPAGE_ADDR (0xffff0000)
+
+#endif	/* _SYSTEM_ARCH_M68K_COMMPAGE_DEFS_H */

Copied: haiku/trunk/headers/private/system/arch/m68k/arch_config.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/m68k/arch_config.h)

Copied: haiku/trunk/headers/private/system/arch/m68k/arch_elf.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/m68k/arch_elf.h)

Copied: haiku/trunk/headers/private/system/arch/m68k/arch_real_time_data.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/m68k/arch_real_time_data.h)

Copied: haiku/trunk/headers/private/system/arch/ppc/arch_commpage_defs.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/ppc/arch_commpage.h)
===================================================================
--- haiku/trunk/headers/private/kernel/arch/ppc/arch_commpage.h	2008-05-12 22:01:12 UTC (rev 25480)
+++ haiku/trunk/headers/private/system/arch/ppc/arch_commpage_defs.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -0,0 +1,17 @@
+/*
+ * Copyright 2007, Travis Geiselbrecht. All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef _SYSTEM_ARCH_PPC_COMMPAGE_DEFS_H
+#define _SYSTEM_ARCH_PPC_COMMPAGE_DEFS_H
+
+#ifndef _SYSTEM_COMMPAGE_DEFS_H
+#	error Must not be included directly. Include &lt;commpage_defs.h&gt; instead!
+#endif
+
+#define COMMPAGE_ENTRY_PPC_SYSCALL	(COMMPAGE_ENTRY_FIRST_ARCH_SPECIFIC + 0)
+#define COMMPAGE_ENTRY_PPC_MEMCPY	(COMMPAGE_ENTRY_FIRST_ARCH_SPECIFIC + 1)
+
+#define ARCH_USER_COMMPAGE_ADDR (0xffff0000)
+
+#endif	/* _SYSTEM_ARCH_PPC_COMMPAGE_DEFS_H */

Copied: haiku/trunk/headers/private/system/arch/ppc/arch_config.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/ppc/arch_config.h)

Copied: haiku/trunk/headers/private/system/arch/ppc/arch_elf.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/ppc/arch_elf.h)

Copied: haiku/trunk/headers/private/system/arch/ppc/arch_real_time_data.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/ppc/arch_real_time_data.h)

Added: haiku/trunk/headers/private/system/arch/x86/apm_defs.h
===================================================================
--- haiku/trunk/headers/private/system/arch/x86/apm_defs.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/system/arch/x86/apm_defs.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -0,0 +1,23 @@
+/*
+ * Copyright 2006, Axel D&#246;rfler, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">axeld at pinc-software.de.</A> All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef SYSTEM_ARCH_X86_APM_DEFS_H
+#define SYSTEM_ARCH_X86_APM_DEFS_H
+
+
+#include &lt;SupportDefs.h&gt;
+
+
+// temporary generic syscall interface
+#define APM_SYSCALLS &quot;apm&quot;
+#define APM_GET_BATTERY_INFO	1
+
+struct battery_info {
+	bool	online;
+	int32	percent;
+	time_t	time_left;
+};
+
+
+#endif	/* SYSTEM_ARCH_X86_APM_DEFS_H */

Copied: haiku/trunk/headers/private/system/arch/x86/arch_commpage_defs.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/x86/arch_commpage.h)
===================================================================
--- haiku/trunk/headers/private/kernel/arch/x86/arch_commpage.h	2008-05-12 22:01:12 UTC (rev 25480)
+++ haiku/trunk/headers/private/system/arch/x86/arch_commpage_defs.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -0,0 +1,17 @@
+/*
+ * Copyright 2007, Travis Geiselbrecht. All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef _SYSTEM_ARCH_x86_COMMPAGE_DEFS_H
+#define _SYSTEM_ARCH_x86_COMMPAGE_DEFS_H
+
+#ifndef _SYSTEM_COMMPAGE_DEFS_H
+#	error Must not be included directly. Include &lt;commpage_defs.h&gt; instead!
+#endif
+
+#define COMMPAGE_ENTRY_X86_SYSCALL	(COMMPAGE_ENTRY_FIRST_ARCH_SPECIFIC + 0)
+#define COMMPAGE_ENTRY_X86_MEMCPY	(COMMPAGE_ENTRY_FIRST_ARCH_SPECIFIC + 1)
+
+#define ARCH_USER_COMMPAGE_ADDR (0xffff0000)
+
+#endif	/* _SYSTEM_ARCH_x86_COMMPAGE_DEFS_H */

Copied: haiku/trunk/headers/private/system/arch/x86/arch_config.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/x86/arch_config.h)

Copied: haiku/trunk/headers/private/system/arch/x86/arch_elf.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/x86/arch_elf.h)

Copied: haiku/trunk/headers/private/system/arch/x86/arch_real_time_data.h (from rev 25480, haiku/trunk/headers/private/kernel/arch/x86/arch_real_time_data.h)

Added: haiku/trunk/headers/private/system/commpage_defs.h
===================================================================
--- haiku/trunk/headers/private/system/commpage_defs.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/system/commpage_defs.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -0,0 +1,29 @@
+/*
+ * Copyright 2007, Travis Geiselbrecht. All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef _SYSTEM_COMMPAGE_DEFS_H
+#define _SYSTEM_COMMPAGE_DEFS_H
+
+/*! Some systemwide commpage constants, used in the kernel and libroot */
+
+/* be careful what you put here, this file is included from assembly */
+#define COMMPAGE_ENTRY_MAGIC				0
+#define COMMPAGE_ENTRY_VERSION				1
+#define COMMPAGE_ENTRY_REAL_TIME_DATA		2
+#define COMMPAGE_ENTRY_FIRST_ARCH_SPECIFIC	3
+
+#define COMMPAGE_SIZE (0x8000)
+#define COMMPAGE_TABLE_ENTRIES 64
+
+#define COMMPAGE_SIGNATURE 'COMM'
+#define COMMPAGE_VERSION 1
+
+#define USER_COMMPAGE_ADDR	ARCH_USER_COMMPAGE_ADDR
+	// set by the architecture specific implementation
+
+#define USER_COMMPAGE_TABLE	((void**)(USER_COMMPAGE_ADDR))
+
+#include &lt;arch_commpage_defs.h&gt;
+
+#endif	/* _SYSTEM_COMMPAGE_DEFS_H */

Added: haiku/trunk/headers/private/system/ddm_userland_interface_defs.h
===================================================================
--- haiku/trunk/headers/private/system/ddm_userland_interface_defs.h	2008-05-13 23:41:09 UTC (rev 25485)
+++ haiku/trunk/headers/private/system/ddm_userland_interface_defs.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -0,0 +1,66 @@
+/*
+ * Copyright 2003-2008, Haiku Inc.
+ * Distributed under the terms of the MIT License.
+ *
+ * Authors:
+ *		Ingo Weinhold, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">bonefish at users.sf.net</A>
+ */
+#ifndef _SYSTEM_DDM_USERLAND_INTERFACE_DEFS_H
+#define _SYSTEM_DDM_USERLAND_INTERFACE_DEFS_H
+
+#include &lt;OS.h&gt;
+
+#include &lt;DiskDeviceDefs.h&gt;
+
+
+// userland partition representation
+typedef struct user_partition_data user_partition_data;
+struct user_partition_data {
+	partition_id		id;
+	off_t				offset;
+	off_t				size;
+	off_t				content_size;
+	uint32				block_size;
+	uint32				status;
+	uint32				flags;
+	dev_t				volume;
+	int32				index;
+	int32				change_counter;	// needed?
+	disk_system_id		disk_system;
+	char				*name;
+	char				*content_name;
+	char				*type;
+	char				*content_type;
+	char				*parameters;
+	char				*content_parameters;
+	void				*user_data;
+	int32				child_count;
+	user_partition_data	*children[1];
+};
+
+// userland disk device representation
+typedef struct user_disk_device_data {
+	uint32				device_flags;
+	char				*path;
+	user_partition_data	device_partition_data;
+} user_disk_device_data;
+
+// userland disk system representation
+typedef struct user_disk_system_info {
+	disk_system_id	id;
+	char			name[B_FILE_NAME_LENGTH];	// better B_PATH_NAME_LENGTH?
+	char			short_name[B_OS_NAME_LENGTH];
+	char			pretty_name[B_OS_NAME_LENGTH];
+	uint32			flags;
+} user_disk_system_info;
+
+// userland disk device job representation
+typedef struct user_disk_device_job_info {
+	disk_job_id		id;
+	uint32			type;
+	partition_id	partition;
+	char			description[256];
+} user_disk_device_job_info;
+
+
+#endif	// _SYSTEM_DDM_USERLAND_INTERFACE_DEFS_H

Copied: haiku/trunk/headers/private/system/elf32.h (from rev 25480, haiku/trunk/headers/private/kernel/elf32.h)
===================================================================
--- haiku/trunk/headers/private/kernel/elf32.h	2008-05-12 22:01:12 UTC (rev 25480)
+++ haiku/trunk/headers/private/system/elf32.h	2008-05-14 03:55:16 UTC (rev 25486)
@@ -0,0 +1,312 @@
+/*
+ * Copyright 2002-2006, Haiku Inc. All Rights Reserved.
+ * Distributed under the terms of the MIT license.
+ *
+ * Copyright 2001, Travis Geiselbrecht. All rights reserved.
+ * Distributed under the terms of the NewOS License.
+ */
+#ifndef _ELF32_H
+#define _ELF32_H
+
+
+#include &lt;SupportDefs.h&gt;
+#include &lt;ByteOrder.h&gt;
+
+#include &lt;arch_elf.h&gt;
+
+
+typedef uint32 Elf32_Addr;
+typedef uint16 Elf32_Half;
+typedef uint32 Elf32_Off;
+typedef int32 Elf32_Sword;
+typedef uint32 Elf32_Word;
+
+
+/*** ELF header ***/
+
+#define EI_NIDENT	16
+
+struct Elf32_Ehdr {
+	uint8		e_ident[EI_NIDENT];
+	Elf32_Half	e_type;
+	Elf32_Half	e_machine;
+	Elf32_Word	e_version;
+	Elf32_Addr	e_entry;
+	Elf32_Off	e_phoff;
+	Elf32_Off	e_shoff;
+	Elf32_Word	e_flags;
+	Elf32_Half	e_ehsize;
+	Elf32_Half	e_phentsize;
+	Elf32_Half	e_phnum;
+	Elf32_Half	e_shentsize;
+	Elf32_Half	e_shnum;
+	Elf32_Half	e_shstrndx;
+
+#ifdef __cplusplus
+	bool IsHostEndian() const;
+#endif
+};
+
+#define ELF_MAGIC	&quot;\x7f&quot;&quot;ELF&quot;
+
+// e_ident[] indices
+#define EI_MAG0		0
+#define EI_MAG1		1
+#define EI_MAG2		2
+#define EI_MAG3		3
+#define EI_CLASS	4
+#define EI_DATA		5
+#define EI_VERSION	6
+#define EI_PAD		7
+
+// architecture class (EI_CLASS)
+#define ELFCLASS32	1
+#define ELFCLASS64	2
+// endian (EI_DATA)
+#define ELFDATA2LSB	1	// little endian
+#define ELFDATA2MSB	2	// big endian
+
+
+/*** section header ***/
+
+struct Elf32_Shdr {
+	Elf32_Word	sh_name;
+	Elf32_Word	sh_type;
+	Elf32_Word	sh_flags;
+	Elf32_Addr	sh_addr;
+	Elf32_Off	sh_offset;
+	Elf32_Word	sh_size;
+	Elf32_Word	sh_link;
+	Elf32_Word	sh_info;
+	Elf32_Word	sh_addralign;
+	Elf32_Word	sh_entsize;
+};
+
+// special section indices
+#define SHN_UNDEF		0
+#define SHN_LORESERVE	0xff00
+#define SHN_LOPROC		0xff00
+#define SHN_HIPROC		0xff1f
+#define SHN_ABS			0xfff1
+#define SHN_COMMON		0xfff2
+#define SHN_HIRESERVE	0xffff
+
+// section header type
+#define SHT_NULL		0
+#define SHT_PROGBITS	1
+#define SHT_SYMTAB		2
+#define SHT_STRTAB		3
+#define SHT_RELA		4
+#define SHT_HASH		5
+#define SHT_DYNAMIC		6
+#define SHT_NOTE		7
+#define SHT_NOBITS		8
+#define SHT_REL			9
+#define SHT_SHLIB		10
+#define SHT_DYNSYM		11
+
+#define SHT_LOPROC		0x70000000
+#define SHT_HIPROC		0x7fffffff
+#define SHT_LOUSER		0x80000000
+#define SHT_HIUSER		0xffffffff
+
+// section header flags
+#define SHF_WRITE		1
+#define SHF_ALLOC		2
+#define SHF_EXECINSTR	4
+
+#define SHF_MASKPROC	0xf0000000
+
+
+/*** program header ***/
+
+struct Elf32_Phdr {
+	Elf32_Word	p_type;
+	Elf32_Off	p_offset;	/* offset from the beginning of the file of the segment */
+	Elf32_Addr	p_vaddr;	/* virtual address for the segment in memory */
+	Elf32_Addr	p_paddr;
+	Elf32_Word	p_filesz;	/* the size of the segment in the file */
+	Elf32_Word	p_memsz;	/* the size of the segment in memory */
+	Elf32_Word	p_flags;
+	Elf32_Word	p_align;
+
+#ifdef __cplusplus
+	bool IsReadWrite() const;
+	bool IsExecutable() const;
+#endif
+};
+
+// program header segment types
+#define PT_NULL		0
+#define PT_LOAD		1
+#define PT_DYNAMIC	2
+#define PT_INTERP	3
+#define PT_NOTE		4
+#define PT_SHLIB	5
+#define PT_PHDR		6
+
+#define PT_LOPROC	0x70000000
+#define PT_HIPROC	0x7fffffff
+
+// program header segment flags
+#define PF_EXECUTE	0x1
+#define PF_WRITE	0x2
+#define PF_READ		0x4
+#define PF_PROTECTION_MASK (PF_EXECUTE | PF_WRITE | PF_READ)
+
+#define PF_MASKPROC	0xf0000000
+
+struct Elf32_Sym {
+	Elf32_Word	st_name;
+	Elf32_Addr	st_value;
+	Elf32_Word	st_size;
+	uint8		st_info;
+	uint8 		st_other;
+	Elf32_Half	st_shndx;
+
+#ifdef __cplusplus
+	uint8 Bind() const;
+	uint8 Type() const;
+#endif
+};
+
+#define ELF32_ST_BIND(i) ((i) &gt;&gt; 4)
+#define ELF32_ST_TYPE(i) ((i) &amp; 0xf)
+#define ELF32_ST_INFO(b, t) (((b) &lt;&lt; 4) + ((t) &amp; 0xf))
+
+#define STT_NOTYPE 0
+#define STT_OBJECT 1
+#define STT_FUNC 2
+#define STT_SECTION 3
+#define STT_FILE 4
+#define STT_LOPROC 13
+#define STT_HIPROC 15
+
+#define STB_LOCAL 0
+#define STB_GLOBAL 1
+#define STB_WEAK 2
+#define STB_LOPROC 13
+#define STB_HIPROC 15
+
+#define STN_UNDEF 0
+
+struct Elf32_Rel {
+	Elf32_Addr r_offset;
+	Elf32_Word r_info;
+
+#ifdef __cplusplus
+	uint8 SymbolIndex() const;
+	uint8 Type() const;
+#endif
+};
+
+#ifdef __cplusplus
+struct Elf32_Rela : public Elf32_Rel {
+#else
+struct Elf32_Rela {
+	Elf32_Addr r_offset;
+	Elf32_Word r_info;
+#endif
+	Elf32_Sword r_addend;
+};
+
+#define ELF32_R_SYM(i) ((i) &gt;&gt; 8)
+#define ELF32_R_TYPE(i) ((unsigned char)(i))
+#define ELF32_R_INFO(s, t) (((s) &lt;&lt; 8) + (unsigned char)(t))
+
+struct Elf32_Dyn {
+	Elf32_Sword d_tag;
+	union {
+		Elf32_Word d_val;
+		Elf32_Addr d_ptr;
+	} d_un;
+};
+
+#define DT_NULL		0
+#define DT_NEEDED	1
+#define DT_PLTRELSZ	2
+#define DT_PLTGOT	3
+#define DT_HASH		4
+#define DT_STRTAB	5
+#define DT_SYMTAB	6
+#define DT_RELA		7
+#define DT_RELASZ	8
+#define DT_RELAENT	9
+#define DT_STRSZ	10
+#define DT_SYMENT	11

[... truncated: 2091 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008840.html">[Haiku-commits] r25485 - in haiku/trunk: build/jam src/kits/network src/kits/network/dns/irs src/kits/network/libnetapi
</A></li>
	<LI>Next message: <A HREF="008836.html">[Haiku-commits] r25486 - in haiku/trunk: build/jam	headers/private headers/private/kernel	headers/private/kernel/arch/m68k headers/private/kernel/arch/ppc	headers/private/kernel/arch/x86	headers/private/kernel/disk_device_manager headers/private/
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8835">[ date ]</a>
              <a href="thread.html#8835">[ thread ]</a>
              <a href="subject.html#8835">[ subject ]</a>
              <a href="author.html#8835">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
