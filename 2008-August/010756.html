<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r26759 - haiku/trunk/src/apps/deskbar
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2008-August/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r26759%20-%20haiku/trunk/src/apps/deskbar&In-Reply-To=%3C200808031604.m73G4KZY028415%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010755.html">
   <LINK REL="Next"  HREF="010758.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r26759 - haiku/trunk/src/apps/deskbar</H1>
    <B>axeld at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r26759%20-%20haiku/trunk/src/apps/deskbar&In-Reply-To=%3C200808031604.m73G4KZY028415%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r26759 - haiku/trunk/src/apps/deskbar">axeld at mail.berlios.de
       </A><BR>
    <I>Sun Aug  3 18:04:20 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="010755.html">[Haiku-commits] r26758 - in haiku/trunk:	headers/private/kernel/arch/m68k src/system/kernel/arch/m68k	src/system/kernel/platform/atari_m68k
</A></li>
        <LI>Next message: <A HREF="010758.html">[Haiku-commits] r26760 - haiku/trunk/src/servers/app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10756">[ date ]</a>
              <a href="thread.html#10756">[ thread ]</a>
              <a href="subject.html#10756">[ subject ]</a>
              <a href="author.html#10756">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: axeld
Date: 2008-08-03 18:04:20 +0200 (Sun, 03 Aug 2008)
New Revision: 26759
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=26759&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=26759&amp;view=rev</A>

Modified:
   haiku/trunk/src/apps/deskbar/WindowMenuItem.cpp
Log:
* Coding style cleanup.


Modified: haiku/trunk/src/apps/deskbar/WindowMenuItem.cpp
===================================================================
--- haiku/trunk/src/apps/deskbar/WindowMenuItem.cpp	2008-08-03 15:57:03 UTC (rev 26758)
+++ haiku/trunk/src/apps/deskbar/WindowMenuItem.cpp	2008-08-03 16:04:20 UTC (rev 26759)
@@ -32,18 +32,20 @@
 All rights reserved.
 */
 
-#include &lt;Debug.h&gt;
+#include &quot;WindowMenuItem.h&quot;
+
 #include &lt;stdio.h&gt;
+
 #include &lt;Bitmap.h&gt;
+#include &lt;Debug.h&gt;
 
 #include &quot;BarApp.h&quot;
 #include &quot;BarMenuBar.h&quot;
 #include &quot;ExpandoMenuBar.h&quot;
+#include &quot;icons.h&quot;
 #include &quot;ResourceSet.h&quot;
 #include &quot;TeamMenu.h&quot;
 #include &quot;WindowMenu.h&quot;
-#include &quot;WindowMenuItem.h&quot;
-#include &quot;icons.h&quot;
 
 
 const float	kHPad = 10.0f;
@@ -52,9 +54,9 @@
 const BRect	kIconRect(1.0f, 1.0f, 13.0f, 14.0f);
 
 
-TWindowMenuItem::TWindowMenuItem(const char *title, int32 id,
-	bool mini, bool currentWorkspace, bool dragging)
-	:	BMenuItem(title, NULL),
+TWindowMenuItem::TWindowMenuItem(const char *title, int32 id, bool mini,
+		bool currentWorkspace, bool dragging)
+	: BMenuItem(title, NULL),
 	fID(id),
 	fMini(mini),
 	fCurrentWorkSpace(currentWorkspace),
@@ -71,14 +73,15 @@
 void
 TWindowMenuItem::Initialize(const char *title)
 {
-	if (fMini)
+	if (fMini) {
  		fBitmap = fCurrentWorkSpace
 			? AppResSet()-&gt;FindBitmap(B_MESSAGE_TYPE, R_WindowHiddenIcon)
 			: AppResSet()-&gt;FindBitmap(B_MESSAGE_TYPE, R_WindowHiddenSwitchIcon);
-	else
+	} else {
  		fBitmap = fCurrentWorkSpace
 			? AppResSet()-&gt;FindBitmap(B_MESSAGE_TYPE, R_WindowShownIcon)
 			: AppResSet()-&gt;FindBitmap(B_MESSAGE_TYPE, R_WindowShownSwitchIcon);
+	}
 
 	BFont font(be_plain_font);
 	fTitleWidth = ceilf(font.StringWidth(title));
@@ -90,8 +93,8 @@
 
 
 void
-TWindowMenuItem::SetTo(const char *title, int32 id,
-	bool mini, bool currentWorkspace, bool dragging)
+TWindowMenuItem::SetTo(const char *title, int32 id, bool mini,
+	bool currentWorkspace, bool dragging)
 {
 	fModified = fCurrentWorkSpace != currentWorkspace || fMini != mini;
 
@@ -121,9 +124,9 @@
 	if (fExpanded &amp;&amp; Menu()) {
 		BPoint contLoc = ContentLocation() + BPoint(kHPad, kVPad);
 		contLoc.x += kIconRect.Width() + kLabelOffset;
-	
+
 		be_plain_font-&gt;TruncateString(&amp;truncatedTitle, B_TRUNCATE_MIDDLE,
-									  Frame().Width() - contLoc.x - 3.0f);
+			Frame().Width() - contLoc.x - 3.0f);
 	}
 
 	if (strcmp(Label(), truncatedTitle.String()) != 0)
@@ -141,22 +144,26 @@
 void
 TWindowMenuItem::GetContentSize(float *width, float *height)
 {
-	if (!fExpanded) {
-		*width = kHPad + fTitleWidth + kHPad;
-		if (fID &gt;= 0)
-			*width += fBitmap-&gt;Bounds().Width() + kLabelOffset;
-	} else
-		*width = Frame().Width()/* - kHPad*/;
+	if (width != NULL) {
+		if (!fExpanded) {
+			*width = kHPad + fTitleWidth + kHPad;
+			if (fID &gt;= 0)
+				*width += fBitmap-&gt;Bounds().Width() + kLabelOffset;
+		} else
+			*width = Frame().Width()/* - kHPad*/;
+	}
 
 	// Note: when the item is in &quot;expanded mode&quot;, ie embedded into
 	// the Deskbar itself, then a truncated label is used in SetLabel()
 	// The code here is ignorant of this fact, but it doesn't seem to
 	// hurt anything.
 
-	*height = (fID &gt;= 0) ? fBitmap-&gt;Bounds().Height() : 0.0f;
-	float labelHeight = fTitleAscent + fTitleDescent;
-	*height = (labelHeight &gt; *height) ? labelHeight : *height;
-	*height += kVPad * 2;
+	if (height != NULL) {
+		*height = (fID &gt;= 0) ? fBitmap-&gt;Bounds().Height() : 0.0f;
+		float labelHeight = fTitleAscent + fTitleDescent;
+		*height = (labelHeight &gt; *height) ? labelHeight : *height;
+		*height += kVPad * 2;
+	}
 }
 
 
@@ -172,23 +179,26 @@
 
 		//	if not selected or being tracked on, fill with gray
 		TBarView *barview = (static_cast&lt;TBarApp *&gt;(be_app))-&gt;BarView();
-		if (!IsSelected() &amp;&amp; !menu-&gt;IsRedrawAfterSticky() || barview-&gt;Dragging() || !IsEnabled()) {
+		if (!IsSelected() &amp;&amp; !menu-&gt;IsRedrawAfterSticky()
+			|| barview-&gt;Dragging() || !IsEnabled()) {
 			menu-&gt;SetHighColor(menuColor);
 			menu-&gt;FillRect(frame);
 
 			if (fExpanded) {
-				rgb_color shadow = tint_color(menuColor, (B_NO_TINT + B_DARKEN_1_TINT) / 2.0f);
+				rgb_color shadow = tint_color(menuColor,
+					(B_NO_TINT + B_DARKEN_1_TINT) / 2.0f);
 				menu-&gt;SetHighColor(shadow);
 				frame.right = frame.left + kHPad / 2;
 				menu-&gt;FillRect(frame);
-			}	
+			}
 		}
 
 		if (IsEnabled() &amp;&amp; IsSelected() &amp;&amp; !menu-&gt;IsRedrawAfterSticky()) {
 			// fill
-			menu-&gt;SetHighColor(tint_color(menuColor, B_HIGHLIGHT_BACKGROUND_TINT));
+			menu-&gt;SetHighColor(tint_color(menuColor,
+				B_HIGHLIGHT_BACKGROUND_TINT));
 			menu-&gt;FillRect(frame);
-		} else 
+		} else
 			menu-&gt;SetLowColor(menuColor);
 
 		DrawContent();
@@ -212,7 +222,7 @@
 
 	if (fID &gt;= 0) {
 		menu-&gt;SetDrawingMode(B_OP_OVER);
-		
+
 		float width = fBitmap-&gt;Bounds().Width();
 
 		if (width &gt; 16)
@@ -228,7 +238,8 @@
 
 		menu-&gt;SetDrawingMode(B_OP_COPY);
 	}
-	contLoc.y = frame.top + ((frame.Height() - fTitleAscent - fTitleDescent) / 2) + 1.0f;
+	contLoc.y = frame.top
+		+ ((frame.Height() - fTitleAscent - fTitleDescent) / 2) + 1.0f;
 	menu-&gt;PopState();
 
 	menu-&gt;MovePenTo(contLoc);
@@ -240,12 +251,12 @@
 
 
 status_t
-TWindowMenuItem::Invoke(BMessage *)
+TWindowMenuItem::Invoke(BMessage* /*message*/)
 {
 	if (!fDragging) {
 		if (fID &gt;= 0) {
-			int32 action = (modifiers() &amp; B_CONTROL_KEY)
-				? B_MINIMIZE_WINDOW :B_BRING_TO_FRONT;
+			int32 action = (modifiers() &amp; B_CONTROL_KEY) != 0
+				? B_MINIMIZE_WINDOW : B_BRING_TO_FRONT;
 
 			bool doZoom = false;
 			BRect zoomRect(0.0f, 0.0f, 0.0f, 0.0f);
@@ -257,8 +268,8 @@
 
 			if (item-&gt;Menu()-&gt;Window() != NULL) {
 				zoomRect = item-&gt;Menu()-&gt;ConvertToScreen(item-&gt;Frame());
-				doZoom = fMini &amp;&amp; (action == B_BRING_TO_FRONT) ||
-						  !fMini &amp;&amp; (action == B_MINIMIZE_WINDOW);
+				doZoom = fMini &amp;&amp; action == B_BRING_TO_FRONT
+					|| !fMini &amp;&amp; action == B_MINIMIZE_WINDOW;
 			}
 
 			do_window_action(fID, action, zoomRect, doZoom);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010755.html">[Haiku-commits] r26758 - in haiku/trunk:	headers/private/kernel/arch/m68k src/system/kernel/arch/m68k	src/system/kernel/platform/atari_m68k
</A></li>
	<LI>Next message: <A HREF="010758.html">[Haiku-commits] r26760 - haiku/trunk/src/servers/app
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10756">[ date ]</a>
              <a href="thread.html#10756">[ thread ]</a>
              <a href="subject.html#10756">[ subject ]</a>
              <a href="author.html#10756">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
