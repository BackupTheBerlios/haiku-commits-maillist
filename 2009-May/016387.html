<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r30545 - in haiku/trunk: . build/jam	headers/os/locale headers/posix src/add-ons	src/add-ons/locale src/add-ons/locale/catalogs	src/add-ons/locale/catalogs/zeta src/add-ons/locale/collators	src/bin src/bin/locale src/data/etc/locale/languages src/kits	src/kits/locale src/preferences src/preferences/locale	src/tests/kits src/tests/kits/locale	src/tests/kits/locale/number_format src/tools	src/tools/locale src/tools/locale/genprops
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-May/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r30545%20-%20in%20haiku/trunk%3A%20.%20build/jam%0A%09headers/os/locale%20headers/posix%20src/add-ons%0A%09src/add-ons/locale%20src/add-ons/locale/catalogs%0A%09src/add-ons/locale/catalogs/zeta%20src/add-ons/locale/collators%0A%09src/bin%20src/bin/locale%20src/data/etc/locale/languages%20src/kits%0A%09src/kits/locale%20src/preferences%20src/preferences/locale%0A%09src/tests/kits%20src/tests/kits/locale%0A%09src/tests/kits/locale/number_format%20src/tools%0A%09src/tools/locale%20src/tools/locale/genprops&In-Reply-To=%3C200905012156.n41LuImD022669%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016386.html">
   <LINK REL="Next"  HREF="016388.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r30545 - in haiku/trunk: . build/jam	headers/os/locale headers/posix src/add-ons	src/add-ons/locale src/add-ons/locale/catalogs	src/add-ons/locale/catalogs/zeta src/add-ons/locale/collators	src/bin src/bin/locale src/data/etc/locale/languages src/kits	src/kits/locale src/preferences src/preferences/locale	src/tests/kits src/tests/kits/locale	src/tests/kits/locale/number_format src/tools	src/tools/locale src/tools/locale/genprops</H1>
    <B>zooey at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r30545%20-%20in%20haiku/trunk%3A%20.%20build/jam%0A%09headers/os/locale%20headers/posix%20src/add-ons%0A%09src/add-ons/locale%20src/add-ons/locale/catalogs%0A%09src/add-ons/locale/catalogs/zeta%20src/add-ons/locale/collators%0A%09src/bin%20src/bin/locale%20src/data/etc/locale/languages%20src/kits%0A%09src/kits/locale%20src/preferences%20src/preferences/locale%0A%09src/tests/kits%20src/tests/kits/locale%0A%09src/tests/kits/locale/number_format%20src/tools%0A%09src/tools/locale%20src/tools/locale/genprops&In-Reply-To=%3C200905012156.n41LuImD022669%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r30545 - in haiku/trunk: . build/jam	headers/os/locale headers/posix src/add-ons	src/add-ons/locale src/add-ons/locale/catalogs	src/add-ons/locale/catalogs/zeta src/add-ons/locale/collators	src/bin src/bin/locale src/data/etc/locale/languages src/kits	src/kits/locale src/preferences src/preferences/locale	src/tests/kits src/tests/kits/locale	src/tests/kits/locale/number_format src/tools	src/tools/locale src/tools/locale/genprops">zooey at mail.berlios.de
       </A><BR>
    <I>Fri May  1 23:56:18 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="016386.html">[Haiku-commits] r30544 -	haiku/trunk/src/apps/debuganalyzer/gui/chart
</A></li>
        <LI>Next message: <A HREF="016388.html">[Haiku-commits] r30546 -	haiku/trunk/src/add-ons/kernel/file_systems/nfs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16387">[ date ]</a>
              <a href="thread.html#16387">[ thread ]</a>
              <a href="subject.html#16387">[ subject ]</a>
              <a href="author.html#16387">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: zooey
Date: 2009-05-01 23:56:16 +0200 (Fri, 01 May 2009)
New Revision: 30545
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=30545&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=30545&amp;view=rev</A>

Removed:
   haiku/trunk/headers/os/locale/LocaleBuild.h
Modified:
   haiku/trunk/Jamfile
   haiku/trunk/build/jam/HaikuImage
   haiku/trunk/headers/os/locale/Catalog.h
   haiku/trunk/headers/os/locale/Collator.h
   haiku/trunk/headers/os/locale/Country.h
   haiku/trunk/headers/os/locale/Currency.h
   haiku/trunk/headers/os/locale/DefaultCatalog.h
   haiku/trunk/headers/os/locale/FloatFormat.h
   haiku/trunk/headers/os/locale/FloatFormatImpl.h
   haiku/trunk/headers/os/locale/FloatFormatParameters.h
   haiku/trunk/headers/os/locale/Format.h
   haiku/trunk/headers/os/locale/FormatImpl.h
   haiku/trunk/headers/os/locale/FormatParameters.h
   haiku/trunk/headers/os/locale/GenericNumberFormat.h
   haiku/trunk/headers/os/locale/IntegerFormat.h
   haiku/trunk/headers/os/locale/IntegerFormatImpl.h
   haiku/trunk/headers/os/locale/IntegerFormatParameters.h
   haiku/trunk/headers/os/locale/Language.h
   haiku/trunk/headers/os/locale/Locale.h
   haiku/trunk/headers/os/locale/LocaleRoster.h
   haiku/trunk/headers/os/locale/NumberFormat.h
   haiku/trunk/headers/os/locale/NumberFormatImpl.h
   haiku/trunk/headers/os/locale/NumberFormatParameters.h
   haiku/trunk/headers/os/locale/UnicodeChar.h
   haiku/trunk/headers/posix/langinfo.h
   haiku/trunk/headers/posix/monetary.h
   haiku/trunk/src/add-ons/Jamfile
   haiku/trunk/src/add-ons/locale/Jamfile
   haiku/trunk/src/add-ons/locale/catalogs/Jamfile
   haiku/trunk/src/add-ons/locale/catalogs/zeta/Jamfile
   haiku/trunk/src/add-ons/locale/collators/Jamfile
   haiku/trunk/src/bin/Jamfile
   haiku/trunk/src/bin/locale/Jamfile
   haiku/trunk/src/data/etc/locale/languages/Jamfile
   haiku/trunk/src/kits/Jamfile
   haiku/trunk/src/kits/locale/Jamfile
   haiku/trunk/src/kits/locale/LibraryInit.cpp
   haiku/trunk/src/kits/locale/adler32.c
   haiku/trunk/src/preferences/Jamfile
   haiku/trunk/src/preferences/locale/Jamfile
   haiku/trunk/src/tests/kits/Jamfile
   haiku/trunk/src/tests/kits/locale/Jamfile
   haiku/trunk/src/tests/kits/locale/number_format/Jamfile
   haiku/trunk/src/tools/Jamfile
   haiku/trunk/src/tools/locale/Jamfile
   haiku/trunk/src/tools/locale/genprops/Jamfile
Log:
Applied patch by PulkoMandy, adjusted and extended by myself:
* integrating most of the locale kit into the build (and image)
* removed LocaleBuild.h and _IMPEXP_LOCALE since that does not make
  sense for elf (which usually exports all symbols anyway)
* added a couple of locale kit related pseudo targets for convenience
Hey, some of that stuff already seems to work :-)

Modified: haiku/trunk/Jamfile
===================================================================
--- haiku/trunk/Jamfile	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/Jamfile	2009-05-01 21:56:16 UTC (rev 30545)
@@ -132,6 +132,25 @@
 	Haiku
 ;
 
+# Pseudo-target to build the locale kit only
+NotFile LocaleKit ;
+Depends LocaleKit :
+	liblocale.so
+	Locale
+	
+	# binaries for building localized software on haiku
+	collectcatkeys
+	dumpcatalog
+	linkcatkeys
+	
+	# addons
+	LocaleKitCollatorAddons
+	LocaleKitCatalogAddons
+	
+	# tests
+	LocaleKitTests
+;
+
 # Evaluate optional package dependencies and prepare the optional build
 # features before parsing the Jamfile tree.
 include [ FDirName $(HAIKU_BUILD_RULES_DIR) OptionalPackageDependencies ] ;

Modified: haiku/trunk/build/jam/HaikuImage
===================================================================
--- haiku/trunk/build/jam/HaikuImage	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/build/jam/HaikuImage	2009-05-01 21:56:16 UTC (rev 30545)
@@ -29,9 +29,10 @@
 
 SYSTEM_BIN = &quot;[&quot; addattr alert arp base64 basename bash bc beep bootman bzip2
 	cal cat catattr checkfs chgrp chmod chop chown chroot cksum clear
-	clockconfig cmp comm compress copyattr CortexAddOnHost cp
+	clockconfig cmp collectcatkeys comm compress copyattr CortexAddOnHost cp
 	csplit ctags cut date dc dd desklink df diff diff3 dircolors dirname
-	draggers driveinfo dstcheck du echo eject env error expand expr
+	draggers driveinfo dstcheck du dumpcatalog
+	echo eject env error expand expr
 	factor false fdinfo ffm filepanel find finddir fmt fold fortune frcode
 	ftp ftpd
 	funzip fwcontrol
@@ -39,7 +40,8 @@
 	id ident ideinfo idestatus ifconfig &lt;bin&gt;install installsound iroster
 	isvolume
 	join
-	keymap kill less lessecho lesskey link listarea listattr listimage listdev
+	keymap kill less lessecho lesskey link linkcatkeys listarea listattr 
+	listimage listdev
 	listport listres listsem listusb ln locate logger login logname ls lsindex
 	makebootable md5sum merge mimeset mkdos mkdir mkfifo mkfs mkindex
 	modifiers mount mount_nfs mountvolume mv
@@ -68,8 +70,8 @@
 	StyledEdit Terminal TextSearch TV Workspaces
 ;
 SYSTEM_PREFERENCES = Appearance Backgrounds CPUFrequency DataTranslations E-mail
-	FileTypes Fonts Keyboard Keymap Media Menu Mouse Network Printers Screen
-	ScreenSaver Sounds Time Touchpad &lt;preference&gt;Tracker VirtualMemory
+	FileTypes Fonts Keyboard Keymap Locale Media Menu Mouse Network Printers 
+	Screen ScreenSaver Sounds Time Touchpad &lt;preference&gt;Tracker VirtualMemory
 ;
 SYSTEM_DEMOS = BSnow Chart Clock Cortex FontDemo
 	GLDirectMode GLTeapot Mandelbrot Pairs
@@ -80,7 +82,7 @@
 	libmail.so libtextencoding.so libz.so libfreetype.so libpng.so libmidi.so
 	libmidi2.so libdevice.so libgame.so libscreensaver.so &lt;revisioned&gt;libroot.so
 	libGL.so libfluidsynth.so liblpsolve55.so liblinprog.so libalm.so
-	libilmimf.so libiconv.so
+	libilmimf.so libiconv.so liblocale.so
 ;
 SYSTEM_SERVERS = registrar debug_server syslog_daemon media_server
 	net_server media_addon_server input_server app_server fake_app_server
@@ -346,6 +348,11 @@
 	= [ FDirName $(HAIKU_TOP) src apps mail ] ;
 AddFilesToHaikuImage system etc word_dictionary : $(spellFiles) ;
 
+# Locale kit language files
+local languageDir = [ FDirName $(HAIKU_TOP) src data etc locale languages ] ;
+local languages = [ Glob $(languageDir) : *.language ] ;
+AddFilesToHaikuImage system etc locale languages : $(languages) ;
+
 local etcFiles = bash_completion inputrc profile teapot.data ;
 etcFiles = $(etcFiles:G=etc) ;
 SEARCH on $(etcFiles) = [ FDirName $(HAIKU_TOP) data etc ] ;

Modified: haiku/trunk/headers/os/locale/Catalog.h
===================================================================
--- haiku/trunk/headers/os/locale/Catalog.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/Catalog.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -1,8 +1,6 @@
 #ifndef _CATALOG_H_
 #define _CATALOG_H_
 
-#include &lt;LocaleBuild.h&gt;
-
 #include &lt;SupportDefs.h&gt;
 #include &lt;String.h&gt;
 
@@ -12,7 +10,7 @@
 struct entry_ref;
 
 
-class _IMPEXP_LOCALE BCatalog {
+class BCatalog {
 
 	public:
 		BCatalog();
@@ -51,8 +49,8 @@
 };
 
 
-extern _IMPEXP_LOCALE BCatalog* be_catalog;
-extern _IMPEXP_LOCALE BCatalog* be_app_catalog;
+extern BCatalog* be_catalog;
+extern BCatalog* be_app_catalog;
 
 
 #ifndef B_AVOID_TRANSLATION_MACROS
@@ -60,22 +58,22 @@
 // you don't want these:
 
 #undef TR_CONTEXT
-	// In a single application, several strings (e.g. 'Ok') will be used 
-	// more than once, in different contexts. 
+	// In a single application, several strings (e.g. 'Ok') will be used
+	// more than once, in different contexts.
 	// As the application programmer can not know if all translations of
 	// this string will be the same for all languages, each occurrence of
 	// the string must be translated on its own.
 	// Specifying the context explicitly with each string allows the person
 	// translating a catalog to separate these different occurrences of the
-	// same string and tell which strings appears in what context of the 
+	// same string and tell which strings appears in what context of the
 	// application.
 	// In order to give the translator a useful hint, the application
-	// programmer needs to define TR_CONTEXT with the context he'd like 
+	// programmer needs to define TR_CONTEXT with the context he'd like
 	// to be associated with the strings used in this specifc source file.
 	// example:
 	//		#define TR_CONTEXT &quot;Folder-Window&quot;
-	// Tip: Use a descriptive name of the class implemented in that 
-	//		source-file. 
+	// Tip: Use a descriptive name of the class implemented in that
+	//		source-file.
 
 
 // Translation macros which may be used to shorten translation requests:
@@ -112,7 +110,7 @@
 			for (char **ch = choices; *ch; ch++) {
 				menu-&gt;AddItem(
 					new BMenuItem(
-						TR(*ch), 
+						TR(*ch),
 						new BMessage(...)
 					)
 				)
@@ -130,25 +128,25 @@
 #undef TR_MARK_ALL
 #define TR_MARK_ALL(str,ctx,cmt) \
 	BCatalogAddOn::MarkForTranslation((str), (ctx), (cmt))
-	
+
 #undef TR_MARK_ID
 #define TR_MARK_ID(id) \
 	BCatalogAddOn::MarkForTranslation((id))
-	
+
 #endif	/* B_AVOID_TRANSLATION_MACROS */
 
 
 /************************************************************************/
 // For BCatalog add-on implementations:
 
-class _IMPEXP_LOCALE BCatalogAddOn {
+class BCatalogAddOn {
 		friend class BLocaleRoster;
 	public:
 		BCatalogAddOn(const char *signature, const char *language,
 					  int32 fingerprint);
 		virtual ~BCatalogAddOn();
 
-		virtual const char *GetString(const char *string, 
+		virtual const char *GetString(const char *string,
 								const char *context=NULL,
 								const char *comment=NULL) = 0;
 		virtual const char *GetString(uint32 id) = 0;
@@ -157,14 +155,14 @@
 		BCatalogAddOn *Next();
 
 		// the following could be used to localize non-textual data (e.g. icons),
-		// but these will only be implemented if there's demand for such a 
+		// but these will only be implemented if there's demand for such a
 		// feature:
 		virtual bool CanHaveData() const;
 		virtual status_t GetData(const char *name, BMessage *msg);
 		virtual status_t GetData(uint32 id, BMessage *msg);
 
 		// interface for catalog-editor-app and testing apps:
-		virtual status_t SetString(const char *string, 
+		virtual status_t SetString(const char *string,
 							const char *translated,
 							const char *context=NULL,
 							const char *comment=NULL);
@@ -187,7 +185,7 @@
 		// magic marker functions which are used to mark a string/id
 		// which will be translated elsewhere in the code (where it can
 		// not be found since it is references by a variable):
-		static const char *MarkForTranslation(const char *str, const char *ctx, 
+		static const char *MarkForTranslation(const char *str, const char *ctx,
 								const char *cmt);
 		static int32 MarkForTranslation(int32 id);
 
@@ -199,29 +197,29 @@
 		BString 			fLanguageName;
 		int32				fFingerprint;
 		BCatalogAddOn 		*fNext;
-		
+
 		friend class BCatalog;
 		friend status_t get_add_on_catalog(BCatalog*, const char *);
 };
 
 // every catalog-add-on should export these symbols...
 // ...the function that instantiates a catalog for this add-on-type...
-extern &quot;C&quot; _IMPEXP_LOCALE 
+extern &quot;C&quot;
 BCatalogAddOn *instantiate_catalog(const char *signature,
 	const char *language, int32 fingerprint);
 // ...the function that creates an empty catalog for this add-on-type...
-extern &quot;C&quot; _IMPEXP_LOCALE 
+extern &quot;C&quot;
 BCatalogAddOn *create_catalog(const char *signature,
 	const char *language);
 // ...and the priority which will be used to order the catalog-add-ons:
-extern _IMPEXP_LOCALE uint8 gCatalogAddOnPriority;
+extern uint8 gCatalogAddOnPriority;
 
 
 /*
  * BCatalog - inlines for trivial accessors:
  */
 inline status_t
-BCatalog::GetSignature(BString *sig) 
+BCatalog::GetSignature(BString *sig)
 {
 	if (!sig)
 		return B_BAD_VALUE;
@@ -232,8 +230,8 @@
 }
 
 
-inline status_t 
-BCatalog::GetLanguage(BString *lang) 
+inline status_t
+BCatalog::GetLanguage(BString *lang)
 {
 	if (!lang)
 		return B_BAD_VALUE;
@@ -241,11 +239,11 @@
 		return B_NO_INIT;
 	*lang = fCatalog-&gt;fLanguageName;
 	return B_OK;
-}	
+}
 
 
-inline status_t 
-BCatalog::GetFingerprint(int32 *fp) 
+inline status_t
+BCatalog::GetFingerprint(int32 *fp)
 {
 	if (!fp)
 		return B_BAD_VALUE;
@@ -259,13 +257,13 @@
 inline status_t
 BCatalog::InitCheck() const
 {
-	return fCatalog 
-				? fCatalog-&gt;InitCheck() 
+	return fCatalog
+				? fCatalog-&gt;InitCheck()
 				: B_NO_INIT;
 }
 
 
-inline int32 
+inline int32
 BCatalog::CountItems() const
 {
 	if (!fCatalog)
@@ -275,7 +273,7 @@
 
 
 inline BCatalogAddOn *
-BCatalog::CatalogAddOn() 
+BCatalog::CatalogAddOn()
 {
 	return fCatalog;
 }
@@ -285,22 +283,22 @@
  * BCatalogAddOn - inlines for trivial accessors:
  */
 inline BCatalogAddOn *
-BCatalogAddOn::Next() 
+BCatalogAddOn::Next()
 {
 	return fNext;
 }
 
 
 inline const char *
-BCatalogAddOn::MarkForTranslation(const char *str, const char *ctx, 
-	const char *cmt) 
+BCatalogAddOn::MarkForTranslation(const char *str, const char *ctx,
+	const char *cmt)
 {
 	return str;
 }
 
 
 inline int32
-BCatalogAddOn::MarkForTranslation(int32 id) 
+BCatalogAddOn::MarkForTranslation(int32 id)
 {
 	return id;
 }
@@ -311,14 +309,14 @@
 /*
  * EditableCatalog
  */
-class _IMPEXP_LOCALE EditableCatalog : public BCatalog {
+class EditableCatalog : public BCatalog {
 
 	public:
-		EditableCatalog(const char *type, const char *signature, 
+		EditableCatalog(const char *type, const char *signature,
 			const char *language);
 		~EditableCatalog();
 
-		status_t SetString(const char *string, 
+		status_t SetString(const char *string,
 					const char *translated,
 					const char *context=NULL,
 					const char *comment=NULL);

Modified: haiku/trunk/headers/os/locale/Collator.h
===================================================================
--- haiku/trunk/headers/os/locale/Collator.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/Collator.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -5,8 +5,6 @@
 #include &lt;SupportDefs.h&gt;
 #include &lt;Archivable.h&gt;
 
-#include &lt;LocaleBuild.h&gt;
-
 class BString;
 class BCollatorAddOn;
 
@@ -23,7 +21,7 @@
 };
 
 
-class _IMPEXP_LOCALE BCollator : public BArchivable {
+class BCollator : public BArchivable {
 	public:
 		BCollator();
 		BCollator(BCollatorAddOn *collator, int8 strength, bool ignorePunctuation);
@@ -55,21 +53,21 @@
 };
 
 
-inline bool 
+inline bool
 BCollator::Equal(const char *s1, const char *s2, int32 len, int8 strength)
 {
 	return Compare(s1, s2, len, strength) == 0;
 }
 
 
-inline bool 
+inline bool
 BCollator::Greater(const char *s1, const char *s2, int32 len, int8 strength)
 {
 	return Compare(s1, s2, len, strength) &gt; 0;
 }
 
 
-inline bool 
+inline bool
 BCollator::GreaterOrEqual(const char *s1, const char *s2, int32 len, int8 strength)
 {
 	return Compare(s1, s2, len, strength) &gt;= 0;
@@ -80,7 +78,7 @@
 
 // For BCollator add-on implementations:
 
-class _IMPEXP_LOCALE BCollatorAddOn : public BArchivable {
+class BCollatorAddOn : public BArchivable {
 	public:
 		BCollatorAddOn();
 		BCollatorAddOn(BMessage *archive);
@@ -114,6 +112,6 @@
 // If your add-on should work with the standard tool to create a language, it
 // should export that function. However, once the language file has been written
 // only the archived collator is used, and that function won't be called anymore.
-extern &quot;C&quot; _IMPEXP_LOCALE BCollatorAddOn *instantiate_collator(void);
+extern &quot;C&quot; BCollatorAddOn *instantiate_collator(void);
 
 #endif	/* _COLLATOR_H_ */

Modified: haiku/trunk/headers/os/locale/Country.h
===================================================================
--- haiku/trunk/headers/os/locale/Country.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/Country.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -3,7 +3,6 @@
 
 
 #include &lt;SupportDefs.h&gt;
-#include &lt;LocaleBuild.h&gt;
 #include &lt;LocaleStrings.h&gt;
 #include &lt;String.h&gt;
 
@@ -13,11 +12,11 @@
 };
 
 
-class _IMPEXP_LOCALE BCountry {
+class BCountry {
 	public:
 		BCountry();
 		virtual ~BCountry();
-		
+
 		virtual const char *Name() const;
 
 		// see definitions below

Modified: haiku/trunk/headers/os/locale/Currency.h
===================================================================
--- haiku/trunk/headers/os/locale/Currency.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/Currency.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -5,11 +5,9 @@
 #include &lt;Message.h&gt;
 #include &lt;String.h&gt;
 
-#include &lt;LocaleBuild.h&gt;
-
 class BLocale;
 
-class _IMPEXP_LOCALE BCurrency : public BArchivable {
+class BCurrency : public BArchivable {
 	public:
 		BCurrency(const BCurrency &amp;other);
 		BCurrency(BMessage *archive);

Modified: haiku/trunk/headers/os/locale/DefaultCatalog.h
===================================================================
--- haiku/trunk/headers/os/locale/DefaultCatalog.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/DefaultCatalog.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -7,8 +7,6 @@
 #	include &lt;hash_map&gt;
 #endif
 
-#include &lt;LocaleBuild.h&gt;
-
 #include &lt;Catalog.h&gt;
 #include &lt;DataIO.h&gt;
 #include &lt;String.h&gt;
@@ -45,9 +43,9 @@
  * but it should also support being created from up to three strings,
  * which as a whole specify the key to the translated string.
  */
-struct _IMPEXP_LOCALE CatKey {
+struct CatKey {
 	BString fKey;
-		// the key-string consists of three values separated by a special 
+		// the key-string consists of three values separated by a special
 		// token:
 		// - the native string
 		// - the context of the string's usage
@@ -73,7 +71,7 @@
  * but the value-type might change to add support for shortcuts and/or
  * graphical data (button-images and the like).
  */
-class _IMPEXP_LOCALE DefaultCatalog : public BCatalogAddOn {
+class DefaultCatalog : public BCatalogAddOn {
 
 	public:
 		DefaultCatalog(const char *signature, const char *language,
@@ -81,10 +79,10 @@
 				// constructor for normal use
 		DefaultCatalog(entry_ref *appOrAddOnRef);
 				// constructor for embedded catalog
-		DefaultCatalog(const char *path, const char *signature, 
+		DefaultCatalog(const char *path, const char *signature,
 			const char *language);
 				// constructor for editor-app
-					   
+
 		~DefaultCatalog();
 
 		// overrides of BCatalogAddOn:
@@ -93,7 +91,7 @@
 		const char *GetString(uint32 id);
 		const char *GetString(const CatKey&amp; key);
 		//
-		status_t SetString(const char *string, const char *translated, 
+		status_t SetString(const char *string, const char *translated,
 					const char *context = NULL, const char *comment = NULL);
 		status_t SetString(int32 id, const char *translated);
 		status_t SetString(const CatKey&amp; key, const char *translated);
@@ -145,50 +143,50 @@
 				CatMap::iterator fPos;
 				CatMap::iterator fEnd;
 		};
-		status_t GetWalker(CatWalker *walker);		
+		status_t GetWalker(CatWalker *walker);
 };
 
-inline 
+inline
 DefaultCatalog::CatWalker::CatWalker(CatMap &amp;catMap)
 	: fPos(catMap.begin()),
 	  fEnd(catMap.end())
 {
 }
 
-inline bool 
+inline bool
 DefaultCatalog::CatWalker::AtEnd() const
 {
 	return fPos == fEnd;
 }
 
-inline const CatKey &amp; 
+inline const CatKey &amp;
 DefaultCatalog::CatWalker::GetKey() const
 {
 	assert(fPos != fEnd);
 	return fPos-&gt;first;
 }
 
-inline const char * 
+inline const char *
 DefaultCatalog::CatWalker::GetValue() const
 {
 	assert(fPos != fEnd);
 	return fPos-&gt;second.String();
 }
 
-inline void 
+inline void
 DefaultCatalog::CatWalker::Next()
 {
 	++fPos;
 }
 
-inline status_t 
+inline status_t
 DefaultCatalog::GetWalker(CatWalker *walker)
 {
 	if (!walker)
 		return B_BAD_VALUE;
 	*walker = CatWalker(fCatMap);
 	return B_OK;
-}		
+}
 
 }	// namespace BPrivate
 

Modified: haiku/trunk/headers/os/locale/FloatFormat.h
===================================================================
--- haiku/trunk/headers/os/locale/FloatFormat.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/FloatFormat.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -7,7 +7,7 @@
 class BString;
 class BFloatFormatImpl;
 
-class _IMPEXP_LOCALE BFloatFormat : public BNumberFormat, public BFloatFormatParameters {
+class BFloatFormat : public BNumberFormat, public BFloatFormatParameters {
 	public:
 		BFloatFormat(const BFloatFormat &amp;other);
 		~BFloatFormat();

Modified: haiku/trunk/headers/os/locale/FloatFormatImpl.h
===================================================================
--- haiku/trunk/headers/os/locale/FloatFormatImpl.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/FloatFormatImpl.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -7,7 +7,7 @@
 class BFloatFormatParameters;
 class BString;
 
-class _IMPEXP_LOCALE BFloatFormatImpl : public BNumberFormatImpl {
+class BFloatFormatImpl : public BNumberFormatImpl {
 	public:
 		BFloatFormatImpl();
 		virtual ~BFloatFormatImpl();

Modified: haiku/trunk/headers/os/locale/FloatFormatParameters.h
===================================================================
--- haiku/trunk/headers/os/locale/FloatFormatParameters.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/FloatFormatParameters.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -10,7 +10,7 @@
 									// number to be formatted
 };
 
-class _IMPEXP_LOCALE BFloatFormatParameters : public BNumberFormatParameters {
+class BFloatFormatParameters : public BNumberFormatParameters {
 	public:
 		BFloatFormatParameters(const BFloatFormatParameters *parent = NULL);
 		BFloatFormatParameters(const BFloatFormatParameters &amp;other);

Modified: haiku/trunk/headers/os/locale/Format.h
===================================================================
--- haiku/trunk/headers/os/locale/Format.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/Format.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -24,7 +24,7 @@
 };
 
 // structure filled in while formatting
-struct _IMPEXP_LOCALE format_field_position {
+struct format_field_position {
 	uint32	field_type;
 	int32	start;
 	int32	length;
@@ -32,7 +32,7 @@
 
 class BFormatImpl;
 
-class _IMPEXP_LOCALE BFormat {
+class BFormat {
 	protected:
 		BFormat(const BFormat &amp;other);
 		~BFormat();

Modified: haiku/trunk/headers/os/locale/FormatImpl.h
===================================================================
--- haiku/trunk/headers/os/locale/FormatImpl.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/FormatImpl.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -3,11 +3,9 @@
 
 #include &lt;SupportDefs.h&gt;
 
-#include &lt;LocaleBuild.h&gt;
-
 class BFormatParameters;
 
-class _IMPEXP_LOCALE BFormatImpl {
+class BFormatImpl {
 	public:
 		BFormatImpl();
 		virtual ~BFormatImpl();

Modified: haiku/trunk/headers/os/locale/FormatParameters.h
===================================================================
--- haiku/trunk/headers/os/locale/FormatParameters.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/FormatParameters.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -3,14 +3,12 @@
 
 #include &lt;SupportDefs.h&gt;
 
-#include &lt;LocaleBuild.h&gt;
-
 enum format_alignment {
 	B_ALIGN_FORMAT_LEFT,		// reuse B_ALIGN_LEFT/B_ALIGN_RIGHT?
 	B_ALIGN_FORMAT_RIGHT,
 };
 
-class _IMPEXP_LOCALE BFormatParameters {
+class BFormatParameters {
 	public:
 		BFormatParameters(const BFormatParameters *parent = NULL);
 		BFormatParameters(const BFormatParameters &amp;other);

Modified: haiku/trunk/headers/os/locale/GenericNumberFormat.h
===================================================================
--- haiku/trunk/headers/os/locale/GenericNumberFormat.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/GenericNumberFormat.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -7,7 +7,7 @@
 class BString;
 struct format_field_position;
 
-class _IMPEXP_LOCALE BGenericNumberFormat {
+class BGenericNumberFormat {
 	public:
 		BGenericNumberFormat();
 		~BGenericNumberFormat();

Modified: haiku/trunk/headers/os/locale/IntegerFormat.h
===================================================================
--- haiku/trunk/headers/os/locale/IntegerFormat.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/IntegerFormat.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -12,7 +12,7 @@
 // and this class (and its base classes) should mirror the parameters
 // classes' accessor methods.
 //
-class _IMPEXP_LOCALE BIntegerFormat : public BNumberFormat, public BIntegerFormatParameters {
+class BIntegerFormat : public BNumberFormat, public BIntegerFormatParameters {
 	public:
 		BIntegerFormat(const BIntegerFormat &amp;other);
 		~BIntegerFormat();

Modified: haiku/trunk/headers/os/locale/IntegerFormatImpl.h
===================================================================
--- haiku/trunk/headers/os/locale/IntegerFormatImpl.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/IntegerFormatImpl.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -7,7 +7,7 @@
 class BIntegerFormatParameters;
 class BString;
 
-class _IMPEXP_LOCALE BIntegerFormatImpl : public BNumberFormatImpl {
+class BIntegerFormatImpl : public BNumberFormatImpl {
 	public:
 		BIntegerFormatImpl();
 		virtual ~BIntegerFormatImpl();

Modified: haiku/trunk/headers/os/locale/IntegerFormatParameters.h
===================================================================
--- haiku/trunk/headers/os/locale/IntegerFormatParameters.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/IntegerFormatParameters.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -3,7 +3,7 @@
 
 #include &lt;NumberFormatParameters.h&gt;
 
-class _IMPEXP_LOCALE BIntegerFormatParameters : public BNumberFormatParameters {
+class BIntegerFormatParameters : public BNumberFormatParameters {
 	public:
 		BIntegerFormatParameters(const BIntegerFormatParameters *parent = NULL);
 		BIntegerFormatParameters(const BIntegerFormatParameters &amp;other);

Modified: haiku/trunk/headers/os/locale/Language.h
===================================================================
--- haiku/trunk/headers/os/locale/Language.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/Language.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -3,7 +3,6 @@
 
 
 #include &lt;SupportDefs.h&gt;
-#include &lt;LocaleBuild.h&gt;
 #include &lt;LocaleStrings.h&gt;
 
 
@@ -14,7 +13,7 @@
 };
 
 
-class _IMPEXP_LOCALE BLanguage {
+class BLanguage {
 	public:
 		~BLanguage();
 

Modified: haiku/trunk/headers/os/locale/Locale.h
===================================================================
--- haiku/trunk/headers/os/locale/Locale.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/Locale.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -2,8 +2,6 @@
 #define _B_LOCALE_H_
 
 
-#include &lt;LocaleBuild.h&gt;
-
 #include &lt;Collator.h&gt;
 #include &lt;Language.h&gt;
 #include &lt;Country.h&gt;
@@ -13,7 +11,7 @@
 class BString;
 
 
-class _IMPEXP_LOCALE BLocale {
+class BLocale {
 	public:
 		BLocale();
 		~BLocale();
@@ -43,7 +41,7 @@
 		int StringCompare(const BString *, const BString *, int32 len = -1, int8 strength = B_COLLATE_DEFAULT) const;
 
 		void GetSortKey(const char *string, BString *key);
-		
+
 		status_t GetAppCatalog(BCatalog *);
 
 	protected:
@@ -53,34 +51,34 @@
 };
 
 // global objects
-extern _IMPEXP_LOCALE BLocale *be_locale;
-extern _IMPEXP_LOCALE BLocaleRoster *be_locale_roster;
+extern BLocale *be_locale;
+extern BLocaleRoster *be_locale_roster;
 
 //----------------------------------------------------------------------
 //--- country short-hands inlines ---
 
-inline void 
+inline void
 BLocale::FormatDate(char *target, size_t maxSize, time_t timer, bool longFormat)
 {
 	fCountry-&gt;FormatDate(target, maxSize, timer, longFormat);
 }
 
 
-inline void 
+inline void
 BLocale::FormatDate(BString *target, time_t timer, bool longFormat)
 {
 	fCountry-&gt;FormatDate(target, timer, longFormat);
 }
 
 
-inline void 
+inline void
 BLocale::FormatTime(char *target, size_t maxSize, time_t timer, bool longFormat)
 {
 	fCountry-&gt;FormatTime(target, maxSize, timer, longFormat);
 }
 
 
-inline void 
+inline void
 BLocale::FormatTime(BString *target, time_t timer, bool longFormat)
 {
 	fCountry-&gt;FormatTime(target, timer, longFormat);
@@ -90,14 +88,14 @@
 //--- locale short-hands inlines ---
 //	#pragma mark -
 
-inline int 
+inline int
 BLocale::StringCompare(const char *string1, const char *string2, int32 length, int8 strength) const
 {
 	return fCollator-&gt;Compare(string1, string2, length, strength);
 }
 
 
-inline int 
+inline int
 BLocale::StringCompare(const BString *string1, const BString *string2, int32 length, int8 strength) const
 {
 	return fCollator-&gt;Compare(string1-&gt;String(), string2-&gt;String(), length, strength);

Deleted: haiku/trunk/headers/os/locale/LocaleBuild.h

Modified: haiku/trunk/headers/os/locale/LocaleRoster.h
===================================================================
--- haiku/trunk/headers/os/locale/LocaleRoster.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/LocaleRoster.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -1,8 +1,6 @@
 #ifndef _LOCALE_ROSTER_H_
 #define _LOCALE_ROSTER_H_
 
-#include &lt;LocaleBuild.h&gt;
-
 #include &lt;String.h&gt;
 
 class BLanguage;
@@ -20,7 +18,7 @@
 	B_LOCALE_CHANGED	= '_LCC',
 };
 
-class _IMPEXP_LOCALE BLocaleRoster {
+class BLocaleRoster {
 
 	public:
 		BLocaleRoster();
@@ -35,14 +33,14 @@
 		status_t GetDefaultCollator(BCollator **) const;
 		status_t GetDefaultLanguage(BLanguage **) const;
 		status_t GetDefaultCountry(BCountry **) const;
-		
+
 		status_t GetPreferredLanguages(BMessage *) const;
 		status_t SetPreferredLanguages(BMessage *);
-			// the message contains one or more 'language'-string-fields 
+			// the message contains one or more 'language'-string-fields
 			// which contain the language-name(s)
 
 		status_t GetInstalledLanguages(BMessage *) const;
-			// the message contains one or more 'language'-string-fields 
+			// the message contains one or more 'language'-string-fields
 			// which contain the language-name(s)
 
 		status_t GetInstalledCatalogs(BMessage *,
@@ -66,14 +64,14 @@
 
 	private:
 
-		BCatalogAddOn* LoadCatalog(const char *signature, 
+		BCatalogAddOn* LoadCatalog(const char *signature,
 							const char *language = NULL,
 							int32 fingerprint = 0);
 		BCatalogAddOn* LoadEmbeddedCatalog(entry_ref *appOrAddOnRef);
 		status_t UnloadCatalog(BCatalogAddOn *addOn);
 		//
 		BCatalogAddOn* CreateCatalog(const char *type,
-							const char *signature, 
+							const char *signature,
 							const char *language);
 
 		friend class BCatalog;

Modified: haiku/trunk/headers/os/locale/NumberFormat.h
===================================================================
--- haiku/trunk/headers/os/locale/NumberFormat.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/NumberFormat.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -6,7 +6,7 @@
 
 class BNumberFormatImpl;
 
-class _IMPEXP_LOCALE BNumberFormat : public BFormat {
+class BNumberFormat : public BFormat {
 	protected:
 		BNumberFormat(const BNumberFormat &amp;other);
 		~BNumberFormat();

Modified: haiku/trunk/headers/os/locale/NumberFormatImpl.h
===================================================================
--- haiku/trunk/headers/os/locale/NumberFormatImpl.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/NumberFormatImpl.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -6,7 +6,7 @@
 struct format_field_position;
 class BNumberFormatParameters;
 
-class _IMPEXP_LOCALE BNumberFormatImpl : public BFormatImpl {
+class BNumberFormatImpl : public BFormatImpl {
 	public:
 		BNumberFormatImpl();
 		virtual ~BNumberFormatImpl();

Modified: haiku/trunk/headers/os/locale/NumberFormatParameters.h
===================================================================
--- haiku/trunk/headers/os/locale/NumberFormatParameters.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/NumberFormatParameters.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -20,7 +20,7 @@
 	B_HEXADECIMAL_BASE		= 16,
 };
 
-class _IMPEXP_LOCALE BNumberFormatParameters : public BFormatParameters {
+class BNumberFormatParameters : public BFormatParameters {
 	public:
 		BNumberFormatParameters(const BNumberFormatParameters *parent = NULL);
 		BNumberFormatParameters(const BNumberFormatParameters &amp;other);

Modified: haiku/trunk/headers/os/locale/UnicodeChar.h
===================================================================
--- haiku/trunk/headers/os/locale/UnicodeChar.h	2009-05-01 21:26:56 UTC (rev 30544)
+++ haiku/trunk/headers/os/locale/UnicodeChar.h	2009-05-01 21:56:16 UTC (rev 30545)
@@ -3,8 +3,6 @@
 
 #include &lt;SupportDefs.h&gt;
 
-#include &lt;LocaleBuild.h&gt;
-
 enum unicode_char_category
 {
 	// Non-category for unassigned and non-character code points.
@@ -49,9 +47,9 @@
  * This specifies the language directional property of a character set.
  */
 
-enum unicode_char_direction { 
-	B_UNICODE_LEFT_TO_RIGHT               = 0, 
-	B_UNICODE_RIGHT_TO_LEFT               = 1, 
+enum unicode_char_direction {
+	B_UNICODE_LEFT_TO_RIGHT               = 0,
+	B_UNICODE_RIGHT_TO_LEFT               = 1,
 	B_UNICODE_EUROPEAN_NUMBER             = 2,
 	B_UNICODE_EUROPEAN_NUMBER_SEPARATOR   = 3,
 	B_UNICODE_EUROPEAN_NUMBER_TERMINATOR  = 4,
@@ -59,8 +57,8 @@
 	B_UNICODE_COMMON_NUMBER_SEPARATOR     = 6,
 	B_UNICODE_BLOCK_SEPARATOR             = 7,
 	B_UNICODE_SEGMENT_SEPARATOR           = 8,
-	B_UNICODE_WHITE_SPACE_NEUTRAL         = 9, 
-	B_UNICODE_OTHER_NEUTRAL               = 10, 
+	B_UNICODE_WHITE_SPACE_NEUTRAL         = 9,
+	B_UNICODE_OTHER_NEUTRAL               = 10,
 	B_UNICODE_LEFT_TO_RIGHT_EMBEDDING     = 11,
 	B_UNICODE_LEFT_TO_RIGHT_OVERRIDE      = 12,
 	B_UNICODE_RIGHT_TO_LEFT_ARABIC        = 13,
@@ -69,7 +67,7 @@
 	B_UNICODE_POP_DIRECTIONAL_FORMAT      = 16,
 	B_UNICODE_DIR_NON_SPACING_MARK        = 17,
 	B_UNICODE_BOUNDARY_NEUTRAL            = 18,
-	
+
 	B_UNICODE_DIRECTION_COUNT
 };
 
@@ -188,7 +186,7 @@
 };
 

[... truncated: 570 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016386.html">[Haiku-commits] r30544 -	haiku/trunk/src/apps/debuganalyzer/gui/chart
</A></li>
	<LI>Next message: <A HREF="016388.html">[Haiku-commits] r30546 -	haiku/trunk/src/add-ons/kernel/file_systems/nfs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16387">[ date ]</a>
              <a href="thread.html#16387">[ thread ]</a>
              <a href="subject.html#16387">[ subject ]</a>
              <a href="author.html#16387">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
