<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r30586 - in haiku/trunk: headers/tools/cppunit	headers/tools/cppunit/cppunit	headers/tools/cppunit/cppunit/extensions src/tools/cppunit	src/tools/cppunit/cppunit
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-May/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r30586%20-%20in%20haiku/trunk%3A%20headers/tools/cppunit%0A%09headers/tools/cppunit/cppunit%0A%09headers/tools/cppunit/cppunit/extensions%20src/tools/cppunit%0A%09src/tools/cppunit/cppunit&In-Reply-To=%3C200905021904.n42J4tPR016843%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016440.html">
   <LINK REL="Next"  HREF="016442.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r30586 - in haiku/trunk: headers/tools/cppunit	headers/tools/cppunit/cppunit	headers/tools/cppunit/cppunit/extensions src/tools/cppunit	src/tools/cppunit/cppunit</H1>
    <B>zooey at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r30586%20-%20in%20haiku/trunk%3A%20headers/tools/cppunit%0A%09headers/tools/cppunit/cppunit%0A%09headers/tools/cppunit/cppunit/extensions%20src/tools/cppunit%0A%09src/tools/cppunit/cppunit&In-Reply-To=%3C200905021904.n42J4tPR016843%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r30586 - in haiku/trunk: headers/tools/cppunit	headers/tools/cppunit/cppunit	headers/tools/cppunit/cppunit/extensions src/tools/cppunit	src/tools/cppunit/cppunit">zooey at mail.berlios.de
       </A><BR>
    <I>Sat May  2 21:04:55 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="016440.html">[Haiku-commits] r30585 - haiku/trunk/build/jam
</A></li>
        <LI>Next message: <A HREF="016442.html">[Haiku-commits] r30587 - haiku/trunk/headers/posix
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16441">[ date ]</a>
              <a href="thread.html#16441">[ thread ]</a>
              <a href="subject.html#16441">[ subject ]</a>
              <a href="author.html#16441">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: zooey
Date: 2009-05-02 21:04:52 +0200 (Sat, 02 May 2009)
New Revision: 30586
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=30586&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=30586&amp;view=rev</A>

Modified:
   haiku/trunk/headers/tools/cppunit/TestCase.h
   haiku/trunk/headers/tools/cppunit/TestListener.h
   haiku/trunk/headers/tools/cppunit/TestShell.h
   haiku/trunk/headers/tools/cppunit/TestSuite.h
   haiku/trunk/headers/tools/cppunit/TestUtils.h
   haiku/trunk/headers/tools/cppunit/ThreadedTestCaller.h
   haiku/trunk/headers/tools/cppunit/ThreadedTestCase.h
   haiku/trunk/headers/tools/cppunit/cppunit/Asserter.h
   haiku/trunk/headers/tools/cppunit/cppunit/CompilerOutputter.h
   haiku/trunk/headers/tools/cppunit/cppunit/Exception.h
   haiku/trunk/headers/tools/cppunit/cppunit/NotEqualException.h
   haiku/trunk/headers/tools/cppunit/cppunit/Portability.h
   haiku/trunk/headers/tools/cppunit/cppunit/SourceLine.h
   haiku/trunk/headers/tools/cppunit/cppunit/Test.h
   haiku/trunk/headers/tools/cppunit/cppunit/TestAssert.h
   haiku/trunk/headers/tools/cppunit/cppunit/TestCaller.h
   haiku/trunk/headers/tools/cppunit/cppunit/TestCase.h
   haiku/trunk/headers/tools/cppunit/cppunit/TestFailure.h
   haiku/trunk/headers/tools/cppunit/cppunit/TestResult.h
   haiku/trunk/headers/tools/cppunit/cppunit/TestResultCollector.h
   haiku/trunk/headers/tools/cppunit/cppunit/TestSuite.h
   haiku/trunk/headers/tools/cppunit/cppunit/TextOutputter.h
   haiku/trunk/headers/tools/cppunit/cppunit/TextTestResult.h
   haiku/trunk/headers/tools/cppunit/cppunit/XmlOutputter.h
   haiku/trunk/headers/tools/cppunit/cppunit/extensions/RepeatedTest.h
   haiku/trunk/headers/tools/cppunit/cppunit/extensions/TestDecorator.h
   haiku/trunk/headers/tools/cppunit/cppunit/extensions/TestFactoryRegistry.h
   haiku/trunk/headers/tools/cppunit/cppunit/extensions/TypeInfoHelper.h
   haiku/trunk/src/tools/cppunit/BTestCase.cpp
   haiku/trunk/src/tools/cppunit/BTestSuite.cpp
   haiku/trunk/src/tools/cppunit/TestApp.cpp
   haiku/trunk/src/tools/cppunit/TestListener.cpp
   haiku/trunk/src/tools/cppunit/TestShell.cpp
   haiku/trunk/src/tools/cppunit/TestUtils.cpp
   haiku/trunk/src/tools/cppunit/ThreadedTestCase.cpp
   haiku/trunk/src/tools/cppunit/cppunit/Asserter.cpp
   haiku/trunk/src/tools/cppunit/cppunit/CompilerOutputter.cpp
   haiku/trunk/src/tools/cppunit/cppunit/Exception.cpp
   haiku/trunk/src/tools/cppunit/cppunit/NotEqualException.cpp
   haiku/trunk/src/tools/cppunit/cppunit/RepeatedTest.cpp
   haiku/trunk/src/tools/cppunit/cppunit/SourceLine.cpp
   haiku/trunk/src/tools/cppunit/cppunit/TestCase.cpp
   haiku/trunk/src/tools/cppunit/cppunit/TestFactoryRegistry.cpp
   haiku/trunk/src/tools/cppunit/cppunit/TestFailure.cpp
   haiku/trunk/src/tools/cppunit/cppunit/TestRunner.cpp
   haiku/trunk/src/tools/cppunit/cppunit/TextOutputter.cpp
   haiku/trunk/src/tools/cppunit/cppunit/TextTestProgressListener.cpp
   haiku/trunk/src/tools/cppunit/cppunit/TextTestResult.cpp
   haiku/trunk/src/tools/cppunit/cppunit/TypeInfoHelper.cpp
   haiku/trunk/src/tools/cppunit/cppunit/XmlOutputter.cpp
Log:
* fix gcc4 build of cppunit library by explicitly spelling out std:: in
  the headers and importing the required classes in the implementation files
* automatic whitespace cleanup

Modified: haiku/trunk/headers/tools/cppunit/TestCase.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/TestCase.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/TestCase.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -9,30 +9,30 @@
 //! Base class for single threaded unit tests
 class CPPUNIT_API BTestCase : public CppUnit::TestCase {
 public:
-	BTestCase(string Name = &quot;&quot;);
-	
+	BTestCase(std::string Name = &quot;&quot;);
+
 	//! Displays the next sub test progress indicator (i.e. [0][1][2][3]...).
 	virtual void NextSubTest();
-	
+
 	//! Starts a new sub test block (i.e. prints a newline :-)
 	virtual void NextSubTestBlock();
-	
+
 	/*! \brief Prints to standard out just like printf, except shell verbosity
 		settings are honored.
 	*/
 	virtual void Outputf(const char *str, ...);
-	
-	//! Saves the location of the current working directory. 
+
+	//! Saves the location of the current working directory.
 	void SaveCWD();
-	
+
 	virtual void tearDown();
-	
-	//! Restores the current working directory to last directory saved by a	call to SaveCWD().	
+
+	//! Restores the current working directory to last directory saved by a	call to SaveCWD().
 	void RestoreCWD(const char *alternate = NULL);
 protected:
 	bool fValidCWD;
-	char fCurrentWorkingDir[B_PATH_NAME_LENGTH+1];	
-	int32 fSubTestNum;	
+	char fCurrentWorkingDir[B_PATH_NAME_LENGTH+1];
+	int32 fSubTestNum;
 };
 
 #endif // _beos_test_case_h_

Modified: haiku/trunk/headers/tools/cppunit/TestListener.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/TestListener.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/TestListener.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -4,15 +4,17 @@
 #include &lt;cppunit/TestListener.h&gt;
 #include &lt;SupportDefs.h&gt;
 
-class CppUnit::Test;
-class CppUnit::TestFailure;
-class CppUnit::Exception;
+namespace CppUnit {
+class Test;
+class TestFailure;
+class Exception;
+}
 
 //! Handles printing of test information
 /*! Receives notification of the beginning and end of each test,
 	and notification of all failures and errors. Prints out	said
 	information in a standard format to standard output.
-	
+
 	You should not need to explicitly use this class in any
 	of your tests.
 */

Modified: haiku/trunk/headers/tools/cppunit/TestShell.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/TestShell.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/TestShell.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -48,9 +48,9 @@
 */
 class CPPUNIT_API BTestShell {
 public:
-	BTestShell(const string &amp;description = &quot;&quot;, SyncObject *syncObject = 0);	
+	BTestShell(const std::string &amp;description = &quot;&quot;, SyncObject *syncObject = 0);
 	virtual ~BTestShell();
-	
+
 	// This function is used to add the tests for a given kit (as contained
 	// in a BTestSuite object) to the list of available tests. The shell assumes
 	// ownership of the BTestSuite object. Each test in the kit is added to
@@ -64,7 +64,7 @@
 	// when the program is run with &quot;--list&quot; as an argument. Usually the
 	// given suite would be a test suite for an entire class, but that's
 	// not a requirement.
-	void AddTest(const string &amp;name, CppUnit::Test* test);
+	void AddTest(const std::string &amp;name, CppUnit::Test* test);
 
 	// This function loads all the test addons it finds in the given
 	// directory, returning the number of tests actually loaded.
@@ -75,7 +75,7 @@
 	// help, or lists installed tests, or whatever, depending on the
 	// command-line arguments passed in.
 	int Run(int argc, char *argv[]);
-	
+
 	// Verbosity Level enumeration and accessor function
 	enum VerbosityLevel { v0, v1, v2, v3, v4 };
 	VerbosityLevel Verbosity() const;
@@ -92,9 +92,9 @@
 	// have to (and always make sure the pointer it returns isn't NULL
 	// before you try to use it :-).
 	static BTestShell* GlobalShell() { return fGlobalShell; };
-	
+
 	// Sets the global BTestShell pointer. The BTestShell class does
-	// not assume ownership of the object. 
+	// not assume ownership of the object.
 	static void SetGlobalShell(BTestShell *shell) { fGlobalShell = shell; };
 
 	const char* TestDir() const;
@@ -104,18 +104,18 @@
 	bool WasDebuggerCalled();
 
 protected:
-	typedef map&lt;string, CppUnit::Test*&gt; TestMap;
-	typedef map&lt;string, BTestSuite*&gt; SuiteMap;
+	typedef std::map&lt;std::string, CppUnit::Test*&gt; TestMap;
+	typedef std::map&lt;std::string, BTestSuite*&gt; SuiteMap;
 
 	VerbosityLevel fVerbosityLevel;
-	set&lt;string&gt; fTestsToRun;
-	set&lt;string&gt; fSuitesToRun;
+	std::set&lt;std::string&gt; fTestsToRun;
+	std::set&lt;std::string&gt; fSuitesToRun;
 	TestMap fTests;
 	SuiteMap fSuites;
-	set&lt;string&gt; fLibDirs;
+	std::set&lt;std::string&gt; fLibDirs;
 	CppUnit::TestResult fTestResults;
 	CppUnit::TestResultCollector fResultsCollector;
-	string fDescription;
+	std::string fDescription;
 	static BTestShell* fGlobalShell;
 	static const char indent[];
 	bool fListTestsAndExit;
@@ -134,7 +134,7 @@
 
 	//! Prints out command line argument instructions
 	void PrintHelp();
-	
+
 	/*! \brief Prints out the list of valid command line arguments.
 		Called by PrintHelp().
 	*/
@@ -142,15 +142,15 @@
 
 	//! Prints out a list of all the currently available tests
 	void PrintInstalledTests();
-	
+
 	/*! \brief Handles command line arguments; returns true if everything goes
 		okay, false if not (or if the program just needs to terminate without
 		running any tests). Modifies settings in &quot;settings&quot; as necessary.
 	*/
 	bool ProcessArguments(int argc, char *argv[]);
-	
+
 	//! Processes a single argument, given by the \c arg parameter.
-	virtual bool ProcessArgument(string arg, int argc, char *argv[]);
+	virtual bool ProcessArgument(std::string arg, int argc, char *argv[]);
 
 	//! Makes any necessary pre-test preparations
 	void InitOutput();
@@ -159,12 +159,12 @@
 		the specified verbosity level.
 	*/
 	void PrintResults();
-	
+
 	/*! \brief Searches all the paths in \c fLibDirs, loading any dynamically
 		loadable suites it finds.
 	*/
 	virtual void LoadDynamicSuites();
-	
+
 	//! Sets the current test directory.
 	void UpdateTestDir(char *argv[]);
 
@@ -187,7 +187,7 @@
 	static image_id _LoadAddOnHook(const char* path);
 	static status_t _UnloadAddOnHook(image_id image);
 #endif	// ! NO_ELF_SYMBOL_PATCHING
-	
+
 };	// class BTestShell
 
 #endif // _beos_test_shell_h_

Modified: haiku/trunk/headers/tools/cppunit/TestSuite.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/TestSuite.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/TestSuite.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -6,31 +6,33 @@
 #include &lt;map&gt;
 #include &lt;string&gt;
 
-class CppUnit::TestResult;
+namespace CppUnit {
+class TestResult;
+}
 
 //! Groups together a set of tests for a given kit.
 class CPPUNIT_API BTestSuite : public CppUnit::Test {
 public:
-	BTestSuite( string name = &quot;&quot; );
+	BTestSuite(std::string name = &quot;&quot;);
 	virtual ~BTestSuite();
 
-	virtual void run( CppUnit::TestResult *result );
+	virtual void run(CppUnit::TestResult *result);
 	virtual int countTestCases() const;
-	virtual string getName() const;
-	virtual string toString() const;
+	virtual std::string getName() const;
+	virtual std::string toString() const;
 
-	virtual void addTest(string name, CppUnit::Test *test);
+	virtual void addTest(std::string name, CppUnit::Test *test);
 	virtual void deleteContents();
 
-	const map&lt;string, CppUnit::Test*&gt; &amp;getTests() const;
+	const std::map&lt;std::string, CppUnit::Test*&gt; &amp;getTests() const;
 
 protected:
-	map&lt;string, CppUnit::Test*&gt; fTests;
-	const string fName;
+	std::map&lt;std::string, CppUnit::Test*&gt; fTests;
+	const std::string fName;
 
 private:
 	BTestSuite(const BTestSuite &amp;other);
-	BTestSuite&amp; operator=(const BTestSuite &amp;other); 
+	BTestSuite&amp; operator=(const BTestSuite &amp;other);
 
 };
 

Modified: haiku/trunk/headers/tools/cppunit/TestUtils.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/TestUtils.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/TestUtils.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -28,7 +28,7 @@
 }
 
 // Returns a string version of the given integer
-extern CPPUNIT_API string IntToStr(int i);
+extern CPPUNIT_API std::string IntToStr(int i);
 
 // Calls system() with the concatenated string of command and parameter.
 extern CPPUNIT_API void ExecCommand(const char *command, const char *parameter);
@@ -40,5 +40,5 @@
 
 // Calls system() with the given command (kind of silly, but it's consistent :-)
 extern CPPUNIT_API void ExecCommand(const char *command);
-	
+
 #endif	// __beos_test_utils_h__

Modified: haiku/trunk/headers/tools/cppunit/ThreadedTestCaller.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/ThreadedTestCaller.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/ThreadedTestCaller.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -14,23 +14,23 @@
 class TestResult;
 
 template &lt;class TestClass, class ExpectedException = CppUnit::NoExceptionExpected&gt;
-class CPPUNIT_API BThreadedTestCaller : public CppUnit::TestCase { 
+class CPPUNIT_API BThreadedTestCaller : public CppUnit::TestCase {
 public:
 	/*! \brief Pointer to a test function in the given class.
 		Each ThreadMethod added with addThread() is run in its own thread.
 	*/
 	typedef void (TestClass::*ThreadMethod)();
 
-	BThreadedTestCaller(std::string name);	
-	BThreadedTestCaller(std::string name, TestClass &amp;object);	
-	BThreadedTestCaller(std::string name, TestClass *object);	
+	BThreadedTestCaller(std::string name);
+	BThreadedTestCaller(std::string name, TestClass &amp;object);
+	BThreadedTestCaller(std::string name, TestClass *object);
 	virtual ~BThreadedTestCaller();
-	
+
     virtual CppUnit::TestResult *run();
     virtual void run(CppUnit::TestResult *result);
 
 	//! Adds a thread to the test. \c threadName must be unique to this BThreadedTestCaller.
-    void addThread(std::string threadName, ThreadMethod method);        
+    void addThread(std::string threadName, ThreadMethod method);
 
 protected:
 	virtual void setUp();
@@ -42,9 +42,9 @@
 	bool fOwnObject;
 	TestClass *fObject;
 	ThreadManagerMap fThreads;
-	
+
 	sem_id fThreadSem;
-	
+
 };
 
 
@@ -78,19 +78,19 @@
 template &lt;class TestClass, class ExpectedException&gt;
 BThreadedTestCaller&lt;TestClass, ExpectedException&gt;::~BThreadedTestCaller() {
 	if (fOwnObject)
-		delete fObject;		
-	for (ThreadManagerMap::iterator it = fThreads.begin(); it != fThreads.end (); ++it) {
+		delete fObject;
+	for (typename ThreadManagerMap::iterator it = fThreads.begin(); it != fThreads.end (); ++it) {
 		delete it-&gt;second;
 	}
 }
-	
 
+
 template &lt;class TestClass, class ExpectedException&gt;
 void
 BThreadedTestCaller&lt;TestClass, ExpectedException&gt;::addThread(std::string threadName, ThreadMethod method) {
 	if (fThreads.find(threadName) == fThreads.end()) {
 		// Unused name, go ahead and add
-		fThreads[threadName] = new BThreadManager&lt;TestClass, ExpectedException&gt;(threadName, fObject, method, fThreadSem);		
+		fThreads[threadName] = new BThreadManager&lt;TestClass, ExpectedException&gt;(threadName, fObject, method, fThreadSem);
 	} else {
 		// Duplicate name, throw an exception
 		throw CppUnit::Exception(&quot;BThreadedTestCaller::addThread() - Attempt to add thread under duplicated name ('&quot;
@@ -110,11 +110,11 @@
 void
 BThreadedTestCaller&lt;TestClass, ExpectedException&gt;::run(CppUnit::TestResult *result) {
 	result-&gt;startTest(this);
-	
+
 	if (fThreads.size() &lt;= 0)
 		throw CppUnit::Exception(&quot;BThreadedTestCaller::run() -- No threads added to BThreadedTestCaller()&quot;);
 
-	try {    
+	try {
 		setUp();
 
 		// This try/catch block should never actually have to catch
@@ -131,13 +131,13 @@
 			// blocked; their output appears later...).
 			//
 			// Each thread will acquire the semaphore once when launched,
-			// thus the initial thread count is equal the number of threads.		
+			// thus the initial thread count is equal the number of threads.
 			fThreadSem = create_sem(fThreads.size(), &quot;ThreadSem&quot;);
 			if (fThreadSem &lt; B_OK)
-				throw CppUnit::Exception(&quot;BThreadedTestCaller::run() -- Error creating fThreadSem&quot;);		
+				throw CppUnit::Exception(&quot;BThreadedTestCaller::run() -- Error creating fThreadSem&quot;);
 
 			// Launch all the threads.
-			for (ThreadManagerMap::iterator i = fThreads.begin();
+			for (typename ThreadManagerMap::iterator i = fThreads.begin();
 				   i != fThreads.end ();
 	    	         ++i)
 	    	{
@@ -146,7 +146,7 @@
 					result-&gt;addError(this, new CppUnit::Exception(&quot;Error launching thread '&quot; + i-&gt;second-&gt;getName() + &quot;'&quot;));
 //				printf(&quot;Launch(%s)\n&quot;, i-&gt;second-&gt;getName().c_str());
 			}
-			
+
 			// Now we loop. Before you faint, there is a reason for this:
 			// Calls to NextSubTest() from other threads don't actually
 			// print anything while the main thread is blocked waiting
@@ -158,13 +158,13 @@
 			// any pending updates, and tries to acquire the semaphore
 			// again. When it finally manages to acquire it, all the
 			// test threads have terminated, and it's safe to clean up.
-			
+
 			status_t err;
 			do {
 				// Try to acquire the semaphore
 				err = acquire_sem_etc(fThreadSem, fThreads.size(), B_RELATIVE_TIMEOUT,	500000);
-				
-				// Empty the UpdateList				
+
+				// Empty the UpdateList
 				std::vector&lt;std::string&gt; &amp;list = fObject-&gt;AcquireUpdateList();
 				for (std::vector&lt;std::string&gt;::iterator i = list.begin();
 					   i != list.end();
@@ -172,16 +172,16 @@
 				{
 					// Only print to standard out if the current global shell
 					// lets us (or if no global shell is designated).
-					if (BTestShell::GlobalBeVerbose()) {					
+					if (BTestShell::GlobalBeVerbose()) {
 						printf(&quot;%s&quot;, (*i).c_str());
 						fflush(stdout);
 					}
 				}
 				list.clear();
-				fObject-&gt;ReleaseUpdateList();				
-				
+				fObject-&gt;ReleaseUpdateList();
+
 			} while (err != B_OK);
-			
+
 			// If we get this far, we actually managed to acquire the semaphore,
 			// so we should release it now.
 			release_sem_etc(fThreadSem, fThreads.size(), 0);
@@ -189,9 +189,9 @@
 			// Print out a newline for asthetics :-)
 			printf(&quot;\n&quot;);
 
-/*			
-			
-			
+/*
+
+
 			// Wait for them all to finish, then clean up
 			for (ThreadManagerMap::iterator i = fThreads.begin();
 				  i != fThreads.end ();
@@ -206,21 +206,21 @@
 */
 
 			fThreads.clear();
-			
+
 		} catch ( CppUnit::Exception &amp;e ) {
 			// Add on the a note that this exception was caught by the
 			// thread caller (which is a bad thing), then note the exception
 	        CppUnit::Exception *threadException = new CppUnit::Exception(
 	        	std::string(e.what()) + &quot; (NOTE: caught by BThreadedTestCaller)&quot;,
 	        	e.sourceLine()
-	        );        	        	
+	        );
 			result-&gt;addFailure( fObject, threadException );
 		}
 		catch ( std::exception &amp;e ) {
 			// Add on the thread name, then note the exception
 	        CppUnit::Exception *threadException = new CppUnit::Exception(
 	        	std::string(e.what()) + &quot; (NOTE: caught by BThreadedTestCaller)&quot;
-	        );        	        	
+	        );
 			result-&gt;addError( fObject, threadException );
 		}
 		catch (...) {
@@ -237,7 +237,7 @@
 		    tearDown();
 		} catch (...) {
 			result-&gt;addError(this, new CppUnit::Exception(&quot;tearDown() failed&quot;));
-		}		
+		}
 	} catch (...) {
 		result-&gt;addError(this, new CppUnit::Exception(&quot;setUp() failed&quot;));
 	}	// setUp() try/catch block
@@ -253,7 +253,7 @@
 		throw CppUnit::Exception(&quot;BThreadedTestCaller::runTest() -- NULL fObject pointer&quot;);
 	if (!fObject-&gt;RegisterForUse())
 		throw CppUnit::Exception(&quot;BThreadedTestCaller::runTest() -- Attempt to reuse ThreadedTestCase object already in use&quot;);
-		
+
 	fObject-&gt;setUp();
 }
 
@@ -265,8 +265,8 @@
 
 template &lt;class TestClass, class ExpectedException&gt;
 std::string
-BThreadedTestCaller&lt;TestClass, ExpectedException&gt;::toString() const { 
-	return std::string(&quot;BThreadedTestCaller for &quot;) + getName(); 
+BThreadedTestCaller&lt;TestClass, ExpectedException&gt;::toString() const {
+	return std::string(&quot;BThreadedTestCaller for &quot;) + getName();
 }
 
 #endif // _beos_threaded_test_caller_h_

Modified: haiku/trunk/headers/tools/cppunit/ThreadedTestCase.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/ThreadedTestCase.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/ThreadedTestCase.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -11,46 +11,46 @@
 //! Base class for single threaded unit tests
 class CPPUNIT_API BThreadedTestCase : public BTestCase {
 public:
-	BThreadedTestCase(string Name = &quot;&quot;, string progressSeparator = &quot;.&quot;);
+	BThreadedTestCase(std::string Name = &quot;&quot;, std::string progressSeparator = &quot;.&quot;);
 	virtual ~BThreadedTestCase();
-	
+
 	/*! \brief Displays the next sub test progress indicator for the
 		thread in which it's called (i.e. [A.0][B.0][A.1][A.2][B.1]...). */
 	virtual void NextSubTest();
-	
+
 	/*! \brief Prints to standard out just like printf, except shell verbosity
 		settings are honored, and output from threads other than the main thread
 		happens before the test is over.
-		
+
 		\note Currently your output is limited to a length of 1024 characters. If
 		you really need to print a single string that's long than that, fix the
 		function yourself :-).
 	*/
 	virtual void Outputf(const char *str, ...);
-	
-	//! Saves the location of the current working directory. 
+
+	//! Saves the location of the current working directory.
 	void SaveCWD();
-	
-	//! Restores the current working directory to last directory saved by a	call to SaveCWD().	
+
+	//! Restores the current working directory to last directory saved by a	call to SaveCWD().
 	void RestoreCWD(const char *alternate = NULL);
-	void InitThreadInfo(thread_id id, string threadName);
+	void InitThreadInfo(thread_id id, std::string threadName);
 	bool RegisterForUse();
 	void UnregisterForUse();
-	
-	vector&lt;string&gt;&amp; AcquireUpdateList();
+
+	std::vector&lt;std::string&gt;&amp; AcquireUpdateList();
 	void ReleaseUpdateList();
 protected:
 	bool fInUse;
 
 //	friend class ThreadManager&lt;BThreadedTestCase&gt;;
-	string fProgressSeparator;
+	std::string fProgressSeparator;
 
 	struct ThreadSubTestInfo {
-		string name;
-		int32 subTestNum;	
+		std::string name;
+		int32 subTestNum;
 	};
-	map&lt;thread_id, ThreadSubTestInfo*&gt; fNumberMap;
-	vector&lt;string&gt; fUpdateList;
+	std::map&lt;thread_id, ThreadSubTestInfo*&gt; fNumberMap;
+	std::vector&lt;std::string&gt; fUpdateList;
 	BLocker *fUpdateLock;
 
 };

Modified: haiku/trunk/headers/tools/cppunit/cppunit/Asserter.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/cppunit/Asserter.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/cppunit/Asserter.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -16,23 +16,23 @@
  * \code
  * #include &lt;cppunit/SourceLine.h&gt;
  * #include &lt;cppunit/TestAssert.h&gt;
- * 
- * void 
+ *
+ * void
  * checkXmlEqual( string expectedXml,
  *                string actualXml,
  *                CppUnit::SourceLine sourceLine )
  * {
  *   string expected = XmlUniformiser( expectedXml ).stripped();
  *   string actual = XmlUniformiser( actualXml ).stripped();
- * 
+ *
  *   if ( expected == actual )
  *     return;
- * 
+ *
  *   ::CppUnit::Asserter::failNotEqual( expected,
  *                                      actual,
  *                                      sourceLine );
  * }
- * 
+ *
  * /// Asserts that two XML strings are equivalent.
  * #define CPPUNITTEST_ASSERT_XML_EQUAL( expected, actual ) \
  *     checkXmlEqual( expected, actual,                     \
@@ -44,7 +44,7 @@
 
   /*! Throws a Exception with the specified message and location.
    */
-  void CPPUNIT_API fail( string message, 
+  void CPPUNIT_API fail( std::string message,
                          SourceLine sourceLine = SourceLine() );
 
   /*! Throws a Exception with the specified message and location.
@@ -53,8 +53,8 @@
    * \param message Message explaining the assertion failiure.
    * \param sourceLine Location of the assertion.
    */
-  void CPPUNIT_API failIf( bool shouldFail, 
-                           string message, 
+  void CPPUNIT_API failIf( bool shouldFail,
+                           std::string message,
                            SourceLine sourceLine = SourceLine() );
 
   /*! Throws a NotEqualException with the specified message and location.
@@ -64,10 +64,10 @@
    *                          where the &quot;difference&quot; is located.
    * \param sourceLine Location of the assertion.
    */
-  void CPPUNIT_API failNotEqual( string expected, 
-                                 string actual, 
+  void CPPUNIT_API failNotEqual( std::string expected,
+                                 std::string actual,
                                  SourceLine sourceLine = SourceLine(),
-                                 string additionalMessage =&quot;&quot; );
+                                 std::string additionalMessage =&quot;&quot; );
 
   /*! Throws a NotEqualException with the specified message and location.
    * \param shouldFail if \c true then the exception is thrown. Otherwise
@@ -79,10 +79,10 @@
    * \param sourceLine Location of the assertion.
    */
   void CPPUNIT_API failNotEqualIf( bool shouldFail,
-                                   string expected, 
-                                   string actual, 
+                                   std::string expected,
+                                   std::string actual,
                                    SourceLine sourceLine = SourceLine(),
-                                   string additionalMessage =&quot;&quot; );
+                                   std::string additionalMessage =&quot;&quot; );
 
 } // namespace Asserter
 } // namespace CppUnit

Modified: haiku/trunk/headers/tools/cppunit/cppunit/CompilerOutputter.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/cppunit/CompilerOutputter.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/cppunit/CompilerOutputter.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -15,7 +15,7 @@
 class TestFailure;
 class TestResultCollector;
 
-/*! 
+/*!
  * \brief Outputs a TestResultCollector in a compiler compatible format.
  * \ingroup WritingTestResult
  *
@@ -33,23 +33,23 @@
  * int main( int argc, char* argv[] ) {
  *   // if command line contains &quot;-selftest&quot; then this is the post build check
  *   // =&gt; the output must be in the compiler error format.
- *   bool selfTest = (argc &gt; 1)  &amp;&amp;  
+ *   bool selfTest = (argc &gt; 1)  &amp;&amp;
  *                   (string(&quot;-selftest&quot;) == argv[1]);
  *
  *   CppUnit::TextUi::TestRunner runner;
  *   runner.addTest( CppUnitTest::suite() );   // Add the top suite to the test runner
- * 
+ *
  *  if ( selfTest )
  *   { // Change the default outputter to a compiler error format outputter
  *     // The test runner owns the new outputter.
- *     runner.setOutputter( CppUnit::CompilerOutputter::defaultOutputter( 
+ *     runner.setOutputter( CppUnit::CompilerOutputter::defaultOutputter(
  *                                                        &amp;runner.result(),
  *                                                         cerr ) );
  *   }
- * 
+ *
  *  // Run the test and don't wait a key if post build check.
  *   bool wasSucessful = runner.run( &quot;&quot;, !selfTest );
- * 
+ *
  *   // Return error code 1 if the one of test failed.
  *   return wasSucessful ? 0 : 1;
  * }
@@ -61,7 +61,7 @@
   /*! Constructs a CompilerOutputter object.
    */
   CompilerOutputter( TestResultCollector *result,
-                     ostream &amp;stream );
+                     std::ostream &amp;stream );
 
   /// Destructor.
   virtual ~CompilerOutputter();
@@ -69,7 +69,7 @@
   /*! Creates an instance of an outputter that matches your current compiler.
    */
   static CompilerOutputter *defaultOutputter( TestResultCollector *result,
-                                              ostream &amp;stream );
+                                              std::ostream &amp;stream );
 
   void write();
 
@@ -84,7 +84,7 @@
   virtual void printFailureMessage( TestFailure *failure );
   virtual void printNotEqualMessage( Exception *thrownException );
   virtual void printDefaultMessage( Exception *thrownException );
-  virtual string wrap( string message );
+  virtual std::string wrap( std::string message );
 
 private:
   /// Prevents the use of the copy constructor.
@@ -93,12 +93,12 @@
   /// Prevents the use of the copy operator.
   void operator =( const CompilerOutputter &amp;copy );
 
-  typedef vector&lt;string&gt; Lines;
-  static Lines splitMessageIntoLines( string message );
+  typedef std::vector&lt;std::string&gt; Lines;
+  static Lines splitMessageIntoLines( std::string message );
 
 private:
   TestResultCollector *m_result;
-  ostream &amp;m_stream;
+  std::ostream &amp;m_stream;
 };
 
 

Modified: haiku/trunk/headers/tools/cppunit/cppunit/Exception.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/cppunit/Exception.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/cppunit/Exception.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -14,31 +14,31 @@
  * Exception is an exception that serves
  * descriptive strings through its what() method
  */
-class CPPUNIT_API Exception : public exception
+class CPPUNIT_API Exception : public std::exception
 {
 public:
 
     class Type
     {
     public:
-        Type( string type ) : m_type ( type ) {}
+        Type( std::string type ) : m_type ( type ) {}
 
         bool operator ==( const Type &amp;other ) const
         {
 	    return m_type == other.m_type;
         }
     private:
-        const string m_type;
+        const std::string m_type;
     };
 
 
-    Exception( string  message = &quot;&quot;, 
+    Exception( std::string  message = &quot;&quot;,
 	       SourceLine sourceLine = SourceLine() );
 
 #ifdef CPPUNIT_ENABLE_SOURCELINE_DEPRECATED
-    Exception( string  message, 
-	       long lineNumber, 
-	       string fileName );
+    Exception( std::string  message,
+	       long lineNumber,
+	       std::string fileName );
 #endif
 
     Exception (const Exception&amp; other);
@@ -55,12 +55,12 @@
     long lineNumber() const;
     string fileName() const;
 
-    static const string UNKNOWNFILENAME;
+    static const std::string UNKNOWNFILENAME;
     static const long UNKNOWNLINENUMBER;
 #endif
 
     virtual Exception *clone() const;
-    
+
     virtual bool isInstanceOf( const Type &amp;type ) const;
 
     static Type type();
@@ -68,9 +68,9 @@
 private:
     // VC++ does not recognize call to parent class when prefixed
     // with a namespace. This is a workaround.
-    typedef exception SuperClass;
+    typedef std::exception SuperClass;
 
-    string m_message;
+    std::string m_message;
     SourceLine m_sourceLine;
 };
 

Modified: haiku/trunk/headers/tools/cppunit/cppunit/NotEqualException.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/cppunit/NotEqualException.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/cppunit/NotEqualException.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -19,16 +19,16 @@
    * \param additionalMessage Additionnal information provided to further qualify
    *                          the inequality.
    */
-  NotEqualException( string expected,
-                     string actual, 
+  NotEqualException( std::string expected,
+                     std::string actual,
                      SourceLine sourceLine = SourceLine(),
-                     string additionalMessage = &quot;&quot; );
+                     std::string additionalMessage = &quot;&quot; );
 
 #ifdef CPPUNIT_ENABLE_SOURCELINE_DEPRECATED
-  NotEqualException( string expected,
-                     string actual, 
-                     long lineNumber, 
-                     string fileName );
+  NotEqualException( std::string expected,
+                     std::string actual,
+                     long lineNumber,
+                     std::string fileName );
 #endif
 
   NotEqualException( const NotEqualException &amp;other );
@@ -36,11 +36,11 @@
 
   virtual ~NotEqualException() throw();
 
-  string expectedValue() const;
+  std::string expectedValue() const;
 
-  string actualValue() const;
+  std::string actualValue() const;
 
-  string additionalMessage() const;
+  std::string additionalMessage() const;
 
   /*! Copy operator.
    * @param other Object to copy.
@@ -55,9 +55,9 @@
   static Type type();
 
 private:
-  string m_expected;
-  string m_actual;
-  string m_additionalMessage;
+  std::string m_expected;
+  std::string m_actual;
+  std::string m_additionalMessage;
 };
 
 }  // namespace CppUnit

Modified: haiku/trunk/headers/tools/cppunit/cppunit/Portability.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/cppunit/Portability.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/cppunit/Portability.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -21,6 +21,10 @@
 #undef CPPUNIT_FUNC_STRING_COMPARE_STRING_FIRST
 #endif
 
+#if __GNUC__ &gt; 2
+#undef CPPUNIT_FUNC_STRING_COMPARE_STRING_FIRST
+#endif
+
 /* Define to 1 if you wish to have the old-style macros
    assert(), assertEqual(), assertDoublesEqual(), and assertLongsEqual() */
 #ifndef CPPUNIT_ENABLE_NAKED_ASSERT
@@ -33,7 +37,7 @@
 #define CPPUNIT_ENABLE_CU_TEST_MACROS        0
 #endif
 
-/* Define to 1 if the preprocessor expands (#foo) to &quot;foo&quot; (quotes incl.) 
+/* Define to 1 if the preprocessor expands (#foo) to &quot;foo&quot; (quotes incl.)
    I don't think there is any C preprocess that does NOT support this! */
 #ifndef CPPUNIT_HAVE_CPP_SOURCE_ANNOTATION
 #define CPPUNIT_HAVE_CPP_SOURCE_ANNOTATION   1
@@ -60,11 +64,11 @@
 #if CPPUNIT_HAVE_SSTREAM
 #   include &lt;sstream&gt;
     namespace CppUnit {
-      class OStringStream : public ostringstream 
+      class OStringStream : public ostringstream
       {
       };
     }
-#else 
+#else
 #if CPPUNIT_HAVE_CLASS_STRSTREAM
 #   include &lt;string&gt;
 #   if CPPUNIT_HAVE_STRSTREAM
@@ -74,14 +78,14 @@
 #   endif
 
     namespace CppUnit {
-      class OStringStream : public ostrstream 
+      class OStringStream : public std::ostrstream
       {
       public:
-          string str()
+          std::string str()
           {
             (*this) &lt;&lt; '\0';
-            string msg(ostrstream::str());
-            ostrstream::freeze(false);
+            std::string msg(std::ostrstream::str());
+            std::ostrstream::freeze(false);
             return msg;
           }
       };

Modified: haiku/trunk/headers/tools/cppunit/cppunit/SourceLine.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/cppunit/SourceLine.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/cppunit/SourceLine.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -21,7 +21,7 @@
  * \ingroup BrowsingCollectedTestResult
  *
  * Used to capture the failure location in assertion.
- * 
+ *
  * Use the CPPUNIT_SOURCELINE() macro to construct that object. Typically used when
  * writing an assertion macro in association with Asserter.
  *
@@ -32,7 +32,7 @@
 public:
   SourceLine();
 
-  SourceLine( const string &amp;fileName,
+  SourceLine( const std::string &amp;fileName,
               int lineNumber );
 
   /// Destructor.
@@ -42,13 +42,13 @@
 
   int lineNumber() const;
 
-  string fileName() const;
+  std::string fileName() const;
 
   bool operator ==( const SourceLine &amp;other ) const;
   bool operator !=( const SourceLine &amp;other ) const;
 
 private:
-  string m_fileName;
+  std::string m_fileName;
   int m_lineNumber;
 };
 

Modified: haiku/trunk/headers/tools/cppunit/cppunit/Test.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/cppunit/Test.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/cppunit/Test.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -13,7 +13,7 @@
  *
  * All test objects should be a subclass of Test.  Some test objects,
  * TestCase for example, represent one individual test.  Other test
- * objects, such as TestSuite, are comprised of several tests.  
+ * objects, such as TestSuite, are comprised of several tests.
  *
  * When a Test is run, the result is collected by a TestResult object.
  *
@@ -38,20 +38,20 @@
     virtual int                   countTestCases () const     = 0;
 
     /*! \brief Returns the test name.
-     * 
+     *
      * Each test has a name.  This name may be used to find the
      * test in a suite or registry of tests.
      */
-    virtual string           getName () const            = 0;
+    virtual std::string           getName () const            = 0;
 
     /*! \brief Description of the test, for diagnostic output.
      *
      * The test description will typically include the test name,
      * but may have additional description.  For example, a test
-     * suite named &lt;tt&gt;complex_add&lt;/tt&gt; may be described as 
+     * suite named &lt;tt&gt;complex_add&lt;/tt&gt; may be described as
      * &lt;tt&gt;suite complex_add&lt;/tt&gt;.
      */
-    virtual string           toString () const           = 0;
+    virtual std::string           toString () const           = 0;
 
 
 };

Modified: haiku/trunk/headers/tools/cppunit/cppunit/TestAssert.h
===================================================================
--- haiku/trunk/headers/tools/cppunit/cppunit/TestAssert.h	2009-05-02 19:03:19 UTC (rev 30585)
+++ haiku/trunk/headers/tools/cppunit/cppunit/TestAssert.h	2009-05-02 19:04:52 UTC (rev 30586)
@@ -20,7 +20,7 @@
    *   {
    *     return x == y;
    *   }
-   * 
+   *
    *   static string toString( const string&amp; x )
    *   {
    *     string text = '&quot;' + x + '&quot;';    // adds quote around the string to see whitespace
@@ -32,14 +32,14 @@
    * \endcode
    */

[... truncated: 2932 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016440.html">[Haiku-commits] r30585 - haiku/trunk/build/jam
</A></li>
	<LI>Next message: <A HREF="016442.html">[Haiku-commits] r30587 - haiku/trunk/headers/posix
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16441">[ date ]</a>
              <a href="thread.html#16441">[ thread ]</a>
              <a href="subject.html#16441">[ subject ]</a>
              <a href="author.html#16441">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
