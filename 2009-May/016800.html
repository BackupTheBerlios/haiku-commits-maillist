<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r30774 - haiku/trunk/src/system/kernel/disk_device_manager
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-May/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r30774%20-%0A%20haiku/trunk/src/system/kernel/disk_device_manager&In-Reply-To=%3C510044770-BeMail%40Gaspode%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016799.html">
   <LINK REL="Next"  HREF="016807.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r30774 - haiku/trunk/src/system/kernel/disk_device_manager</H1>
    <B>Bruno Albuquerque</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r30774%20-%0A%20haiku/trunk/src/system/kernel/disk_device_manager&In-Reply-To=%3C510044770-BeMail%40Gaspode%3E"
       TITLE="[Haiku-commits] r30774 - haiku/trunk/src/system/kernel/disk_device_manager">bga at bug-br.org.br
       </A><BR>
    <I>Sat May 16 20:42:25 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="016799.html">[Haiku-commits] r30774 - haiku/trunk/src/system/kernel/disk_device_manager
</A></li>
        <LI>Next message: <A HREF="016807.html">[Haiku-commits] r30774 - haiku/trunk/src/system/kernel/disk_device_manager
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16800">[ date ]</a>
              <a href="thread.html#16800">[ thread ]</a>
              <a href="subject.html#16800">[ subject ]</a>
              <a href="author.html#16800">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sun, 17 May 2009 00:53:52 +0200 CEST, Axel D&#246;rfler said:

&gt;<i> So many style violations...
</I>
Heh. You know, altough I am all for consistency and all that, I don' t 
see the point of this comment. you could have pointed out the 
violations (and I would have fixed them) or you could fix it (as you 
did), but there is really no need to act like this specially when your 
fix did not add anything in what concerns readability of the code. I 
would understand the criticism if the code was unreadable or something. 
Oh well... 
 
&gt;<i> But anyway, this hides a bug in the disk device itself; according to 
</I>&gt;<i> the BeBook, a driver should only return B_DEV_MEDIA_CHANGED once in 
</I>&gt;<i> case there was a change: &quot;B_DEV_MEDIA_CHANGED. The media changed 
</I>&gt;<i> since 
</I>&gt;<i> the time that the device was opened, or since the time of the last 
</I>&gt;<i> B_GET_MEDIA_STATUS request.&quot;
</I>&gt;<i> While it's good defensive style to fix both ends of an error, the 
</I>&gt;<i> disk 
</I>&gt;<i> device driver is still behaving incorrectly, and that should be fixed 
</I>&gt;<i> as well.
</I>
I don't think it is wrong, it is just implemented in a way that works 
for now in the sense that this should be a notification mechanism and 
it is actually implemented with polling. There is a TODO in the code 
mentioning that it should implemented as notifications or something. It 
was probably just the fastest way to get it working when Ingo did it. 
Right now 2 consecutive polls results in MediaChanged() being true and 
this probably happens because the device itself keeps this status for a 
while (althouhg I didn't go that deep). Whenever notifications are 
implemented, this will not be a problem I guess as we would get one 
notification (from the device, I mean. Right now we pool the device) 
and that would be all.

-Bruno
 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016799.html">[Haiku-commits] r30774 - haiku/trunk/src/system/kernel/disk_device_manager
</A></li>
	<LI>Next message: <A HREF="016807.html">[Haiku-commits] r30774 - haiku/trunk/src/system/kernel/disk_device_manager
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16800">[ date ]</a>
              <a href="thread.html#16800">[ thread ]</a>
              <a href="subject.html#16800">[ subject ]</a>
              <a href="author.html#16800">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
