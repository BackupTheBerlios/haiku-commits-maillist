<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r32269 - haiku/trunk/src/servers/mail
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-August/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r32269%20-%20haiku/trunk/src/servers/mail&In-Reply-To=%3C200908121047.n7CAlcPM015904%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019037.html">
   <LINK REL="Next"  HREF="019041.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r32269 - haiku/trunk/src/servers/mail</H1>
    <B>aldeck at mail.berlios.de</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r32269%20-%20haiku/trunk/src/servers/mail&In-Reply-To=%3C200908121047.n7CAlcPM015904%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r32269 - haiku/trunk/src/servers/mail">aldeck at mail.berlios.de
       </A><BR>
    <I>Wed Aug 12 12:47:38 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019037.html">[Haiku-commits] r32268 - in	haiku/branches/components/gsoc-locale-kit: headers/os/locale	src/kits/locale src/preferences/locale
</A></li>
        <LI>Next message: <A HREF="019041.html">[Haiku-commits] r32270 - in	haiku/branches/components/gsoc-locale-kit: headers/os/locale	src/kits/locale src/preferences/locale
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19040">[ date ]</a>
              <a href="thread.html#19040">[ thread ]</a>
              <a href="subject.html#19040">[ subject ]</a>
              <a href="author.html#19040">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: aldeck
Date: 2009-08-12 12:47:18 +0200 (Wed, 12 Aug 2009)
New Revision: 32269
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=32269&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=32269&amp;view=rev</A>

Added:
   haiku/trunk/src/servers/mail/DeskbarViewIcons.h
   haiku/trunk/src/servers/mail/DeskbarViewIcons.rdef
Modified:
   haiku/trunk/src/servers/mail/Jamfile
   haiku/trunk/src/servers/mail/deskbarview.cpp
   haiku/trunk/src/servers/mail/deskbarview.h
Log:
* Rewrote icon drawing for the deskbar replicant, now use our shiny vector
 icons. Haven't looked into R5 backward compat.
* Minor style fixes, more in the next commit.


Added: haiku/trunk/src/servers/mail/DeskbarViewIcons.h
===================================================================
--- haiku/trunk/src/servers/mail/DeskbarViewIcons.h	2009-08-12 09:54:58 UTC (rev 32268)
+++ haiku/trunk/src/servers/mail/DeskbarViewIcons.h	2009-08-12 10:47:18 UTC (rev 32269)
@@ -0,0 +1,13 @@
+/*
+ * Copyright 2009, Haiku. All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef DESKBAR_VIEW_ICONS_H
+#define DESKBAR_VIEW_ICONS_H
+
+enum {
+	kIconNoMail		= 1000,
+	kIconNewMail	= 1001
+};
+
+#endif // DESKBAR_VIEW_ICONS_H

Added: haiku/trunk/src/servers/mail/DeskbarViewIcons.rdef
===================================================================
--- haiku/trunk/src/servers/mail/DeskbarViewIcons.rdef	2009-08-12 09:54:58 UTC (rev 32268)
+++ haiku/trunk/src/servers/mail/DeskbarViewIcons.rdef	2009-08-12 10:47:18 UTC (rev 32269)
@@ -0,0 +1,80 @@
+/*
+ * Copyright 2009, Haiku. All rights reserved.
+ * Distributed under the terms of the MIT License.
+ *
+ * Authors:
+ *		Alexandre Deckner &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">alex at zappotek.com</A>&gt;
+ */
+
+#include &quot;DeskbarViewIcons.h&quot;
+
+resource(kIconNoMail) #'VICN' array {
+	$&quot;6E63696610050004006A020006063C55F93D5C9ABF48EE3E484E4B6A43C35976&quot;
+	$&quot;495F849385EAF7FFA2A5B7C2C2A0BCCCDC748994FF829AB2020006033B9EE13B&quot;
+	$&quot;9EE1BB9EE13B9EE14A10E147F9EB00ACD3DB9FFFFFFFFF6492A8020006023A2A&quot;
+	$&quot;16B8F45D3AE2F43C1D5446BCF5477C2100F7FBFDFF31596B02000603BA68BD3A&quot;
+	$&quot;CB11BCBEBBBC5E184A35D549E60100343D412F364145FF566F7A020006023B4E&quot;
+	$&quot;07BA96743B15213BEFCE499B3D4A176700435563FF2D404802000602352DDDBA&quot;
+	$&quot;68303C7773374206477FF64AE5FA00BED1DBFF8DADBA020006023A11DA3A5196&quot;
+	$&quot;BACC2E3A7F4848C35C4A23C100FFEEC0FFE7D6A80200060238DDE0B865633B86&quot;
+	$&quot;F63C1C2A48AFCD493E7A00B4A06BFFA28B4E03826A31037795A303F206060200&quot;
+	$&quot;0602BAD0C03A15D1BAF9D2BC024D4BB1114A539100FFC7BAFFC31A1A02000602&quot;
+	$&quot;BAD0C03A15D1BAF9D2BC024D4BB1114A539101E3E3E3FF59697A0200060237FB&quot;
+	$&quot;FC391283BC18FD3AB8644BB9C148DD1D00D6D9DCFF78899912060BE28B3F3960&quot;
+	$&quot;3C46564C564A564E5653535155C788C71BC9764E5B5F48CB8147CB8147CC4D44&quot;
+	$&quot;60406043603D5C3B5E3C5C3B02044647453BC291BE263C2DC189B9DE382B2F2D&quot;
+	$&quot;342B342D392F362DBFCBBADC060CFEAFAA5A405A345A345A2B4E23572649213F&quot;
+	$&quot;2545223F252E2D2E2DB7AFB8FEB6FDBC282ABA75B6FDBC282A492C4A2251395E&quot;
+	$&quot;4354C1BCC81F0607FE1A5A405A345A345A2B4E23572649213F2545223F252E2D&quot;
+	$&quot;4445560404FE44564446444F443D382FC066BAE5BAE0B8222D2F302D2D2F0606&quot;
+	$&quot;EF03382F382FB89AB6FEB6FDBD5A2A30B6FDBD5A2A492B3A2B3A2B30382F2E2A&quot;
+	$&quot;382FBC910605EF03382F382FB89AB6FEB763BD5A2B30B763BD5A2B49C0BBBDBD&quot;
+	$&quot;C0BBBDBDC000BB9BBC912FBE9DBA00BC912F0605FE022C4A444D3B49444D4445&quot;
+	$&quot;4445C156C041C0BBBDBDC122BEEAC0BBBDBD2A490606A70A444D3B49444DC7EB&quot;
+	$&quot;4354395E22512C4A0A042F4C28513358424C0605AA03B7BABEF223433254BFB1&quot;
+	$&quot;C3BA38443D4733410606EA0A44423A36B7BABEF2384433413D47BFB1C3BA4447&quot;
+	$&quot;060AEEEF0E234331C24EB746C1EB31C24E3253BA6EC264BA6EC264BB8FC285BC&quot;
+	$&quot;CAC21CBC7AC27CBCFAC1E3BD30C05DBD1AC134BD30C05D4444BD3DBFCABD3DBF&quot;
+	$&quot;CABD60BDF73A363744394235460A05563C5E365E41584756460A04543B5C355E&quot;
+	$&quot;36563C0A044C44563C563E4C460A064A454A43543B563C4C444C460A095C354A&quot;
+	$&quot;434A454C46563E564658475E415E360E0A010100000A0001021001178402040A&quot;
+	$&quot;020103000A030101000A0001041001178400040A040105000A050106000A0601&quot;
+	$&quot;07000A070108000A0001111001178400040A0C010D000A0D010E000A0E010F00&quot;
+	$&quot;0A0F011000&quot;
+};
+
+resource(kIconNewMail) #'VICN' array {
+	$&quot;6E63696611050004006A020006063C55F93D5C9ABF48EE3E484E4B6A43C35976&quot;
+	$&quot;495F849385EAF7FFA2A5B7C2C2A0BCCCDC748994FF829AB2020006033B9EE13B&quot;
+	$&quot;9EE1BB9EE13B9EE14A10E147F9EB00ACD3DB9FFFFFFFFF6492A8020006023A2A&quot;
+	$&quot;16B8F45D3AE2F43C1D5446BCF5477C2100F7FBFDFF31596B02000603BA68BD3A&quot;
+	$&quot;CB11BCBEBBBC5E184A35D549E60100343D412F364145FF566F7A020006023B4E&quot;
+	$&quot;07BA96743B15213BEFCE499B3D4A176700435563FF2D404802000602352DDDBA&quot;
+	$&quot;68303C7773374206477FF64AE5FA00BED1DBFF8DADBA020006023A11DA3A5196&quot;
+	$&quot;BACC2E3A7F4848C35C4A23C100FFEEC0FFE7D6A80200060238DDE0B865633B86&quot;
+	$&quot;F63C1C2A48AFCD493E7A00B4A06BFFA28B4E03826A31037795A303F206060200&quot;
+	$&quot;06022F146D3B80D3BC7FF03032974B85E5482BA200FFC7BAFFC31A1A02000602&quot;
+	$&quot;2F146D3B80D3BC7FF03032974B85E5482BA201E3E3E3FF59697A020006022F14&quot;
+	$&quot;6D3B80D3BC7FF03032974B75E5484BA200D6D9DCFF78899903FAA28E13060BE2&quot;
+	$&quot;8B3F39603C46564C564A564E5653535155C788C71BC9764E5B5F48CB8147CB81&quot;
+	$&quot;47CC4D4460406043603D5C3B5E3C5C3B02044647453BC291BE263C2DC189B9DE&quot;
+	$&quot;382B2F2D342B342D392F362DBFCBBADC060CFEAFAA5A405A345A345A2B4E2357&quot;
+	$&quot;2649213F2545223F252E2D2E2DB7AFB8FEB6FDBC282ABA75B6FDBC282A492C4A&quot;
+	$&quot;2251395E4354C1BCC81F0607FE1A5A405A345A345A2B4E23572649213F254522&quot;
+	$&quot;3F252E2D4445560404FE44564446444F443D382FC066BAE5BAE0B8222D2F302D&quot;
+	$&quot;2D2F0606EF03382F382FB89AB6FEB6FDBD5A2A30B6FDBD5A2A492B3A2B3A2B30&quot;
+	$&quot;382F2E2A382FBC910605EF03382F382FB89AB6FEB763BD5A2B30B763BD5A2B49&quot;
+	$&quot;C0BBBDBDC0BBBDBDC000BB9BBC912FBE9DBA00BC912F0605FE022C4A444D3B49&quot;
+	$&quot;444D44454445C156C041C0BBBDBDC122BEEAC0BBBDBD2A490606A70A444D3B49&quot;
+	$&quot;444DC7EB4354395E22512C4A0A042F4C28513358424C0605AA03B7BABEF22343&quot;
+	$&quot;3254BFB1C3BA38443D4733410606EA0A44423A36B7BABEF2384433413D47BFB1&quot;
+	$&quot;C3BA4447060AEEEF0E234331C24EB746C1EB31C24E3253BA6EC264BA6EC264BB&quot;
+	$&quot;8FC285BCCAC21CBC7AC27CBCFAC1E3BD30C05DBD1AC134BD30C05D4444BD3DBF&quot;
+	$&quot;CABD3DBFCABD60BDF73A363744394235460A054EBA2B4E285623562C50310A04&quot;
+	$&quot;4CB9BA4C274E284EBA200A044C274E28562354220A044E404EBA2B4F324F3F0A&quot;
+	$&quot;044E404C3F4CB9C54EBA390A084C274C3F4E404F3F4F32562C56235422140A01&quot;
+	$&quot;0100000A0001021001178402040A020103000A030101000A0001041001178400&quot;
+	$&quot;040A040105000A050106000A060107000A070108000A0B0109000A00020A0B10&quot;
+	$&quot;01178400040A08010A000A09010B000A0A010C000A0001121001178400040A0C&quot;
+	$&quot;010D000A0D010E000A10010F000A0E0110000A0F011100&quot;
+};

Modified: haiku/trunk/src/servers/mail/Jamfile
===================================================================
--- haiku/trunk/src/servers/mail/Jamfile	2009-08-12 09:54:58 UTC (rev 32268)
+++ haiku/trunk/src/servers/mail/Jamfile	2009-08-12 10:47:18 UTC (rev 32269)
@@ -8,10 +8,11 @@
 
 UsePublicHeaders [ FDirName add-ons mail_daemon ] ;
 UsePrivateHeaders mail ;
+UseLibraryHeaders icon ;
 
 SubDirHdrs [ FDirName $(HAIKU_TOP) headers os add-ons mail_daemon ] ;
 
-AddResources mail_daemon : mail_daemon.rdef ;
+AddResources mail_daemon : mail_daemon.rdef DeskbarViewIcons.rdef ;
 
 Server mail_daemon :
 	deskbarview.cpp

Modified: haiku/trunk/src/servers/mail/deskbarview.cpp
===================================================================
--- haiku/trunk/src/servers/mail/deskbarview.cpp	2009-08-12 09:54:58 UTC (rev 32268)
+++ haiku/trunk/src/servers/mail/deskbarview.cpp	2009-08-12 10:47:18 UTC (rev 32269)
@@ -18,6 +18,7 @@
 #include &lt;VolumeRoster.h&gt;
 #include &lt;Directory.h&gt;
 #include &lt;FindDirectory.h&gt;
+#include &lt;IconUtils.h&gt;
 #include &lt;Query.h&gt;
 #include &lt;SymLink.h&gt;
 #include &lt;NodeInfo.h&gt;
@@ -36,6 +37,7 @@
 #include &lt;MDRLanguage.h&gt;
 
 #include &quot;deskbarview.h&quot;
+#include &quot;DeskbarViewIcons.h&quot;
 
 const char *kTrackerSignature = &quot;application/x-vnd.Be-TRAK&quot;;
 
@@ -62,7 +64,7 @@
 			(char*)our_image &lt;= (char*)image-&gt;text_part + image-&gt;text_part_size)
 			break;
 	}
-	
+
 	return ret;
 }
 
@@ -76,36 +78,44 @@
 //	#pragma mark -
 
 
-DeskbarView::DeskbarView(BRect frame) 
-	: BView(frame, &quot;mail_daemon&quot;, B_FOLLOW_NONE, B_WILL_DRAW | B_PULSE_NEEDED)
-	, fIcon(NULL)
-	, fCurrentIconState(NEW_MAIL)
+DeskbarView::DeskbarView(BRect frame)
+	:
+	BView(frame, &quot;mail_daemon&quot;, B_FOLLOW_NONE, B_WILL_DRAW | B_PULSE_NEEDED),
+	fStatus(kStatusNoMail)
 {
+	_InitBitmaps();
 }
 
 DeskbarView::DeskbarView(BMessage *message)
-	: BView(message)
-	, fIcon(NULL)
-	, fCurrentIconState(NEW_MAIL)
+	:
+	BView(message),
+	fStatus(kStatusNoMail)
 {
-	ChangeIcon(NO_MAIL);
+	_InitBitmaps();
 }
 
 DeskbarView::~DeskbarView()
 {
-	delete fIcon;
+	for (int i = 0; i &lt; kStatusCount; i++)
+		delete fBitmaps[i];
+
 	for (int32 i = 0; i &lt; fNewMailQueries.CountItems(); i++)
 		delete ((BQuery *)(fNewMailQueries.ItemAt(i)));
 }
 
 void DeskbarView::AttachedToWindow()
 {
-	if (be_roster-&gt;IsRunning(&quot;application/x-vnd.Be-POST&quot;))
-	{
+	BView::AttachedToWindow();
+	if (Parent())
+		SetViewColor(Parent()-&gt;ViewColor());
+	else
+		SetViewColor(ui_color(B_PANEL_BACKGROUND_COLOR));
+
+	SetLowColor(ViewColor());
+
+	if (be_roster-&gt;IsRunning(&quot;application/x-vnd.Be-POST&quot;)) {
 		RefreshMailQuery();
-	}
-	else
-	{
+	} else {
 		BDeskbar deskbar;
 		deskbar.RemoveItem(&quot;mail_daemon&quot;);
 	}
@@ -120,10 +130,10 @@
 	BVolumeRoster volumes;
 	BVolume volume;
 	fNewMessages = 0;
-	
+
 	while (volumes.GetNextVolume(&amp;volume) == B_OK) {
 		BQuery *newMailQuery = new BQuery;
-	
+
 		newMailQuery-&gt;SetTarget(this);
 		newMailQuery-&gt;SetVolume(&amp;volume);
 		newMailQuery-&gt;PushAttr(B_MAIL_ATTR_STATUS);
@@ -138,16 +148,17 @@
 		newMailQuery-&gt;PushOp(B_OR);
 		newMailQuery-&gt;PushOp(B_AND);
 		newMailQuery-&gt;Fetch();
-		
+
 		BEntry entry;
 		while (newMailQuery-&gt;GetNextEntry(&amp;entry) == B_OK)
 			if (entry.InitCheck() == B_OK)
 				fNewMessages++;
-		
+
 		fNewMailQueries.AddItem(newMailQuery);
 	}
 
-	ChangeIcon((fNewMessages &gt; 0) ? NEW_MAIL : NO_MAIL);
+	fStatus = (fNewMessages &gt; 0) ? kStatusNewMail : kStatusNoMail;
+	Invalidate();
 }
 
 DeskbarView* DeskbarView::Instantiate(BMessage *data)
@@ -168,18 +179,12 @@
 
 void DeskbarView::Draw(BRect /*updateRect*/)
 {
-	PushState();
+	if (fBitmaps[fStatus] == NULL)
+		return;
 
-	SetHighColor(Parent()-&gt;ViewColor());
-	FillRect(BRect(0.0,0.0,15.0,15.0));
-	if(fIcon)
-	{
-		SetDrawingMode(B_OP_OVER);
-		DrawBitmap(fIcon,BRect(0.0,0.0,15.0,15.0));
-	}
-
-	PopState();
-	Sync();
+	SetDrawingMode(B_OP_ALPHA);
+	DrawBitmap(fBitmaps[fStatus]);
+	SetDrawingMode(B_OP_COPY);
 }
 
 status_t OpenFolder(const char* end)
@@ -187,15 +192,15 @@
 	BPath path;
 	find_directory(B_USER_DIRECTORY, &amp;path);
 	path.Append(end);
-	
+
 	entry_ref ref;
 	if (get_ref_for_path(path.Path(),&amp;ref) != B_OK) return B_NAME_NOT_FOUND;
 	if (!BEntry(&amp;ref).Exists()) return B_NAME_NOT_FOUND;
-	
-	
+
+
 	BMessage open_mbox(B_REFS_RECEIVED);
 	open_mbox.AddRef(&quot;refs&quot;,&amp;ref);
-	
+
 	BMessenger tracker(&quot;application/x-vnd.Be-TRAK&quot;);
 	tracker.SendMessage(&amp;open_mbox);
 	return B_OK;
@@ -244,8 +249,9 @@
 				case B_ENTRY_REMOVED:
 					fNewMessages--;
 					break;
-			}	
-			ChangeIcon((fNewMessages &gt; 0) ? NEW_MAIL : NO_MAIL);
+			}
+			fStatus = (fNewMessages &gt; 0) ? kStatusNewMail : kStatusNoMail;
+			Invalidate();
 			break;
 		}
 		case B_QUIT_REQUESTED:
@@ -256,17 +262,17 @@
 		{
 			BMessage argv(B_ARGV_RECEIVED);
 			argv.AddString(&quot;argv&quot;, &quot;E-mail&quot;);
-			
+
 			entry_ref ref;
 			BPath path;
 			int i = 0;
-			
+
 			while (message-&gt;FindRef(&quot;refs&quot;,i++,&amp;ref) == B_OK &amp;&amp; path.SetTo(&amp;ref) == B_OK)
 			{
 				//fprintf(stderr,&quot;got %s\n&quot;, path.Path());
 				argv.AddString(&quot;argv&quot;, path.Path());
 			}
-			
+
 			if (i &gt; 1)
 			{
 				argv.AddInt32(&quot;argc&quot;, i);
@@ -281,40 +287,38 @@
 
 
 void
-DeskbarView::ChangeIcon(int32 icon)
+DeskbarView::_InitBitmaps()
 {
-	if (fCurrentIconState == icon)
-		return;
+	for (int i = 0; i &lt; kStatusCount; i++)
+		fBitmaps[i] = NULL;
 
-	BBitmap *newIcon(NULL);
-
 	image_info info;
-	if (our_image(&amp;info) == B_OK) {
-		BFile file(info.name, B_READ_ONLY);
-		if (file.InitCheck() &lt; B_OK)
-			goto err;
+	if (our_image(&amp;info) != B_OK)
+		return;
 
-		BResources rsrc(&amp;file);
-		size_t len;
-		const void *data = rsrc.LoadResource('BBMP', icon == NEW_MAIL
-			? &quot;New&quot; : &quot;Read&quot;,&amp;len);
-		if (len == 0)
-			goto err;
+	BFile file(info.name, B_READ_ONLY);
+	if (file.InitCheck() != B_OK)
+		return;
 
-		BMemoryIO stream(data, len);
-		stream.Seek(0, SEEK_SET);
-		BMessage archive;
-		if (archive.Unflatten(&amp;stream) != B_OK)
-			goto err;
-		newIcon = new BBitmap(&amp;archive);
-	} else
-		fputs(&quot;no image!&quot;, stderr);
+	BResources resources(&amp;file);
+	if (resources.InitCheck() != B_OK)
+		return;
 
-err:
-	fCurrentIconState = icon;
-	delete fIcon;
-	fIcon = newIcon;
-	Invalidate();
+	for (int i = 0; i &lt; kStatusCount; i++) {
+		const void* data = NULL;
+		size_t size;
+		data = resources.LoadResource(B_VECTOR_ICON_TYPE,
+			kIconNoMail + i, &amp;size);
+		if (data != NULL) {
+			BBitmap* icon = new BBitmap(Bounds(), B_RGBA32);
+			if (icon-&gt;InitCheck() == B_OK
+				&amp;&amp; BIconUtils::GetVectorIcon((const uint8 *)data,
+					size, icon) == B_OK) {
+				fBitmaps[i] = icon;
+			} else
+				delete icon;
+		}
+	}
 }
 
 
@@ -465,7 +469,7 @@
 						&amp;&amp; strcmp(mimeString, &quot;application/x-vnd.Be-query&quot;) == 0)
 						useNavMenu = true;
 				}
-				// clobber the existing ref only if the symlink derefernces completely, 
+				// clobber the existing ref only if the symlink derefernces completely,
 				// otherwise we'll stick with what we have
 				entry.GetRef(&amp;ref);
 			}

Modified: haiku/trunk/src/servers/mail/deskbarview.h
===================================================================
--- haiku/trunk/src/servers/mail/deskbarview.h	2009-08-12 09:54:58 UTC (rev 32268)
+++ haiku/trunk/src/servers/mail/deskbarview.h	2009-08-12 10:47:18 UTC (rev 32269)
@@ -10,9 +10,10 @@
 #include &quot;NavMenu.h&quot;
 
 
-enum MDDeskbarIcon {
-	NO_MAIL = 0,
-	NEW_MAIL,
+enum {
+	kStatusNoMail = 0,
+	kStatusNewMail,
+	kStatusCount
 };
 
 enum MDDeskbarMessages {
@@ -33,7 +34,7 @@
 class _EXPORT DeskbarView : public BView {
 	public:
 		DeskbarView (BRect frame);
-		DeskbarView (BMessage *data);	
+		DeskbarView (BMessage *data);
 
 		virtual ~DeskbarView();
 
@@ -46,17 +47,16 @@
 		virtual void		MessageReceived(BMessage *message);
 		virtual void		Pulse();
 
-		void				ChangeIcon(int32 icon);
-
 	private:
 		void		RefreshMailQuery();
 		bool		CreateMenuLinks(BDirectory &amp;,BPath &amp;);
 		void		CreateNewMailQuery(BEntry &amp;);
 		BPopUpMenu	*BuildMenu();
-	
-		BBitmap		*fIcon;
-		int32		fCurrentIconState;
-		
+		void		_InitBitmaps();
+
+		BBitmap*	fBitmaps[kStatusCount];
+		int32		fStatus;
+
 		BList		fNewMailQueries;
 		int32		fNewMessages;
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019037.html">[Haiku-commits] r32268 - in	haiku/branches/components/gsoc-locale-kit: headers/os/locale	src/kits/locale src/preferences/locale
</A></li>
	<LI>Next message: <A HREF="019041.html">[Haiku-commits] r32270 - in	haiku/branches/components/gsoc-locale-kit: headers/os/locale	src/kits/locale src/preferences/locale
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19040">[ date ]</a>
              <a href="thread.html#19040">[ thread ]</a>
              <a href="subject.html#19040">[ subject ]</a>
              <a href="author.html#19040">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
