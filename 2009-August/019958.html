<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r32700 - in haiku/trunk: headers/os/interface	src/kits/interface
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-August/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r32700%20-%20in%20haiku/trunk%3A%20headers/os/interface%0A%09src/kits/interface&In-Reply-To=%3C200908261147.n7QBlrOY022938%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019956.html">
   <LINK REL="Next"  HREF="019959.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r32700 - in haiku/trunk: headers/os/interface	src/kits/interface</H1>
    <B>stippi at mail.berlios.de</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r32700%20-%20in%20haiku/trunk%3A%20headers/os/interface%0A%09src/kits/interface&In-Reply-To=%3C200908261147.n7QBlrOY022938%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r32700 - in haiku/trunk: headers/os/interface	src/kits/interface">stippi at mail.berlios.de
       </A><BR>
    <I>Wed Aug 26 13:47:53 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019956.html">[Haiku-commits] r32699 - haiku/trunk/headers/os/interface
</A></li>
        <LI>Next message: <A HREF="019959.html">[Haiku-commits] r32701 - in haiku/trunk: headers/os/interface	src/kits/interface
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19958">[ date ]</a>
              <a href="thread.html#19958">[ thread ]</a>
              <a href="subject.html#19958">[ subject ]</a>
              <a href="author.html#19958">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: stippi
Date: 2009-08-26 13:47:51 +0200 (Wed, 26 Aug 2009)
New Revision: 32700
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=32700&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=32700&amp;view=rev</A>

Modified:
   haiku/trunk/headers/os/interface/ListView.h
   haiku/trunk/src/kits/interface/ListView.cpp
Log:
* Updated indentation style
* Better grouping of methods
* Fixed copyright
+alphabranch


Modified: haiku/trunk/headers/os/interface/ListView.h
===================================================================
--- haiku/trunk/headers/os/interface/ListView.h	2009-08-26 11:27:06 UTC (rev 32699)
+++ haiku/trunk/headers/os/interface/ListView.h	2009-08-26 11:47:51 UTC (rev 32700)
@@ -1,6 +1,6 @@
 /*
- * Copyright 2002-2009, Haiku, Inc. All Rights Reserved.
- * Distributed under the terms of the MIT License.
+ * Copyright 2002-2009, Haiku, Inc. All rights reserved.
+ * Distributed under the terms of the MIT license.
  */
 #ifndef _LIST_VIEW_H
 #define _LIST_VIEW_H
@@ -22,115 +22,137 @@
 
 class BListView : public BView, public BInvoker {
 public:
-							BListView(BRect frame, const char* name,
-								list_view_type type = B_SINGLE_SELECTION_LIST,
-								uint32 resizeMask = B_FOLLOW_LEFT | B_FOLLOW_TOP,
-								uint32 flags = B_WILL_DRAW | B_FRAME_EVENTS
-									| B_NAVIGABLE);
-							BListView(const char* name,
-								list_view_type type = B_SINGLE_SELECTION_LIST,
-								uint32 flags = B_WILL_DRAW | B_FRAME_EVENTS
-									| B_NAVIGABLE);
-							BListView(
-								list_view_type type = B_SINGLE_SELECTION_LIST);
-							BListView(BMessage* data);
+								BListView(BRect frame, const char* name,
+									list_view_type type
+										= B_SINGLE_SELECTION_LIST,
+									uint32 resizeMask = B_FOLLOW_LEFT
+										| B_FOLLOW_TOP,
+									uint32 flags = B_WILL_DRAW
+										| B_FRAME_EVENTS | B_NAVIGABLE);
+								BListView(const char* name,
+									list_view_type type
+										= B_SINGLE_SELECTION_LIST,
+									uint32 flags = B_WILL_DRAW
+										| B_FRAME_EVENTS | B_NAVIGABLE);
+								BListView(list_view_type type
+									= B_SINGLE_SELECTION_LIST);
+								BListView(BMessage* data);
 
-	virtual					~BListView();
+	virtual						~BListView();
 
-	static	BArchivable*	Instantiate(BMessage* data);
-	virtual status_t		Archive(BMessage* data, bool deep = true) const;
-	virtual void			Draw(BRect updateRect);
-	virtual void			MessageReceived(BMessage* message);
-	virtual void			MouseDown(BPoint where);
-	virtual void			KeyDown(const char* bytes, int32 numBytes);
-	virtual void			MakeFocus(bool state = true);
-	virtual void			AttachedToWindow();
-	virtual void			FrameResized(float newWidth, float newHeight);
-	virtual void			FrameMoved(BPoint newPosition);
-	virtual	void			SetFont(const BFont* font, uint32 mask = B_FONT_ALL);
-	virtual void			TargetedByScrollView(BScrollView* scroller);
-	virtual void			ScrollTo(BPoint where);
-	inline	void			ScrollTo(float x, float y);
-	virtual bool			AddItem(BListItem* item);
-	virtual bool			AddItem(BListItem* item, int32 atIndex);
-	virtual bool			AddList(BList* newItems);
-	virtual bool			AddList(BList* newItems, int32 atIndex);
-	virtual bool			RemoveItem(BListItem* item);
-	virtual BListItem*		RemoveItem(int32 index);
-	virtual bool			RemoveItems(int32 index, int32 count);
+	static	BArchivable*		Instantiate(BMessage* data);
+	virtual status_t			Archive(BMessage* data,
+									bool deep = true) const;
 
-	virtual void			SetSelectionMessage(BMessage* message);
-	virtual void			SetInvocationMessage(BMessage* message);
+	virtual void				Draw(BRect updateRect);
 
-			BMessage*		SelectionMessage() const;
-			uint32			SelectionCommand() const;
-			BMessage*		InvocationMessage() const;
-			uint32			InvocationCommand() const;
+	virtual void				AttachedToWindow();
+	virtual void				DetachedFromWindow();
+	virtual void				AllAttached();
+	virtual void				AllDetached();
+	virtual void				FrameResized(float newWidth, float newHeight);
+	virtual void				FrameMoved(BPoint newPosition);
+	virtual void				TargetedByScrollView(BScrollView* scroller);
+	virtual void				WindowActivated(bool state);
 
-	virtual void			SetListType(list_view_type type);
-			list_view_type	ListType() const;
+	virtual void				MessageReceived(BMessage* message);
+	virtual void				KeyDown(const char* bytes, int32 numBytes);
+	virtual void				MouseDown(BPoint where);
+	virtual void				MouseUp(BPoint point);
+	virtual void				MouseMoved(BPoint point, uint32 code,
+									const BMessage* dragMessage);
 
-			BListItem*		ItemAt(int32 index) const;
-			int32			IndexOf(BPoint point) const;
-			int32			IndexOf(BListItem* item) const;
-			BListItem*		FirstItem() const;
-			BListItem*		LastItem() const;
-			bool			HasItem(BListItem* item) const;
-			int32			CountItems() const;
-	virtual void			MakeEmpty();
-			bool			IsEmpty() const;
-			void			DoForEach(bool (*func)(BListItem* item));
-			void			DoForEach(bool (*func)(BListItem* item, void* arg),
-								void* arg);
-			const BListItem** Items() const;
-			void			InvalidateItem(int32 index);
-			void			ScrollToSelection();
+	virtual bool				InitiateDrag(BPoint point, int32 itemIndex,
+									bool initialySelected);
 
-			void			Select(int32 index, bool extend = false);
-			void			Select(int32 from, int32 to, bool extend = false);
-			bool			IsItemSelected(int32 index) const;
-			int32			CurrentSelection(int32 index = 0) const;
-	virtual status_t		Invoke(BMessage* message = NULL);
+	virtual void				ResizeToPreferred();
+	virtual void				GetPreferredSize(float* _width,
+									float* _height);
 
-			void			DeselectAll();
-			void			DeselectExcept(int32 exceptFrom, int32 exceptTo);
-			void			Deselect(int32 index);
+	virtual	BSize				MinSize();
+	virtual	BSize				MaxSize();
+	virtual	BSize				PreferredSize();
 
-	virtual void			SelectionChanged();
+	virtual void				MakeFocus(bool state = true);
 
-			void			SortItems(int (*cmp)(const void*, const void*));
+	virtual	void				SetFont(const BFont* font, uint32 mask
+									= B_FONT_ALL);
+	virtual void				ScrollTo(BPoint where);
+	inline	void				ScrollTo(float x, float y);
 
-	/* These functions bottleneck through DoMiscellaneous() */
-			bool			SwapItems(int32 a, int32 b);
-			bool			MoveItem(int32 from, int32 to);
-			bool			ReplaceItem(int32 index, BListItem* item);
+	virtual bool				AddItem(BListItem* item);
+	virtual bool				AddItem(BListItem* item, int32 atIndex);
+	virtual bool				AddList(BList* newItems);
+	virtual bool				AddList(BList* newItems, int32 atIndex);
+	virtual bool				RemoveItem(BListItem* item);
+	virtual BListItem*			RemoveItem(int32 index);
+	virtual bool				RemoveItems(int32 index, int32 count);
 
-			BRect			ItemFrame(int32 index);
+	virtual void				SetSelectionMessage(BMessage* message);
+	virtual void				SetInvocationMessage(BMessage* message);
 
-	virtual BHandler*		ResolveSpecifier(BMessage* message, int32 index,
-								BMessage* specifier, int32 form,
-								const char* property);
-	virtual status_t		GetSupportedSuites(BMessage* data);
+			BMessage*			SelectionMessage() const;
+			uint32				SelectionCommand() const;
+			BMessage*			InvocationMessage() const;
+			uint32				InvocationCommand() const;
 
-	virtual status_t		Perform(perform_code code, void* arg);
+	virtual void				SetListType(list_view_type type);
+			list_view_type		ListType() const;
 
-	virtual void			WindowActivated(bool state);
-	virtual void			MouseUp(BPoint point);
-	virtual void			MouseMoved(BPoint point, uint32 code,
-								const BMessage* dragMessage);
-	virtual void			DetachedFromWindow();
-	virtual bool			InitiateDrag(BPoint point, int32 itemIndex,
-								bool initialySelected);
+			BListItem*			ItemAt(int32 index) const;
+			int32				IndexOf(BPoint point) const;
+			int32				IndexOf(BListItem* item) const;
+			BListItem*			FirstItem() const;
+			BListItem*			LastItem() const;
+			bool				HasItem(BListItem* item) const;
+			int32				CountItems() const;
+	virtual void				MakeEmpty();
+			bool				IsEmpty() const;
+			void				DoForEach(bool (*func)(BListItem* item));
+			void				DoForEach(bool (*func)(BListItem* item,
+									void* arg), void* arg);
+			const BListItem**	Items() const;
+			void				InvalidateItem(int32 index);
+			void				ScrollToSelection();
 
-	virtual void			ResizeToPreferred();
-	virtual void			GetPreferredSize(float* _width, float* _height);
-	virtual void			AllAttached();
-	virtual void			AllDetached();
+			void				Select(int32 index, bool extend = false);
+			void				Select(int32 from, int32 to,
+									bool extend = false);
+			bool				IsItemSelected(int32 index) const;
+			int32				CurrentSelection(int32 index = 0) const;
+	virtual status_t			Invoke(BMessage* message = NULL);
 
-	virtual	BSize			MinSize();
-	virtual	BSize			MaxSize();
-	virtual	BSize			PreferredSize();
+			void				DeselectAll();
+			void				DeselectExcept(int32 exceptFrom,
+									int32 exceptTo);
+			void				Deselect(int32 index);
 
+	virtual void				SelectionChanged();
+
+			void				SortItems(int (*cmp)(const void*,
+									const void*));
+
+	// These functions bottleneck through DoMiscellaneous()
+			bool				SwapItems(int32 a, int32 b);
+			bool				MoveItem(int32 from, int32 to);
+			bool				ReplaceItem(int32 index, BListItem* item);
+
+			BRect				ItemFrame(int32 index);
+
+	virtual BHandler*			ResolveSpecifier(BMessage* message,
+									int32 index, BMessage* specifier,
+									int32 form, const char* property);
+	virtual status_t			GetSupportedSuites(BMessage* data);
+
+	virtual status_t			Perform(perform_code code, void* arg);
+
+private:
+	virtual	void				_ReservedListView2();
+	virtual	void				_ReservedListView3();
+	virtual	void				_ReservedListView4();
+
+			BListView&amp;			operator=(const BListView&amp; other);
+
 protected:
 	enum MiscCode { B_NO_OP, B_REPLACE_OP, B_MOVE_OP, B_SWAP_OP };
 	union MiscData {
@@ -140,48 +162,44 @@
 		struct Swap { int32 a; int32 b; } swap;
 	};
 
-	virtual bool			DoMiscellaneous(MiscCode code, MiscData* data);
+	virtual bool				DoMiscellaneous(MiscCode code, MiscData* data);
 
 private:
 	friend class BOutlineListView;
 
-	virtual	void			_ReservedListView2();
-	virtual	void			_ReservedListView3();
-	virtual	void			_ReservedListView4();
+			void				_InitObject(list_view_type type);
+			void				_FixupScrollBar();
+			void				_InvalidateFrom(int32 index);
+			status_t			_PostMessage(BMessage* message);
+			void				_FontChanged();
+			int32				_RangeCheck(int32 index);
+			bool				_Select(int32 index, bool extend);
+			bool				_Select(int32 from, int32 to, bool extend);
+			bool				_Deselect(int32 index);
+			bool				_DeselectAll(int32 exceptFrom, int32 exceptTo);
+			int32				_CalcFirstSelected(int32 after);
+			int32				_CalcLastSelected(int32 before);
+			void				_RecalcItemTops(int32 start, int32 end = -1);
 
-			BListView&amp;		operator=(const BListView&amp; other);
+	virtual void				DrawItem(BListItem* item, BRect itemRect,
+									bool complete = false);
 
-			void			_InitObject(list_view_type type);
-			void			_FixupScrollBar();
-			void			_InvalidateFrom(int32 index);
-			status_t		_PostMessage(BMessage* message);
-			void			_FontChanged();
-			int32			_RangeCheck(int32 index);
-			bool			_Select(int32 index, bool extend);
-			bool			_Select(int32 from, int32 to, bool extend);
-			bool			_Deselect(int32 index);
-			bool			_DeselectAll(int32 exceptFrom, int32 exceptTo);
-			int32			_CalcFirstSelected(int32 after);
-			int32			_CalcLastSelected(int32 before);
-			void			_RecalcItemTops(int32 start, int32 end = -1);
-	virtual void			DrawItem(BListItem* item, BRect itemRect,
-								bool complete = false);
+			bool				_SwapItems(int32 a, int32 b);
+			bool				_MoveItem(int32 from, int32 to);
+			bool				_ReplaceItem(int32 index, BListItem* item);
+			void				_RescanSelection(int32 from, int32 to);
 
-			bool			_SwapItems(int32 a, int32 b);
-			bool			_MoveItem(int32 from, int32 to);
-			bool			_ReplaceItem(int32 index, BListItem* item);
-			void			_RescanSelection(int32 from, int32 to);
+private:
+			BList				fList;
+			list_view_type		fListType;
+			int32				fFirstSelected;
+			int32				fLastSelected;
+			int32				fAnchorIndex;
+			BMessage*			fSelectMessage;
+			BScrollView*		fScrollView;
+			track_data*			fTrack;
 
-			BList			fList;
-			list_view_type	fListType;
-			int32			fFirstSelected;
-			int32			fLastSelected;
-			int32			fAnchorIndex;
-			BMessage*		fSelectMessage;
-			BScrollView*	fScrollView;
-			track_data*		fTrack;
-
-			uint32			_reserved[4];
+			uint32				_reserved[4];
 };
 
 
@@ -191,4 +209,4 @@
 	ScrollTo(BPoint(x, y));
 }
 
-#endif /* _LIST_VIEW_H */
+#endif // _LIST_VIEW_H

Modified: haiku/trunk/src/kits/interface/ListView.cpp
===================================================================
--- haiku/trunk/src/kits/interface/ListView.cpp	2009-08-26 11:27:06 UTC (rev 32699)
+++ haiku/trunk/src/kits/interface/ListView.cpp	2009-08-26 11:47:51 UTC (rev 32700)
@@ -1,5 +1,5 @@
 /*
- * Copyright (c) 2001-2009, Haiku, Inc.
+ * Copyright 2001-2009, Haiku, Inc. All rights resrerved.
  * Distributed under the terms of the MIT license.
  *
  * Authors:
@@ -135,6 +135,9 @@
 }
 
 
+// #pragma mark -
+
+
 BArchivable*
 BListView::Instantiate(BMessage* archive)
 {
@@ -178,6 +181,9 @@
 }
 
 
+// #pragma mark -
+
+
 void
 BListView::Draw(BRect updateRect)
 {
@@ -199,6 +205,71 @@
 
 
 void
+BListView::AttachedToWindow()
+{
+	BView::AttachedToWindow();
+	_FontChanged();
+
+	if (!Messenger().IsValid())
+		SetTarget(Window(), NULL);
+
+	_FixupScrollBar();
+}
+
+
+void
+BListView::DetachedFromWindow()
+{
+	BView::DetachedFromWindow();
+}
+
+
+void
+BListView::AllAttached()
+{
+	BView::AllAttached();
+}
+
+
+void
+BListView::AllDetached()
+{
+	BView::AllDetached();
+}
+
+
+void
+BListView::FrameResized(float width, float height)
+{
+	_FixupScrollBar();
+}
+
+
+void
+BListView::FrameMoved(BPoint new_position)
+{
+	BView::FrameMoved(new_position);
+}
+
+
+void
+BListView::TargetedByScrollView(BScrollView *view)
+{
+	fScrollView = view;
+}
+
+
+void
+BListView::WindowActivated(bool state)
+{
+	BView::WindowActivated(state);
+}
+
+
+// #pragma mark -
+
+
+void
 BListView::MessageReceived(BMessage* msg)
 {
 	switch (msg-&gt;what) {
@@ -215,7 +286,8 @@
 				|| specifier.FindString(&quot;property&quot;, &amp;property) != B_OK)
 				return;
 
-			switch (propInfo.FindMatch(msg, 0, &amp;specifier, msg-&gt;what, property)) {
+			switch (propInfo.FindMatch(msg, 0, &amp;specifier, msg-&gt;what,
+					property)) {
 				case B_ERROR:
 					BView::MessageReceived(msg);
 					break;
@@ -302,6 +374,96 @@
 
 
 void
+BListView::KeyDown(const char *bytes, int32 numBytes)
+{
+	bool extend
+		= fListType == B_MULTIPLE_SELECTION_LIST
+			&amp;&amp; (modifiers() &amp; B_SHIFT_KEY) != 0;
+
+	switch (bytes[0]) {
+		case B_UP_ARROW:
+		{
+			if (fFirstSelected == -1) {
+				// if nothing is selected yet, always select the first item
+				Select(0);
+			} else {
+				if (fAnchorIndex &gt; 0) {
+					if (!extend || fAnchorIndex &lt;= fFirstSelected)
+						Select(fAnchorIndex - 1, extend);
+					else
+						Deselect(fAnchorIndex--);
+				}
+			}
+
+			ScrollToSelection();
+			break;
+		}
+		case B_DOWN_ARROW:
+		{
+			if (fFirstSelected == -1) {
+				// if nothing is selected yet, always select the first item
+				Select(0);
+			} else {
+				if (fAnchorIndex &lt; CountItems() - 1) {
+					if (!extend || fAnchorIndex &gt;= fLastSelected)
+						Select(fAnchorIndex + 1, extend);
+					else
+						Deselect(fAnchorIndex++);
+				}
+			}
+
+			ScrollToSelection();
+			break;
+		}
+
+		case B_HOME:
+			if (extend) {
+				Select(0, fAnchorIndex, true);
+				fAnchorIndex = 0;
+			} else
+				Select(0, false);
+			ScrollToSelection();
+			break;
+		case B_END:
+			if (extend) {
+				Select(fAnchorIndex, CountItems() - 1, true);
+				fAnchorIndex = CountItems() - 1;
+			} else
+				Select(CountItems() - 1, false);
+			ScrollToSelection();
+			break;
+
+		case B_PAGE_UP:
+		{
+			BPoint scrollOffset(LeftTop());
+			scrollOffset.y = max_c(0, scrollOffset.y - Bounds().Height());
+			ScrollTo(scrollOffset);
+			break;
+		}
+		case B_PAGE_DOWN:
+		{
+			BPoint scrollOffset(LeftTop());
+			if (BListItem* item = LastItem()) {
+				scrollOffset.y += Bounds().Height();
+				scrollOffset.y = min_c(item-&gt;Bottom() - Bounds().Height(),
+					scrollOffset.y);
+			}
+			ScrollTo(scrollOffset);
+			break;
+		}
+
+		case B_RETURN:
+		case B_SPACE:
+			Invoke();
+			break;
+
+		default:
+			BView::KeyDown(bytes, numBytes);
+	}
+}
+
+
+void
 BListView::MouseDown(BPoint point)
 {
 	if (!IsFocus()) {
@@ -408,133 +570,84 @@
 }
 
 
-void
-BListView::KeyDown(const char *bytes, int32 numBytes)
+bool
+BListView::InitiateDrag(BPoint point, int32 index, bool wasSelected)
 {
-	bool extend
-		= fListType == B_MULTIPLE_SELECTION_LIST
-			&amp;&amp; (modifiers() &amp; B_SHIFT_KEY) != 0;
+	return false;
+}
 
-	switch (bytes[0]) {
-		case B_UP_ARROW:
-		{
-			if (fFirstSelected == -1) {
-				// if nothing is selected yet, always select the first item
-				Select(0);
-			} else {
-				if (fAnchorIndex &gt; 0) {
-					if (!extend || fAnchorIndex &lt;= fFirstSelected)
-						Select(fAnchorIndex - 1, extend);
-					else
-						Deselect(fAnchorIndex--);
-				}
-			}
 
-			ScrollToSelection();
-			break;
-		}
-		case B_DOWN_ARROW:
-		{
-			if (fFirstSelected == -1) {
-				// if nothing is selected yet, always select the first item
-				Select(0);
-			} else {
-				if (fAnchorIndex &lt; CountItems() - 1) {
-					if (!extend || fAnchorIndex &gt;= fLastSelected)
-						Select(fAnchorIndex + 1, extend);
-					else
-						Deselect(fAnchorIndex++);
-				}
-			}
+// #pragma mark -
 
-			ScrollToSelection();
-			break;
-		}
 
-		case B_HOME:
-			if (extend) {
-				Select(0, fAnchorIndex, true);
-				fAnchorIndex = 0;
-			} else
-				Select(0, false);
-			ScrollToSelection();
-			break;
-		case B_END:
-			if (extend) {
-				Select(fAnchorIndex, CountItems() - 1, true);
-				fAnchorIndex = CountItems() - 1;
-			} else
-				Select(CountItems() - 1, false);
-			ScrollToSelection();
-			break;
+void
+BListView::ResizeToPreferred()
+{
+	BView::ResizeToPreferred();
+}
 
-		case B_PAGE_UP:
-		{
-			BPoint scrollOffset(LeftTop());
-			scrollOffset.y = max_c(0, scrollOffset.y - Bounds().Height());
-			ScrollTo(scrollOffset);
-			break;
+
+void
+BListView::GetPreferredSize(float* _width, float* _height)
+{
+	int32 count = CountItems();
+
+	if (count &gt; 0) {
+		float maxWidth = 0.0;
+		for (int32 i = 0; i &lt; count; i++) {
+			float itemWidth = ItemAt(i)-&gt;Width();
+			if (itemWidth &gt; maxWidth)
+				maxWidth = itemWidth;
 		}
-		case B_PAGE_DOWN:
-		{
-			BPoint scrollOffset(LeftTop());
-			if (BListItem* item = LastItem()) {
-				scrollOffset.y += Bounds().Height();
-				scrollOffset.y = min_c(item-&gt;Bottom() - Bounds().Height(),
-					scrollOffset.y);
-			}
-			ScrollTo(scrollOffset);
-			break;
-		}
 
-		case B_RETURN:
-		case B_SPACE:
-			Invoke();
-			break;
-
-		default:
-			BView::KeyDown(bytes, numBytes);
+		if (_width != NULL)
+			*_width = maxWidth;
+		if (_height != NULL)
+			*_height = ItemAt(count - 1)-&gt;Bottom();
+	} else {
+		BView::GetPreferredSize(_width, _height);
 	}
 }
 
 
-void
-BListView::MakeFocus(bool focused)
+BSize
+BListView::MinSize()
 {
-	if (IsFocus() == focused)
-		return;
+	// We need a stable min size: the BView implementation uses
+	// GetPreferredSize(), which by default just returns the current size.
+	return BLayoutUtils::ComposeSize(ExplicitMinSize(), BSize(10, 10));
+}
 
-	BView::MakeFocus(focused);
 
-	if (fScrollView)
-		fScrollView-&gt;SetBorderHighlighted(focused);
+BSize
+BListView::MaxSize()
+{
+	return BView::MaxSize();
 }
 
 
-void
-BListView::AttachedToWindow()
+BSize
+BListView::PreferredSize()
 {
-	BView::AttachedToWindow();
-	_FontChanged();
+	// We need a stable preferred size: the BView implementation uses
+	// GetPreferredSize(), which by default just returns the current size.
+	return BLayoutUtils::ComposeSize(ExplicitPreferredSize(), BSize(100, 50));
+}
 
-	if (!Messenger().IsValid())
-		SetTarget(Window(), NULL);
 
-	_FixupScrollBar();
-}
+// #pragma mark -
 
 
 void
-BListView::FrameResized(float width, float height)
+BListView::MakeFocus(bool focused)
 {
-	_FixupScrollBar();
-}
+	if (IsFocus() == focused)
+		return;
 
+	BView::MakeFocus(focused);
 
-void
-BListView::FrameMoved(BPoint new_position)
-{
-	BView::FrameMoved(new_position);
+	if (fScrollView)
+		fScrollView-&gt;SetBorderHighlighted(focused);
 }
 
 
@@ -547,19 +660,15 @@
 
 
 void
-BListView::TargetedByScrollView(BScrollView *view)
-{
-	fScrollView = view;
-}
-
-
-void
 BListView::ScrollTo(BPoint point)
 {
 	BView::ScrollTo(point);
 }
 
 
+// #pragma mark - List ops
+
+
 bool
 BListView::AddItem(BListItem *item, int32 index)
 {
@@ -1119,6 +1228,9 @@
 }
 
 
+// #pragma mark -
+
+
 BHandler*
 BListView::ResolveSpecifier(BMessage* message, int32 index,
 	BMessage* specifier, int32 form, const char* property)
@@ -1210,97 +1322,7 @@
 }
 
 
-void
-BListView::WindowActivated(bool state)
-{
-	BView::WindowActivated(state);
-}
-
-
-void
-BListView::DetachedFromWindow()
-{
-	BView::DetachedFromWindow();
-}
-
-
 bool
-BListView::InitiateDrag(BPoint point, int32 index, bool wasSelected)
-{
-	return false;
-}
-
-
-void
-BListView::ResizeToPreferred()
-{
-	BView::ResizeToPreferred();
-}
-
-
-void
-BListView::GetPreferredSize(float* _width, float* _height)
-{
-	int32 count = CountItems();
-
-	if (count &gt; 0) {
-		float maxWidth = 0.0;
-		for (int32 i = 0; i &lt; count; i++) {
-			float itemWidth = ItemAt(i)-&gt;Width();
-			if (itemWidth &gt; maxWidth)
-				maxWidth = itemWidth;
-		}
-
-		if (_width != NULL)
-			*_width = maxWidth;
-		if (_height != NULL)
-			*_height = ItemAt(count - 1)-&gt;Bottom();
-	} else {
-		BView::GetPreferredSize(_width, _height);
-	}
-}
-
-
-void
-BListView::AllAttached()
-{
-	BView::AllAttached();
-}
-
-
-void
-BListView::AllDetached()
-{
-	BView::AllDetached();
-}
-
-
-BSize
-BListView::MinSize()
-{
-	// We need a stable min size: the BView implementation uses
-	// GetPreferredSize(), which by default just returns the current size.
-	return BLayoutUtils::ComposeSize(ExplicitMinSize(), BSize(10, 10));
-}
-
-
-BSize
-BListView::MaxSize()
-{
-	return BView::MaxSize();
-}
-
-
-BSize
-BListView::PreferredSize()
-{
-	// We need a stable preferred size: the BView implementation uses
-	// GetPreferredSize(), which by default just returns the current size.
-	return BLayoutUtils::ComposeSize(ExplicitPreferredSize(), BSize(100, 50));
-}
-
-
-bool
 BListView::DoMiscellaneous(MiscCode code, MiscData* data)
 {
 	if (code &gt; B_SWAP_OP)
@@ -1324,6 +1346,9 @@
 }
 
 
+// #pragma mark -
+
+
 void BListView::_ReservedListView2() {}
 void BListView::_ReservedListView3() {}
 void BListView::_ReservedListView4() {}
@@ -1336,6 +1361,9 @@
 }
 
 
+// #pragma mark -
+
+
 void
 BListView::_InitObject(list_view_type type)
 {


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019956.html">[Haiku-commits] r32699 - haiku/trunk/headers/os/interface
</A></li>
	<LI>Next message: <A HREF="019959.html">[Haiku-commits] r32701 - in haiku/trunk: headers/os/interface	src/kits/interface
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19958">[ date ]</a>
              <a href="thread.html#19958">[ thread ]</a>
              <a href="subject.html#19958">[ subject ]</a>
              <a href="author.html#19958">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
