<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r32586 - in haiku/trunk:	headers/libs/fluidsynth/fluidsynth src/libs/fluidsynth	src/libs/fluidsynth/src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-August/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r32586%20-%20in%20haiku/trunk%3A%0A%09headers/libs/fluidsynth/fluidsynth%20src/libs/fluidsynth%0A%09src/libs/fluidsynth/src&In-Reply-To=%3C200908212127.n7LLRpcw009800%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="019744.html">
   <LINK REL="Next"  HREF="019748.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r32586 - in haiku/trunk:	headers/libs/fluidsynth/fluidsynth src/libs/fluidsynth	src/libs/fluidsynth/src</H1>
    <B>korli at mail.berlios.de</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r32586%20-%20in%20haiku/trunk%3A%0A%09headers/libs/fluidsynth/fluidsynth%20src/libs/fluidsynth%0A%09src/libs/fluidsynth/src&In-Reply-To=%3C200908212127.n7LLRpcw009800%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r32586 - in haiku/trunk:	headers/libs/fluidsynth/fluidsynth src/libs/fluidsynth	src/libs/fluidsynth/src">korli at mail.berlios.de
       </A><BR>
    <I>Fri Aug 21 23:27:51 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="019744.html">[Haiku-commits] r32585 - haiku/trunk/src/preferences/devices
</A></li>
        <LI>Next message: <A HREF="019748.html">[Haiku-commits] r32587 - in haiku/trunk: headers/libs/png	src/libs/png
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19747">[ date ]</a>
              <a href="thread.html#19747">[ thread ]</a>
              <a href="subject.html#19747">[ subject ]</a>
              <a href="author.html#19747">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: korli
Date: 2009-08-21 23:27:45 +0200 (Fri, 21 Aug 2009)
New Revision: 32586
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=32586&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=32586&amp;view=rev</A>

Modified:
   haiku/trunk/headers/libs/fluidsynth/fluidsynth/version.h
   haiku/trunk/src/libs/fluidsynth/AUTHORS
   haiku/trunk/src/libs/fluidsynth/src/config.h
   haiku/trunk/src/libs/fluidsynth/src/fluid_adriver.c
   haiku/trunk/src/libs/fluidsynth/src/fluid_chan.c
   haiku/trunk/src/libs/fluidsynth/src/fluid_chan.h
   haiku/trunk/src/libs/fluidsynth/src/fluid_conv.h
   haiku/trunk/src/libs/fluidsynth/src/fluid_defsfont.c
   haiku/trunk/src/libs/fluidsynth/src/fluid_mdriver.c
   haiku/trunk/src/libs/fluidsynth/src/fluid_midi.c
   haiku/trunk/src/libs/fluidsynth/src/fluid_midi.h
   haiku/trunk/src/libs/fluidsynth/src/fluid_mod.c
   haiku/trunk/src/libs/fluidsynth/src/fluid_synth.c
   haiku/trunk/src/libs/fluidsynth/src/fluid_synth.h
   haiku/trunk/src/libs/fluidsynth/src/fluid_sys.c
   haiku/trunk/src/libs/fluidsynth/src/fluid_sys.h
   haiku/trunk/src/libs/fluidsynth/src/fluid_voice.c
   haiku/trunk/src/libs/fluidsynth/src/fluidsynth.c
Log:
updated fluidsynth to 1.0.9


Modified: haiku/trunk/headers/libs/fluidsynth/fluidsynth/version.h
===================================================================
--- haiku/trunk/headers/libs/fluidsynth/fluidsynth/version.h	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/headers/libs/fluidsynth/fluidsynth/version.h	2009-08-21 21:27:45 UTC (rev 32586)
@@ -26,10 +26,10 @@
 extern &quot;C&quot; {
 #endif
 
-#define FLUIDSYNTH_VERSION       &quot;1.0.8&quot;
+#define FLUIDSYNTH_VERSION       &quot;1.0.9&quot;
 #define FLUIDSYNTH_VERSION_MAJOR 1
 #define FLUIDSYNTH_VERSION_MINOR 0
-#define FLUIDSYNTH_VERSION_MICRO 8
+#define FLUIDSYNTH_VERSION_MICRO 9
 
 
 FLUIDSYNTH_API void fluid_version(int *major, int *minor, int *micro);

Modified: haiku/trunk/src/libs/fluidsynth/AUTHORS
===================================================================
--- haiku/trunk/src/libs/fluidsynth/AUTHORS	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/AUTHORS	2009-08-21 21:27:45 UTC (rev 32586)
@@ -1,4 +1,11 @@
+[:Team:]
+Current development team
 
+Josh Green
+Bernat Arlandis i Ma&#241;&#243;
+Pedro Lopez-Cabanillas
+
+
 [:Idea:]
 
 * Samuel Bianchini, Peter Hanappe and Johnathan Lee
@@ -12,26 +19,25 @@
 summary of contributions.
 
 
-* Peter Hanappe. Initiated the project. files: sticked his nose in all
+* Peter Hanappe. Initiated the project. files: stuck his nose in all
   files.
 
 * Josh Green is the current maintainer and contributed a lot of code
   directly or indirectly through the Swami and Smurf code base.
   The SoundFont loader is completely based on his code. He also wrote
   the alsa sequencer driver. He made many changes and bug fixes,
-  but above all, he's one of the driver forces behind the synthesizer.
+  but above all, he's one of the driving forces behind the synthesizer.
   He also created the current FluidSynth graphic logo with Blender
   (the blue waves with FluidSynth letters partially submerged).
-  files: iiwu_defsfont.{c,h}, iiwu_alsa{c,h} and others.
 
 * Markus Nentwig (re-)designed the resonant filter, the chorus, the
   LADSPA subsystem, the MIDI router, optimized for SSE, made many
   changes and bug fixes and got the synthesizer to actually work. Most
-  importantly, he used it on stage to make music.  files:
-  iiwu_ladspa.{c,h}, iiwu_cmd.{c,h}, iiwu_voice.{c,h}, iiwu_synth.c,
-  iiwu_sse.h, iiwu_dsp_core.h, iiwu_rev.{c,h}, and basically all the
-  other files.
+  importantly, he used it on stage to make music.
 
+* S. Christian Collins did much testing of FluidSynth in regards to
+  EMU10K1 compatibility and provided many synthesis fixes in that regard.
+
 * Stephane Letz from Grame wrote most of the MidiShare driver, all of
   the PortAudio driver, ported iiwusynth to MacOS X, and sent in many
   fixes. files: iiwu_midishare.c, iiwu_portaudio.c
@@ -98,7 +104,11 @@
   signed integer type). Mozilla NSPR library, www.mozilla.org.  file:
   iiwu_phase.h
 
-* Growing list of individuals who contributed bug fixes and corrections:
+* KO Myung-Hun for OS/2 support with Dart audio driver.
+
+* Growing list of individuals who contributed bug fixes, corrections and minor features:
+Pedro Lopez-Cabanillas for midi.winmidi.device setting.
+Nicolas Boulicault for ALSA sequencer midi.portname setting.
 Werner Schweer
 Dave Philips
 Anthony Green

Modified: haiku/trunk/src/libs/fluidsynth/src/config.h
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/config.h	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/config.h	2009-08-21 21:27:45 UTC (rev 32586)
@@ -160,11 +160,8 @@
 /* Define to 1 if you have the ANSI C header files. */
 #define STDC_HEADERS 1
 
-/* Define to use long long type, where appropriate */
-/* #undef USE_LONGLONG */
-
 /* Version number of package */
-#define VERSION &quot;1.0.7&quot;
+#define VERSION &quot;1.0.9&quot;
 
 /* Define to do all DSP in single floating point precision */
 #define WITH_FLOAT 1

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_adriver.c
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_adriver.c	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_adriver.c	2009-08-21 21:27:45 UTC (rev 32586)
@@ -37,6 +37,14 @@
 } fluid_audriver_definition_t;
 
 
+#if PULSE_SUPPORT
+fluid_audio_driver_t* new_fluid_pulse_audio_driver(fluid_settings_t* settings,
+						   fluid_synth_t* synth);
+fluid_audio_driver_t* new_fluid_pulse_audio_driver2(fluid_settings_t* settings,
+						    fluid_audio_func_t func, void* data);
+int delete_fluid_pulse_audio_driver(fluid_audio_driver_t* p);
+void fluid_pulse_audio_driver_settings(fluid_settings_t* settings);
+#endif
 
 #if ALSA_SUPPORT
 fluid_audio_driver_t* new_fluid_alsa_audio_driver(fluid_settings_t* settings,
@@ -74,6 +82,7 @@
 #endif
 
 #if PORTAUDIO_SUPPORT
+void fluid_portaudio_driver_settings (fluid_settings_t *settings);
 fluid_audio_driver_t* new_fluid_portaudio_driver(fluid_settings_t* settings,
 						 fluid_synth_t* synth);
 int delete_fluid_portaudio_driver(fluid_audio_driver_t* p);
@@ -96,6 +105,13 @@
 int delete_fluid_sndmgr_audio_driver(fluid_audio_driver_t* p);
 #endif
 
+#if DART_SUPPORT
+fluid_audio_driver_t* new_fluid_dart_audio_driver(fluid_settings_t* settings,
+                          fluid_synth_t* synth);
+int delete_fluid_dart_audio_driver(fluid_audio_driver_t* p);
+void fluid_dart_audio_driver_settings(fluid_settings_t* settings);
+#endif
+
 #define AUFILE_SUPPORT 1
 #if AUFILE_SUPPORT
 fluid_audio_driver_t* new_fluid_file_audio_driver(fluid_settings_t* settings,
@@ -104,13 +120,14 @@
 void fluid_file_audio_driver_settings(fluid_settings_t* settings);
 #endif
 
+/* Available audio drivers, listed in order of preference */
 fluid_audriver_definition_t fluid_audio_drivers[] = {
-#if OSS_SUPPORT
-  { &quot;oss&quot;,
-    new_fluid_oss_audio_driver,
-    new_fluid_oss_audio_driver2,
-    delete_fluid_oss_audio_driver,
-    fluid_oss_audio_driver_settings },
+#if JACK_SUPPORT
+  { &quot;jack&quot;,
+    new_fluid_jack_audio_driver,
+    new_fluid_jack_audio_driver2,
+    delete_fluid_jack_audio_driver,
+    fluid_jack_audio_driver_settings },
 #endif
 #if ALSA_SUPPORT
   { &quot;alsa&quot;,
@@ -119,6 +136,20 @@
     delete_fluid_alsa_audio_driver,
     fluid_alsa_audio_driver_settings },
 #endif
+#if OSS_SUPPORT
+  { &quot;oss&quot;,
+    new_fluid_oss_audio_driver,
+    new_fluid_oss_audio_driver2,
+    delete_fluid_oss_audio_driver,
+    fluid_oss_audio_driver_settings },
+#endif
+#if PULSE_SUPPORT
+  { &quot;pulseaudio&quot;,
+    new_fluid_pulse_audio_driver,
+    new_fluid_pulse_audio_driver2,
+    delete_fluid_pulse_audio_driver,
+    fluid_pulse_audio_driver_settings },
+#endif
 #if COREAUDIO_SUPPORT
   { &quot;coreaudio&quot;,
     new_fluid_core_audio_driver,
@@ -138,7 +169,7 @@
     new_fluid_portaudio_driver,
     NULL,
     delete_fluid_portaudio_driver,
-    NULL },
+    fluid_portaudio_driver_settings },
 #endif
 #if SNDMAN_SUPPORT
   { &quot;sndman&quot;,
@@ -147,12 +178,12 @@
     delete_fluid_sndmgr_audio_driver,
     NULL },
 #endif
-#if JACK_SUPPORT
-  { &quot;jack&quot;,
-    new_fluid_jack_audio_driver,
-    new_fluid_jack_audio_driver2,
-    delete_fluid_jack_audio_driver,
-    fluid_jack_audio_driver_settings },
+#if DART_SUPPORT
+  { &quot;dart&quot;,
+    new_fluid_dart_audio_driver,
+    NULL,
+    delete_fluid_dart_audio_driver,
+    fluid_dart_audio_driver_settings },
 #endif
 #if AUFILE_SUPPORT
   { &quot;file&quot;,
@@ -191,8 +222,12 @@
 #endif
 
   /* Set the default driver */
-#if ALSA_SUPPORT
+#if JACK_SUPPORT
+  fluid_settings_register_str(settings, &quot;audio.driver&quot;, &quot;jack&quot;, 0, NULL, NULL);
+#elif ALSA_SUPPORT
   fluid_settings_register_str(settings, &quot;audio.driver&quot;, &quot;alsa&quot;, 0, NULL, NULL);
+#elif PULSE_SUPPORT
+  fluid_settings_register_str(settings, &quot;audio.driver&quot;, &quot;pulseaudio&quot;, 0, NULL, NULL);
 #elif OSS_SUPPORT
   fluid_settings_register_str(settings, &quot;audio.driver&quot;, &quot;oss&quot;, 0, NULL, NULL);
 #elif COREAUDIO_SUPPORT
@@ -203,8 +238,8 @@
   fluid_settings_register_str(settings, &quot;audio.driver&quot;, &quot;sndman&quot;, 0, NULL, NULL);
 #elif PORTAUDIO_SUPPORT
   fluid_settings_register_str(settings, &quot;audio.driver&quot;, &quot;portaudio&quot;, 0, NULL, NULL);
-#elif JACK_SUPPORT
-  fluid_settings_register_str(settings, &quot;audio.driver&quot;, &quot;jack&quot;, 0, NULL, NULL);
+#elif DART_SUPPORT
+  fluid_settings_register_str(settings, &quot;audio.driver&quot;, &quot;dart&quot;, 0, NULL, NULL);
 #elif AUFILE_SUPPORT
   fluid_settings_register_str(settings, &quot;audio.driver&quot;, &quot;file&quot;, 0, NULL, NULL);
 #else
@@ -212,6 +247,9 @@
 #endif
 
   /* Add all drivers to the list of options */
+#if PULSE_SUPPORT
+  fluid_settings_add_option(settings, &quot;audio.driver&quot;, &quot;pulseaudio&quot;);
+#endif
 #if ALSA_SUPPORT
   fluid_settings_add_option(settings, &quot;audio.driver&quot;, &quot;alsa&quot;);
 #endif
@@ -233,6 +271,9 @@
 #if JACK_SUPPORT
   fluid_settings_add_option(settings, &quot;audio.driver&quot;, &quot;jack&quot;);
 #endif
+#if DART_SUPPORT
+  fluid_settings_add_option(settings, &quot;audio.driver&quot;, &quot;dart&quot;);
+#endif
 #if AUFILE_SUPPORT
   fluid_settings_add_option(settings, &quot;audio.driver&quot;, &quot;file&quot;);
 #endif

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_chan.c
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_chan.c	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_chan.c	2009-08-21 21:27:45 UTC (rev 32586)
@@ -62,6 +62,7 @@
   chan-&gt;interp_method = FLUID_INTERP_DEFAULT;
   chan-&gt;tuning = NULL;
   chan-&gt;nrpn_select = 0;
+  chan-&gt;nrpn_active = 0;
 }
 
 void
@@ -85,16 +86,20 @@
   }
 
   /* Volume / initial attenuation (MSB &amp; LSB) */
-  SETCC(chan, 7, 127);
-  SETCC(chan, 39, 0);
+  SETCC(chan, VOLUME_MSB, 127);
+  SETCC(chan, VOLUME_LSB, 0);
 
   /* Pan (MSB &amp; LSB) */
-  SETCC(chan, 10, 64);
-  SETCC(chan, 10, 64);
+  SETCC(chan, PAN_MSB, 64);
+  SETCC(chan, PAN_LSB, 0);
 
   /* Expression (MSB &amp; LSB) */
-  SETCC(chan, 11, 127);
-  SETCC(chan, 43, 127);
+  SETCC(chan, EXPRESSION_MSB, 127);
+  SETCC(chan, EXPRESSION_LSB, 127);
+
+  /* Set RPN controllers to NULL state */
+  SETCC(chan, RPN_LSB, 127);
+  SETCC(chan, RPN_MSB, 127);
 }
 
 void
@@ -241,18 +246,52 @@
     {
       int data = (value &lt;&lt; 7) + chan-&gt;cc[DATA_ENTRY_LSB];
 
-      /* SontFont 2.01 NRPN Message (Sect. 9.6, p. 74)  */
-      if ((chan-&gt;cc[NRPN_MSB] == 120) &amp;&amp; (chan-&gt;cc[NRPN_LSB] &lt; 100)) {
-	float val = fluid_gen_scale_nrpn(chan-&gt;nrpn_select, data);
-	FLUID_LOG(FLUID_WARN, &quot;%s: %d: Data = %d, value = %f&quot;, __FILE__, __LINE__, data, val);
-	fluid_synth_set_gen(chan-&gt;synth, chan-&gt;channum, chan-&gt;nrpn_select, val);
+      if (chan-&gt;nrpn_active)  /* NRPN is active? */
+      {
+	/* SontFont 2.01 NRPN Message (Sect. 9.6, p. 74)  */
+	if ((chan-&gt;cc[NRPN_MSB] == 120) &amp;&amp; (chan-&gt;cc[NRPN_LSB] &lt; 100))
+	{
+	  if (chan-&gt;nrpn_select &lt; GEN_LAST)
+	  {
+	    float val = fluid_gen_scale_nrpn(chan-&gt;nrpn_select, data);
+	    fluid_synth_set_gen(chan-&gt;synth, chan-&gt;channum, chan-&gt;nrpn_select, val);
+	  }
+
+	  chan-&gt;nrpn_select = 0;  /* Reset to 0 */
+	}
       }
+      else if (chan-&gt;cc[RPN_MSB] == 0)    /* RPN is active: MSB = 0? */
+      {
+	switch (chan-&gt;cc[RPN_LSB])
+	{
+	  case RPN_PITCH_BEND_RANGE:
+	    fluid_channel_pitch_wheel_sens (chan, value);   /* Set bend range in semitones */
+	    /* FIXME - Handle LSB? (Fine bend range in cents) */
+	    break;
+	  case RPN_CHANNEL_FINE_TUNE:   /* Fine tune is 14 bit over 1 semitone (+/- 50 cents, 8192 = center) */
+	    fluid_synth_set_gen(chan-&gt;synth, chan-&gt;channum, GEN_FINETUNE,
+				(data - 8192) / 8192.0 * 50.0);
+	    break;
+	  case RPN_CHANNEL_COARSE_TUNE: /* Coarse tune is 7 bit and in semitones (64 is center) */
+	    fluid_synth_set_gen(chan-&gt;synth, chan-&gt;channum, GEN_COARSETUNE,
+				value - 64);
+	    break;
+	  case RPN_TUNING_PROGRAM_CHANGE:
+	    break;
+	  case RPN_TUNING_BANK_SELECT:
+	    break;
+	  case RPN_MODULATION_DEPTH_RANGE:
+	    break;
+	}
+      }
+
       break;
     }
 
   case NRPN_MSB:
     chan-&gt;cc[NRPN_LSB] = 0;
     chan-&gt;nrpn_select = 0;
+    chan-&gt;nrpn_active = 1;
     break;
 
   case NRPN_LSB:
@@ -266,19 +305,15 @@
 	chan-&gt;nrpn_select += 10000;
       } else if (value &lt; 100) {
 	chan-&gt;nrpn_select += value;
-	FLUID_LOG(FLUID_WARN, &quot;%s: %d: NRPN Select = %d&quot;, __FILE__, __LINE__, chan-&gt;nrpn_select);
       }
     }
+
+    chan-&gt;nrpn_active = 1;
     break;
 
   case RPN_MSB:
-    break;
-
   case RPN_LSB:
-    /* erase any previously received NRPN message  */
-    chan-&gt;cc[NRPN_MSB] = 0;
-    chan-&gt;cc[NRPN_LSB] = 0;
-    chan-&gt;nrpn_select = 0;
+    chan-&gt;nrpn_active = 0;
     break;
 
   default:
@@ -298,6 +333,17 @@
 }
 
 /*
+ * fluid_channel_pressure
+ */
+int
+fluid_channel_pressure(fluid_channel_t* chan, int val)
+{
+  chan-&gt;channel_pressure = val;
+  fluid_synth_modulate_voices(chan-&gt;synth, chan-&gt;channum, 0, FLUID_MOD_CHANNELPRESSURE);
+  return FLUID_OK;
+}
+
+/*
  * fluid_channel_pitch_bend
  */
 int

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_chan.h
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_chan.h	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_chan.h	2009-08-21 21:27:45 UTC (rev 32586)
@@ -53,6 +53,7 @@
 
   /* NRPN system */
   short nrpn_select;
+  short nrpn_active;    /* 1 if data entry CCs are for NRPN, 0 if RPN */
 
   /* The values of the generators, set by NRPN messages, or by
    * fluid_synth_set_gen(), are cached in the channel so they can be
@@ -87,6 +88,7 @@
 int fluid_channel_set_prognum(fluid_channel_t* chan, int prognum);
 int fluid_channel_get_prognum(fluid_channel_t* chan);
 int fluid_channel_cc(fluid_channel_t* chan, int ctrl, int val);
+int fluid_channel_pressure(fluid_channel_t* chan, int val);
 int fluid_channel_pitch_bend(fluid_channel_t* chan, int val);
 int fluid_channel_pitch_wheel_sens(fluid_channel_t* chan, int val);
 int fluid_channel_get_cc(fluid_channel_t* chan, int num);

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_conv.h
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_conv.h	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_conv.h	2009-08-21 21:27:45 UTC (rev 32586)
@@ -32,7 +32,8 @@
 /* EMU 8k/10k don't follow spec in regards to volume attenuation.
  * This factor is used in the equation pow (10.0, cb / FLUID_ATTEN_POWER_FACTOR).
  * By the standard this should be -200.0. */
-#define FLUID_ATTEN_POWER_FACTOR  (-531.509)
+/* 07/11/2008 modified by S. Christian Collins for increased velocity sensitivity.  Now it equals the response of EMU10K1 programming.*/
+#define FLUID_ATTEN_POWER_FACTOR  (-200.0)	/* was (-531.509)*/
 
 void fluid_conversion_config(void);
 

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_defsfont.c
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_defsfont.c	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_defsfont.c	2009-08-21 21:27:45 UTC (rev 32586)
@@ -689,7 +689,7 @@
 	     *  page 69, 'bullet' 3 defines 'identical'.  */
 
 	    for (i = 0; i &lt; mod_list_count; i++){
-	      if (fluid_mod_test_identity(mod,mod_list[i])){
+	      if (mod_list[i] &amp;&amp; fluid_mod_test_identity(mod,mod_list[i])){
 		mod_list[i] = NULL;
 	      }
 	    }
@@ -768,7 +768,7 @@
 	  mod = preset_zone-&gt;mod;
 	  while (mod){
 	    for (i = 0; i &lt; mod_list_count; i++){
-	      if (fluid_mod_test_identity(mod,mod_list[i])){
+	      if (mod_list[i] &amp;&amp; fluid_mod_test_identity(mod,mod_list[i])){
 		mod_list[i] = NULL;
 	      }
 	    }

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_mdriver.c
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_mdriver.c	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_mdriver.c	2009-08-21 21:27:45 UTC (rev 32586)
@@ -37,6 +37,15 @@
 void fluid_alsa_seq_driver_settings(fluid_settings_t* settings);
 #endif
 
+/* JACK */
+#if JACK_SUPPORT
+void fluid_jack_midi_driver_settings (fluid_settings_t *settings);
+fluid_midi_driver_t *new_fluid_jack_midi_driver (fluid_settings_t *settings,
+						 handle_midi_event_func_t handler,
+						 void *data);
+int delete_fluid_jack_midi_driver(fluid_midi_driver_t *p);
+#endif
+
 /* OSS */
 #if OSS_SUPPORT
 fluid_midi_driver_t* new_fluid_oss_midi_driver(fluid_settings_t* settings,
@@ -52,6 +61,7 @@
 					    handle_midi_event_func_t handler,
 					    void* event_handler_data);
 int delete_fluid_winmidi_driver(fluid_midi_driver_t* p);
+void fluid_winmidi_midi_driver_settings(fluid_settings_t* settings);
 #endif
 
 /* definitions for the MidiShare driver */
@@ -62,6 +72,14 @@
 int delete_fluid_midishare_midi_driver(fluid_midi_driver_t* p);
 #endif
 
+/* definitions for the CoreMidi driver */
+#if COREMIDI_SUPPORT
+fluid_midi_driver_t* new_fluid_coremidi_driver(fluid_settings_t* settings,
+						   void* event_handler_data,
+						   handle_midi_event_func_t handler);
+int delete_fluid_coremidi_driver(fluid_midi_driver_t* p);
+void fluid_coremidi_driver_settings(fluid_settings_t* settings);
+#endif
 
 
 /*
@@ -78,6 +96,12 @@
 
 
 struct fluid_mdriver_definition_t fluid_midi_drivers[] = {
+#if JACK_SUPPORT
+  { &quot;jack&quot;,
+    new_fluid_jack_midi_driver,
+    delete_fluid_jack_midi_driver,
+    fluid_jack_midi_driver_settings },
+#endif
 #if OSS_SUPPORT
   { &quot;oss&quot;,
     new_fluid_oss_midi_driver,
@@ -98,7 +122,7 @@
   { &quot;winmidi&quot;,
     new_fluid_winmidi_driver,
     delete_fluid_winmidi_driver,
-    NULL },
+    fluid_winmidi_midi_driver_settings },
 #endif
 #if MIDISHARE_SUPPORT
   { &quot;midishare&quot;,
@@ -106,6 +130,12 @@
     delete_fluid_midishare_midi_driver,
     NULL },
 #endif
+#if COREMIDI_SUPPORT
+  { &quot;coremidi&quot;,
+    new_fluid_coremidi_driver,
+    delete_fluid_coremidi_driver,
+    fluid_coremidi_driver_settings },
+#endif
   { NULL, NULL, NULL, NULL }
 };
 
@@ -118,12 +148,16 @@
   /* Set the default driver */
 #if ALSA_SUPPORT
   fluid_settings_register_str(settings, &quot;midi.driver&quot;, &quot;alsa_seq&quot;, 0, NULL, NULL);
+#elif JACK_SUPPORT
+  fluid_settings_register_str(settings, &quot;midi.driver&quot;, &quot;jack&quot;, 0, NULL, NULL);
 #elif OSS_SUPPORT
   fluid_settings_register_str(settings, &quot;midi.driver&quot;, &quot;oss&quot;, 0, NULL, NULL);
 #elif WINMIDI_SUPPORT
   fluid_settings_register_str(settings, &quot;midi.driver&quot;, &quot;winmidi&quot;, 0, NULL, NULL);
 #elif MIDISHARE_SUPPORT
   fluid_settings_register_str(settings, &quot;midi.driver&quot;, &quot;midishare&quot;, 0, NULL, NULL);
+#elif COREMIDI_SUPPORT
+  fluid_settings_register_str(settings, &quot;midi.driver&quot;, &quot;coremidi&quot;, 0, NULL, NULL);
 #else
   fluid_settings_register_str(settings, &quot;midi.driver&quot;, &quot;&quot;, 0, NULL, NULL);
 #endif
@@ -133,6 +167,9 @@
   fluid_settings_add_option(settings, &quot;midi.driver&quot;, &quot;alsa_seq&quot;);
   fluid_settings_add_option(settings, &quot;midi.driver&quot;, &quot;alsa_raw&quot;);
 #endif
+#if JACK_SUPPORT
+  fluid_settings_add_option(settings, &quot;midi.driver&quot;, &quot;jack&quot;);
+#endif
 #if OSS_SUPPORT
   fluid_settings_add_option(settings, &quot;midi.driver&quot;, &quot;oss&quot;);
 #endif
@@ -142,6 +179,9 @@
 #if MIDISHARE_SUPPORT
   fluid_settings_add_option(settings, &quot;midi.driver&quot;, &quot;midishare&quot;);
 #endif
+#if COREMIDI_SUPPORT
+  fluid_settings_add_option(settings, &quot;midi.driver&quot;, &quot;coremidi&quot;);
+#endif
 
   for (i = 0; fluid_midi_drivers[i].name != NULL; i++) {
     if (fluid_midi_drivers[i].settings != NULL) {
@@ -168,7 +208,7 @@
       FLUID_LOG(FLUID_DBG, &quot;Using '%s' midi driver&quot;, fluid_midi_drivers[i].name);
       driver = fluid_midi_drivers[i].new(settings, handler, event_handler_data);
       if (driver) {
-	driver-&gt;name = fluid_midi_drivers[i].name;
+        driver-&gt;name = fluid_midi_drivers[i].name;
       }
       return driver;
     }

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_midi.c
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_midi.c	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_midi.c	2009-08-21 21:27:45 UTC (rev 32586)
@@ -272,6 +272,7 @@
 		return FLUID_FAILED;
 	}
 	id[4]='\0';
+	mf-&gt;dtime = 0;
 
 	while (!found_track){
 
@@ -354,7 +355,6 @@
  */
 int fluid_midi_file_read_event(fluid_midi_file* mf, fluid_track_t* track)
 {
-	int dtime;
 	int status;
 	int type;
 	int tempo;
@@ -371,7 +371,7 @@
 	if (fluid_midi_file_read_varlen(mf) != FLUID_OK) {
 		return FLUID_FAILED;
 	}
-	dtime = mf-&gt;varlen;
+	mf-&gt;dtime += mf-&gt;varlen;
 
 	/* read the status byte */
 	status = fluid_midi_file_getc(mf);
@@ -519,12 +519,13 @@
 					result = FLUID_FAILED;
 					break;
 				}
-				evt-&gt;dtime = dtime;
+				evt-&gt;dtime = mf-&gt;dtime;
 				evt-&gt;type = MIDI_SET_TEMPO;
 				evt-&gt;channel = 0;
 				evt-&gt;param1 = tempo;
 				evt-&gt;param2 = 0;
 				fluid_track_add_event(track, evt);
+				mf-&gt;dtime = 0;
 				break;
 
 			case MIDI_SMPTE_OFFSET:
@@ -642,12 +643,13 @@
 				FLUID_LOG(FLUID_ERR, &quot;Out of memory&quot;);
 				return FLUID_FAILED;
 			}
-			evt-&gt;dtime = dtime;
+			evt-&gt;dtime = mf-&gt;dtime;
 			evt-&gt;type = type;
 			evt-&gt;channel = channel;
 			evt-&gt;param1 = param1;
 			evt-&gt;param2 = param2;
 			fluid_track_add_event(track, evt);
+			mf-&gt;dtime = 0;
 		}
 	}
 	return FLUID_OK;

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_midi.h
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_midi.h	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_midi.h	2009-08-21 21:27:45 UTC (rev 32586)
@@ -146,6 +146,16 @@
   POLY_ON = 0x7F
 };
 
+/* General MIDI RPN event numbers (LSB, MSB = 0) */
+enum midi_rpn_event {
+  RPN_PITCH_BEND_RANGE = 0x00,
+  RPN_CHANNEL_FINE_TUNE = 0x01,
+  RPN_CHANNEL_COARSE_TUNE = 0x02,
+  RPN_TUNING_PROGRAM_CHANGE = 0x03,
+  RPN_TUNING_BANK_SELECT = 0x04,
+  RPN_MODULATION_DEPTH_RANGE = 0x05
+};
+
 enum midi_meta_event {
   MIDI_COPYRIGHT = 0x02,
   MIDI_TRACK_NAME = 0x03,
@@ -280,6 +290,7 @@
   int trackpos;
   int eot;
   int varlen;
+  int dtime;
 } fluid_midi_file;
 
 fluid_midi_file* new_fluid_midi_file(char* filename);

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_mod.c
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_mod.c	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_mod.c	2009-08-21 21:27:45 UTC (rev 32586)
@@ -146,12 +146,17 @@
       (mod-&gt;flags2 == (FLUID_MOD_GC | FLUID_MOD_UNIPOLAR
 		       | FLUID_MOD_POSITIVE | FLUID_MOD_SWITCH)) &amp;&amp;
       (mod-&gt;dest == GEN_FILTERFC)) {
+// S. Christian Collins' mod, to stop forcing velocity based filtering
+/*
     if (voice-&gt;vel &lt; 64){
       return (fluid_real_t) mod-&gt;amount / 2.0;
     } else {
       return (fluid_real_t) mod-&gt;amount * (127 - voice-&gt;vel) / 127;
     }
+*/
+     return 0; // (fluid_real_t) mod-&gt;amount / 2.0;
   }
+// end S. Christian Collins' mod
 
   /* get the initial value of the first source */
   if (mod-&gt;src1 &gt; 0) {
@@ -198,7 +203,7 @@
       v1 = -1.0f + 2.0f * v1 / range1;
       break;
     case 3: /* linear, bipolar, negative */
-      v1 = -1.0f + 2.0f * v1 / range1;
+      v1 = 1.0f - 2.0f * v1 / range1;
       break;
     case 4: /* concave, unipolar, positive */
       v1 = fluid_concave(v1);
@@ -219,7 +224,7 @@
       v1 = fluid_convex(127 - v1);
       break;
     case 10: /* convex, bipolar, positive */
-      v1 = (v1 &gt; 64)? -fluid_convex(2 * (v1 - 64)) : fluid_convex(2 * (64 - v1));
+      v1 = (v1 &gt; 64)? fluid_convex(2 * (v1 - 64)) : -fluid_convex(2 * (64 - v1));
       break;
     case 11: /* convex, bipolar, negative */
       v1 = (v1 &gt; 64)? -fluid_convex(2 * (v1 - 64)) : fluid_convex(2 * (64 - v1));

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_synth.c
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_synth.c	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_synth.c	2009-08-21 21:27:45 UTC (rev 32586)
@@ -112,6 +112,7 @@
   fluid_settings_register_str(settings, &quot;synth.reverb.active&quot;, &quot;yes&quot;, 0, NULL, NULL);
   fluid_settings_register_str(settings, &quot;synth.chorus.active&quot;, &quot;yes&quot;, 0, NULL, NULL);
   fluid_settings_register_str(settings, &quot;synth.ladspa.active&quot;, &quot;no&quot;, 0, NULL, NULL);
+  fluid_settings_register_str(settings, &quot;midi.portname&quot;, &quot;&quot;, 0, NULL, NULL);
 
   fluid_settings_register_int(settings, &quot;synth.polyphony&quot;,
 			     256, 16, 4096, 0, NULL, NULL);
@@ -996,10 +997,50 @@
   return FLUID_OK;
 }
 
-/*
- * fluid_synth_pitch_bend
+/**
+ * Set the MIDI channel pressure controller value.
+ * @param synth FluidSynth instance
+ * @param chan MIDI channel number
+ * @param val MIDI channel pressure value (7 bit, 0-127)
+ * @return FLUID_OK on success
+ *
+ * Assign to the MIDI channel pressure controller value on a specific MIDI channel
+ * in real time.
  */
 int
+fluid_synth_channel_pressure(fluid_synth_t* synth, int chan, int val)
+{
+
+/*   fluid_mutex_lock(synth-&gt;busy); /\* Don't interfere with the audio thread *\/ */
+/*   fluid_mutex_unlock(synth-&gt;busy); */
+
+  /* check the ranges of the arguments */
+  if ((chan &lt; 0) || (chan &gt;= synth-&gt;midi_channels)) {
+    FLUID_LOG(FLUID_WARN, &quot;Channel out of range&quot;);
+    return FLUID_FAILED;
+  }
+
+  if (synth-&gt;verbose) {
+    FLUID_LOG(FLUID_INFO, &quot;channelpressure\t%d\t%d&quot;, chan, val);
+  }
+
+  /* set the channel pressure value in the channel */
+  fluid_channel_pressure(synth-&gt;channel[chan], val);
+
+  return FLUID_OK;
+}
+
+/**
+ * Set the MIDI pitch bend controller value.
+ * @param synth FluidSynth instance
+ * @param chan MIDI channel number
+ * @param val MIDI pitch bend value (14 bit, 0-16383 with 8192 being center)
+ * @return FLUID_OK on success
+ *
+ * Assign to the MIDI pitch bend controller value on a specific MIDI channel
+ * in real time.
+ */
+int
 fluid_synth_pitch_bend(fluid_synth_t* synth, int chan, int val)
 {
 
@@ -1169,48 +1210,72 @@
   fluid_channel_t* channel;
   unsigned int banknum;
   unsigned int sfont_id;
+  int subst_bank, subst_prog;
 
-/*   fluid_mutex_lock(synth-&gt;busy); /\* Don't interfere with the audio thread *\/ */
-/*   fluid_mutex_unlock(synth-&gt;busy); */
+  if ((prognum &lt; 0) || (prognum &gt;= FLUID_NUM_PROGRAMS) ||
+      (chan &lt; 0) || (chan &gt;= synth-&gt;midi_channels))
+  {
+    FLUID_LOG(FLUID_ERR, &quot;Index out of range (chan=%d, prog=%d)&quot;, chan, prognum);
+    return FLUID_FAILED;
+  }
 
-  if ((prognum &gt;= 0) &amp;&amp; (prognum &lt; FLUID_NUM_PROGRAMS) &amp;&amp;
-      (chan &gt;= 0) &amp;&amp; (chan &lt; synth-&gt;midi_channels)) {
+  channel = synth-&gt;channel[chan];
+  banknum = fluid_channel_get_banknum(channel);
 
-    channel = synth-&gt;channel[chan];
-    banknum = fluid_channel_get_banknum(channel);
+  /* inform the channel of the new program number */
+  fluid_channel_set_prognum(channel, prognum);
 
-    /* inform the channel of the new program number */
-    fluid_channel_set_prognum(channel, prognum);
+  if (synth-&gt;verbose)
+    FLUID_LOG(FLUID_INFO, &quot;prog\t%d\t%d\t%d&quot;, chan, banknum, prognum);
 
-    if (synth-&gt;verbose) {
-      FLUID_LOG(FLUID_INFO, &quot;prog\t%d\t%d\t%d&quot;, chan, banknum, prognum);
-    }
+  /* Special handling of channel 10 (or 9 counting from 0). channel
+   * 10 is the percussion channel.
+   *
+   * FIXME - Shouldn't hard code bank selection for channel 10.  I think this
+   * is a hack for MIDI files that do bank changes in GM mode.  Proper way to
+   * handle this would probably be to ignore bank changes when in GM mode.
+   */
+  if (channel-&gt;channum == 9)
+    preset = fluid_synth_find_preset(synth, DRUM_INST_BANK, prognum);
+  else preset = fluid_synth_find_preset(synth, banknum, prognum);
 
-    /* special handling of channel 10 (or 9 counting from 0). channel
-       10 is the percussion channel.  */
-    if (channel-&gt;channum == 9) {
+  /* Fallback to another preset if not found */
+  if (!preset)
+  {
+    subst_bank = banknum;
+    subst_prog = prognum;
 
-      /* try to search the drum instrument first */
-      preset = fluid_synth_find_preset(synth, banknum | DRUM_INST_MASK, prognum);
+    /* Melodic instrument? */
+    if (channel-&gt;channum != 9 &amp;&amp; banknum != DRUM_INST_BANK)
+    {
+      subst_bank = 0;
 
-      /* if that fails try to search the melodic instrument */
-      if (preset == NULL) {
-	preset = fluid_synth_find_preset(synth, banknum, prognum);
+      /* Fallback first to bank 0:prognum */
+      preset = fluid_synth_find_preset(synth, 0, prognum);
+
+      /* Fallback to first preset in bank 0 */
+      if (!preset &amp;&amp; prognum != 0)
+      {
+	preset = fluid_synth_find_preset(synth, 0, 0);
+	subst_prog = 0;
       }
-
-    } else {
-      preset = fluid_synth_find_preset(synth, banknum, prognum);
     }
+    else /* Percussion: Fallback to preset 0 in percussion bank */
+    {
+      preset = fluid_synth_find_preset(synth, DRUM_INST_BANK, 0);
+      subst_prog = 0;
+    }
 
-    sfont_id = preset? fluid_sfont_get_id(preset-&gt;sfont) : 0;
-    fluid_channel_set_sfontnum(channel, sfont_id);
-    fluid_channel_set_preset(channel, preset);
-
-    return FLUID_OK;
+    if (preset)
+      FLUID_LOG(FLUID_WARN, &quot;Instrument not found on channel %d [bank=%d prog=%d], substituted [bank=%d prog=%d]&quot;,
+		chan, banknum, prognum, subst_bank, subst_prog); 
   }
 
-  FLUID_LOG(FLUID_ERR, &quot;Index out of range (chan=%d, prog=%d)&quot;, chan, prognum);
-  return FLUID_FAILED;
+  sfont_id = preset? fluid_sfont_get_id(preset-&gt;sfont) : 0;
+  fluid_channel_set_sfontnum(channel, sfont_id);
+  fluid_channel_set_preset(channel, preset);
+
+  return FLUID_OK;
 }
 
 /*
@@ -1562,13 +1627,11 @@
  */
 int
 fluid_synth_nwrite_float(fluid_synth_t* synth, int len,
-			float** left, float** right,
-			float** fx_left, float** fx_right)
+			 float** left, float** right,
+       float** fx_left, float** fx_right)
 {
   fluid_real_t** left_in = synth-&gt;left_buf;
   fluid_real_t** right_in = synth-&gt;right_buf;
-  fluid_real_t** fx_left_in = synth-&gt;fx_left_buf;
-  fluid_real_t** fx_right_in = synth-&gt;fx_right_buf;
   double time = fluid_utime();
   int i, num, available, count, bytes;
 
@@ -1590,10 +1653,6 @@
       FLUID_MEMCPY(left[i], left_in[i] + synth-&gt;cur, bytes);
       FLUID_MEMCPY(right[i], right_in[i] + synth-&gt;cur, bytes);
     }
-    for (i = 0; i &lt; synth-&gt;effects_channels; i++) {
-      FLUID_MEMCPY(fx_left[i], fx_left_in[i] + synth-&gt;cur, bytes);
-      FLUID_MEMCPY(fx_right[i], fx_right_in[i] + synth-&gt;cur, bytes);
-    }
     count += num;
     num += synth-&gt;cur; /* if we're now done, num becomes the new synth-&gt;cur below */
   }
@@ -1609,10 +1668,6 @@
       FLUID_MEMCPY(left[i] + count, left_in[i], bytes);
       FLUID_MEMCPY(right[i] + count, right_in[i], bytes);
     }
-    for (i = 0; i &lt; synth-&gt;effects_channels; i++) {
-      FLUID_MEMCPY(fx_left[i] + count, fx_left_in[i], bytes);
-      FLUID_MEMCPY(fx_right[i] + count, fx_right_in[i], bytes);
-    }
 
     count += num;
   }
@@ -1628,11 +1683,28 @@
   return 0;
 }
 
+
 int fluid_synth_process(fluid_synth_t* synth, int len,
 		       int nin, float** in,
 		       int nout, float** out)
 {
-  return fluid_synth_write_float(synth, len, out[0], 0, 1, out[1], 0, 1);
+  if (nout==2) {
+    return fluid_synth_write_float(synth, len, out[0], 0, 1, out[1], 0, 1);
+  }
+  else {
+    float **left, **right;
+    int i;
+    left = FLUID_ARRAY(float*, nout/2);
+    right = FLUID_ARRAY(float*, nout/2);
+    for(i=0; i&lt;nout/2; i++) {
+      left[i] = out[2*i];
+      right[i] = out[2*i+1];
+    }
+    fluid_synth_nwrite_float(synth, len, left, right, NULL, NULL);
+    FLUID_FREE(left);
+    FLUID_FREE(right);
+    return 0;
+  }
 }
 
 
@@ -3028,6 +3100,9 @@
       case PROGRAM_CHANGE:
 	return fluid_synth_program_change(synth, chan, fluid_midi_event_get_program(event));
 
+      case CHANNEL_PRESSURE:
+      return fluid_synth_channel_pressure(synth, chan, fluid_midi_event_get_program(event));
+
       case PITCH_BEND:
 	return fluid_synth_pitch_bend(synth, chan, fluid_midi_event_get_pitch(event));
 

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_synth.h
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_synth.h	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_synth.h	2009-08-21 21:27:45 UTC (rev 32586)
@@ -44,8 +44,8 @@
  *
  *                         DEFINES
  */
-#define FLUID_NUM_PROGRAMS      129
-#define DRUM_INST_MASK         ((unsigned int)0x80000000)
+#define FLUID_NUM_PROGRAMS      128
+#define DRUM_INST_BANK		128
 
 #if defined(WITH_FLOAT)
 #define FLUID_SAMPLE_FORMAT     FLUID_SAMPLE_FLOAT

Modified: haiku/trunk/src/libs/fluidsynth/src/fluid_sys.c
===================================================================
--- haiku/trunk/src/libs/fluidsynth/src/fluid_sys.c	2009-08-21 20:51:16 UTC (rev 32585)
+++ haiku/trunk/src/libs/fluidsynth/src/fluid_sys.c	2009-08-21 21:27:45 UTC (rev 32586)
@@ -635,6 +635,185 @@
 }
 
 
+
+#elif defined(__OS2__)
+/*=============================================================*/
+/*                                                             */
+/*                           OS2                               */
+/*                                                             */
+/*=============================================================*/
+
+/***************************************************************
+ *
+ *               Timer
+ *
+ */
+
+struct _fluid_timer_t
+{
+  long msec;
+  fluid_timer_callback_t callback;
+  void* data;
+  int thread_id;

[... truncated: 391 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="019744.html">[Haiku-commits] r32585 - haiku/trunk/src/preferences/devices
</A></li>
	<LI>Next message: <A HREF="019748.html">[Haiku-commits] r32587 - in haiku/trunk: headers/libs/png	src/libs/png
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#19747">[ date ]</a>
              <a href="thread.html#19747">[ thread ]</a>
              <a href="subject.html#19747">[ subject ]</a>
              <a href="author.html#19747">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
