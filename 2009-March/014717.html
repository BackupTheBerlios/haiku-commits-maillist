<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r29421	-	haiku/trunk/src/add-ons/kernel/drivers/audio/hda
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-March/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r29421%0A%09-%09haiku/trunk/src/add-ons/kernel/drivers/audio/hda&In-Reply-To=%3C20090307114748.70960%40gmx.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014715.html">
   <LINK REL="Next"  HREF="014716.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r29421	-	haiku/trunk/src/add-ons/kernel/drivers/audio/hda</H1>
    <B>Stephan Assmus</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r29421%0A%09-%09haiku/trunk/src/add-ons/kernel/drivers/audio/hda&In-Reply-To=%3C20090307114748.70960%40gmx.net%3E"
       TITLE="[Haiku-commits] r29421	-	haiku/trunk/src/add-ons/kernel/drivers/audio/hda">superstippi at gmx.de
       </A><BR>
    <I>Sat Mar  7 12:47:48 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="014715.html">[Haiku-commits] r29421 -	haiku/trunk/src/add-ons/kernel/drivers/audio/hda
</A></li>
        <LI>Next message: <A HREF="014716.html">[Haiku-commits] r29422 -	haiku/trunk/src/apps/mediaplayer/media_node_framework/audio
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14717">[ date ]</a>
              <a href="thread.html#14717">[ thread ]</a>
              <a href="subject.html#14717">[ subject ]</a>
              <a href="author.html#14717">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

&gt;<i> &gt; Author: stippi
</I>&gt;<i> &gt; Date: 2009-03-07 11:23:52 +0100 (Sat, 07 Mar 2009)
</I>&gt;<i> &gt; New Revision: 29421
</I>&gt;<i> &gt; ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=29421&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=29421&amp;view=rev</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Modified:
</I>&gt;<i> &gt;   haiku/trunk/src/add-ons/kernel/drivers/audio/hda/driver.h
</I>&gt;<i> &gt;   haiku/trunk/src/add-ons/kernel/drivers/audio/hda/hda_controller.cpp
</I>&gt;<i> &gt;   haiku/trunk/src/add-ons/kernel/drivers/audio/hda/hda_multi_audio.cpp
</I>&gt;<i> &gt; Log:
</I>&gt;<i> &gt; * Use a default buffer frame count that is adapted to the sample rate
</I>&gt;<i> &gt;  of the audio group. This is supposed to keep the latency about the same
</I>&gt;<i> &gt;  regardless of sample rate and lessen the requirements on the system
</I>&gt;<i> &gt;  performance when using higher sample rates. Currently the multi-audio
</I>&gt;<i> &gt;  addon uses the highest available rate.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> What would be the formula ?
</I>
I didn't use a specific formula, I just took the 2048 frames per buffer which were the previous hard-coded default, assumed those were good for about 48000 Hz and applied roughly the same ratio to all the other sample rates. From my tests, it seems MediaPlayer can playback smoothly at about half that buffer size, so maybe we can half those sizes to get better latency. Even better would be to get an estimate on the speed of the computer, but since I don't have a good idea how calculate that reliably, I figured most users would rather enjoy smooth audio than lowest possible latency. So I tried to play it safe.

&gt;<i> &gt; * Added TODO about the highest sample rate seemingly being forgotten in
</I>&gt;<i> &gt;   one place.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 384000 is not available in the HDA specification.
</I>
Ah, ok. Thanks for clearing that up. I saw it being used elsewhere in the driver, so I just stumbled over the mismatch.

Best regards,
-Stephan

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014715.html">[Haiku-commits] r29421 -	haiku/trunk/src/add-ons/kernel/drivers/audio/hda
</A></li>
	<LI>Next message: <A HREF="014716.html">[Haiku-commits] r29422 -	haiku/trunk/src/apps/mediaplayer/media_node_framework/audio
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14717">[ date ]</a>
              <a href="thread.html#14717">[ thread ]</a>
              <a href="subject.html#14717">[ subject ]</a>
              <a href="author.html#14717">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
