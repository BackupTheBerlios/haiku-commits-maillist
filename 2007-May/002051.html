<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r20985 - in haiku/trunk/src/libs: . compat	compat/freebsd_network compat/freebsd_network/compat	compat/freebsd_network/compat/altq compat/freebsd_network/compat/dev	compat/freebsd_network/compat/dev/mii	compat/freebsd_network/compat/dev/ofw	compat/freebsd_network/compat/dev/pci	compat/freebsd_network/compat/machine	compat/freebsd_network/compat/net compat/freebsd_network/compat/sys
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r20985%20-%20in%20haiku/trunk/src/libs%3A%20.%20compat%0A%09compat/freebsd_network%20compat/freebsd_network/compat%0A%09compat/freebsd_network/compat/altq%20compat/freebsd_network/compat/dev%0A%09compat/freebsd_network/compat/dev/mii%0A%09compat/freebsd_network/compat/dev/ofw%0A%09compat/freebsd_network/compat/dev/pci%0A%09compat/freebsd_network/compat/machine%0A%09compat/freebsd_network/compat/net%20compat/freebsd_network/compat/sys&In-Reply-To=%3C200705022311.l42NB0Xv003652%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002045.html">
   <LINK REL="Next"  HREF="002060.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r20985 - in haiku/trunk/src/libs: . compat	compat/freebsd_network compat/freebsd_network/compat	compat/freebsd_network/compat/altq compat/freebsd_network/compat/dev	compat/freebsd_network/compat/dev/mii	compat/freebsd_network/compat/dev/ofw	compat/freebsd_network/compat/dev/pci	compat/freebsd_network/compat/machine	compat/freebsd_network/compat/net compat/freebsd_network/compat/sys</H1>
    <B>hugosantos at mail.berlios.de</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r20985%20-%20in%20haiku/trunk/src/libs%3A%20.%20compat%0A%09compat/freebsd_network%20compat/freebsd_network/compat%0A%09compat/freebsd_network/compat/altq%20compat/freebsd_network/compat/dev%0A%09compat/freebsd_network/compat/dev/mii%0A%09compat/freebsd_network/compat/dev/ofw%0A%09compat/freebsd_network/compat/dev/pci%0A%09compat/freebsd_network/compat/machine%0A%09compat/freebsd_network/compat/net%20compat/freebsd_network/compat/sys&In-Reply-To=%3C200705022311.l42NB0Xv003652%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r20985 - in haiku/trunk/src/libs: . compat	compat/freebsd_network compat/freebsd_network/compat	compat/freebsd_network/compat/altq compat/freebsd_network/compat/dev	compat/freebsd_network/compat/dev/mii	compat/freebsd_network/compat/dev/ofw	compat/freebsd_network/compat/dev/pci	compat/freebsd_network/compat/machine	compat/freebsd_network/compat/net compat/freebsd_network/compat/sys">hugosantos at mail.berlios.de
       </A><BR>
    <I>Thu May  3 01:11:00 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="002045.html">[Haiku-commits] r20984 - haiku/trunk/src/servers/input
</A></li>
        <LI>Next message: <A HREF="002060.html">[Haiku-commits] r20985 - in haiku/trunk/src/libs: . compat compat/freebsd_network  compat/freebsd_network/compat compat/freebsd_network/compat/altq  compat/freebsd_network/compat/dev compat/freebsd_network/compat/dev/mii compat/freebsd_network/compat/dev/ofw compat/freebsd_network/compat/dev/pci compat/freebsd_network/compat/machine compat/freebsd_network/compat/net  compat/freebsd_network/compat/sys
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2051">[ date ]</a>
              <a href="thread.html#2051">[ thread ]</a>
              <a href="subject.html#2051">[ subject ]</a>
              <a href="author.html#2051">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: hugosantos
Date: 2007-05-03 01:10:18 +0200 (Thu, 03 May 2007)
New Revision: 20985
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=20985&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=20985&amp;view=rev</A>

Added:
   haiku/trunk/src/libs/compat/
   haiku/trunk/src/libs/compat/Jamfile
   haiku/trunk/src/libs/compat/freebsd_network/
   haiku/trunk/src/libs/compat/freebsd_network/Jamfile
   haiku/trunk/src/libs/compat/freebsd_network/README
   haiku/trunk/src/libs/compat/freebsd_network/compat.c
   haiku/trunk/src/libs/compat/freebsd_network/compat/
   haiku/trunk/src/libs/compat/freebsd_network/compat/altq/
   haiku/trunk/src/libs/compat/freebsd_network/compat/altq/if_altq.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/dev/
   haiku/trunk/src/libs/compat/freebsd_network/compat/dev/mii/
   haiku/trunk/src/libs/compat/freebsd_network/compat/dev/mii/mii.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/dev/mii/miivar.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/dev/ofw/
   haiku/trunk/src/libs/compat/freebsd_network/compat/dev/ofw/openfirm.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/dev/pci/
   haiku/trunk/src/libs/compat/freebsd_network/compat/dev/pci/pcireg.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/dev/pci/pcivar.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/machine/
   haiku/trunk/src/libs/compat/freebsd_network/compat/machine/bus.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/machine/clock.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/machine/endian.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/machine/ofw_machdep.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/machine/resource.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/miibus_if.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/net/
   haiku/trunk/src/libs/compat/freebsd_network/compat/net/bpf.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/net/ethernet.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/net/if.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/net/if_arp.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/net/if_media.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/net/if_var.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/net/if_vlan_var.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/_task.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/bus.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/bus_dma.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/callout.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/cdefs.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/endian.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/event.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/eventhandler.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/kernel.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/ktr.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/lock.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/malloc.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/mbuf.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/module.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/mutex.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/param.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/queue.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/rman.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/sockio.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/sysctl.h
   haiku/trunk/src/libs/compat/freebsd_network/compat/sys/systm.h
Modified:
   haiku/trunk/src/libs/Jamfile
Log:
initial work towards a FreeBSD network driver source level compatibility layer.


Modified: haiku/trunk/src/libs/Jamfile
===================================================================
--- haiku/trunk/src/libs/Jamfile	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/Jamfile	2007-05-02 23:10:18 UTC (rev 20985)
@@ -2,6 +2,7 @@
 
 SubInclude HAIKU_TOP src libs agg ;
 SubInclude HAIKU_TOP src libs bsd ;
+SubInclude HAIKU_TOP src libs compat ;
 SubInclude HAIKU_TOP src libs crypt ;
 SubInclude HAIKU_TOP src libs edit ;
 SubInclude HAIKU_TOP src libs expat ;

Added: haiku/trunk/src/libs/compat/Jamfile
===================================================================
--- haiku/trunk/src/libs/compat/Jamfile	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/Jamfile	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,3 @@
+SubDir HAIKU_TOP src libs compat ;
+
+SubInclude HAIKU_TOP src libs compat freebsd_network ;

Added: haiku/trunk/src/libs/compat/freebsd_network/Jamfile
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/Jamfile	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/Jamfile	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,12 @@
+SubDir HAIKU_TOP src libs compat freebsd_network ;
+
+UsePrivateHeaders kernel net ;
+
+UseHeaders [ FDirName $(SUBDIR) ] : true ;
+UseHeaders [ FDirName $(SUBDIR) headers ] : true ;
+
+SubDirCcFlags [ FDefines _KERNEL=1 ] ;
+
+Library libfreebsd_network.a :
+	compat.c
+	;

Added: haiku/trunk/src/libs/compat/freebsd_network/README
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/README	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/README	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,3 @@
+FreeBSD network driver compatability layer. Based on FreeBSD 6.2.
+
+  - Hugo, 3 May 2007

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/altq/if_altq.h
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/compat/altq/if_altq.h	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/compat/altq/if_altq.h	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,33 @@
+#ifndef _FBSD_COMPAT_ALTQ_IF_ALTQ_H_
+#define _FBSD_COMPAT_ALTQ_IF_ALTQ_H_
+
+#include &lt;sys/mbuf.h&gt;
+#include &lt;sys/mutex.h&gt;
+
+struct ifaltq {
+	struct mbuf	*	ifq_head;
+	struct mbuf *	ifq_tail;
+
+	int				ifq_len;
+	int				ifq_maxlen;
+	struct mtx		ifq_mtx;
+
+	struct mbuf *	ifq_drv_head;
+	struct mbuf *	ifq_drv_tail;
+	int				ifq_drv_len;
+	int				ifq_drv_maxlen;
+
+	int				altq_flags;
+};
+
+#define ALTQF_READY	0x1
+
+#define ALTDQ_REMOVE	1
+
+#define ALTQ_IS_ENABLED(ifq)	0
+#define ALTQ_DEQUEUE(ifr, m)	(m) = NULL
+
+#define TBR_IS_ENABLED(ifq)		0
+#define tbr_dequeue_ptr(ifq, v)	NULL
+
+#endif

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/dev/mii/mii.h
===================================================================

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/dev/mii/miivar.h
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/compat/dev/mii/miivar.h	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/compat/dev/mii/miivar.h	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,229 @@
+/*	$NetBSD: miivar.h,v 1.8 1999/04/23 04:24:32 thorpej Exp $	*/
+
+/*-
+ * Copyright (c) 1998, 1999 The NetBSD Foundation, Inc.
+ * All rights reserved.
+ *
+ * This code is derived from software contributed to The NetBSD Foundation
+ * by Jason R. Thorpe of the Numerical Aerospace Simulation Facility,
+ * NASA Ames Research Center.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the NetBSD
+ *	Foundation, Inc. and its contributors.
+ * 4. Neither the name of The NetBSD Foundation nor the names of its
+ *    contributors may be used to endorse or promote products derived
+ *    from this software without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
+ * ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
+ * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
+ * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+ * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+ * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
+ * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
+ * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
+ * POSSIBILITY OF SUCH DAMAGE.
+ *
+ * $FreeBSD: src/sys/dev/mii/miivar.h,v 1.15.14.1 2006/06/24 06:14:24 oleg Exp $
+ */
+
+#ifndef _DEV_MII_MIIVAR_H_
+#define	_DEV_MII_MIIVAR_H_
+
+#include &lt;sys/queue.h&gt;
+
+/*
+ * Media Independent Interface configuration defintions.
+ */
+
+struct mii_softc;
+
+/*
+ * Callbacks from MII layer into network interface device driver.
+ */
+typedef	int (*mii_readreg_t)(struct device *, int, int);
+typedef	void (*mii_writereg_t)(struct device *, int, int, int);
+typedef	void (*mii_statchg_t)(struct device *);
+
+/*
+ * A network interface driver has one of these structures in its softc.
+ * It is the interface from the network interface driver to the MII
+ * layer.
+ */
+struct mii_data {
+	struct ifmedia mii_media;	/* media information */
+	struct ifnet *mii_ifp;		/* pointer back to network interface */
+
+	/*
+	 * For network interfaces with multiple PHYs, a list of all
+	 * PHYs is required so they can all be notified when a media
+	 * request is made.
+	 */
+	LIST_HEAD(mii_listhead, mii_softc) mii_phys;
+	int mii_instance;
+
+	/*
+	 * PHY driver fills this in with active media status.
+	 */
+	int mii_media_status;
+	int mii_media_active;
+
+	/*
+	 * Calls from MII layer into network interface driver.
+	 */
+	mii_readreg_t mii_readreg;
+	mii_writereg_t mii_writereg;
+	mii_statchg_t mii_statchg;
+};
+typedef struct mii_data mii_data_t;
+
+/*
+ * This call is used by the MII layer to call into the PHY driver
+ * to perform a `service request'.
+ */
+typedef	int (*mii_downcall_t)(struct mii_softc *, struct mii_data *, int);
+
+/*
+ * Requests that can be made to the downcall.
+ */
+#define	MII_TICK	1	/* once-per-second tick */
+#define	MII_MEDIACHG	2	/* user changed media; perform the switch */
+#define	MII_POLLSTAT	3	/* user requested media status; fill it in */
+
+/*
+ * Each PHY driver's softc has one of these as the first member.
+ * XXX This would be better named &quot;phy_softc&quot;, but this is the name
+ * XXX BSDI used, and we would like to have the same interface.
+ */
+struct mii_softc {
+	device_t mii_dev;		/* generic device glue */
+	
+	LIST_ENTRY(mii_softc) mii_list;	/* entry on parent's PHY list */
+
+	int mii_phy;			/* our MII address */
+	int mii_inst;			/* instance for ifmedia */
+
+	mii_downcall_t mii_service;	/* our downcall */
+	struct mii_data *mii_pdata;	/* pointer to parent's mii_data */
+
+	int mii_flags;			/* misc. flags; see below */
+	int mii_capabilities;		/* capabilities from BMSR */
+	int mii_extcapabilities;	/* extended capabilities */
+	int mii_ticks;			/* MII_TICK counter */
+	int mii_anegticks;		/* ticks before retrying aneg */
+	int mii_media_active;		/* last active media */
+	int mii_media_status;		/* last active status */
+};
+typedef struct mii_softc mii_softc_t;
+
+/* mii_flags */
+#define	MIIF_INITDONE	0x0001		/* has been initialized (mii_data) */
+#define	MIIF_NOISOLATE	0x0002		/* do not isolate the PHY */
+#define	MIIF_NOLOOP	0x0004		/* no loopback capability */
+#define MIIF_AUTOTSLEEP	0x0010		/* use tsleep(), not callout() */
+#define MIIF_HAVEFIBER	0x0020		/* from parent: has fiber interface */
+#define	MIIF_HAVE_GTCR	0x0040		/* has 100base-T2/1000base-T CR */
+#define	MIIF_IS_1000X	0x0080		/* is a 1000BASE-X device */
+#define	MIIF_DOPAUSE	0x0100		/* advertise PAUSE capability */
+#define	MIIF_IS_HPNA	0x0200		/* is a HomePNA device */
+
+/* Default mii_anegticks values */
+#define	MII_ANEGTICKS		5
+#define	MII_ANEGTICKS_GIGE	17
+
+#define	MIIF_INHERIT_MASK	(MIIF_NOISOLATE|MIIF_NOLOOP|MIIF_AUTOTSLEEP)
+
+/*
+ * Used to attach a PHY to a parent.
+ */
+struct mii_attach_args {
+	struct mii_data *mii_data;	/* pointer to parent data */
+	int mii_phyno;			/* MII address */
+	int mii_id1;			/* PHY ID register 1 */
+	int mii_id2;			/* PHY ID register 2 */
+	int mii_capmask;		/* capability mask from BMSR */
+};
+typedef struct mii_attach_args mii_attach_args_t;
+
+/*
+ * Used to match a PHY.
+ */
+struct mii_phydesc {
+	u_int32_t mpd_oui;		/* the PHY's OUI */
+	u_int32_t mpd_model;		/* the PHY's model */
+	const char *mpd_name;		/* the PHY's name */
+};
+
+/*
+ * An array of these structures map MII media types to BMCR/ANAR settings.
+ */
+struct mii_media {
+	int	mm_bmcr;		/* BMCR settings for this media */
+	int	mm_anar;		/* ANAR settings for this media */
+	int	mm_gtcr;		/* 100base-T2 or 1000base-T CR */
+};
+
+#define	MII_MEDIA_NONE		0
+#define	MII_MEDIA_10_T		1
+#define	MII_MEDIA_10_T_FDX	2
+#define	MII_MEDIA_100_T4	3
+#define	MII_MEDIA_100_TX	4
+#define	MII_MEDIA_100_TX_FDX	5
+#define	MII_MEDIA_1000_X	6
+#define	MII_MEDIA_1000_X_FDX	7
+#define	MII_MEDIA_1000_T	8
+#define	MII_MEDIA_1000_T_FDX	9
+#define	MII_NMEDIA		10
+
+#ifdef _KERNEL
+
+#define PHY_READ(p, r) \
+	MIIBUS_READREG((p)-&gt;mii_dev, (p)-&gt;mii_phy, (r))
+
+#define PHY_WRITE(p, r, v) \
+	MIIBUS_WRITEREG((p)-&gt;mii_dev, (p)-&gt;mii_phy, (r), (v))
+
+extern devclass_t	miibus_devclass;
+extern driver_t		miibus_driver;
+
+int	miibus_probe(device_t);
+int	miibus_attach(device_t);
+int	miibus_detach(device_t);
+
+int	mii_anar(int);
+void	mii_down(struct mii_data *);
+int	mii_mediachg(struct mii_data *);
+void	mii_tick(struct mii_data *);
+void	mii_pollstat(struct mii_data *);
+int	mii_phy_probe(device_t, device_t *, ifm_change_cb_t, ifm_stat_cb_t);
+void	mii_add_media(struct mii_softc *);
+void	mii_phy_add_media(struct mii_softc *);
+
+int	mii_media_from_bmcr(int);
+
+int	mii_phy_auto(struct mii_softc *);
+int	mii_phy_detach(device_t dev);
+void	mii_phy_down(struct mii_softc *);
+void	mii_phy_reset(struct mii_softc *);
+void	mii_phy_setmedia(struct mii_softc *sc);
+void	mii_phy_update(struct mii_softc *, int);
+int	mii_phy_tick(struct mii_softc *);
+
+const struct mii_phydesc * mii_phy_match(const struct mii_attach_args *ma, const struct mii_phydesc *mpd);
+
+void	ukphy_status(struct mii_softc *);
+#endif /* _KERNEL */
+
+#endif /* _DEV_MII_MIIVAR_H_ */

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/dev/ofw/openfirm.h
===================================================================

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/dev/pci/pcireg.h
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/compat/dev/pci/pcireg.h	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/compat/dev/pci/pcireg.h	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,14 @@
+#ifndef _FBSD_COMPAT_DEV_PCI_PCIREG_H_
+#define _FBSD_COMPAT_DEV_PCI_PCIREG_H_
+
+#define PCIR_COMMAND	0x04
+#define PCIR_REVID		0x08
+#define PCIR_CACHELNSZ	0x0c
+#define PCIR_SUBVEND_0	0x2c
+#define PCIR_SUBDEV_0	0x2e
+
+#define PCIM_CMD_PORTEN		0x0001
+#define PCIM_CMD_MEMEN		0x0002
+#define PCIM_CMD_MWRICEN	0x0010
+
+#endif

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/dev/pci/pcivar.h
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/compat/dev/pci/pcivar.h	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/compat/dev/pci/pcivar.h	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,21 @@
+#ifndef _FBSD_COMPAT_DEV_PCI_PCIVAR_H_
+#define _FBSD_COMPAT_DEV_PCI_PCIVAR_H_
+
+#include &lt;sys/bus.h&gt;
+
+int pci_enable_busmaster(device_t dev);
+
+uint32_t pci_get_devid(device_t dev);
+void pci_set_intpin(device_t dev, uint8_t pin);
+uint8_t pci_get_intpin(device_t dev);
+
+uint16_t pci_get_vendor(device_t dev);
+uint16_t pci_get_device(device_t dev);
+uint16_t pci_get_subvendor(device_t dev);
+uint16_t pci_get_subdevice(device_t dev);
+uint8_t pci_get_revid(device_t dev);
+
+uint32_t pci_read_config(device_t dev, int reg, int width);
+void pci_write_config(device_t dev, int reg, uint32_t val, int width);
+
+#endif

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/machine/bus.h
===================================================================

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/machine/clock.h
===================================================================

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/machine/endian.h
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/compat/machine/endian.h	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/compat/machine/endian.h	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,4 @@
+#ifndef _FBSD_COMPAT_MACHINE_ENDIAN_H_
+#define _FBSD_COMPAT_MACHINE_ENDIAN_H_
+
+#endif

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/machine/ofw_machdep.h
===================================================================

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/machine/resource.h
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/compat/machine/resource.h	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/compat/machine/resource.h	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,9 @@
+#ifndef _FBSD_COMPAT_MACHINE_RESOURCE_H_
+#define _FBSD_COMPAT_MACHINE_RESOURCE_H_
+
+#define SYS_RES_IRQ		0x1
+#define SYS_RES_DRQ		0x2
+#define SYS_RES_MEMORY	0x3
+#define SYS_RES_IOPORT	0x4
+
+#endif

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/miibus_if.h
===================================================================

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/net/bpf.h
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/compat/net/bpf.h	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/compat/net/bpf.h	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,7 @@
+#ifndef _FBSD_COMPAT_NET_BPF_H_
+#define _FBSD_COMPAT_NET_BPF_H_
+
+#define bpf_mtap(bpf_if, mbuf) do { } while (0)
+#define BPF_MTAP(ifp, m) do { } while (0)
+
+#endif

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/net/ethernet.h
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/compat/net/ethernet.h	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/compat/net/ethernet.h	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,382 @@
+/*
+ * Fundamental constants relating to ethernet.
+ *
+ * $FreeBSD: src/sys/net/ethernet.h,v 1.24 2004/10/05 19:28:52 sam Exp $
+ *
+ */
+
+#ifndef _NET_ETHERNET_H_
+#define _NET_ETHERNET_H_
+
+/*
+ * Somce basic Ethernet constants.
+ */
+#define	ETHER_ADDR_LEN		6	/* length of an Ethernet address */
+#define	ETHER_TYPE_LEN		2	/* length of the Ethernet type field */
+#define	ETHER_CRC_LEN		4	/* length of the Ethernet CRC */
+#define	ETHER_HDR_LEN		(ETHER_ADDR_LEN*2+ETHER_TYPE_LEN)
+#define	ETHER_MIN_LEN		64	/* minimum frame len, including CRC */
+#define	ETHER_MAX_LEN		1518	/* maximum frame len, including CRC */
+#define	ETHER_MAX_LEN_JUMBO	9018	/* max jumbo frame len, including CRC */
+
+#define	ETHER_VLAN_ENCAP_LEN	4	/* len of 802.1Q VLAN encapsulation */
+/*
+ * Mbuf adjust factor to force 32-bit alignment of IP header.
+ * Drivers should do m_adj(m, ETHER_ALIGN) when setting up a
+ * receive so the upper layers get the IP header properly aligned
+ * past the 14-byte Ethernet header.
+ */
+#define	ETHER_ALIGN		2	/* driver adjust for IP hdr alignment */
+
+/*
+ * Compute the maximum frame size based on ethertype (i.e. possible
+ * encapsulation) and whether or not an FCS is present.
+ */
+#define	ETHER_MAX_FRAME(ifp, etype, hasfcs)				\
+	((ifp)-&gt;if_mtu + ETHER_HDR_LEN +				\
+	 ((hasfcs) ? ETHER_CRC_LEN : 0) +				\
+	 (((etype) == ETHERTYPE_VLAN) ? ETHER_VLAN_ENCAP_LEN : 0))
+
+/*
+ * Ethernet-specific mbuf flags.
+ */
+#define	M_HASFCS	M_PROTO5	/* FCS included at end of frame */
+
+/*
+ * Ethernet CRC32 polynomials (big- and little-endian verions).
+ */
+#define	ETHER_CRC_POLY_LE	0xedb88320
+#define	ETHER_CRC_POLY_BE	0x04c11db6
+
+/*
+ * A macro to validate a length with
+ */
+#define	ETHER_IS_VALID_LEN(foo)	\
+	((foo) &gt;= ETHER_MIN_LEN &amp;&amp; (foo) &lt;= ETHER_MAX_LEN)
+
+/*
+ * Structure of a 10Mb/s Ethernet header.
+ */
+struct	ether_header {
+	u_char	ether_dhost[ETHER_ADDR_LEN];
+	u_char	ether_shost[ETHER_ADDR_LEN];
+	u_short	ether_type;
+};
+
+/*
+ * Structure of a 48-bit Ethernet address.
+ */
+struct	ether_addr {
+	u_char octet[ETHER_ADDR_LEN];
+};
+
+#define	ETHER_IS_MULTICAST(addr) (*(addr) &amp; 0x01) /* is address mcast/bcast? */
+
+/*
+ *  NOTE: 0x0000-0x05DC (0..1500) are generally IEEE 802.3 length fields.
+ *  However, there are some conflicts.
+ */
+
+#define	ETHERTYPE_8023		0x0004	/* IEEE 802.3 packet */
+		   /* 0x0101 .. 0x1FF	   Experimental */
+#define	ETHERTYPE_PUP		0x0200	/* Xerox PUP protocol - see 0A00 */
+#define	ETHERTYPE_PUPAT		0x0200	/* PUP Address Translation - see 0A01 */
+#define	ETHERTYPE_SPRITE	0x0500	/* ??? */
+			     /* 0x0400	   Nixdorf */
+#define	ETHERTYPE_NS		0x0600	/* XNS */
+#define	ETHERTYPE_NSAT		0x0601	/* XNS Address Translation (3Mb only) */
+#define	ETHERTYPE_DLOG1 	0x0660	/* DLOG (?) */
+#define	ETHERTYPE_DLOG2 	0x0661	/* DLOG (?) */
+#define	ETHERTYPE_IP		0x0800	/* IP protocol */
+#define	ETHERTYPE_X75		0x0801	/* X.75 Internet */
+#define	ETHERTYPE_NBS		0x0802	/* NBS Internet */
+#define	ETHERTYPE_ECMA		0x0803	/* ECMA Internet */
+#define	ETHERTYPE_CHAOS 	0x0804	/* CHAOSnet */
+#define	ETHERTYPE_X25		0x0805	/* X.25 Level 3 */
+#define	ETHERTYPE_ARP		0x0806	/* Address resolution protocol */
+#define	ETHERTYPE_NSCOMPAT	0x0807	/* XNS Compatibility */
+#define	ETHERTYPE_FRARP 	0x0808	/* Frame Relay ARP (RFC1701) */
+			     /* 0x081C	   Symbolics Private */
+		    /* 0x0888 - 0x088A	   Xyplex */
+#define	ETHERTYPE_UBDEBUG	0x0900	/* Ungermann-Bass network debugger */
+#define	ETHERTYPE_IEEEPUP	0x0A00	/* Xerox IEEE802.3 PUP */
+#define	ETHERTYPE_IEEEPUPAT	0x0A01	/* Xerox IEEE802.3 PUP Address Translation */
+#define	ETHERTYPE_VINES 	0x0BAD	/* Banyan VINES */
+#define	ETHERTYPE_VINESLOOP	0x0BAE	/* Banyan VINES Loopback */
+#define	ETHERTYPE_VINESECHO	0x0BAF	/* Banyan VINES Echo */
+
+/*		       0x1000 - 0x100F	   Berkeley Trailer */
+/*
+ * The ETHERTYPE_NTRAILER packet types starting at ETHERTYPE_TRAIL have
+ * (type-ETHERTYPE_TRAIL)*512 bytes of data followed
+ * by an ETHER type (as given above) and then the (variable-length) header.
+ */
+#define	ETHERTYPE_TRAIL		0x1000	/* Trailer packet */
+#define	ETHERTYPE_NTRAILER	16
+
+#define	ETHERTYPE_DCA		0x1234	/* DCA - Multicast */
+#define	ETHERTYPE_VALID 	0x1600	/* VALID system protocol */
+#define	ETHERTYPE_DOGFIGHT	0x1989	/* Artificial Horizons (&quot;Aviator&quot; dogfight simulator [on Sun]) */
+#define	ETHERTYPE_RCL		0x1995	/* Datapoint Corporation (RCL lan protocol) */
+
+					/* The following 3C0x types
+					   are unregistered: */
+#define	ETHERTYPE_NBPVCD	0x3C00	/* 3Com NBP virtual circuit datagram (like XNS SPP) not registered */
+#define	ETHERTYPE_NBPSCD	0x3C01	/* 3Com NBP System control datagram not registered */
+#define	ETHERTYPE_NBPCREQ	0x3C02	/* 3Com NBP Connect request (virtual cct) not registered */
+#define	ETHERTYPE_NBPCRSP	0x3C03	/* 3Com NBP Connect repsonse not registered */
+#define	ETHERTYPE_NBPCC		0x3C04	/* 3Com NBP Connect complete not registered */
+#define	ETHERTYPE_NBPCLREQ	0x3C05	/* 3Com NBP Close request (virtual cct) not registered */
+#define	ETHERTYPE_NBPCLRSP	0x3C06	/* 3Com NBP Close response not registered */
+#define	ETHERTYPE_NBPDG		0x3C07	/* 3Com NBP Datagram (like XNS IDP) not registered */
+#define	ETHERTYPE_NBPDGB	0x3C08	/* 3Com NBP Datagram broadcast not registered */
+#define	ETHERTYPE_NBPCLAIM	0x3C09	/* 3Com NBP Claim NetBIOS name not registered */
+#define	ETHERTYPE_NBPDLTE	0x3C0A	/* 3Com NBP Delete Netbios name not registered */
+#define	ETHERTYPE_NBPRAS	0x3C0B	/* 3Com NBP Remote adaptor status request not registered */
+#define	ETHERTYPE_NBPRAR	0x3C0C	/* 3Com NBP Remote adaptor response not registered */
+#define	ETHERTYPE_NBPRST	0x3C0D	/* 3Com NBP Reset not registered */
+
+#define	ETHERTYPE_PCS		0x4242	/* PCS Basic Block Protocol */
+#define	ETHERTYPE_IMLBLDIAG	0x424C	/* Information Modes Little Big LAN diagnostic */
+#define	ETHERTYPE_DIDDLE	0x4321	/* THD - Diddle */
+#define	ETHERTYPE_IMLBL		0x4C42	/* Information Modes Little Big LAN */
+#define	ETHERTYPE_SIMNET	0x5208	/* BBN Simnet Private */
+#define	ETHERTYPE_DECEXPER	0x6000	/* DEC Unassigned, experimental */
+#define	ETHERTYPE_MOPDL		0x6001	/* DEC MOP dump/load */
+#define	ETHERTYPE_MOPRC		0x6002	/* DEC MOP remote console */
+#define	ETHERTYPE_DECnet	0x6003	/* DEC DECNET Phase IV route */
+#define	ETHERTYPE_DN		ETHERTYPE_DECnet	/* libpcap, tcpdump */
+#define	ETHERTYPE_LAT		0x6004	/* DEC LAT */
+#define	ETHERTYPE_DECDIAG	0x6005	/* DEC diagnostic protocol (at interface initialization?) */
+#define	ETHERTYPE_DECCUST	0x6006	/* DEC customer protocol */
+#define	ETHERTYPE_SCA		0x6007	/* DEC LAVC, SCA */
+#define	ETHERTYPE_AMBER		0x6008	/* DEC AMBER */
+#define	ETHERTYPE_DECMUMPS	0x6009	/* DEC MUMPS */
+		    /* 0x6010 - 0x6014	   3Com Corporation */
+#define	ETHERTYPE_TRANSETHER	0x6558	/* Trans Ether Bridging (RFC1701)*/
+#define	ETHERTYPE_RAWFR		0x6559	/* Raw Frame Relay (RFC1701) */
+#define	ETHERTYPE_UBDL		0x7000	/* Ungermann-Bass download */
+#define	ETHERTYPE_UBNIU		0x7001	/* Ungermann-Bass NIUs */
+#define	ETHERTYPE_UBDIAGLOOP	0x7002	/* Ungermann-Bass diagnostic/loopback */
+#define	ETHERTYPE_UBNMC		0x7003	/* Ungermann-Bass ??? (NMC to/from UB Bridge) */
+#define	ETHERTYPE_UBBST		0x7005	/* Ungermann-Bass Bridge Spanning Tree */
+#define	ETHERTYPE_OS9		0x7007	/* OS/9 Microware */
+#define	ETHERTYPE_OS9NET	0x7009	/* OS/9 Net? */
+		    /* 0x7020 - 0x7029	   LRT (England) (now Sintrom) */
+#define	ETHERTYPE_RACAL		0x7030	/* Racal-Interlan */
+#define	ETHERTYPE_PRIMENTS	0x7031	/* Prime NTS (Network Terminal Service) */
+#define	ETHERTYPE_CABLETRON	0x7034	/* Cabletron */
+#define	ETHERTYPE_CRONUSVLN	0x8003	/* Cronus VLN */
+#define	ETHERTYPE_CRONUS	0x8004	/* Cronus Direct */
+#define	ETHERTYPE_HP		0x8005	/* HP Probe */
+#define	ETHERTYPE_NESTAR	0x8006	/* Nestar */
+#define	ETHERTYPE_ATTSTANFORD	0x8008	/* AT&amp;T/Stanford (local use) */
+#define	ETHERTYPE_EXCELAN	0x8010	/* Excelan */
+#define	ETHERTYPE_SG_DIAG	0x8013	/* SGI diagnostic type */
+#define	ETHERTYPE_SG_NETGAMES	0x8014	/* SGI network games */
+#define	ETHERTYPE_SG_RESV	0x8015	/* SGI reserved type */
+#define	ETHERTYPE_SG_BOUNCE	0x8016	/* SGI bounce server */
+#define	ETHERTYPE_APOLLODOMAIN	0x8019	/* Apollo DOMAIN */
+#define	ETHERTYPE_TYMSHARE	0x802E	/* Tymeshare */
+#define	ETHERTYPE_TIGAN		0x802F	/* Tigan, Inc. */
+#define	ETHERTYPE_REVARP	0x8035	/* Reverse addr resolution protocol */
+#define	ETHERTYPE_AEONIC	0x8036	/* Aeonic Systems */
+#define	ETHERTYPE_IPXNEW	0x8037	/* IPX (Novell Netware?) */
+#define	ETHERTYPE_LANBRIDGE	0x8038	/* DEC LANBridge */
+#define	ETHERTYPE_DSMD	0x8039	/* DEC DSM/DDP */
+#define	ETHERTYPE_ARGONAUT	0x803A	/* DEC Argonaut Console */
+#define	ETHERTYPE_VAXELN	0x803B	/* DEC VAXELN */
+#define	ETHERTYPE_DECDNS	0x803C	/* DEC DNS Naming Service */
+#define	ETHERTYPE_ENCRYPT	0x803D	/* DEC Ethernet Encryption */
+#define	ETHERTYPE_DECDTS	0x803E	/* DEC Distributed Time Service */
+#define	ETHERTYPE_DECLTM	0x803F	/* DEC LAN Traffic Monitor */
+#define	ETHERTYPE_DECNETBIOS	0x8040	/* DEC PATHWORKS DECnet NETBIOS Emulation */
+#define	ETHERTYPE_DECLAST	0x8041	/* DEC Local Area System Transport */
+			     /* 0x8042	   DEC Unassigned */
+#define	ETHERTYPE_PLANNING	0x8044	/* Planning Research Corp. */
+		    /* 0x8046 - 0x8047	   AT&amp;T */
+#define	ETHERTYPE_DECAM		0x8048	/* DEC Availability Manager for Distributed Systems DECamds (but someone at DEC says not) */
+#define	ETHERTYPE_EXPERDATA	0x8049	/* ExperData */
+#define	ETHERTYPE_VEXP		0x805B	/* Stanford V Kernel exp. */
+#define	ETHERTYPE_VPROD		0x805C	/* Stanford V Kernel prod. */
+#define	ETHERTYPE_ES		0x805D	/* Evans &amp; Sutherland */
+#define	ETHERTYPE_LITTLE	0x8060	/* Little Machines */
+#define	ETHERTYPE_COUNTERPOINT	0x8062	/* Counterpoint Computers */
+		    /* 0x8065 - 0x8066	   Univ. of Mass @ Amherst */
+#define	ETHERTYPE_VEECO		0x8067	/* Veeco Integrated Auto. */
+#define	ETHERTYPE_GENDYN	0x8068	/* General Dynamics */
+#define	ETHERTYPE_ATT		0x8069	/* AT&amp;T */
+#define	ETHERTYPE_AUTOPHON	0x806A	/* Autophon */
+#define	ETHERTYPE_COMDESIGN	0x806C	/* ComDesign */
+#define	ETHERTYPE_COMPUGRAPHIC	0x806D	/* Compugraphic Corporation */
+		    /* 0x806E - 0x8077	   Landmark Graphics Corp. */
+#define	ETHERTYPE_MATRA		0x807A	/* Matra */
+#define	ETHERTYPE_DDE		0x807B	/* Dansk Data Elektronik */
+#define	ETHERTYPE_MERIT		0x807C	/* Merit Internodal (or Univ of Michigan?) */
+		    /* 0x807D - 0x807F	   Vitalink Communications */
+#define	ETHERTYPE_VLTLMAN	0x8080	/* Vitalink TransLAN III Management */
+		    /* 0x8081 - 0x8083	   Counterpoint Computers */
+		    /* 0x8088 - 0x808A	   Xyplex */
+#define	ETHERTYPE_ATALK		0x809B	/* AppleTalk */
+#define	ETHERTYPE_AT		ETHERTYPE_ATALK		/* old NetBSD */
+#define	ETHERTYPE_APPLETALK	ETHERTYPE_ATALK		/* HP-UX */
+		    /* 0x809C - 0x809E	   Datability */
+#define	ETHERTYPE_SPIDER	0x809F	/* Spider Systems Ltd. */
+			     /* 0x80A3	   Nixdorf */
+		    /* 0x80A4 - 0x80B3	   Siemens Gammasonics Inc. */
+		    /* 0x80C0 - 0x80C3	   DCA (Digital Comm. Assoc.) Data Exchange Cluster */
+		    /* 0x80C4 - 0x80C5	   Banyan Systems */
+#define	ETHERTYPE_PACER		0x80C6	/* Pacer Software */
+#define	ETHERTYPE_APPLITEK	0x80C7	/* Applitek Corporation */
+		    /* 0x80C8 - 0x80CC	   Intergraph Corporation */
+		    /* 0x80CD - 0x80CE	   Harris Corporation */
+		    /* 0x80CF - 0x80D2	   Taylor Instrument */
+		    /* 0x80D3 - 0x80D4	   Rosemount Corporation */
+#define	ETHERTYPE_SNA		0x80D5	/* IBM SNA Services over Ethernet */
+#define	ETHERTYPE_VARIAN	0x80DD	/* Varian Associates */
+		    /* 0x80DE - 0x80DF	   TRFS (Integrated Solutions Transparent Remote File System) */
+		    /* 0x80E0 - 0x80E3	   Allen-Bradley */
+		    /* 0x80E4 - 0x80F0	   Datability */
+#define	ETHERTYPE_RETIX		0x80F2	/* Retix */
+#define	ETHERTYPE_AARP		0x80F3	/* AppleTalk AARP */
+		    /* 0x80F4 - 0x80F5	   Kinetics */
+#define	ETHERTYPE_APOLLO	0x80F7	/* Apollo Computer */
+#define ETHERTYPE_VLAN		0x8100	/* IEEE 802.1Q VLAN tagging (XXX conflicts) */
+		    /* 0x80FF - 0x8101	   Wellfleet Communications (XXX conflicts) */
+#define	ETHERTYPE_BOFL		0x8102	/* Wellfleet; BOFL (Breath OF Life) pkts [every 5-10 secs.] */
+#define	ETHERTYPE_WELLFLEET	0x8103	/* Wellfleet Communications */
+		    /* 0x8107 - 0x8109	   Symbolics Private */
+#define	ETHERTYPE_TALARIS	0x812B	/* Talaris */
+#define	ETHERTYPE_WATERLOO	0x8130	/* Waterloo Microsystems Inc. (XXX which?) */
+#define	ETHERTYPE_HAYES		0x8130	/* Hayes Microcomputers (XXX which?) */
+#define	ETHERTYPE_VGLAB		0x8131	/* VG Laboratory Systems */
+		    /* 0x8132 - 0x8137	   Bridge Communications */
+#define	ETHERTYPE_IPX		0x8137	/* Novell (old) NetWare IPX (ECONFIG E option) */
+#define	ETHERTYPE_NOVELL	0x8138	/* Novell, Inc. */
+		    /* 0x8139 - 0x813D	   KTI */
+#define	ETHERTYPE_MUMPS		0x813F	/* M/MUMPS data sharing */
+#define	ETHERTYPE_AMOEBA	0x8145	/* Vrije Universiteit (NL) Amoeba 4 RPC (obsolete) */
+#define	ETHERTYPE_FLIP		0x8146	/* Vrije Universiteit (NL) FLIP (Fast Local Internet Protocol) */
+#define	ETHERTYPE_VURESERVED	0x8147	/* Vrije Universiteit (NL) [reserved] */
+#define	ETHERTYPE_LOGICRAFT	0x8148	/* Logicraft */
+#define	ETHERTYPE_NCD		0x8149	/* Network Computing Devices */
+#define	ETHERTYPE_ALPHA		0x814A	/* Alpha Micro */
+#define	ETHERTYPE_SNMP		0x814C	/* SNMP over Ethernet (see RFC1089) */
+		    /* 0x814D - 0x814E	   BIIN */
+#define	ETHERTYPE_TEC	0x814F	/* Technically Elite Concepts */
+#define	ETHERTYPE_RATIONAL	0x8150	/* Rational Corp */
+		    /* 0x8151 - 0x8153	   Qualcomm */
+		    /* 0x815C - 0x815E	   Computer Protocol Pty Ltd */
+		    /* 0x8164 - 0x8166	   Charles River Data Systems */
+#define	ETHERTYPE_XTP		0x817D	/* Protocol Engines XTP */
+#define	ETHERTYPE_SGITW		0x817E	/* SGI/Time Warner prop. */
+#define	ETHERTYPE_HIPPI_FP	0x8180	/* HIPPI-FP encapsulation */
+#define	ETHERTYPE_STP		0x8181	/* Scheduled Transfer STP, HIPPI-ST */
+		    /* 0x8182 - 0x8183	   Reserved for HIPPI-6400 */
+		    /* 0x8184 - 0x818C	   SGI prop. */
+#define	ETHERTYPE_MOTOROLA	0x818D	/* Motorola */
+#define	ETHERTYPE_NETBEUI	0x8191	/* PowerLAN NetBIOS/NetBEUI (PC) */
+		    /* 0x819A - 0x81A3	   RAD Network Devices */
+		    /* 0x81B7 - 0x81B9	   Xyplex */
+		    /* 0x81CC - 0x81D5	   Apricot Computers */
+		    /* 0x81D6 - 0x81DD	   Artisoft Lantastic */
+		    /* 0x81E6 - 0x81EF	   Polygon */
+		    /* 0x81F0 - 0x81F2	   Comsat Labs */
+		    /* 0x81F3 - 0x81F5	   SAIC */
+		    /* 0x81F6 - 0x81F8	   VG Analytical */
+		    /* 0x8203 - 0x8205	   QNX Software Systems Ltd. */
+		    /* 0x8221 - 0x8222	   Ascom Banking Systems */
+		    /* 0x823E - 0x8240	   Advanced Encryption Systems */
+		    /* 0x8263 - 0x826A	   Charles River Data Systems */
+		    /* 0x827F - 0x8282	   Athena Programming */
+		    /* 0x829A - 0x829B	   Inst Ind Info Tech */
+		    /* 0x829C - 0x82AB	   Taurus Controls */
+		    /* 0x82AC - 0x8693	   Walker Richer &amp; Quinn */
+#define	ETHERTYPE_ACCTON	0x8390	/* Accton Technologies (unregistered) */
+#define	ETHERTYPE_TALARISMC	0x852B	/* Talaris multicast */
+#define	ETHERTYPE_KALPANA	0x8582	/* Kalpana */
+		    /* 0x8694 - 0x869D	   Idea Courier */
+		    /* 0x869E - 0x86A1	   Computer Network Tech */
+		    /* 0x86A3 - 0x86AC	   Gateway Communications */
+#define	ETHERTYPE_SECTRA	0x86DB	/* SECTRA */
+#define	ETHERTYPE_IPV6		0x86DD	/* IP protocol version 6 */
+#define	ETHERTYPE_DELTACON	0x86DE	/* Delta Controls */
+#define	ETHERTYPE_ATOMIC	0x86DF	/* ATOMIC */
+		    /* 0x86E0 - 0x86EF	   Landis &amp; Gyr Powers */
+		    /* 0x8700 - 0x8710	   Motorola */
+#define	ETHERTYPE_RDP		0x8739	/* Control Technology Inc. RDP Without IP */
+#define	ETHERTYPE_MICP		0x873A	/* Control Technology Inc. Mcast Industrial Ctrl Proto. */
+		    /* 0x873B - 0x873C	   Control Technology Inc. Proprietary */
+#define	ETHERTYPE_TCPCOMP	0x876B	/* TCP/IP Compression (RFC1701) */
+#define	ETHERTYPE_IPAS		0x876C	/* IP Autonomous Systems (RFC1701) */
+#define	ETHERTYPE_SECUREDATA	0x876D	/* Secure Data (RFC1701) */
+#define	ETHERTYPE_FLOWCONTROL	0x8808	/* 802.3x flow control packet */
+#define	ETHERTYPE_PPP		0x880B	/* PPP (obsolete by PPPOE) */
+#define	ETHERTYPE_HITACHI	0x8820	/* Hitachi Cable (Optoelectronic Systems Laboratory) */
+#define	ETHERTYPE_MPLS		0x8847	/* MPLS Unicast */
+#define	ETHERTYPE_MPLS_MCAST	0x8848	/* MPLS Multicast */
+#define	ETHERTYPE_AXIS		0x8856	/* Axis Communications AB proprietary bootstrap/config */
+#define	ETHERTYPE_PPPOEDISC	0x8863	/* PPP Over Ethernet Discovery Stage */
+#define	ETHERTYPE_PPPOE		0x8864	/* PPP Over Ethernet Session Stage */
+#define	ETHERTYPE_LANPROBE	0x8888	/* HP LanProbe test? */
+#define	ETHERTYPE_PAE		0x888e	/* EAPOL PAE/802.1x */
+#define	ETHERTYPE_LOOPBACK	0x9000	/* Loopback: used to test interfaces */
+#define	ETHERTYPE_LBACK		ETHERTYPE_LOOPBACK	/* DEC MOP loopback */
+#define	ETHERTYPE_XNSSM		0x9001	/* 3Com (Formerly Bridge Communications), XNS Systems Management */
+#define	ETHERTYPE_TCPSM		0x9002	/* 3Com (Formerly Bridge Communications), TCP/IP Systems Management */
+#define	ETHERTYPE_BCLOOP	0x9003	/* 3Com (Formerly Bridge Communications), loopback detection */
+#define	ETHERTYPE_DEBNI		0xAAAA	/* DECNET? Used by VAX 6220 DEBNI */
+#define	ETHERTYPE_SONIX		0xFAF5	/* Sonix Arpeggio */
+#define	ETHERTYPE_VITAL		0xFF00	/* BBN VITAL-LanBridge cache wakeups */
+		    /* 0xFF00 - 0xFFOF	   ISC Bunker Ramo */
+
+#define	ETHERTYPE_MAX		0xFFFF	/* Maximum valid ethernet type, reserved */
+
+/*
+ * The ETHERTYPE_NTRAILER packet types starting at ETHERTYPE_TRAIL have
+ * (type-ETHERTYPE_TRAIL)*512 bytes of data followed
+ * by an ETHER type (as given above) and then the (variable-length) header.
+ */
+#define	ETHERTYPE_TRAIL		0x1000		/* Trailer packet */
+#define	ETHERTYPE_NTRAILER	16
+
+#define	ETHERMTU	(ETHER_MAX_LEN-ETHER_HDR_LEN-ETHER_CRC_LEN)
+#define	ETHERMIN	(ETHER_MIN_LEN-ETHER_HDR_LEN-ETHER_CRC_LEN)
+#define	ETHERMTU_JUMBO	(ETHER_MAX_LEN_JUMBO - ETHER_HDR_LEN - ETHER_CRC_LEN)
+
+#ifdef _KERNEL
+
+struct ifnet;
+struct mbuf;
+struct rtentry;
+struct sockaddr;
+
+extern	uint32_t ether_crc32_le(const uint8_t *, size_t);
+extern	uint32_t ether_crc32_be(const uint8_t *, size_t);
+extern	void ether_demux(struct ifnet *, struct mbuf *);
+extern	void ether_ifattach(struct ifnet *, const u_int8_t *);
+extern	void ether_ifdetach(struct ifnet *);
+extern	int  ether_ioctl(struct ifnet *, int, caddr_t);
+extern	int  ether_output(struct ifnet *,
+		   struct mbuf *, struct sockaddr *, struct rtentry *);
+extern	int  ether_output_frame(struct ifnet *, struct mbuf *);
+extern	char *ether_sprintf(const u_int8_t *);
+
+#else /* _KERNEL */
+
+#include &lt;sys/cdefs.h&gt;
+
+/*
+ * Ethernet address conversion/parsing routines.
+ */
+__BEGIN_DECLS
+struct	ether_addr *ether_aton(const char *);
+int	ether_hostton(const char *, struct ether_addr *);
+int	ether_line(const char *, struct ether_addr *, char *);
+char 	*ether_ntoa(const struct ether_addr *);
+int	ether_ntohost(char *, const struct ether_addr *);
+__END_DECLS
+
+#endif /* !_KERNEL */
+
+#endif /* !_NET_ETHERNET_H_ */

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/net/if.h
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/compat/net/if.h	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/compat/net/if.h	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,73 @@
+#ifndef _FBSD_COMPAT_NET_IF_H_
+#define _FBSD_COMPAT_NET_IF_H_
+
+#include &lt;posix/net/if.h&gt;
+
+#include &lt;sys/time.h&gt; /* for timeval */
+
+
+/* Capabilities that interfaces can advertise. */
+#define IFCAP_RXCSUM		0x0001  /* can offload checksum on RX */
+#define IFCAP_TXCSUM		0x0002  /* can offload checksum on TX */
+#define IFCAP_NETCONS		0x0004  /* can be a network console */
+#define	IFCAP_VLAN_MTU		0x0008	/* VLAN-compatible MTU */
+#define	IFCAP_VLAN_HWTAGGING	0x0010	/* hardware VLAN tag support */
+#define	IFCAP_JUMBO_MTU		0x0020	/* 9000 byte MTU supported */
+#define	IFCAP_POLLING		0x0040	/* driver supports polling */
+
+#define IFCAP_HWCSUM		(IFCAP_RXCSUM | IFCAP_TXCSUM)
+
+
+#define IFF_DRV_RUNNING		0x10000
+#define IFF_DRV_OACTIVE		0x20000
+#define IFF_LINK0			0x40000
+
+
+struct ifmediareq {
+	char	ifm_name[IFNAMSIZ];	/* if name, e.g. &quot;en0&quot; */
+	int	ifm_current;		/* current media options */
+	int	ifm_mask;		/* don't care mask */
+	int	ifm_status;		/* media status */
+	int	ifm_active;		/* active options */
+	int	ifm_count;		/* # entries in ifm_ulist array */
+	int	*ifm_ulist;		/* media words */
+};
+
+/*
+ * Structure describing information about an interface
+ * which may be of interest to management entities.
+ */
+struct if_data {
+	/* generic interface information */
+	u_char	ifi_type;		/* ethernet, tokenring, etc */
+	u_char	ifi_physical;		/* e.g., AUI, Thinnet, 10base-T, etc */
+	u_char	ifi_addrlen;		/* media address length */
+	u_char	ifi_hdrlen;		/* media header length */
+	u_char	ifi_link_state;		/* current link state */
+	u_char	ifi_recvquota;		/* polling quota for receive intrs */
+	u_char	ifi_xmitquota;		/* polling quota for xmit intrs */
+	u_char	ifi_datalen;		/* length of this data struct */
+	u_long	ifi_mtu;		/* maximum transmission unit */
+	u_long	ifi_metric;		/* routing metric (external only) */
+	u_long	ifi_baudrate;		/* linespeed */
+	/* volatile statistics */
+	u_long	ifi_ipackets;		/* packets received on interface */
+	u_long	ifi_ierrors;		/* input errors on interface */
+	u_long	ifi_opackets;		/* packets sent on interface */
+	u_long	ifi_oerrors;		/* output errors on interface */
+	u_long	ifi_collisions;		/* collisions on csma interfaces */
+	u_long	ifi_ibytes;		/* total number of octets received */
+	u_long	ifi_obytes;		/* total number of octets sent */
+	u_long	ifi_imcasts;		/* packets received via multicast */
+	u_long	ifi_omcasts;		/* packets sent via multicast */
+	u_long	ifi_iqdrops;		/* dropped on input, this interface */
+	u_long	ifi_noproto;		/* destined for unsupported protocol */
+	u_long	ifi_hwassist;		/* HW offload capabilities */
+	time_t	ifi_epoch;		/* uptime at attach or stat reset */
+#ifdef __alpha__
+	u_int	ifi_timepad;		/* time_t is int, not long on alpha */
+#endif
+	struct	timeval ifi_lastchange;	/* time of last administrative change */
+};
+
+#endif

Added: haiku/trunk/src/libs/compat/freebsd_network/compat/net/if_arp.h
===================================================================
--- haiku/trunk/src/libs/compat/freebsd_network/compat/net/if_arp.h	2007-05-02 19:05:57 UTC (rev 20984)
+++ haiku/trunk/src/libs/compat/freebsd_network/compat/net/if_arp.h	2007-05-02 23:10:18 UTC (rev 20985)
@@ -0,0 +1,115 @@
+/*-
+ * Copyright (c) 1986, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)if_arp.h	8.1 (Berkeley) 6/10/93
+ * $FreeBSD: src/sys/net/if_arp.h,v 1.22 2005/06/10 16:49:18 brooks Exp $
+ */
+
+#ifndef _NET_IF_ARP_H_
+#define	_NET_IF_ARP_H_
+
+/*
+ * Address Resolution Protocol.
+ *
+ * See RFC 826 for protocol description.  ARP packets are variable
+ * in size; the arphdr structure defines the fixed-length portion.
+ * Protocol type values are the same as those for 10 Mb/s Ethernet.
+ * It is followed by the variable-sized fields ar_sha, arp_spa,
+ * arp_tha and arp_tpa in that order, according to the lengths
+ * specified.  Field names used correspond to RFC 826.
+ */
+struct	arphdr {
+	u_short	ar_hrd;		/* format of hardware address */
+#define ARPHRD_ETHER 	1	/* ethernet hardware format */
+#define ARPHRD_IEEE802	6	/* token-ring hardware format */
+#define ARPHRD_ARCNET	7	/* arcnet hardware format */
+#define ARPHRD_FRELAY 	15	/* frame relay hardware format */
+#define ARPHRD_IEEE1394	24	/* firewire hardware format */
+	u_short	ar_pro;		/* format of protocol address */
+	u_char	ar_hln;		/* length of hardware address */
+	u_char	ar_pln;		/* length of protocol address */
+	u_short	ar_op;		/* one of: */
+#define	ARPOP_REQUEST	1	/* request to resolve address */
+#define	ARPOP_REPLY	2	/* response to previous request */
+#define	ARPOP_REVREQUEST 3	/* request protocol address given hardware */
+#define	ARPOP_REVREPLY	4	/* response giving protocol address */
+#define ARPOP_INVREQUEST 8 	/* request to identify peer */
+#define ARPOP_INVREPLY	9	/* response identifying peer */
+/*
+ * The remaining fields are variable in size,
+ * according to the sizes above.
+ */
+#ifdef COMMENT_ONLY
+	u_char	ar_sha[];	/* sender hardware address */
+	u_char	ar_spa[];	/* sender protocol address */
+	u_char	ar_tha[];	/* target hardware address */
+	u_char	ar_tpa[];	/* target protocol address */
+#endif
+};
+
+#define ar_sha(ap)	(((caddr_t)((ap)+1)) +   0)
+#define ar_spa(ap)	(((caddr_t)((ap)+1)) +   (ap)-&gt;ar_hln)
+#define ar_tha(ap)	(((caddr_t)((ap)+1)) +   (ap)-&gt;ar_hln + (ap)-&gt;ar_pln)
+#define ar_tpa(ap)	(((caddr_t)((ap)+1)) + 2*(ap)-&gt;ar_hln + (ap)-&gt;ar_pln)
+
+#define arphdr_len2(ar_hln, ar_pln)					\
+	(sizeof(struct arphdr) + 2*(ar_hln) + 2*(ar_pln))
+#define arphdr_len(ap)	(arphdr_len2((ap)-&gt;ar_hln, (ap)-&gt;ar_pln))
+
+/*
+ * ARP ioctl request
+ */
+struct arpreq {
+	struct	sockaddr arp_pa;		/* protocol address */
+	struct	sockaddr arp_ha;		/* hardware address */
+	int	arp_flags;			/* flags */
+};
+/*  arp_flags and at_flags field values */
+#define	ATF_INUSE	0x01	/* entry in use */
+#define ATF_COM		0x02	/* completed entry (enaddr valid) */
+#define	ATF_PERM	0x04	/* permanent entry */
+#define	ATF_PUBL	0x08	/* publish entry (respond for other host) */
+#define	ATF_USETRAILERS	0x10	/* has requested trailers */
+
+#ifdef _KERNEL
+/*
+ * Structure shared between the ethernet driver modules and
+ * the address resolution code.

[... truncated: 3603 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002045.html">[Haiku-commits] r20984 - haiku/trunk/src/servers/input
</A></li>
	<LI>Next message: <A HREF="002060.html">[Haiku-commits] r20985 - in haiku/trunk/src/libs: . compat compat/freebsd_network  compat/freebsd_network/compat compat/freebsd_network/compat/altq  compat/freebsd_network/compat/dev compat/freebsd_network/compat/dev/mii compat/freebsd_network/compat/dev/ofw compat/freebsd_network/compat/dev/pci compat/freebsd_network/compat/machine compat/freebsd_network/compat/net  compat/freebsd_network/compat/sys
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2051">[ date ]</a>
              <a href="thread.html#2051">[ thread ]</a>
              <a href="subject.html#2051">[ subject ]</a>
              <a href="author.html#2051">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
