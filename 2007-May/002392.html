<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r21209 - in haiku/trunk/src/add-ons/translators: .	hpgs hpgs/lib
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r21209%20-%20in%20haiku/trunk/src/add-ons/translators%3A%20.%0A%09hpgs%20hpgs/lib&In-Reply-To=%3C200705222233.l4MMX8DY023542%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002388.html">
   <LINK REL="Next"  HREF="002394.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r21209 - in haiku/trunk/src/add-ons/translators: .	hpgs hpgs/lib</H1>
    <B>korli at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r21209%20-%20in%20haiku/trunk/src/add-ons/translators%3A%20.%0A%09hpgs%20hpgs/lib&In-Reply-To=%3C200705222233.l4MMX8DY023542%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r21209 - in haiku/trunk/src/add-ons/translators: .	hpgs hpgs/lib">korli at mail.berlios.de
       </A><BR>
    <I>Wed May 23 00:33:08 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="002388.html">[Haiku-commits] r21208 - haiku/trunk/docs/user/support
</A></li>
        <LI>Next message: <A HREF="002394.html">[Haiku-commits] r21210 - in haiku/trunk: headers/private/net	src/add-ons/kernel/network/datalink_protocols/arp	src/add-ons/kernel/network/datalink_protocols/ethernet_frame	src/add-ons/kernel/network/devices/loopback	src/add-ons/kernel/network/protocols/icmp	src/add-ons/kernel/network/protocols/ipv4	src/add-ons/kernel/network/protocols/tcp	src/add-ons/kernel/network/protocols/udp	src/add-ons/kernel/network/stack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2392">[ date ]</a>
              <a href="thread.html#2392">[ thread ]</a>
              <a href="subject.html#2392">[ subject ]</a>
              <a href="author.html#2392">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: korli
Date: 2007-05-23 00:32:50 +0200 (Wed, 23 May 2007)
New Revision: 21209
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=21209&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=21209&amp;view=rev</A>

Added:
   haiku/trunk/src/add-ons/translators/hpgs/
   haiku/trunk/src/add-ons/translators/hpgs/ConfigView.cpp
   haiku/trunk/src/add-ons/translators/hpgs/ConfigView.h
   haiku/trunk/src/add-ons/translators/hpgs/HPGSTranslator.cpp
   haiku/trunk/src/add-ons/translators/hpgs/HPGSTranslator.h
   haiku/trunk/src/add-ons/translators/hpgs/Jamfile
   haiku/trunk/src/add-ons/translators/hpgs/ReadHelper.h
   haiku/trunk/src/add-ons/translators/hpgs/lib/
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgs.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgs.h
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsbase.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsbbox.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsbezier.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgscharacter.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsdevices.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsdevices.h
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsfont.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsfont.h
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsglobal.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsgstate.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsi18n.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsi18n.h
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsimage.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsimage.h
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsimagerop.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsistream.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgslabel.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgslexer.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsmatrix.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsmkrop.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsmutex.h
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsostream.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgspaint.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgspaint.h
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgspaintimage.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgspaintpath.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgspath.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgspcl.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgspe.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgspen.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgspjl.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsplugin.h
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsreader.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsreader.h
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsrop.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgsscanline.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgssetup.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgstransform.c
   haiku/trunk/src/add-ons/translators/hpgs/lib/hpgszostream.c
Modified:
   haiku/trunk/src/add-ons/translators/Jamfile
Log:
added a translator for HPGL/2 files based on HPGS. It handles .hp2 files
This builds only with GCC 4, mostly because the code is C99 compliant only


Modified: haiku/trunk/src/add-ons/translators/Jamfile
===================================================================
--- haiku/trunk/src/add-ons/translators/Jamfile	2007-05-22 16:50:08 UTC (rev 21208)
+++ haiku/trunk/src/add-ons/translators/Jamfile	2007-05-22 22:32:50 UTC (rev 21209)
@@ -2,6 +2,7 @@
 
 SubInclude HAIKU_TOP src add-ons translators bmp ;
 SubInclude HAIKU_TOP src add-ons translators gif ;
+SubInclude HAIKU_TOP src add-ons translators hpgs ;
 SubInclude HAIKU_TOP src add-ons translators ico ;
 SubInclude HAIKU_TOP src add-ons translators jpeg ;
 SubInclude HAIKU_TOP src add-ons translators jpeg2000 ;

Added: haiku/trunk/src/add-ons/translators/hpgs/ConfigView.cpp
===================================================================
--- haiku/trunk/src/add-ons/translators/hpgs/ConfigView.cpp	2007-05-22 16:50:08 UTC (rev 21208)
+++ haiku/trunk/src/add-ons/translators/hpgs/ConfigView.cpp	2007-05-22 22:32:50 UTC (rev 21209)
@@ -0,0 +1,67 @@
+/*
+ * Copyright 2007, J&#233;r&#244;me Duval. All rights reserved.
+ * Copyright 2005-2007, Axel D&#246;rfler, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">axeld at pinc-software.de.</A> All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+
+
+#include &quot;ConfigView.h&quot;
+#include &quot;HPGSTranslator.h&quot;
+
+#include &lt;StringView.h&gt;
+#include &lt;CheckBox.h&gt;
+
+#include &lt;stdio.h&gt;
+#include &lt;string.h&gt;
+
+
+ConfigView::ConfigView(const BRect &amp;frame, uint32 resize, uint32 flags)
+	: BView(frame, &quot;HPGSTranslator Settings&quot;, resize, flags)
+{
+	SetViewColor(ui_color(B_PANEL_BACKGROUND_COLOR));
+
+	font_height fontHeight;
+	be_bold_font-&gt;GetHeight(&amp;fontHeight);
+	float height = fontHeight.descent + fontHeight.ascent + fontHeight.leading;
+
+	BRect rect(10, 10, 200, 10 + height);
+	BStringView *stringView = new BStringView(rect, &quot;title&quot;, &quot;HPGS Images&quot;);
+	stringView-&gt;SetFont(be_bold_font);
+	stringView-&gt;ResizeToPreferred();
+	AddChild(stringView);
+
+	rect.OffsetBy(0, height + 10);
+	char version[256];
+	sprintf(version, &quot;Version %d.%d.%d, %s&quot;,
+		int(B_TRANSLATION_MAJOR_VERSION(HPGS_TRANSLATOR_VERSION)),
+		int(B_TRANSLATION_MINOR_VERSION(HPGS_TRANSLATOR_VERSION)),
+		int(B_TRANSLATION_REVISION_VERSION(HPGS_TRANSLATOR_VERSION)),
+		__DATE__);
+	stringView = new BStringView(rect, &quot;version&quot;, version);
+	stringView-&gt;ResizeToPreferred();
+	AddChild(stringView);
+
+	GetFontHeight(&amp;fontHeight);
+	height = fontHeight.descent + fontHeight.ascent + fontHeight.leading;
+
+	rect.OffsetBy(0, height + 5);
+	stringView = new BStringView(rect, &quot;copyright&quot;, B_UTF8_COPYRIGHT &quot;2007 Haiku Inc.&quot;);
+	stringView-&gt;ResizeToPreferred();
+	AddChild(stringView);
+
+	rect.OffsetBy(0, height + 10);
+	stringView = new BStringView(rect, &quot;copyright2&quot;, &quot;Based on HPGS (<A HREF="http://hpgs.berlios.de">http://hpgs.berlios.de</A>)&quot;);
+	stringView-&gt;ResizeToPreferred();
+	AddChild(stringView);
+
+	rect.OffsetBy(0, height + 5);
+	stringView = new BStringView(rect, &quot;copyright3&quot;, B_UTF8_COPYRIGHT &quot;2004-2006 ev-i Informationstechnologie GmbH&quot;);
+	stringView-&gt;ResizeToPreferred();
+	AddChild(stringView);
+}
+
+
+ConfigView::~ConfigView()
+{
+}
+

Added: haiku/trunk/src/add-ons/translators/hpgs/ConfigView.h
===================================================================
--- haiku/trunk/src/add-ons/translators/hpgs/ConfigView.h	2007-05-22 16:50:08 UTC (rev 21208)
+++ haiku/trunk/src/add-ons/translators/hpgs/ConfigView.h	2007-05-22 22:32:50 UTC (rev 21209)
@@ -0,0 +1,19 @@
+/*
+ * Copyright 2004-2007, Axel D&#246;rfler, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">axeld at pinc-software.de.</A> All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef CONFIG_VIEW_H
+#define CONFIG_VIEW_H
+
+
+#include &lt;View.h&gt;
+
+
+class ConfigView : public BView {
+	public:
+		ConfigView(const BRect &amp;frame, uint32 resize = B_FOLLOW_ALL,
+			uint32 flags = B_WILL_DRAW);	
+		virtual ~ConfigView();
+};
+
+#endif	/* CONFIG_VIEW_H */

Added: haiku/trunk/src/add-ons/translators/hpgs/HPGSTranslator.cpp
===================================================================
--- haiku/trunk/src/add-ons/translators/hpgs/HPGSTranslator.cpp	2007-05-22 16:50:08 UTC (rev 21208)
+++ haiku/trunk/src/add-ons/translators/hpgs/HPGSTranslator.cpp	2007-05-22 22:32:50 UTC (rev 21209)
@@ -0,0 +1,277 @@
+/*
+ * Copyright 2007, J&#233;r&#244;me Duval. All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+
+
+#include &quot;HPGSTranslator.h&quot;
+#include &quot;ConfigView.h&quot;
+#include &quot;ReadHelper.h&quot;
+
+#include &quot;hpgsimage.h&quot;
+
+#include &lt;Messenger.h&gt;
+#include &lt;TranslatorRoster.h&gt;
+
+#include &lt;stdlib.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;string.h&gt;
+
+typedef struct my_hpgs_png_image_st {
+	hpgs_png_image image;
+	BPositionIO *target;
+} my_hpgs_png_image;
+
+
+int 
+my_pim_write(hpgs_image *_this, const char *filename)
+{
+	BPositionIO* target = ((my_hpgs_png_image *)_this)-&gt;target;
+	unsigned char *row;
+	int stride, depth;
+	_this-&gt;vtable-&gt;get_data(_this, &amp;row, &amp;stride, &amp;depth);
+	for (int i = 0; i&lt; _this-&gt;height; ++i) {
+		ssize_t bytesWritten = target-&gt;Write(row, stride);
+		if (bytesWritten &lt; B_OK)
+			return bytesWritten;
+		row += stride;
+	}
+
+	return 0;
+}
+
+
+// The input formats that this translator supports.
+translation_format sInputFormats[] = {
+	{
+		HPGS_IMAGE_FORMAT,
+		B_TRANSLATOR_BITMAP,
+		HPGS_IN_QUALITY,
+		HPGS_IN_CAPABILITY,
+		&quot;vector/x-hpgl2&quot;,
+		&quot;HP-GL/2&quot;
+	},
+};
+
+// The output formats that this translator supports.
+translation_format sOutputFormats[] = {
+	{
+		B_TRANSLATOR_BITMAP,
+		B_TRANSLATOR_BITMAP,
+		BITS_OUT_QUALITY,
+		BITS_OUT_CAPABILITY,
+		&quot;x-be-bitmap&quot;,
+		&quot;Be Bitmap image&quot;
+	},
+};
+
+// Default settings for the Translator
+static TranSetting sDefaultSettings[] = {
+	{B_TRANSLATOR_EXT_HEADER_ONLY, TRAN_SETTING_BOOL, false},
+	{B_TRANSLATOR_EXT_DATA_ONLY, TRAN_SETTING_BOOL, false}
+};
+
+const uint32 kNumInputFormats = sizeof(sInputFormats) / sizeof(translation_format);
+const uint32 kNumOutputFormats = sizeof(sOutputFormats) / sizeof(translation_format);
+const uint32 kNumDefaultSettings = sizeof(sDefaultSettings) / sizeof(TranSetting);
+
+
+//	#pragma mark -
+
+
+HPGSTranslator::HPGSTranslator()
+	: BaseTranslator(&quot;HPGS Images&quot;, &quot;HPGS Image Translator&quot;,
+		HPGS_TRANSLATOR_VERSION,
+		sInputFormats, kNumInputFormats,
+		sOutputFormats, kNumOutputFormats,
+		&quot;HPGSTranslator_Settings&quot;,
+		sDefaultSettings, kNumDefaultSettings,
+		B_TRANSLATOR_BITMAP, HPGS_IMAGE_FORMAT)
+{
+	hpgs_init(&quot;/usr/local&quot;);
+}
+
+
+HPGSTranslator::~HPGSTranslator()
+{
+	hpgs_cleanup();
+}
+
+
+status_t
+HPGSTranslator::DerivedIdentify(BPositionIO *stream,
+	const translation_format *format, BMessage *settings,
+	translator_info *info, uint32 outType)
+{
+	if (!outType)
+		outType = B_TRANSLATOR_BITMAP;
+	if (outType != B_TRANSLATOR_BITMAP)
+		return B_NO_TRANSLATOR;
+
+	hpgs_istream *istream = hpgs_new_wrapper_istream(stream);
+	
+	status_t err = B_OK;
+	int verbosity = 1;
+	hpgs_bool multipage = HPGS_FALSE;
+	hpgs_bool ignore_ps = HPGS_FALSE;
+	hpgs_bool do_linewidth = HPGS_TRUE;
+	hpgs_device *size_dev = (hpgs_device *)hpgs_new_plotsize_device(ignore_ps, do_linewidth);
+	hpgs_reader *reader = hpgs_new_reader(istream, size_dev, multipage, verbosity);
+	if (hpgs_read(reader, HPGS_FALSE) == B_OK) {
+		info-&gt;type = HPGS_IMAGE_FORMAT;
+		info-&gt;group = B_TRANSLATOR_BITMAP;
+		info-&gt;quality = HPGS_IN_QUALITY;
+		info-&gt;capability = HPGS_IN_CAPABILITY;
+		snprintf(info-&gt;name, sizeof(info-&gt;name), &quot;HPGS image&quot;);
+		strcpy(info-&gt;MIME, &quot;vector/x-hpgl2&quot;);
+	} else
+		err = B_NO_TRANSLATOR;
+	
+	free(reader);
+	free(size_dev);
+	free(istream-&gt;stream);
+	free(istream);
+
+	return err;
+}
+
+
+status_t
+HPGSTranslator::DerivedTranslate(BPositionIO* source,
+	const translator_info* info, BMessage* settings,
+	uint32 outType, BPositionIO* target, int32 baseType)
+{
+	if (!outType)
+		outType = B_TRANSLATOR_BITMAP;
+	if (outType != B_TRANSLATOR_BITMAP || baseType != 0)
+		return B_NO_TRANSLATOR;
+
+	status_t err = B_OK;
+	hpgs_istream *istream = hpgs_new_wrapper_istream(source);
+		
+	TranslatorBitmap header;
+	ssize_t bytesWritten;
+	uint32 dataSize;
+	
+	double paper_angle = 180.0;
+	double paper_border = 0.0;
+	double paper_width = 0.0;
+	double paper_height = 0.0;
+	int verbosity = 0;
+	int depth = 32;
+	int palette = 0;
+	hpgs_bool multipage = HPGS_FALSE;
+	hpgs_bool ignore_ps = HPGS_FALSE;
+	hpgs_bool do_linewidth = HPGS_TRUE;
+	hpgs_bool do_rop3 = HPGS_TRUE;
+	hpgs_bool antialias = HPGS_FALSE;
+	int image_interpolation = 0;
+	double thin_alpha = 0.25;
+	hpgs_device *size_dev = 0;
+	hpgs_bbox bbox = { 0.0, 0.0, 0.0, 0.0 };
+	hpgs_image *image;
+	hpgs_paint_device *pdv;
+	hpgs_device *plot_dev;
+
+	size_dev = (hpgs_device *)hpgs_new_plotsize_device(ignore_ps, do_linewidth);
+	hpgs_reader *reader = hpgs_new_reader(istream, size_dev, multipage, verbosity);
+	if (hpgs_read(reader, HPGS_FALSE)) {
+		fprintf(stderr, &quot;no hpgs\n&quot;);
+		err = B_NO_TRANSLATOR;
+		goto err1;
+	}
+
+	if (hpgs_getplotsize(size_dev,1,&amp;bbox)&lt;0) {
+		fprintf(stderr, &quot;no hpgs\n&quot;);
+		err = B_NO_TRANSLATOR;
+		goto err1;
+	}
+
+	// set the appropriate page placement.
+	if (paper_width &gt; 0.0 &amp;&amp; paper_height &gt; 0.0) {
+		hpgs_reader_set_fixed_page(reader,&amp;bbox,
+			paper_width, paper_height, paper_border, paper_angle);
+	} else {
+		paper_width = 200.0 * 72.0;
+		paper_height = 200.0 * 72.0;
+		hpgs_reader_set_dynamic_page(reader,&amp;bbox,
+			paper_width, paper_height, paper_border, paper_angle);
+	}
+
+	image = (hpgs_image*)hpgs_new_png_image((int)bbox.urx, (int)bbox.ury, depth, palette, do_rop3);
+	image-&gt;vtable-&gt;write = &amp;my_pim_write;
+	image = (hpgs_image *)realloc(image, sizeof(my_hpgs_png_image));
+	((my_hpgs_png_image *)image)-&gt;target = target;
+	
+	pdv = hpgs_new_paint_device(image, NULL, &amp;bbox, antialias);
+	hpgs_paint_device_set_image_interpolation(pdv, image_interpolation);
+	hpgs_paint_device_set_thin_alpha(pdv, thin_alpha);
+
+	plot_dev = (hpgs_device *)pdv;
+	if (hpgs_reader_imbue(reader, plot_dev)) {
+		fprintf(stderr, hpgs_i18n(&quot;Error: Cannot imbue plot device to reader: %s\n&quot;),
+			hpgs_get_error());
+		err = B_NO_TRANSLATOR;
+		goto err2;
+	}
+
+	dataSize = (int)bbox.urx * 4 * (int)bbox.ury;
+
+	header.magic = B_TRANSLATOR_BITMAP;
+	header.bounds.Set(0, 0, (int)bbox.urx - 1, bbox.ury - 1);
+	header.rowBytes = (int)bbox.urx * 4;
+	header.colors = B_RGBA32;
+	header.dataSize = dataSize;
+
+	// write out Be's Bitmap header
+	swap_data(B_UINT32_TYPE, &amp;header, sizeof(TranslatorBitmap),
+		B_SWAP_HOST_TO_BENDIAN);
+	bytesWritten = target-&gt;Write(&amp;header, sizeof(TranslatorBitmap));
+	if (bytesWritten &lt; B_OK) {
+		fprintf(stderr, &quot;Write error %s\n&quot;, strerror(bytesWritten));
+		err = bytesWritten;
+		goto err2;
+	}
+
+	if ((size_t)bytesWritten != sizeof(TranslatorBitmap)) {
+		fprintf(stderr, &quot;TranslatorBitmap\n&quot;);
+		err = B_IO_ERROR;
+	}
+
+	if (err == B_OK &amp;&amp; hpgs_read(reader, HPGS_FALSE)) {
+		fprintf(stderr, hpgs_i18n(&quot;Error: Cannot process plot data %s\n&quot;), hpgs_get_error());
+		err = B_NO_TRANSLATOR;
+	}
+
+err2:
+	free(pdv);
+	free(image);
+
+err1:
+	free(reader);
+	free(size_dev);
+	free(istream-&gt;stream);
+	free(istream);
+	return err;
+}
+
+
+BView *
+HPGSTranslator::NewConfigView(TranslatorSettings *settings)
+{
+	return new ConfigView(BRect(0, 0, 225, 175));
+}
+
+
+//	#pragma mark -
+
+
+BTranslator *
+make_nth_translator(int32 n, image_id you, uint32 flags, ...)
+{
+	if (n != 0)
+		return NULL;
+
+	return new HPGSTranslator();
+}
+

Added: haiku/trunk/src/add-ons/translators/hpgs/HPGSTranslator.h
===================================================================
--- haiku/trunk/src/add-ons/translators/hpgs/HPGSTranslator.h	2007-05-22 16:50:08 UTC (rev 21208)
+++ haiku/trunk/src/add-ons/translators/hpgs/HPGSTranslator.h	2007-05-22 22:32:50 UTC (rev 21209)
@@ -0,0 +1,53 @@
+/*
+ * Copyright 2007, J&#233;r&#244;me Duval. All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef HPGS_TRANSLATOR_H
+#define HPGS_TRANSLATOR_H
+
+
+#include &quot;BaseTranslator.h&quot;
+
+#include &lt;Translator.h&gt;
+#include &lt;TranslatorFormats.h&gt;
+#include &lt;TranslationDefs.h&gt;
+#include &lt;GraphicsDefs.h&gt;
+#include &lt;InterfaceDefs.h&gt;
+#include &lt;DataIO.h&gt;
+#include &lt;File.h&gt;
+#include &lt;ByteOrder.h&gt;
+
+
+#define HPGS_TRANSLATOR_VERSION B_TRANSLATION_MAKE_VERSION(0, 1, 0)
+#define HPGS_IMAGE_FORMAT	'HPGI'
+
+#define HPGS_IN_QUALITY		0.90
+#define HPGS_IN_CAPABILITY	0.90
+#define BITS_IN_QUALITY		1
+#define BITS_IN_CAPABILITY	1
+
+#define HPGS_OUT_QUALITY		0.8
+#define HPGS_OUT_CAPABILITY	0.8
+#define BITS_OUT_QUALITY	1
+#define BITS_OUT_CAPABILITY	0.9
+
+
+class HPGSTranslator : public BaseTranslator {
+	public:
+		HPGSTranslator();
+		virtual ~HPGSTranslator();
+
+		virtual status_t DerivedIdentify(BPositionIO *inSource,
+			const translation_format *inFormat, BMessage *ioExtension,
+			translator_info *outInfo, uint32 outType);
+
+		virtual status_t DerivedTranslate(BPositionIO *inSource,
+			const translator_info *inInfo, BMessage *ioExtension,
+			uint32 outType, BPositionIO *outDestination, int32 baseType);
+
+		virtual BView *NewConfigView(TranslatorSettings *settings);
+
+	private:
+};
+
+#endif	// HPGS_TRANSLATOR_H

Added: haiku/trunk/src/add-ons/translators/hpgs/Jamfile
===================================================================
--- haiku/trunk/src/add-ons/translators/hpgs/Jamfile	2007-05-22 16:50:08 UTC (rev 21208)
+++ haiku/trunk/src/add-ons/translators/hpgs/Jamfile	2007-05-22 22:32:50 UTC (rev 21209)
@@ -0,0 +1,59 @@
+SubDir HAIKU_TOP src add-ons translators hpgs ;
+
+SubDirSysHdrs [ FDirName $(SUBDIR) lib ] ;
+SubDirCcFlags -DHPGS_SHARED -std=c99 ;
+UseLibraryHeaders zlib png ;
+
+# Include code from shared translator directory
+SEARCH_SOURCE += [ FDirName $(HAIKU_TOP) src add-ons translators shared ] ;
+
+local sources = 
+hpgsbase.c
+hpgsbbox.c
+hpgsbezier.c
+hpgs.c
+hpgscharacter.c
+hpgsdevices.c
+hpgsfont.c
+hpgsglobal.c
+hpgsgstate.c
+hpgsi18n.c
+hpgsimage.c
+hpgsimagerop.c
+hpgsistream.c
+hpgslabel.c
+hpgslexer.c
+hpgsmatrix.c
+hpgsostream.c
+hpgspaint.c
+hpgspaintimage.c
+hpgspaintpath.c
+hpgspath.c
+hpgspcl.c
+hpgspe.c
+hpgspen.c
+hpgspjl.c
+hpgsreader.c
+hpgsrop.c
+hpgsscanline.c
+hpgssetup.c
+hpgstransform.c
+hpgszostream.c
+;
+
+Translator HPGSTranslator :
+	# HPGSTranslator classes
+	ConfigView.cpp
+	HPGSTranslator.cpp
+	$(sources)
+
+	# shared classes
+	BaseTranslator.cpp
+	TranslatorSettings.cpp
+	TranslatorWindow.cpp
+
+	: be translation libpng.so libtextencoding.so libz.so
+	: true
+;
+
+SEARCH on [ FGristFiles $(sources) ] = [ FDirName $(SUBDIR) lib ] ;

Added: haiku/trunk/src/add-ons/translators/hpgs/ReadHelper.h
===================================================================
--- haiku/trunk/src/add-ons/translators/hpgs/ReadHelper.h	2007-05-22 16:50:08 UTC (rev 21208)
+++ haiku/trunk/src/add-ons/translators/hpgs/ReadHelper.h	2007-05-22 22:32:50 UTC (rev 21209)
@@ -0,0 +1,127 @@
+/*
+ * Copyright 2007, J&#233;r&#244;me Duval. All rights reserved.
+ * Distributed under the terms of the MIT License.
+ */
+#ifndef READ_HELPER_H
+#define READ_HELPER_H
+
+#include &lt;errno.h&gt;
+#include &lt;hpgs.h&gt;
+#include &lt;DataIO.h&gt;
+
+typedef struct my_hpgs_istream_st
+{
+  BPositionIO *stream;
+  status_t iseof;
+} my_hpgs_istream;
+
+
+static int 
+positionio_getc(my_hpgs_istream *stream)
+{
+	unsigned char value;
+	status_t error;
+	stream-&gt;iseof = 0;
+	error = stream-&gt;stream-&gt;Read((void *)&amp;value, sizeof(unsigned char));
+	if (error &gt; B_OK)
+		return value;
+	stream-&gt;iseof = EOF;
+	return EOF;
+}
+
+
+static int 
+positionio_ungetc(int c, my_hpgs_istream *stream)
+{
+	return stream-&gt;stream-&gt;Seek(-1, SEEK_CUR);
+}
+
+
+static int 
+positionio_close(my_hpgs_istream *stream)
+{
+	return B_OK;
+}
+
+
+static int 
+positionio_eof(my_hpgs_istream *stream)
+{
+	return stream-&gt;iseof;
+}
+
+
+static int 
+positionio_error(my_hpgs_istream *stream)
+{
+	return errno;
+}
+
+
+static int 
+positionio_tell(my_hpgs_istream *stream, size_t *pos)
+{
+	*pos = stream-&gt;stream-&gt;Position();
+	return 0;
+}
+
+
+static int 
+positionio_seek(my_hpgs_istream *stream, size_t pos)
+{
+	stream-&gt;stream-&gt;Seek(pos, SEEK_SET);
+	return 0;
+}
+
+
+static int 
+positionio_seekend(my_hpgs_istream *stream, size_t pos)
+{
+	stream-&gt;stream-&gt;Seek(pos, SEEK_END);
+	return 0;
+}
+
+
+static size_t 
+positionio_read(void *ptr, size_t size, size_t nmemb, my_hpgs_istream *stream)
+{
+	unsigned char *iptr = (unsigned char *)ptr;
+	size_t i = 0;
+	for (; i &lt; nmemb; i++) {
+		if (size != stream-&gt;stream-&gt;Read(iptr, size))
+			break;
+		iptr += size;
+	}
+	return i;
+}
+
+
+static hpgs_istream_vtable positionio_vtable =
+  {
+    (hpgs_istream_getc_func_t)    positionio_getc,
+    (hpgs_istream_ungetc_func_t)  positionio_ungetc,
+    (hpgs_istream_close_func_t)   positionio_close,
+    (hpgs_istream_iseof_func_t)   positionio_eof,
+    (hpgs_istream_iserror_func_t) positionio_error,
+    (hpgs_istream_seek_func_t)    positionio_seek,
+    (hpgs_istream_tell_func_t)    positionio_tell,
+    (hpgs_istream_read_func_t)    positionio_read,
+    (hpgs_istream_seekend_func_t) positionio_seekend
+  };
+
+hpgs_istream *hpgs_new_wrapper_istream(BPositionIO *stream)
+{
+	hpgs_istream *ret = (hpgs_istream *)malloc(sizeof(hpgs_istream));
+
+	if (!ret)
+		return NULL;
+
+	ret-&gt;stream = (my_hpgs_istream *)malloc(sizeof(my_hpgs_istream));
+	ret-&gt;vtable = &amp;positionio_vtable;
+	((my_hpgs_istream *)ret-&gt;stream)-&gt;iseof = 0;
+	((my_hpgs_istream *)ret-&gt;stream)-&gt;stream = stream;
+
+	return ret;
+}
+
+#endif // READ_HELPER_H

Added: haiku/trunk/src/add-ons/translators/hpgs/lib/hpgs.c
===================================================================
--- haiku/trunk/src/add-ons/translators/hpgs/lib/hpgs.c	2007-05-22 16:50:08 UTC (rev 21208)
+++ haiku/trunk/src/add-ons/translators/hpgs/lib/hpgs.c	2007-05-22 22:32:50 UTC (rev 21209)
@@ -0,0 +1,1086 @@
+/***********************************************************************
+ *                                                                     *
+ * $Id: hpgs.c 390 2007-03-19 15:56:42Z softadm $
+ *                                                                     *
+ * hpgs - HPGl Script, a hpgl/2 interpreter, which uses a Postscript   *
+ *        API for rendering a scene and thus renders to a variety of   *
+ *        devices and fileformats.                                     *
+ *                                                                     *
+ * (C) 2004-2006 EV-i Informationstechnologie GmbH  <A HREF="http://www.ev-i.at">http://www.ev-i.at</A> *
+ *                                                                     *
+ * Author: Wolfgang Glas                                               *
+ *                                                                     *
+ *  hpgs is free software; you can redistribute it and/or              *
+ * modify it under the terms of the GNU Lesser General Public          *
+ * License as published by the Free Software Foundation; either        *
+ * version 2.1 of the License, or (at your option) any later version.  *
+ *                                                                     *
+ * hpgs is distributed in the hope that it will be useful,             *
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of      *
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU   *
+ * Lesser General Public License for more details.                     *
+ *                                                                     *
+ * You should have received a copy of the GNU Lesser General Public    *
+ * License along with this library; if not, write to the               *
+ * Free Software  Foundation, Inc., 59 Temple Place, Suite 330,        *
+ * Boston, MA  02111-1307  USA                                         *
+ *                                                                     *
+ ***********************************************************************
+ *                                                                     *
+ * The main program.                                                   *
+ *                                                                     *
+ ***********************************************************************/
+
+#include &lt;hpgs.h&gt;
+#include &lt;string.h&gt;
+#include &lt;math.h&gt;
+#include &lt;errno.h&gt;
+#include &lt;locale.h&gt;
+
+#if defined ( __MINGW32__ ) || defined ( _MSC_VER )
+#include&lt;malloc.h&gt;
+#else
+#include&lt;alloca.h&gt;
+#endif
+
+/*! \mainpage The HPGS documentation
+ 
+    \section intro_sec Introduction
+ 
+
+    HPGS has been developed by
+    &lt;A HREF=&quot;<A HREF="http://www.ev-i.at">http://www.ev-i.at</A>&quot;&gt;EV-i Informationstechnologie GmbH&lt;/A&gt;
+    and has been published under the
+    &lt;A HREF=&quot;<A HREF="http://www.fsf.org/licenses/lgpl.html">http://www.fsf.org/licenses/lgpl.html</A>&quot;&gt;LGPL&lt;/A&gt;.
+
+    For Details visit the &lt;A HREF=&quot;<A HREF="http://hpgs.berlios.de">http://hpgs.berlios.de</A>&quot;&gt;project's homepage&lt;/A&gt;.
+
+    \section install_sec Installation
+ 
+     See the file INSTALL of the distribution.
+
+    \section invoke_sec Invoking hpgs
+   
+    \verbinclude hpgs-args.txt
+
+    \section api_sec The hpgs API.
+
+    HPGS is designed to be highly modular and may be used inside
+    C or C++ programs for either displaying HPGL files or
+    drawing a vector graphics sceneery to an image.
+
+    Refer to the \ref reader, \ref device, \ref paint_device and
+    \ref image modules in order to get an impression what the hpgs API
+    can do for you.
+ */
+
+
+#ifdef WIN32
+
+#include &lt;windows.h&gt;
+
+static char *get_aux_path(void)
+{
+  const char *key = &quot;SOFTWARE\\ev-i\\hpgs&quot;;
+  DWORD len;
+  HKEY hkey;
+  char *ret;
+  const char *prg;
+
+  if ((RegOpenKeyEx(HKEY_CURRENT_USER,
+		    key, 0, KEY_READ, &amp;hkey) == ERROR_SUCCESS ||
+       RegOpenKeyEx(HKEY_LOCAL_MACHINE,
+		    key, 0, KEY_READ, &amp;hkey) == ERROR_SUCCESS    )&amp;&amp;
+      RegQueryValueEx(hkey,&quot;prefix&quot;,NULL,NULL,NULL,&amp;len) == ERROR_SUCCESS)
+    {
+      ret = malloc(len+2);
+
+      if (RegQueryValueEx(hkey,&quot;prefix&quot;,NULL,NULL,ret,&amp;len) != ERROR_SUCCESS)
+	{ free (ret); ret = 0; }
+
+      RegCloseKey(hkey);
+
+      return ret;
+    }
+
+  prg = getenv(&quot;PROGRAMFILES&quot;);
+
+  if (prg)
+    return hpgs_sprintf_malloc(&quot;%s\\EV-i&quot;,prg);
+  
+  return strdup(&quot;C:\\Programme\\EV-i&quot;);
+}
+#else
+
+#ifndef HPGS_DEFAULT_PREFIX
+#define HPGS_DEFAULT_PREFIX &quot;/usr/local&quot;
+#endif
+
+static char *get_aux_path(void)
+{
+  char *p=getenv(&quot;EV_I_PREFIX&quot;);
+
+  if (!p)
+    return strdup(HPGS_DEFAULT_PREFIX);
+
+  return strdup(p);
+}
+#endif
+
+static int usage (void)
+{
+  fprintf (stderr,hpgs_i18n(
+	   &quot;\n&quot;
+	   &quot; hpgs v%s - HPGl Script, a hpgl/2 interpreter/renderer.\n&quot;
+	   &quot;\n&quot;
+	   &quot; (C) 2004-2006 ev-i Informationstechnologie GmbH (<A HREF="http://www.ev-i.at">http://www.ev-i.at</A>)\n&quot;
+	   &quot;     published under the LGPL (<A HREF="http://www.fsf.org/licenses/lgpl.html">http://www.fsf.org/licenses/lgpl.html</A>).\n&quot;
+	   &quot;\n&quot;
+	   &quot;Type `hpgs --help' for a detailed description of cmd line options.\n&quot;)
+	   ,HPGS_VERSION  );
+
+  hpgs_cleanup();
+
+  return 0;
+}
+
+static int help (void)
+{
+  fprintf (stderr,hpgs_i18n(
+	   &quot;\n&quot;
+	   &quot; hpgs v%s - HPGl Script, a hpgl/2 interpreter/renderer.\n&quot;
+	   &quot;\n&quot;
+	   &quot; (C) 2004-2006 ev-i Informationstechnologie GmbH (<A HREF="http://www.ev-i.at">http://www.ev-i.at</A>)\n&quot;
+	   &quot;     published under the LGPL (<A HREF="http://www.fsf.org/licenses/lgpl.html">http://www.fsf.org/licenses/lgpl.html</A>).\n&quot;
+	   &quot;\n&quot;
+	   &quot;usage: hpgs [-i] [-v] [-q] [-d &lt;dev&gt;] [options...] [-o &lt;out&gt;] &lt;in1&gt; &lt;in2&gt;...\n&quot;
+	   &quot;       -i ... Ignore plotsize from PS and determine\n&quot;
+	   &quot;              the plotsize from the file content.\n&quot;
+	   &quot;       --linewidth-size ... Account for linewidths in the plotsize\n&quot;
+	   &quot;              calculation for -i (default behaviour).\n&quot;
+	   &quot;       --no-linewidth-size ... Ignore linewidths in the plotsize\n&quot;
+	   &quot;              calculation for -i.\n&quot;
+	   &quot;       -v ... Increase verbosity.\n&quot;
+	   &quot;       -q ... Decrease verbosity, be quiet.\n&quot;
+	   &quot;       -o &lt;out&gt; ... specifiy the output filename. If not specified, write\n&quot;
+	   &quot;                    to stdout.\n&quot;
+	   &quot;       -m ... Switch to multipage mode, if a single file is given on the.\n&quot;
+	   &quot;              command line. If not specified, only the first page of the input\n&quot;
+           &quot;              file is processed.\n&quot;
+	   &quot;       -w ... Correct linewidth by given factor (default: 1).\n&quot;
+	   &quot;       -d ... Specifiy the output device. The default is the\n&quot;
+	   &quot;              native 'eps' device, which writes a simple eps file.\n&quot;
+	   &quot;              See section `Supported devices' below.\n&quot;
+	   &quot;       -a ... Use antialiasing when rendering to a png image.\n&quot;
+	   &quot;       --thin-alpha=&lt;a&gt;\n&quot;
+           &quot;              Specifiy the minimal alpha value for thin lines.\n&quot;
+	   &quot;              allowed values lie in the interval [0.001,1.0] (default: 0.25).\n&quot;
+	   &quot;       -I ... Specifiy image interpolation.\n&quot;
+	   &quot;       --rop3 ... Use ROP3 raster operations for rendering on devices\n&quot;
+	   &quot;              with ROP3 capabilities (default).\n&quot;
+	   &quot;       --no-rop3 ... Suppress usage of ROP3 raster operations.\n&quot;
+	   &quot;       -c ... Specifiy the compression level for png writing.\n&quot;
+	   &quot;       -r ... Specifiy the device resolution in dpi.\n&quot;
+	   &quot;              If no y-resolution is given, the y-resolution\n&quot;
+	   &quot;              is set to the same value as the x-resolution.\n&quot;
+	   &quot;       -p ... Specifiy the maximum pixel size of the device.\n&quot;
+	   &quot;              This is in fact an alternate method to specify the\n&quot;
+	   &quot;              resolution of the device. If -p is given, the device\n&quot;
+	   &quot;              resolution is caclulated in a way, that the plot fits\n&quot;
+	   &quot;              into the given rectangle.\n&quot;
+	   &quot;              If no y-size is given, the size y-size\n&quot;
+	   &quot;              is set to the same value as the x-size.\n&quot;
+	   &quot;       -s&lt;papersize&gt; ... Specifiy the plot size in pt (1/72 inch).\n&quot;
+	   &quot;              If -s is not given, the size is calculated from\n&quot;
+	   &quot;              the contents of the hpgl file.\n&quot;
+           &quot;              The &lt;papersize&gt; may be either one of the standard\n&quot;
+           &quot;              paper sizes A0,A1,A2,A3 or A4, their landscape versions\n&quot;
+           &quot;              A0l,A1l,A2l,A3l or A4l or a size in the format &lt;width&gt;x&lt;height&gt;\n&quot;
+           &quot;              where &lt;width&gt; and &lt;height&gt; specify a physical length in one of the\n&quot;
+           &quot;              formats &lt;l&gt;,&lt;l&gt;mm,&lt;l&gt;cm,&lt;l&gt;inch or &lt;l&gt;pt. &lt;l&gt; is a floating point\n&quot;
+           &quot;              number, the default unit is PostScript pt (1/72 inch).\n&quot;
+	   &quot;       --paper=&lt;papersize&gt;\n&quot;
+           &quot;              Specify a paper size of the output device. All plots\n&quot;
+           &quot;              are scaled to this paper size respecting the given border.\n&quot;
+           &quot;              If no fixed paper size is given, each page in the output\n&quot;
+           &quot;              file has an individual size adapted to the size of the HPGL\n&quot;
+           &quot;              content of the page.\n&quot;
+           &quot;              The format of &lt;papersize&gt; is decribed above for -s.\n&quot;
+	   &quot;       --border=&lt;border&gt;\n&quot;
+           &quot;              Specify a border for placing plots on output pages.\n&quot;
+	   &quot;       --rotation=&lt;angle&gt;\n&quot;
+           &quot;              Specify an angle for placing plots on output pages.\n&quot;
+	   &quot;       --stamp=&lt;stamp&gt;\n&quot;
+           &quot;              Specify a string, which is printed in the background.\n&quot;
+	   &quot;       --stamp-encoding=&lt;enc&gt;\n&quot;
+           &quot;              Specify an the name of the encoding of the string, which\n&quot;
+	   &quot;              is given in --stamp. Default is iso-8859-1.\n&quot;
+	   &quot;       --stamp-size=&lt;pt&gt;\n&quot;
+           &quot;              Specify the size of the stamp specified with --stamp\n&quot;
+	   &quot;              in point. Default value: 500pt.\n&quot;
+	   &quot;       --dump-png=&lt;filename&gt;\n&quot;
+           &quot;              Specify a filename for dumping inline PCL images in.\n&quot;
+           &quot;              PNG format. The actual filenames written are:\n&quot;
+           &quot;                 &lt;filename&gt;0001.png\n&quot;
+           &quot;                 &lt;filename&gt;0002.png\n&quot;
+           &quot;                  .....\n&quot;
+           &quot;              If &lt;filename&gt; contains an extension '.png' the counter\n&quot;
+           &quot;              is put between the basename and the '.png' extension.\n&quot;
+	   &quot;       --help\n&quot;
+           &quot;              Displays this usage information.\n&quot;
+	   &quot;       --version\n&quot;
+           &quot;              Displays the version information.\n&quot;
+	   &quot;\n&quot;
+	   &quot;Supported devices (option -d):\n&quot;
+	   &quot;\n&quot;
+	   &quot;       bbox    ... writes a PostScript BoundingBox to stdout.\n&quot;
+	   &quot;       ps      ... writes a multipage PostScript file.\n&quot;
+	   &quot;       eps     ... writes an eps files.\n&quot;
+	   &quot;       png_256 ... writes an indexed 8bpp png image.\n&quot;
+	   &quot;       png_gray... writes a grayscale 8bpp png image.\n&quot;
+	   &quot;       png_rgb ... writes a rgb 24bpp png image.\n&quot;
+	   &quot;       png_gray_alpha ... writes a grayscale 16bpp png image\n&quot;
+	   &quot;                          with an alpha channel.\n&quot;
+	   &quot;       png_rgb_alpha ... writes a rgb 32bpp png image\n&quot;
+	   &quot;                         with an alpha channel.\n&quot;
+	   &quot;       cairo_png ... writes a rgb 32bpp png image using\n&quot;
+	   &quot;                     the cairo library (experimental).\n&quot;)
+	   ,HPGS_VERSION );
+
+  hpgs_cleanup();
+
+  return 0;
+}
+
+static int get_double_arg(const char *arg, double *val)
+{
+  char * endptr = (char*)arg;
+  *val = strtod(arg,&amp;endptr);
+  return (*endptr || endptr == arg) ? -1 : 0;
+}
+
+static int get_double_pair(const char *arg, double *xval, double *yval)
+{
+  char * endptr = (char*)arg;
+  *xval = strtod(arg,&amp;endptr);
+
+  if (endptr == arg) return -1;
+  if (*endptr == '\0') { *yval = *xval; return 0; }
+  if (*endptr != 'x') return -1;
+
+  const char *yarg=endptr+1;
+
+  *yval = strtod(yarg,&amp;endptr);
+  return (*endptr || endptr == yarg) ? -1 : 0;
+}
+
+static int get_int_arg(const char *arg, int *val)
+{
+  char * endptr = (char*)arg;
+  *val = strtol(arg,&amp;endptr,10);
+  return (*endptr) ? -1 : 0;
+}
+
+static int get_int_pair(const char *arg, int *xval, int *yval)
+{
+  char * endptr = (char*)arg;
+  *xval = strtod(arg,&amp;endptr);
+
+  if (*endptr == '\0') { *yval = *xval; return 0; }
+  if (*endptr != 'x') return -1;
+
+  const char *yarg=endptr+1;
+
+  *yval = strtod(yarg,&amp;endptr);
+  return (*endptr || endptr == yarg) ? -1 : 0;
+}
+
+// helper function for supporting old device-specific options, which
+// are now global ones.
+static int get_dev_arg_value(const char *dev_name,int dev_name_len,
+                             const char *opt, const char *argv[],
+                             const char **value, int *narg)
+{
+  char *opt_name = alloca(4+dev_name_len+strlen(opt));
+
+  // contruct string --&lt;dev_name&gt;&lt;opt&gt;
+  opt_name[1] = opt_name[0] = '-';
+  memcpy(opt_name+2,dev_name,dev_name_len);
+  strcpy(&amp;opt_name[2+dev_name_len],opt);
+  
+  return  hpgs_get_arg_value(opt_name,argv,value,narg);
+}
+
+/*
+   The main program analyses the cmd line argument and delegates the work.
+*/
+
+#define HPGS_MAX_PLUGIN_ARGS 32
+
+int main(int argc, const char *argv[])
+{
+  const char *dev_name=&quot;eps&quot;;
+  int dev_name_len = 3;
+  const char *out_fn=0;
+  const char *stamp=0;
+  const char *stamp_enc=0;
+  const char *png_dump_fn=0;
+  int ifile;
+  char *aux_path;
+  double x_dpi=72.0;
+  double y_dpi=72.0;
+  hpgs_bbox bbox= { 0.0, 0.0, 0.0, 0.0 };
+  double paper_angle = 0.0;
+  double paper_border = 0.0;
+  double paper_width = 0.0;
+  double paper_height = 0.0;
+  double lw_factor=-1.0;
+  double thin_alpha=0.25;
+  double stamp_size=500.0;
+  int x_px_size=0;
+  int y_px_size=0;
+  hpgs_bool multipage=HPGS_FALSE;
+  hpgs_bool ignore_ps=HPGS_FALSE;
+  hpgs_bool do_linewidth=HPGS_TRUE;

[... truncated: 53200 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002388.html">[Haiku-commits] r21208 - haiku/trunk/docs/user/support
</A></li>
	<LI>Next message: <A HREF="002394.html">[Haiku-commits] r21210 - in haiku/trunk: headers/private/net	src/add-ons/kernel/network/datalink_protocols/arp	src/add-ons/kernel/network/datalink_protocols/ethernet_frame	src/add-ons/kernel/network/devices/loopback	src/add-ons/kernel/network/protocols/icmp	src/add-ons/kernel/network/protocols/ipv4	src/add-ons/kernel/network/protocols/tcp	src/add-ons/kernel/network/protocols/udp	src/add-ons/kernel/network/stack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2392">[ date ]</a>
              <a href="thread.html#2392">[ thread ]</a>
              <a href="subject.html#2392">[ subject ]</a>
              <a href="author.html#2392">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
