<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r26648 - in haiku/trunk:	headers/libs/print/libprint headers/private/print	src/add-ons/print/drivers/canon_lips/lips3	src/add-ons/print/drivers/canon_lips/lips4	src/add-ons/print/drivers/pcl5 src/add-ons/print/drivers/pcl6	src/add-ons/print/drivers/pdf/source	src/add-ons/print/drivers/postscript	src/add-ons/print/drivers/preview src/kits/print	src/libs/print/libprint src/servers/print
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2008-July/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r26648%20-%20in%20haiku/trunk%3A%0A%09headers/libs/print/libprint%20headers/private/print%0A%09src/add-ons/print/drivers/canon_lips/lips3%0A%09src/add-ons/print/drivers/canon_lips/lips4%0A%09src/add-ons/print/drivers/pcl5%20src/add-ons/print/drivers/pcl6%0A%09src/add-ons/print/drivers/pdf/source%0A%09src/add-ons/print/drivers/postscript%0A%09src/add-ons/print/drivers/preview%20src/kits/print%0A%09src/libs/print/libprint%20src/servers/print&In-Reply-To=%3C200807262236.m6QMa89b017262%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010595.html">
   <LINK REL="Next"  HREF="010597.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r26648 - in haiku/trunk:	headers/libs/print/libprint headers/private/print	src/add-ons/print/drivers/canon_lips/lips3	src/add-ons/print/drivers/canon_lips/lips4	src/add-ons/print/drivers/pcl5 src/add-ons/print/drivers/pcl6	src/add-ons/print/drivers/pdf/source	src/add-ons/print/drivers/postscript	src/add-ons/print/drivers/preview src/kits/print	src/libs/print/libprint src/servers/print</H1>
    <B>julun at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r26648%20-%20in%20haiku/trunk%3A%0A%09headers/libs/print/libprint%20headers/private/print%0A%09src/add-ons/print/drivers/canon_lips/lips3%0A%09src/add-ons/print/drivers/canon_lips/lips4%0A%09src/add-ons/print/drivers/pcl5%20src/add-ons/print/drivers/pcl6%0A%09src/add-ons/print/drivers/pdf/source%0A%09src/add-ons/print/drivers/postscript%0A%09src/add-ons/print/drivers/preview%20src/kits/print%0A%09src/libs/print/libprint%20src/servers/print&In-Reply-To=%3C200807262236.m6QMa89b017262%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r26648 - in haiku/trunk:	headers/libs/print/libprint headers/private/print	src/add-ons/print/drivers/canon_lips/lips3	src/add-ons/print/drivers/canon_lips/lips4	src/add-ons/print/drivers/pcl5 src/add-ons/print/drivers/pcl6	src/add-ons/print/drivers/pdf/source	src/add-ons/print/drivers/postscript	src/add-ons/print/drivers/preview src/kits/print	src/libs/print/libprint src/servers/print">julun at mail.berlios.de
       </A><BR>
    <I>Sun Jul 27 00:36:08 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="010595.html">[Haiku-commits] r26647 - haiku/trunk/build/jam
</A></li>
        <LI>Next message: <A HREF="010597.html">[Haiku-commits] r26649 - in haiku/trunk: headers/build	headers/os/interface src/kits/interface src/servers/app	src/servers/app/drawing/Painter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10596">[ date ]</a>
              <a href="thread.html#10596">[ thread ]</a>
              <a href="subject.html#10596">[ subject ]</a>
              <a href="author.html#10596">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: julun
Date: 2008-07-27 00:36:01 +0200 (Sun, 27 Jul 2008)
New Revision: 26648
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=26648&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=26648&amp;view=rev</A>

Added:
   haiku/trunk/headers/libs/print/libprint/InterfaceUtils.h
   haiku/trunk/headers/libs/print/libprint/MarginView.h
   haiku/trunk/headers/libs/print/libprint/PrintJobReader.h
   haiku/trunk/headers/libs/print/libprint/PrintUtils.h
   haiku/trunk/src/libs/print/libprint/InterfaceUtils.cpp
   haiku/trunk/src/libs/print/libprint/MarginView.cpp
   haiku/trunk/src/libs/print/libprint/PrintJobReader.cpp
   haiku/trunk/src/libs/print/libprint/PrintUtils.cpp
Removed:
   haiku/trunk/headers/libs/print/libprint/MarginView.h
   haiku/trunk/headers/private/print/InterfaceUtils.h
   haiku/trunk/headers/private/print/MarginView.h
   haiku/trunk/headers/private/print/PrintJobReader.h
   haiku/trunk/headers/private/print/Utils.h
   haiku/trunk/src/kits/print/InterfaceUtils.cpp
   haiku/trunk/src/kits/print/MarginView.cpp
   haiku/trunk/src/kits/print/PrintJobReader.cpp
   haiku/trunk/src/kits/print/Utils.cpp
Modified:
   haiku/trunk/headers/libs/print/libprint/JSDSlider.h
   haiku/trunk/headers/private/print/BeUtils.h
   haiku/trunk/src/add-ons/print/drivers/canon_lips/lips3/Jamfile
   haiku/trunk/src/add-ons/print/drivers/canon_lips/lips4/Jamfile
   haiku/trunk/src/add-ons/print/drivers/pcl5/Jamfile
   haiku/trunk/src/add-ons/print/drivers/pcl6/Jamfile
   haiku/trunk/src/add-ons/print/drivers/pdf/source/AdvancedSettingsWindow.cpp
   haiku/trunk/src/add-ons/print/drivers/pdf/source/Cache.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/DocInfoWindow.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/Fonts.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/FontsWindow.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/Image.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/ImageCache.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/Jamfile
   haiku/trunk/src/add-ons/print/drivers/pdf/source/JobSetupWindow.cpp
   haiku/trunk/src/add-ons/print/drivers/pdf/source/JobSetupWindow.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/Link.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/PDFWriter.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/PageSetupWindow.cpp
   haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterDriver.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterSettings.cpp
   haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterSetupWindow.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/Report.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/StatusWindow.h
   haiku/trunk/src/add-ons/print/drivers/pdf/source/XReferences.h
   haiku/trunk/src/add-ons/print/drivers/postscript/Jamfile
   haiku/trunk/src/add-ons/print/drivers/preview/Jamfile
   haiku/trunk/src/add-ons/print/drivers/preview/JobSetupWindow.h
   haiku/trunk/src/add-ons/print/drivers/preview/PageSetupWindow.cpp
   haiku/trunk/src/add-ons/print/drivers/preview/PageSetupWindow.h
   haiku/trunk/src/add-ons/print/drivers/preview/Preview.cpp
   haiku/trunk/src/kits/print/BeUtils.cpp
   haiku/trunk/src/kits/print/Jamfile
   haiku/trunk/src/libs/print/libprint/JSDSlider.cpp
   haiku/trunk/src/libs/print/libprint/Jamfile
   haiku/trunk/src/libs/print/libprint/PageSetupDlg.cpp
   haiku/trunk/src/libs/print/libprint/Preview.cpp
   haiku/trunk/src/libs/print/libprint/PrinterDriver.cpp
   haiku/trunk/src/servers/print/ConfigWindow.cpp
   haiku/trunk/src/servers/print/Jamfile
Log:
* merge parts of libprint and libprintutils to make both indepentend
* adjust all drivers to take that into account
* fix UpdateText() signature in JSDSlider to avoid warning



Copied: haiku/trunk/headers/libs/print/libprint/InterfaceUtils.h (from rev 26638, haiku/trunk/headers/private/print/InterfaceUtils.h)
===================================================================
--- haiku/trunk/headers/private/print/InterfaceUtils.h	2008-07-25 19:43:56 UTC (rev 26638)
+++ haiku/trunk/headers/libs/print/libprint/InterfaceUtils.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -0,0 +1,161 @@
+/*
+
+InterfaceUtils.cpp
+
+Copyright (c) 2002 OpenBeOS. 
+
+Author: 
+	Michael Pfeiffer
+
+Permission is hereby granted, free of charge, to any person obtaining a copy of
+this software and associated documentation files (the &quot;Software&quot;), to deal in
+the Software without restriction, including without limitation the rights to
+use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
+of the Software, and to permit persons to whom the Software is furnished to do
+so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in all
+copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
+
+*/
+
+#ifndef _INTERFACE_UTILS_H
+#define _INTERFACE_UTILS_H
+
+#include &lt;InterfaceKit.h&gt;
+#include &lt;MessageFilter.h&gt;
+
+
+class EscapeMessageFilter : public BMessageFilter
+{
+private:
+	BWindow *fWindow;
+	int32    fWhat;
+
+public:
+	EscapeMessageFilter(BWindow *window, int32 what);
+	filter_result Filter(BMessage *msg, BHandler **target);
+};
+
+
+class HWindow : public BWindow
+{
+protected:
+	void Init(uint32 escape_msg);
+	
+public:
+	typedef BWindow 		inherited;
+
+	HWindow(BRect frame, const char *title, window_type type, uint32 flags, uint32 workspace = B_CURRENT_WORKSPACE, uint32 escape_msg = B_QUIT_REQUESTED);
+	HWindow(BRect frame, const char *title, window_look look, window_feel feel, uint32 flags, uint32 workspace = B_CURRENT_WORKSPACE, uint32 escape_msg = B_QUIT_REQUESTED);
+	
+	virtual void MessageReceived(BMessage* m);
+	virtual void AboutRequested();
+	virtual const char* AboutText() const { return NULL; }
+};
+
+
+class BlockingWindow : public HWindow
+{
+public:
+	BlockingWindow(BRect frame, const char *title, window_type type, uint32 flags, uint32 workspace = B_CURRENT_WORKSPACE, uint32 escape_msg = B_QUIT_REQUESTED);
+	BlockingWindow(BRect frame, const char *title, window_look look, window_feel feel, uint32 flags, uint32 workspace = B_CURRENT_WORKSPACE, uint32 escape_msg = B_QUIT_REQUESTED);
+	~BlockingWindow();
+	
+	bool QuitRequested();
+	// Quit() is called by child class with result code
+	void Quit(status_t result);
+	// Show window and wait for it to quit, returns result code
+	virtual status_t Go();
+	// Or quit window e.g. something went wrong in constructor
+	void Quit();
+	// Sets the result that is returned when the user closes the window.
+	// Default is B_OK.
+	void SetUserQuitResult(status_t result);
+	
+	typedef HWindow 		inherited;
+	
+private:
+	void Init(const char* title);
+	
+	status_t                fUserQuitResult;
+	bool                    fReadyToQuit;
+	sem_id 					fExitSem;
+	status_t* 				fResult;
+};
+
+// --------------------------------------------------
+class TextView : public BTextView
+{
+public:
+	typedef BTextView inherited;
+	
+	TextView(BRect frame,
+				const char *name,
+				BRect textRect,
+				uint32 rmask = B_FOLLOW_LEFT | B_FOLLOW_TOP,
+				uint32 flags = B_WILL_DRAW | B_NAVIGABLE);
+
+	TextView(BRect frame,
+				const char *name,
+				BRect textRect,
+				const BFont *font, const rgb_color *color,
+				uint32 rmask = B_FOLLOW_LEFT | B_FOLLOW_TOP,
+				uint32 flags = B_WILL_DRAW | B_NAVIGABLE);
+
+	void KeyDown(const char *bytes, int32 numBytes);
+	void MakeFocus(bool focus = true);
+	void Draw(BRect r);
+};
+
+
+// --------------------------------------------------
+class TextControl : public BView
+{
+	BStringView *fLabel;
+	TextView   *fText;
+public:
+	TextControl(BRect frame,
+				const char *name,
+				const char *label, 
+				const char *initial_text, 
+				BMessage *message,
+				uint32 rmask = B_FOLLOW_LEFT | B_FOLLOW_TOP,
+				uint32 flags = B_WILL_DRAW | B_NAVIGABLE); 
+	const char *Label() { return fLabel-&gt;Text(); }
+	const char *Text()  { return fText-&gt;Text(); }
+	void MakeFocus(bool focus = true) { fText-&gt;MakeFocus(focus); }	
+	void ConvertToParent(BView* parent, BView* child, BRect &amp;rect);
+	void FocusSetTo(BView* child);
+};
+
+
+// --------------------------------------------------
+class Table : public BView
+{
+public:
+	typedef BView inherited;
+	
+	Table(BRect frame, const char *name, uint32 rmode, uint32 flags);
+	void ScrollTo(BPoint p);
+};
+
+class DragListView : public BListView
+{
+public:
+	DragListView(BRect frame, const char *name,
+		list_view_type type = B_SINGLE_SELECTION_LIST,
+		uint32 resizingMode = B_FOLLOW_LEFT | B_FOLLOW_TOP, 
+		uint32 flags = B_WILL_DRAW | B_NAVIGABLE | B_FRAME_EVENTS);
+	bool InitiateDrag(BPoint point, int32 index, bool wasSelected);
+};
+
+#endif

Modified: haiku/trunk/headers/libs/print/libprint/JSDSlider.h
===================================================================
--- haiku/trunk/headers/libs/print/libprint/JSDSlider.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/headers/libs/print/libprint/JSDSlider.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -17,15 +17,15 @@
 class JSDSlider : public BSlider 
 {
 public: 
-	JSDSlider(BRect frame, const char* name, const char *label, BMessage *msg, 
-				int32 min, int32 max, thumb_style t); 
+						JSDSlider(BRect frame, const char* name, const char *label,
+							BMessage *msg, int32 min, int32 max, thumb_style t);
 
-	~JSDSlider(); 
-  
-	char* UpdateText() const; 
-	
+	virtual				~JSDSlider();
+
+	virtual const char* UpdateText() const;
+
 private:
-	BString* fResult;	
+	mutable	BString		fResult;
 };
 
 #endif 

Deleted: haiku/trunk/headers/libs/print/libprint/MarginView.h

Copied: haiku/trunk/headers/libs/print/libprint/MarginView.h (from rev 26638, haiku/trunk/headers/private/print/MarginView.h)

Copied: haiku/trunk/headers/libs/print/libprint/PrintJobReader.h (from rev 26638, haiku/trunk/headers/private/print/PrintJobReader.h)

Copied: haiku/trunk/headers/libs/print/libprint/PrintUtils.h (from rev 26638, haiku/trunk/headers/private/print/Utils.h)
===================================================================
--- haiku/trunk/headers/private/print/Utils.h	2008-07-25 19:43:56 UTC (rev 26638)
+++ haiku/trunk/headers/libs/print/libprint/PrintUtils.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -0,0 +1,134 @@
+/*
+
+PDF Writer printer driver.
+
+Copyright (c) 2001, 2002 OpenBeOS.
+Copyright (c) 2005 - 2008 Haiku.
+
+Authors:
+	Philippe Houdoin
+	Simon Gauvin
+	Michael Pfeiffer
+
+Permission is hereby granted, free of charge, to any person obtaining a copy of
+this software and associated documentation files (the &quot;Software&quot;), to deal in
+the Software without restriction, including without limitation the rights to
+use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
+of the Software, and to permit persons to whom the Software is furnished to do
+so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in all
+copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
+
+*/
+
+#ifndef _PRINT_UTILS_H_
+#define _PRINT_UTILS_H_
+
+
+#include &lt;List.h&gt;
+#include &lt;MessageFilter.h&gt;
+#include &lt;String.h&gt;
+#include &lt;Rect.h&gt;
+
+
+class BHandler;
+class BMessage;
+class BWindow;
+
+
+#define BEGINS_CHAR(byte) ((byte &amp; 0xc0) != 0x80)
+
+
+BRect ScaleRect(const BRect&amp; rect, float scale);
+
+
+// set or replace a value in a BMessage
+void SetBool(BMessage* msg, const char* name, bool value);
+void SetFloat(BMessage* msg, const char* name, float value);
+void SetInt32(BMessage* msg, const char* name, int32 value);
+void SetString(BMessage* msg, const char* name, const char* value);
+void SetRect(BMessage* msg, const char* name, const BRect&amp; rect);
+void SetString(BMessage* msg, const char* name, const BString&amp; value);
+void AddFields(BMessage* to, const BMessage* from, const char* excludeList[] = NULL,
+	const char* includeList[] = NULL, bool overwrite = true);
+
+
+template &lt;class T&gt;
+class TList {
+private:
+	BList fList;
+	typedef int (*sort_func)(const void*, const void*);
+
+public:
+	virtual ~TList();
+	void     MakeEmpty();
+	int32    CountItems() const;
+	T*       ItemAt(int32 index) const;
+	void     AddItem(T* p);
+	T*       RemoveItem(int i);
+	T*       Items();
+	void     SortItems(int (*comp)(const T**, const T**));
+};
+
+// TList
+template&lt;class T&gt;
+TList&lt;T&gt;::~TList() {
+	MakeEmpty();
+}
+
+
+template&lt;class T&gt;
+void TList&lt;T&gt;::MakeEmpty() {
+	const int32 n = CountItems();
+	for (int i = 0; i &lt; n; i++) {
+		delete ItemAt(i);
+	}
+	fList.MakeEmpty();
+}
+
+
+template&lt;class T&gt;
+int32 TList&lt;T&gt;::CountItems() const {
+	return fList.CountItems();
+}
+
+
+template&lt;class T&gt;
+T* TList&lt;T&gt;::ItemAt(int32 index) const {
+	return (T*)fList.ItemAt(index);
+}
+
+
+template&lt;class T&gt;
+void TList&lt;T&gt;::AddItem(T* p) {
+	fList.AddItem(p);
+}
+
+template&lt;class T&gt;
+T* TList&lt;T&gt;::RemoveItem(int i) {
+	return (T*)fList.RemoveItem(i);
+}
+
+
+template&lt;class T&gt;
+T* TList&lt;T&gt;::Items() {
+	return (T*)fList.Items();
+}
+
+
+template&lt;class T&gt;
+void TList&lt;T&gt;::SortItems(int (*comp)(const T**, const T**)) {
+	sort_func sort = (sort_func)comp;
+	fList.SortItems(sort);
+}
+
+#endif	// _PRINT_UTILS_H_

Modified: haiku/trunk/headers/private/print/BeUtils.h
===================================================================
--- haiku/trunk/headers/private/print/BeUtils.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/headers/private/print/BeUtils.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -90,8 +90,6 @@
 
 // mimetype from sender
 bool MimeTypeForSender(BMessage* sender, BString&amp; mime);
-// adds fields to message or replaces existing fields
-void AddFields(BMessage* to, const BMessage* from, const char* excludeList[] = NULL, const char* includeList[] = NULL, bool overwrite = true);
 // load bitmap from application resources
 BBitmap* LoadBitmap(const char* name, uint32 type_code = B_TRANSLATOR_BITMAP);
 // convert bitmap to picture; view must be attached to a window!
@@ -99,7 +97,4 @@
 BPicture *BitmapToPicture(BView* view, BBitmap *bitmap);
 BPicture *BitmapToGrayedPicture(BView* view, BBitmap *bitmap);
 
-// scalar multiplication
-BRect ScaleRect(BRect rect, float scale); 
-
 #endif

Deleted: haiku/trunk/headers/private/print/InterfaceUtils.h

Deleted: haiku/trunk/headers/private/print/MarginView.h

Deleted: haiku/trunk/headers/private/print/PrintJobReader.h

Deleted: haiku/trunk/headers/private/print/Utils.h

Modified: haiku/trunk/src/add-ons/print/drivers/canon_lips/lips3/Jamfile
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/canon_lips/lips3/Jamfile	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/canon_lips/lips3/Jamfile	2008-07-26 22:36:01 UTC (rev 26648)
@@ -11,11 +11,7 @@
 	Lips3.cpp
 	Lips3Cap.cpp
 	Compress3.cpp
-	:
-	be
-	libprint.a
-	libprintutils.a
-	$(TARGET_LIBSTDC++)
+	: be libprint.a $(TARGET_LIBSTDC++)
 ;
 
 Package haiku-printingkit-cvs :

Modified: haiku/trunk/src/add-ons/print/drivers/canon_lips/lips4/Jamfile
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/canon_lips/lips4/Jamfile	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/canon_lips/lips4/Jamfile	2008-07-26 22:36:01 UTC (rev 26648)
@@ -10,11 +10,7 @@
 	Lips4Entry.cpp
 	Lips4.cpp
 	Lips4Cap.cpp
-	:
-	be
-	libprint.a
-	libprintutils.a
-	$(TARGET_LIBSTDC++)
+	: be libprint.a $(TARGET_LIBSTDC++)
 ;
 
 Package haiku-printingkit-cvs :

Modified: haiku/trunk/src/add-ons/print/drivers/pcl5/Jamfile
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pcl5/Jamfile	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pcl5/Jamfile	2008-07-26 22:36:01 UTC (rev 26648)
@@ -10,11 +10,7 @@
 	PCL5Entry.cpp
 	PCL5.cpp
 	PCL5Cap.cpp
-	:
-	be
-	libprint.a
-	libprintutils.a
-	$(TARGET_LIBSTDC++)
+	: be libprint.a $(TARGET_LIBSTDC++)
 ;
 
 Package haiku-printingkit-cvs :

Modified: haiku/trunk/src/add-ons/print/drivers/pcl6/Jamfile
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pcl6/Jamfile	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pcl6/Jamfile	2008-07-26 22:36:01 UTC (rev 26648)
@@ -14,11 +14,7 @@
 	PCL6Rasterizer.cpp
 	PCL6Writer.cpp
 	Rasterizer.cpp
-	:
-	be
-	libprint.a
-	libprintutils.a
-	$(TARGET_LIBSTDC++)
+	: be libprint.a $(TARGET_LIBSTDC++)
 ;
 
 Package haiku-printingkit-cvs :

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/AdvancedSettingsWindow.cpp
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/AdvancedSettingsWindow.cpp	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/AdvancedSettingsWindow.cpp	2008-07-26 22:36:01 UTC (rev 26648)
@@ -28,7 +28,7 @@
 */
 
 #include &quot;AdvancedSettingsWindow.h&quot;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 
 #include &lt;Box.h&gt;

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/Cache.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/Cache.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/Cache.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -30,7 +30,7 @@
 #ifndef _CACHE_H
 #define _CACHE_H
 
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 class CacheItem;
 

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/DocInfoWindow.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/DocInfoWindow.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/DocInfoWindow.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -40,7 +40,7 @@
 #include &lt;Path.h&gt;
 #include &lt;String.h&gt;
 #include &quot;InterfaceUtils.h&quot;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 #define HAVE_FULLVERSION_PDF_LIB 0
 

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/Fonts.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/Fonts.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/Fonts.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -35,7 +35,7 @@
 #include &lt;Archivable.h&gt;
 #include &lt;String.h&gt;
 #include &lt;List.h&gt;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 enum font_encoding 
 {

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/FontsWindow.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/FontsWindow.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/FontsWindow.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -39,7 +39,7 @@
 #include &lt;FindDirectory.h&gt;
 #include &lt;Path.h&gt;
 #include &lt;String.h&gt;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 #include &quot;Fonts.h&quot;
 
 #define USE_CLV 0

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/Image.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/Image.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/Image.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -34,7 +34,7 @@
 #include &lt;Bitmap.h&gt;
 
 #include &quot;pdflib.h&quot;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 #include &quot;Cache.h&quot;
 
 class Image;

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/ImageCache.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/ImageCache.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/ImageCache.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -35,7 +35,7 @@
 #include &lt;String.h&gt;
 
 #include &quot;pdflib.h&quot;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 #include &quot;Cache.h&quot;
 
 extern const char* kTemporaryPath;

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/Jamfile
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/Jamfile	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/Jamfile	2008-07-26 22:36:01 UTC (rev 26648)
@@ -3,6 +3,7 @@
 SetSubDirSupportedPlatformsBeOSCompatible ;
 
 UsePrivateHeaders print ;
+SubDirHdrs [ FDirName $(HAIKU_TOP) headers libs print libprint ] ;
 SubDirHdrs [ FDirName $(HAIKU_TOP) src libs pdflib libs pdflib ] ;
 
 AddResources PDF\ Writer : 
@@ -45,7 +46,8 @@
 	be 
 	textencoding 
 	translation
-	libpdf.a 
+	libpdf.a
+	libprint.a 
 	libprintutils.a 
 ;
 

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/JobSetupWindow.cpp
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/JobSetupWindow.cpp	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/JobSetupWindow.cpp	2008-07-26 22:36:01 UTC (rev 26648)
@@ -33,7 +33,7 @@
 #include &lt;SupportKit.h&gt;
 #include &lt;stdlib.h&gt;
 
-#include &quot;BeUtils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 #include &quot;PrinterDriver.h&quot;
 #include &quot;JobSetupWindow.h&quot;

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/JobSetupWindow.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/JobSetupWindow.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/JobSetupWindow.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -34,7 +34,7 @@
 
 #include &lt;InterfaceKit.h&gt;
 #include &quot;InterfaceUtils.h&quot;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 class JobSetupWindow : public HWindow 
 {

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/Link.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/Link.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/Link.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -33,7 +33,7 @@
 #include &lt;String.h&gt;
 #include &lt;Font.h&gt;
 #include &lt;Point.h&gt;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 #include &quot;PDFSystem.h&quot;
 
 class PDFSystem;

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/PDFWriter.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/PDFWriter.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/PDFWriter.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -43,7 +43,7 @@
 #include &quot;PictureIterator.h&quot;
 #include &quot;Fonts.h&quot;
 #include &quot;SubPath.h&quot;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 #include &quot;Link.h&quot;
 #include &quot;ImageCache.h&quot;
 #include &quot;PDFSystem.h&quot;

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/PageSetupWindow.cpp
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/PageSetupWindow.cpp	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/PageSetupWindow.cpp	2008-07-26 22:36:01 UTC (rev 26648)
@@ -40,7 +40,7 @@
 #include &quot;MarginView.h&quot;
 #include &quot;PrinterDriver.h&quot;
 #include &quot;pdflib.h&quot;				// for pageFormat constants
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 
 #include &lt;Box.h&gt;

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterDriver.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterDriver.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterDriver.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -37,6 +37,8 @@
 
 #include &quot;PrintTransport.h&quot;
 
+class BNode;
+
 #ifndef ROUND_UP
 	#define ROUND_UP(x, y) (((x) + (y) - 1) &amp; ~((y) - 1))
 #endif

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterSettings.cpp
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterSettings.cpp	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterSettings.cpp	2008-07-26 22:36:01 UTC (rev 26648)
@@ -33,7 +33,7 @@
 
 #include &lt;fs_attr.h&gt;
 
-#include &quot;BeUtils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 #include &quot;PrinterPrefs.h&quot;
 

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterSetupWindow.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterSetupWindow.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/PrinterSetupWindow.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -34,7 +34,7 @@
 
 #include &lt;InterfaceKit.h&gt;
 #include &quot;InterfaceUtils.h&quot;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 class PrinterSetupWindow : public HWindow 
 {

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/Report.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/Report.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/Report.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -33,7 +33,7 @@
 #include &lt;stdio.h&gt;
 #include &lt;String.h&gt;
 #include &lt;Locker.h&gt;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 
 enum kind {

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/StatusWindow.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/StatusWindow.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/StatusWindow.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -37,7 +37,7 @@
 //class PrinterDriver;
 #include &quot;PrinterDriver.h&quot;
 #include &quot;InterfaceUtils.h&quot;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 class StatusWindow : public HWindow 
 {

Modified: haiku/trunk/src/add-ons/print/drivers/pdf/source/XReferences.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/pdf/source/XReferences.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/pdf/source/XReferences.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -33,7 +33,7 @@
 #include &lt;List.h&gt;
 #include &quot;Link.h&quot;
 #include &quot;RegExp.h&quot; 
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 class MatchResult;
 class Pattern;

Modified: haiku/trunk/src/add-ons/print/drivers/postscript/Jamfile
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/postscript/Jamfile	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/postscript/Jamfile	2008-07-26 22:36:01 UTC (rev 26648)
@@ -10,11 +10,7 @@
 	PSEntry.cpp
 	PS.cpp
 	PSCap.cpp
-	:
-	be
-	libprint.a
-	libprintutils.a
-	$(TARGET_LIBSTDC++)
+	: be libprint.a $(TARGET_LIBSTDC++)
 ;
 
 Package haiku-printingkit-cvs :

Modified: haiku/trunk/src/add-ons/print/drivers/preview/Jamfile
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/preview/Jamfile	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/preview/Jamfile	2008-07-26 22:36:01 UTC (rev 26648)
@@ -2,7 +2,7 @@
 
 SetSubDirSupportedPlatformsBeOSCompatible ;
 
-UsePrivateHeaders print ;
+SubDirHdrs [ FDirName $(HAIKU_TOP) headers libs print libprint ] ;
 
 AddResources Preview : Preview.rsrc ;
 
@@ -13,10 +13,7 @@
 	Preview.cpp
 	PrinterDriver.cpp
 	PreviewDriver.cpp
-	:
-	be
-	root
-	libprintutils.a
+	: be libprint.a
 ;
 
 Package haiku-printingkit-cvs :

Modified: haiku/trunk/src/add-ons/print/drivers/preview/JobSetupWindow.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/preview/JobSetupWindow.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/preview/JobSetupWindow.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -14,7 +14,7 @@
 
 
 #include &quot;InterfaceUtils.h&quot;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 
 #include &lt;String.h&gt;

Modified: haiku/trunk/src/add-ons/print/drivers/preview/PageSetupWindow.cpp
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/preview/PageSetupWindow.cpp	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/preview/PageSetupWindow.cpp	2008-07-26 22:36:01 UTC (rev 26648)
@@ -10,12 +10,11 @@
  *		julun &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">host.haiku at gmx.de</A>&gt;
  */
 
-#include &quot;BeUtils.h&quot;
 #include &quot;MarginView.h&quot;
 #include &quot;PrinterDriver.h&quot;
 #include &quot;PageSetupWindow.h&quot;
+#include &quot;PrintUtils.h&quot;
 
-
 #include &lt;stdlib.h&gt;
 
 

Modified: haiku/trunk/src/add-ons/print/drivers/preview/PageSetupWindow.h
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/preview/PageSetupWindow.h	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/preview/PageSetupWindow.h	2008-07-26 22:36:01 UTC (rev 26648)
@@ -15,7 +15,7 @@
 
 
 #include &quot;InterfaceUtils.h&quot;
-#include &quot;Utils.h&quot;
+#include &quot;PrintUtils.h&quot;
 
 
 #include &lt;String.h&gt;

Modified: haiku/trunk/src/add-ons/print/drivers/preview/Preview.cpp
===================================================================
--- haiku/trunk/src/add-ons/print/drivers/preview/Preview.cpp	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/add-ons/print/drivers/preview/Preview.cpp	2008-07-26 22:36:01 UTC (rev 26648)
@@ -8,11 +8,9 @@
  *		julun &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">host.haiku at gmx.de</A>&gt;
  */
 
-#include &quot;BeUtils.h&quot;
-#include &quot;Utils.h&quot;
 #include &quot;Preview.h&quot;
+#include &quot;PrintUtils.h&quot;
 
-
 #include &lt;stdlib.h&gt;
 
 

Modified: haiku/trunk/src/kits/print/BeUtils.cpp
===================================================================
--- haiku/trunk/src/kits/print/BeUtils.cpp	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/kits/print/BeUtils.cpp	2008-07-26 22:36:01 UTC (rev 26648)
@@ -93,56 +93,3 @@
 	}
 	return false;
 }
-
-static bool InList(const char* list[], const char* name) {
-	for (int i = 0; list[i] != NULL; i ++) {
-		if (strcmp(list[i], name) == 0) return true;
-	}
-	return false;
-} 
-
-void AddFields(BMessage* to, const BMessage* from, const char* excludeList[], const char* includeList[], bool overwrite) {
-	if (to == from) return;
-#ifndef B_BEOS_VERSION_DANO
-	char* name;
-#else
-	const char* name;
-#endif
-	type_code type;
-	int32 count;
-	for (int32 i = 0; from-&gt;GetInfo(B_ANY_TYPE, i, &amp;name, &amp;type, &amp;count) == B_OK; i ++) {
-		const void* data;
-		ssize_t size;
-
-		if (excludeList &amp;&amp; InList(excludeList, name)) continue;
-		if (includeList &amp;&amp; !InList(includeList, name)) continue;
-
-		if (!overwrite &amp;&amp; to-&gt;FindData(name, type, 0, &amp;data, &amp;size) == B_OK) {
-			continue;
-		}
-		// replace existing data
-		to-&gt;RemoveName(name);
-		
-		for (int32 j = 0; j &lt; count; j ++) {
-			if (from-&gt;FindData(name, type, j, &amp;data, &amp;size) == B_OK) {
-				if (type == B_STRING_TYPE) {
-					to-&gt;AddString(name, (const char*)data);
-				} else if (type == B_MESSAGE_TYPE) {
-					BMessage m;
-					from-&gt;FindMessage(name, j, &amp;m);
-					to-&gt;AddMessage(name, &amp;m);
-				} else {
-					to-&gt;AddData(name, type, data, size);
-				}
-			}
-		}
-	}
-}
-
-BRect ScaleRect(BRect rect, float scale) {
-	rect.left *= scale;
-	rect.right *= scale;
-	rect.top *= scale;
-	rect.bottom *= scale;
-	return rect;
-}

Deleted: haiku/trunk/src/kits/print/InterfaceUtils.cpp

Modified: haiku/trunk/src/kits/print/Jamfile
===================================================================
--- haiku/trunk/src/kits/print/Jamfile	2008-07-26 22:04:31 UTC (rev 26647)
+++ haiku/trunk/src/kits/print/Jamfile	2008-07-26 22:36:01 UTC (rev 26648)
@@ -8,13 +8,9 @@
 	BeUtils.cpp
 	BeUtilsTranslation.cpp
 	FolderWatcher.cpp
-	InterfaceUtils.cpp
 	Jobs.cpp
-	MarginView.cpp
-	PrintJobReader.cpp
 	PicturePrinter.cpp
 	PrintTransport.cpp
 	PictureIterator.cpp
 	PrintTransportAddOn.cpp
-	Utils.cpp
 ;

Deleted: haiku/trunk/src/kits/print/MarginView.cpp

Deleted: haiku/trunk/src/kits/print/PrintJobReader.cpp

Deleted: haiku/trunk/src/kits/print/Utils.cpp

Copied: haiku/trunk/src/libs/print/libprint/InterfaceUtils.cpp (from rev 26638, haiku/trunk/src/kits/print/InterfaceUtils.cpp)
===================================================================
--- haiku/trunk/src/kits/print/InterfaceUtils.cpp	2008-07-25 19:43:56 UTC (rev 26638)
+++ haiku/trunk/src/libs/print/libprint/InterfaceUtils.cpp	2008-07-26 22:36:01 UTC (rev 26648)
@@ -0,0 +1,375 @@
+/*
+
+InterfaceUtils.cpp
+
+Copyright (c) 2002 OpenBeOS. 
+
+Author: 
+	Michael Pfeiffer
+
+Permission is hereby granted, free of charge, to any person obtaining a copy of
+this software and associated documentation files (the &quot;Software&quot;), to deal in
+the Software without restriction, including without limitation the rights to
+use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
+of the Software, and to permit persons to whom the Software is furnished to do
+so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in all
+copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
+
+*/
+
+#include &lt;string.h&gt;
+#include &lt;Debug.h&gt;
+#include &quot;InterfaceUtils.h&quot;
+
+
+EscapeMessageFilter::EscapeMessageFilter(BWindow *window, int32 what)
+	: BMessageFilter(B_ANY_DELIVERY, B_ANY_SOURCE, '_KYD')
+	, fWindow(window),
+	fWhat(what)
+{
+}
+
+
+filter_result
+EscapeMessageFilter::Filter(BMessage *msg, BHandler **target)
+{
+	int32 key;
+	// notify window with message fWhat if Escape key is hit
+	if (B_OK == msg-&gt;FindInt32(&quot;key&quot;, &amp;key) &amp;&amp; key == 1) {
+		fWindow-&gt;PostMessage(fWhat);
+		return B_SKIP_MESSAGE;
+	}
+	return B_DISPATCH_MESSAGE;
+}
+
+
+// Implementation of HWindow
+
+// --------------------------------------------------
+HWindow::HWindow(BRect frame, const char *title, window_type type, uint32 flags, uint32 workspace, uint32 escape_msg)
+	: BWindow(frame, title, type, flags, workspace)
+{
+	Init(escape_msg);
+}
+
+
+// --------------------------------------------------
+HWindow::HWindow(BRect frame, const char *title, window_look look, window_feel feel, uint32 flags, uint32 workspace, uint32 escape_msg)
+	: BWindow(frame, title, look, feel, flags, workspace)
+{
+	Init(escape_msg);
+}
+
+
+// --------------------------------------------------
+void
+HWindow::Init(uint32 escape_msg)
+{
+	AddShortcut('i', 0, new BMessage(B_ABOUT_REQUESTED));
+	AddCommonFilter(new EscapeMessageFilter(this, escape_msg));	

[... truncated: 690 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010595.html">[Haiku-commits] r26647 - haiku/trunk/build/jam
</A></li>
	<LI>Next message: <A HREF="010597.html">[Haiku-commits] r26649 - in haiku/trunk: headers/build	headers/os/interface src/kits/interface src/servers/app	src/servers/app/drawing/Painter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10596">[ date ]</a>
              <a href="thread.html#10596">[ thread ]</a>
              <a href="subject.html#10596">[ subject ]</a>
              <a href="author.html#10596">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
