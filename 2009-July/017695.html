<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r31395 - in haiku/branches/features/32bit-wchar_t:	build/jam headers/os/bluetooth/HCI headers/os/kernel	headers/private/bluetooth headers/private/debug	headers/private/interface headers/private/shared	src/add-ons/accelerants/nvidia/engine	src/add-ons/media/plugins src/add-ons/media/plugins/ffmpeg	src/apps/debugger src/apps/debugger/debug_info	src/apps/debugger/debugger_interface src/apps/debugger/dwarf	src/apps/debugger/files src/apps/debugger/gui/team_window	src/apps/debugger/model src/apps/icon-o-matic/generic/gui/scrollview	src/kits/bluetooth src/kits/debug src/kits/interface	src/kits/shared src/kits/support src/kits/tracker	src/preferences/bluetooth src/preferences/time	src/servers/bluetooth src/servers/input src/system/kernel	src/system/libroot/os
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-July/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r31395%20-%20in%20haiku/branches/features/32bit-wchar_t%3A%0A%09build/jam%20headers/os/bluetooth/HCI%20headers/os/kernel%0A%09headers/private/bluetooth%20headers/private/debug%0A%09headers/private/interface%20headers/private/shared%0A%09src/add-ons/accelerants/nvidia/engine%0A%09src/add-ons/media/plugins%20src/add-ons/media/plugins/ffmpeg%0A%09src/apps/debugger%20src/apps/debugger/debug_info%0A%09src/apps/debugger/debugger_interface%20src/apps/debugger/dwarf%0A%09src/apps/debugger/files%20src/apps/debugger/gui/team_window%0A%09src/apps/debugger/model%20src/apps/icon-o-matic/generic/gui/scrollview%0A%09src/kits/bluetooth%20src/kits/debug%20src/kits/interface%0A%09src/kits/shared%20src/kits/support%20src/kits/tracker%0A%09src/preferences/bluetooth%20src/preferences/time%0A%09src/servers/bluetooth%20src/servers/input%20src/system/kernel%0A%09src/system/libroot/os&In-Reply-To=%3C200907031614.n63GEWJR006757%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="017691.html">
   <LINK REL="Next"  HREF="017698.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r31395 - in haiku/branches/features/32bit-wchar_t:	build/jam headers/os/bluetooth/HCI headers/os/kernel	headers/private/bluetooth headers/private/debug	headers/private/interface headers/private/shared	src/add-ons/accelerants/nvidia/engine	src/add-ons/media/plugins src/add-ons/media/plugins/ffmpeg	src/apps/debugger src/apps/debugger/debug_info	src/apps/debugger/debugger_interface src/apps/debugger/dwarf	src/apps/debugger/files src/apps/debugger/gui/team_window	src/apps/debugger/model src/apps/icon-o-matic/generic/gui/scrollview	src/kits/bluetooth src/kits/debug src/kits/interface	src/kits/shared src/kits/support src/kits/tracker	src/preferences/bluetooth src/preferences/time	src/servers/bluetooth src/servers/input src/system/kernel	src/system/libroot/os</H1>
    <B>zooey at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r31395%20-%20in%20haiku/branches/features/32bit-wchar_t%3A%0A%09build/jam%20headers/os/bluetooth/HCI%20headers/os/kernel%0A%09headers/private/bluetooth%20headers/private/debug%0A%09headers/private/interface%20headers/private/shared%0A%09src/add-ons/accelerants/nvidia/engine%0A%09src/add-ons/media/plugins%20src/add-ons/media/plugins/ffmpeg%0A%09src/apps/debugger%20src/apps/debugger/debug_info%0A%09src/apps/debugger/debugger_interface%20src/apps/debugger/dwarf%0A%09src/apps/debugger/files%20src/apps/debugger/gui/team_window%0A%09src/apps/debugger/model%20src/apps/icon-o-matic/generic/gui/scrollview%0A%09src/kits/bluetooth%20src/kits/debug%20src/kits/interface%0A%09src/kits/shared%20src/kits/support%20src/kits/tracker%0A%09src/preferences/bluetooth%20src/preferences/time%0A%09src/servers/bluetooth%20src/servers/input%20src/system/kernel%0A%09src/system/libroot/os&In-Reply-To=%3C200907031614.n63GEWJR006757%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r31395 - in haiku/branches/features/32bit-wchar_t:	build/jam headers/os/bluetooth/HCI headers/os/kernel	headers/private/bluetooth headers/private/debug	headers/private/interface headers/private/shared	src/add-ons/accelerants/nvidia/engine	src/add-ons/media/plugins src/add-ons/media/plugins/ffmpeg	src/apps/debugger src/apps/debugger/debug_info	src/apps/debugger/debugger_interface src/apps/debugger/dwarf	src/apps/debugger/files src/apps/debugger/gui/team_window	src/apps/debugger/model src/apps/icon-o-matic/generic/gui/scrollview	src/kits/bluetooth src/kits/debug src/kits/interface	src/kits/shared src/kits/support src/kits/tracker	src/preferences/bluetooth src/preferences/time	src/servers/bluetooth src/servers/input src/system/kernel	src/system/libroot/os">zooey at mail.berlios.de
       </A><BR>
    <I>Fri Jul  3 18:14:32 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="017691.html">[Haiku-commits] r31394 - haiku/trunk/src/apps/debugger/files
</A></li>
        <LI>Next message: <A HREF="017698.html">[Haiku-commits] r31396 -	haiku/trunk/src/add-ons/kernel/network/protocols/ipv4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17695">[ date ]</a>
              <a href="thread.html#17695">[ thread ]</a>
              <a href="subject.html#17695">[ subject ]</a>
              <a href="author.html#17695">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: zooey
Date: 2009-07-03 18:14:11 +0200 (Fri, 03 Jul 2009)
New Revision: 31395
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=31395&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=31395&amp;view=rev</A>

Added:
   haiku/branches/features/32bit-wchar_t/src/add-ons/media/plugins/ffmpeg/
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/dwarf/LineNumberProgram.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/dwarf/LineNumberProgram.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/files/
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/FileSourceCode.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/FileSourceCode.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/util/
   haiku/branches/features/32bit-wchar_t/src/system/libroot/os/time.cpp
Removed:
   haiku/branches/features/32bit-wchar_t/src/add-ons/media/plugins/avcodec/
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/Array.h
   haiku/branches/features/32bit-wchar_t/src/system/libroot/os/time.c
Modified:
   haiku/branches/features/32bit-wchar_t/build/jam/HaikuImage
   haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI.h
   haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI_command.h
   haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI_event.h
   haiku/branches/features/32bit-wchar_t/headers/os/kernel/OS.h
   haiku/branches/features/32bit-wchar_t/headers/private/bluetooth/bluetoothserver_p.h
   haiku/branches/features/32bit-wchar_t/headers/private/debug/debug_support.h
   haiku/branches/features/32bit-wchar_t/headers/private/interface/MenuWindow.h
   haiku/branches/features/32bit-wchar_t/headers/private/shared/Referenceable.h
   haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_dac.c
   haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_dac2.c
   haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_info.c
   haiku/branches/features/32bit-wchar_t/src/add-ons/media/plugins/Jamfile
   haiku/branches/features/32bit-wchar_t/src/add-ons/media/plugins/ffmpeg/Jamfile
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/Jamfile
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/Jobs.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/MessageCodes.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/TeamDebugger.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/TeamDebugger.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/ThreadHandler.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/ThreadHandler.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/BasicFunctionDebugInfo.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/BasicFunctionDebugInfo.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/DebuggerTeamDebugInfo.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/DebuggerTeamDebugInfo.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/DwarfFunctionDebugInfo.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/DwarfFunctionDebugInfo.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/DwarfImageDebugInfo.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/DwarfImageDebugInfo.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/DwarfTeamDebugInfo.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/DwarfTeamDebugInfo.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/FunctionDebugInfo.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/SpecificTeamDebugInfo.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/TeamDebugInfo.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debug_info/TeamDebugInfo.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debugger_interface/DebuggerInterface.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/debugger_interface/DebuggerInterface.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/dwarf/CompilationUnit.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/dwarf/DwarfFile.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/dwarf/DwarfUtils.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/dwarf/DwarfUtils.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/dwarf/Jamfile
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/files/FileManager.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/files/FileManager.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/gui/team_window/ImageFunctionsView.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/gui/team_window/SourceView.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/gui/team_window/TeamWindow.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/gui/team_window/ThreadListView.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/gui/team_window/ThreadListView.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/Image.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/Image.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/ImageInfo.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/ImageInfo.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/SymbolInfo.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/SymbolInfo.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/Team.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/Team.h
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/Thread.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/debugger/model/Thread.h
   haiku/branches/features/32bit-wchar_t/src/apps/icon-o-matic/generic/gui/scrollview/ScrollView.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/icon-o-matic/generic/gui/scrollview/ScrollView.h
   haiku/branches/features/32bit-wchar_t/src/apps/icon-o-matic/generic/gui/scrollview/Scroller.cpp
   haiku/branches/features/32bit-wchar_t/src/apps/icon-o-matic/generic/gui/scrollview/Scroller.h
   haiku/branches/features/32bit-wchar_t/src/kits/bluetooth/CommandManager.cpp
   haiku/branches/features/32bit-wchar_t/src/kits/debug/Image.cpp
   haiku/branches/features/32bit-wchar_t/src/kits/debug/Image.h
   haiku/branches/features/32bit-wchar_t/src/kits/debug/SymbolLookup.cpp
   haiku/branches/features/32bit-wchar_t/src/kits/debug/SymbolLookup.h
   haiku/branches/features/32bit-wchar_t/src/kits/debug/debug_support.cpp
   haiku/branches/features/32bit-wchar_t/src/kits/interface/Menu.cpp
   haiku/branches/features/32bit-wchar_t/src/kits/interface/MenuWindow.cpp
   haiku/branches/features/32bit-wchar_t/src/kits/interface/View.cpp
   haiku/branches/features/32bit-wchar_t/src/kits/shared/CalendarView.cpp
   haiku/branches/features/32bit-wchar_t/src/kits/support/Referenceable.cpp
   haiku/branches/features/32bit-wchar_t/src/kits/tracker/PoseView.cpp
   haiku/branches/features/32bit-wchar_t/src/kits/tracker/TitleView.cpp
   haiku/branches/features/32bit-wchar_t/src/preferences/bluetooth/BluetoothDeviceView.cpp
   haiku/branches/features/32bit-wchar_t/src/preferences/time/DateTimeEdit.cpp
   haiku/branches/features/32bit-wchar_t/src/preferences/time/DateTimeEdit.h
   haiku/branches/features/32bit-wchar_t/src/preferences/time/DateTimeView.cpp
   haiku/branches/features/32bit-wchar_t/src/preferences/time/SectionEdit.cpp
   haiku/branches/features/32bit-wchar_t/src/preferences/time/SectionEdit.h
   haiku/branches/features/32bit-wchar_t/src/preferences/time/ZoneView.cpp
   haiku/branches/features/32bit-wchar_t/src/servers/bluetooth/BluetoothServer.cpp
   haiku/branches/features/32bit-wchar_t/src/servers/bluetooth/LocalDeviceImpl.cpp
   haiku/branches/features/32bit-wchar_t/src/servers/bluetooth/LocalDeviceImpl.h
   haiku/branches/features/32bit-wchar_t/src/servers/input/MethodReplicant.cpp
   haiku/branches/features/32bit-wchar_t/src/system/kernel/real_time_clock.c
   haiku/branches/features/32bit-wchar_t/src/system/libroot/os/Jamfile
Log:
* merging changes from trunk up to r31394 and fix linking problems

Modified: haiku/branches/features/32bit-wchar_t/build/jam/HaikuImage
===================================================================
--- haiku/branches/features/32bit-wchar_t/build/jam/HaikuImage	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/build/jam/HaikuImage	2009-07-03 16:14:11 UTC (rev 31395)
@@ -122,7 +122,7 @@
 	#legacy.media_addon
 ;
 SYSTEM_ADD_ONS_MEDIA_PLUGINS = $(GPL_ONLY)ac3_decoder
-	aiff_reader asf_reader au_reader $(X86_ONLY)avcodec avi_reader
+	aiff_reader asf_reader au_reader avi_reader $(X86_ONLY)ffmpeg
 	matroska mov_reader
 	mp3_decoder mp3_reader
 	mp4_reader musepack

Modified: haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI.h
===================================================================
--- haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI.h	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI.h	2009-07-03 16:14:11 UTC (rev 31395)
@@ -20,6 +20,13 @@
 				HCI_NUM_PACKET_TYPES
 } bt_packet_t;
 
+const char* BluetoothCommandOpcode(uint16 opcode);
+const char* BluetoothEvent(uint8 event);
+const char* BluetoothManufacturer(uint16 manufacturer);
+const char* BluetoothHciVersion(uint16 ver);
+const char* BluetoothLmpVersion(uint16 ver);
+const char* BluetoothError(uint8 error);
+
 /* packets sizes */
 #define HCI_MAX_ACL_SIZE		1024
 #define HCI_MAX_SCO_SIZE		255

Modified: haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI_command.h
===================================================================
--- haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI_command.h	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI_command.h	2009-07-03 16:14:11 UTC (rev 31395)
@@ -10,12 +10,6 @@
 
 #define HCI_COMMAND_HDR_SIZE 3
 
-const char* GetCommand(uint16 command);
-const char* GetEvent(uint8 event);
-const char* GetManufacturer(uint16 manufacturer);
-const char* GetHciVersion(uint16 ver);
-const char* GetLmpVersion(uint16 ver);
-
 struct hci_command_header {
 	uint16	opcode;		/* OCF &amp; OGF */
 	uint8	clen;

Modified: haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI_event.h
===================================================================
--- haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI_event.h	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/headers/os/bluetooth/HCI/btHCI_event.h	2009-07-03 16:14:11 UTC (rev 31395)
@@ -292,7 +292,7 @@
 // TODO: Define remaining Bluetooth 2.1 events structures
 #define HCI_EVENT_EXTENDED_INQUIRY_RESULT			0x2F
 
-#define HCI_EVENT_ENCRYPTION_KEY_REFERSH_COMPLETE	0x30
+#define HCI_EVENT_ENCRYPTION_KEY_REFRESH_COMPLETE	0x30
 
 #define HCI_EVENT_IO_CAPABILITY_REQUEST				0x31
 

Modified: haiku/branches/features/32bit-wchar_t/headers/os/kernel/OS.h
===================================================================
--- haiku/branches/features/32bit-wchar_t/headers/os/kernel/OS.h	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/headers/os/kernel/OS.h	2009-07-03 16:14:11 UTC (rev 31395)
@@ -1,11 +1,11 @@
-/* Kernel specific structures and functions
- *
- * Copyright 2004-2006, Haiku Inc. All Rights Reserved.
+/*
+ * Copyright 2004-2009, Haiku Inc. All Rights Reserved.
  * Distributed under the terms of the MIT License.
  */
 #ifndef _OS_H
 #define _OS_H
 
+//! Kernel specific structures and functions
 
 #include &lt;stdarg.h&gt;
 
@@ -17,7 +17,6 @@
 extern &quot;C&quot; {
 #endif
 
-/*-------------------------------------------------------------*/
 /* System constants */
 
 #define B_OS_NAME_LENGTH	32
@@ -37,7 +36,7 @@
 										| B_TIMEOUT_REAL_TIME_BASE
 };
 
-/*-------------------------------------------------------------*/
+
 /* Types */
 
 typedef int32 area_id;
@@ -47,7 +46,6 @@
 typedef int32 thread_id;
 
 
-/*-------------------------------------------------------------*/
 /* Areas */
 
 typedef struct area_info {
@@ -82,28 +80,28 @@
 #define B_READ_AREA				1
 #define B_WRITE_AREA			2
 
-extern area_id	create_area(const char *name, void **startAddress, uint32 addressSpec,
-					size_t size, uint32 lock, uint32 protection);
-extern area_id	clone_area(const char *name, void **destAddress, uint32 addressSpec,
-					uint32 protection, area_id source);
-extern area_id	find_area(const char *name);
-extern area_id	area_for(void *address);
-extern status_t	delete_area(area_id id);
-extern status_t	resize_area(area_id id, size_t newSize);
-extern status_t	set_area_protection(area_id id, uint32 newProtection);
+extern area_id		create_area(const char *name, void **startAddress,
+						uint32 addressSpec, size_t size, uint32 lock,
+						uint32 protection);
+extern area_id		clone_area(const char *name, void **destAddress,
+						uint32 addressSpec, uint32 protection, area_id source);
+extern area_id		find_area(const char *name);
+extern area_id		area_for(void *address);
+extern status_t		delete_area(area_id id);
+extern status_t		resize_area(area_id id, size_t newSize);
+extern status_t		set_area_protection(area_id id, uint32 newProtection);
 
 /* system private, use macros instead */
-extern status_t	_get_area_info(area_id id, area_info *areaInfo, size_t size);
-extern status_t	_get_next_area_info(team_id team, int32 *cookie,
-					area_info *areaInfo, size_t size);
+extern status_t		_get_area_info(area_id id, area_info *areaInfo, size_t size);
+extern status_t		_get_next_area_info(team_id team, int32 *cookie,
+						area_info *areaInfo, size_t size);
 
 #define get_area_info(id, areaInfo) \
-			_get_area_info((id), (areaInfo),sizeof(*(areaInfo)))
+	_get_area_info((id), (areaInfo),sizeof(*(areaInfo)))
 #define get_next_area_info(team, cookie, areaInfo) \
-			_get_next_area_info((team), (cookie), (areaInfo), sizeof(*(areaInfo)))
+	_get_next_area_info((team), (cookie), (areaInfo), sizeof(*(areaInfo)))
 
 
-/*-------------------------------------------------------------*/
 /* Ports */
 
 typedef struct port_info {
@@ -115,31 +113,35 @@
 	int32		total_count;	/* total # msgs read so far */
 } port_info;
 
-extern port_id	create_port(int32 capacity, const char *name);
-extern port_id	find_port(const char *name);
-extern ssize_t	read_port(port_id port, int32 *code, void *buffer, size_t bufferSize);
-extern ssize_t	read_port_etc(port_id port, int32 *code, void *buffer, size_t bufferSize,
-					uint32 flags, bigtime_t timeout);
-extern status_t write_port(port_id port, int32 code, const void *buffer, size_t bufferSize);
-extern status_t write_port_etc(port_id port, int32 code, const void *buffer,
-					size_t bufferSize, uint32 flags, bigtime_t timeout);
-extern status_t close_port(port_id port);
-extern status_t delete_port(port_id port);
+extern port_id		create_port(int32 capacity, const char *name);
+extern port_id		find_port(const char *name);
+extern ssize_t		read_port(port_id port, int32 *code, void *buffer,
+						size_t bufferSize);
+extern ssize_t		read_port_etc(port_id port, int32 *code, void *buffer,
+						size_t bufferSize, uint32 flags, bigtime_t timeout);
+extern status_t		write_port(port_id port, int32 code, const void *buffer,
+						size_t bufferSize);
+extern status_t		write_port_etc(port_id port, int32 code, const void *buffer,
+						size_t bufferSize, uint32 flags, bigtime_t timeout);
+extern status_t		close_port(port_id port);
+extern status_t		delete_port(port_id port);
 
-extern ssize_t	port_buffer_size(port_id port);
-extern ssize_t	port_buffer_size_etc(port_id port, uint32 flags, bigtime_t timeout);
-extern ssize_t	port_count(port_id port);
-extern status_t set_port_owner(port_id port, team_id team);
+extern ssize_t		port_buffer_size(port_id port);
+extern ssize_t		port_buffer_size_etc(port_id port, uint32 flags,
+						bigtime_t timeout);
+extern ssize_t		port_count(port_id port);
+extern status_t		set_port_owner(port_id port, team_id team);
 
 /* system private, use the macros instead */
-extern status_t _get_port_info(port_id port, port_info *portInfo, size_t portInfoSize);
-extern status_t _get_next_port_info(team_id team, int32 *cookie, port_info *portInfo,
-					size_t portInfoSize);
+extern status_t		_get_port_info(port_id port, port_info *portInfo,
+						size_t portInfoSize);
+extern status_t		_get_next_port_info(team_id team, int32 *cookie,
+						port_info *portInfo, size_t portInfoSize);
 
 #define get_port_info(port, info) \
-			_get_port_info((port), (info), sizeof(*(info)))
+	_get_port_info((port), (info), sizeof(*(info)))
 #define get_next_port_info(team, cookie, info) \
-			_get_next_port_info((team), (cookie), (info), sizeof(*(info)))
+	_get_next_port_info((team), (cookie), (info), sizeof(*(info)))
 
 
 /* WARNING: The following is Haiku experimental API. It might be removed or
@@ -153,15 +155,14 @@
 } port_message_info;
 
 /* similar to port_buffer_size_etc(), but returns (more) info */
-extern status_t _get_port_message_info_etc(port_id port,
-					port_message_info *info, size_t infoSize, uint32 flags,
-					bigtime_t timeout);
+extern status_t		_get_port_message_info_etc(port_id port,
+						port_message_info *info, size_t infoSize, uint32 flags,
+						bigtime_t timeout);
 
 #define get_port_message_info_etc(port, info, flags, timeout) \
-			_get_port_message_info_etc((port), (info), sizeof(*(info)), flags, \
-					timeout)
+	_get_port_message_info_etc((port), (info), sizeof(*(info)), flags, timeout)
 
-/*-------------------------------------------------------------*/
+
 /* Semaphores */
 
 typedef struct sem_info {
@@ -191,33 +192,34 @@
 										   threads waiting */
 };
 
-extern sem_id	create_sem(int32 count, const char *name);
-extern status_t	delete_sem(sem_id id);
-extern status_t	acquire_sem(sem_id id);
-extern status_t	acquire_sem_etc(sem_id id, int32 count, uint32 flags, bigtime_t timeout);
-extern status_t	release_sem(sem_id id);
-extern status_t	release_sem_etc(sem_id id, int32 count, uint32 flags);
-/* ToDo: the following two calls are not part of the BeOS API, and might be
+extern sem_id		create_sem(int32 count, const char *name);
+extern status_t		delete_sem(sem_id id);
+extern status_t		acquire_sem(sem_id id);
+extern status_t		acquire_sem_etc(sem_id id, int32 count, uint32 flags,
+						bigtime_t timeout);
+extern status_t		release_sem(sem_id id);
+extern status_t		release_sem_etc(sem_id id, int32 count, uint32 flags);
+/* TODO: the following two calls are not part of the BeOS API, and might be
    changed or even removed for the final release of Haiku R1 */
-extern status_t	switch_sem(sem_id semToBeReleased, sem_id id);
-extern status_t	switch_sem_etc(sem_id semToBeReleased, sem_id id, int32 count,
-					uint32 flags, bigtime_t timeout);
-extern status_t	get_sem_count(sem_id id, int32 *threadCount);
-extern status_t	set_sem_owner(sem_id id, team_id team);
+extern status_t		switch_sem(sem_id semToBeReleased, sem_id id);
+extern status_t		switch_sem_etc(sem_id semToBeReleased, sem_id id,
+						int32 count, uint32 flags, bigtime_t timeout);
+extern status_t		get_sem_count(sem_id id, int32 *threadCount);
+extern status_t		set_sem_owner(sem_id id, team_id team);
 
 /* system private, use the macros instead */
-extern status_t	_get_sem_info(sem_id id, struct sem_info *info, size_t infoSize);
-extern status_t	_get_next_sem_info(team_id team, int32 *cookie, struct sem_info *info,
-					size_t infoSize);
+extern status_t		_get_sem_info(sem_id id, struct sem_info *info,
+						size_t infoSize);
+extern status_t		_get_next_sem_info(team_id team, int32 *cookie,
+						struct sem_info *info, size_t infoSize);
 
 #define get_sem_info(sem, info) \
-			_get_sem_info((sem), (info), sizeof(*(info)))
+	_get_sem_info((sem), (info), sizeof(*(info)))
 
 #define get_next_sem_info(team, cookie, info) \
-			_get_next_sem_info((team), (cookie), (info), sizeof(*(info)))
+	_get_next_sem_info((team), (cookie), (info), sizeof(*(info)))
 
 
-/*-------------------------------------------------------------*/
 /* Teams */
 
 typedef struct {
@@ -236,18 +238,19 @@
 #define B_CURRENT_TEAM	0
 #define B_SYSTEM_TEAM	1
 
-extern status_t kill_team(team_id team);
+extern status_t		kill_team(team_id team);
 	/* see also: send_signal() */
 
 /* system private, use macros instead */
-extern status_t _get_team_info(team_id id, team_info *info, size_t size);
-extern status_t _get_next_team_info(int32 *cookie, team_info *info, size_t size);
+extern status_t		_get_team_info(team_id id, team_info *info, size_t size);
+extern status_t		_get_next_team_info(int32 *cookie, team_info *info,
+						size_t size);
 
 #define get_team_info(id, info) \
-			_get_team_info((id), (info), sizeof(*(info)))
+	_get_team_info((id), (info), sizeof(*(info)))
 
 #define get_next_team_info(cookie, info) \
-			_get_next_team_info((cookie), (info), sizeof(*(info)))
+	_get_next_team_info((cookie), (info), sizeof(*(info)))
 
 /* team usage info */
 
@@ -263,12 +266,13 @@
 };
 
 /* system private, use macros instead */
-extern status_t	_get_team_usage_info(team_id team, int32 who, team_usage_info *info, size_t size);
+extern status_t		_get_team_usage_info(team_id team, int32 who,
+						team_usage_info *info, size_t size);
 
 #define get_team_usage_info(team, who, info) \
-			_get_team_usage_info((team), (who), (info), sizeof(*(info)))
+	_get_team_usage_info((team), (who), (info), sizeof(*(info)))
 
-/*-------------------------------------------------------------*/
+
 /* Threads */
 
 typedef enum {
@@ -311,7 +315,8 @@
 #define thread_entry thread_func
 	/* thread_entry is for backward compatibility only! Use thread_func */
 
-extern thread_id	spawn_thread(thread_func, const char *name, int32 priority, void *data);
+extern thread_id	spawn_thread(thread_func, const char *name, int32 priority,
+						void *data);
 extern status_t		kill_thread(thread_id thread);
 extern status_t		resume_thread(thread_id thread);
 extern status_t		suspend_thread(thread_id thread);
@@ -319,14 +324,16 @@
 extern status_t		rename_thread(thread_id thread, const char *newName);
 extern status_t		set_thread_priority (thread_id thread, int32 newPriority);
 extern void			exit_thread(status_t status);
-extern status_t		wait_for_thread (thread_id thread, status_t *threadReturnValue);
+extern status_t		wait_for_thread (thread_id thread,
+						status_t *threadReturnValue);
 extern status_t		on_exit_thread(void (*callback)(void *), void *data);
 
 extern thread_id 	find_thread(const char *name);
 
 extern status_t		send_data(thread_id thread, int32 code, const void *buffer,
 						size_t bufferSize);
-extern int32		receive_data(thread_id *sender, void *buffer, size_t bufferSize);
+extern int32		receive_data(thread_id *sender, void *buffer,
+						size_t bufferSize);
 extern bool			has_data(thread_id thread);
 
 extern status_t		snooze(bigtime_t amount);
@@ -339,23 +346,22 @@
 						thread_info *info, size_t size);
 
 #define get_thread_info(id, info) \
-			_get_thread_info((id), (info), sizeof(*(info)))
+	_get_thread_info((id), (info), sizeof(*(info)))
 
 #define get_next_thread_info(team, cookie, info) \
-			_get_next_thread_info((team), (cookie), (info), sizeof(*(info)))
+	_get_next_thread_info((team), (cookie), (info), sizeof(*(info)))
 
 
-/*-------------------------------------------------------------*/
 /* Time */
 
 extern uint32		real_time_clock(void);
-extern void			set_real_time_clock(uint32 secs_since_jan1_1970);
+extern void			set_real_time_clock(uint32 secsSinceJan1st1970);
 extern bigtime_t	real_time_clock_usecs(void);
-extern status_t		set_timezone(char *timezone);
-extern bigtime_t	system_time(void);     /* time since booting in microseconds */
+extern status_t		set_timezone(const char *timezone);
+extern bigtime_t	system_time(void);
+						/* time since booting in microseconds */
 
 
-/*-------------------------------------------------------------*/
 /* Alarm */
 
 enum {
@@ -364,13 +370,12 @@
 	B_PERIODIC_ALARM			/* &quot;when&quot; specifies the period */
 };
 
-extern bigtime_t set_alarm(bigtime_t when, uint32 flags);
+extern bigtime_t	set_alarm(bigtime_t when, uint32 flags);
 
 
-/*-------------------------------------------------------------*/
 /* Debugger */
 
-extern void	debugger(const char *message);
+extern void			debugger(const char *message);
 
 /*
    calling this function with a non-zero value will cause your thread
@@ -380,18 +385,17 @@
 
    to re-enable the default debugger pass a zero.
 */
-extern int disable_debugger(int state);
+extern int			disable_debugger(int state);
 
 /* TODO: Remove. Temporary debug helper. */
-extern void debug_printf(const char *format, ...)
-	__attribute__ ((format (__printf__, 1, 2)));
-extern void debug_vprintf(const char *format, va_list args);
-extern void ktrace_printf(const char *format, ...)
-	__attribute__ ((format (__printf__, 1, 2)));
-extern void ktrace_vprintf(const char *format, va_list args);
+extern void			debug_printf(const char *format, ...)
+						__attribute__ ((format (__printf__, 1, 2)));
+extern void			debug_vprintf(const char *format, va_list args);
+extern void			ktrace_printf(const char *format, ...)
+						__attribute__ ((format (__printf__, 1, 2)));
+extern void			ktrace_vprintf(const char *format, va_list args);
 
 
-/*-------------------------------------------------------------*/
 /* System information */
 
 #if __INTEL__
@@ -409,10 +413,8 @@
 #	define B_MAX_CPU_COUNT	1
 #endif
 
-#define OBOS_CPU_TYPES
-
 typedef enum cpu_types {
-	/* ToDo: add latest models */
+	/* TODO: add latest models */
 
 	/* Motorola/IBM */
 	B_CPU_PPC_UNKNOWN					= 0,
@@ -641,7 +643,8 @@
 	} regs;
 } cpuid_info;
 
-extern status_t get_cpuid(cpuid_info *info, uint32 eaxRegister, uint32 cpuNum);
+extern status_t		get_cpuid(cpuid_info *info, uint32 eaxRegister,
+						uint32 cpuNum);
 #endif
 
 
@@ -672,20 +675,20 @@
 typedef int32 machine_id[2];	/* unique machine ID */
 
 typedef struct {
-	machine_id		id;							/* unique machine ID */
-	bigtime_t		boot_time;					/* time of boot (usecs since 1/1/1970) */
+	machine_id		id;					/* unique machine ID */
+	bigtime_t		boot_time;			/* time of boot (usecs since 1/1/1970) */
 
-	int32			cpu_count;					/* number of cpus */
-	enum cpu_types	cpu_type;					/* type of cpu */
-	int32			cpu_revision;				/* revision # of cpu */
+	int32			cpu_count;			/* number of cpus */
+	enum cpu_types	cpu_type;			/* type of cpu */
+	int32			cpu_revision;		/* revision # of cpu */
 	cpu_info		cpu_infos[B_MAX_CPU_COUNT];	/* info about individual cpus */
-	int64			cpu_clock_speed;	 		/* processor clock speed (Hz) */
-	int64			bus_clock_speed;			/* bus clock speed (Hz) */
-	enum platform_types platform_type;          /* type of machine we're on */
+	int64			cpu_clock_speed;	/* processor clock speed (Hz) */
+	int64			bus_clock_speed;	/* bus clock speed (Hz) */
+	enum platform_types platform_type;	/* type of machine we're on */
 
-	int32			max_pages;					/* total # physical pages */
-	int32			used_pages;					/* # physical pages in use */
-	int32			page_faults;				/* # of page faults */
+	int32			max_pages;			/* total # physical pages */
+	int32			used_pages;			/* # physical pages in use */
+	int32			page_faults;		/* # of page faults */
 	int32			max_sems;
 	int32			used_sems;
 	int32			max_ports;
@@ -695,27 +698,27 @@
 	int32			max_teams;
 	int32			used_teams;
 
-	char			kernel_name[B_FILE_NAME_LENGTH];		/* name of kernel */
-	char			kernel_build_date[B_OS_NAME_LENGTH];	/* date kernel built */
-	char			kernel_build_time[B_OS_NAME_LENGTH];	/* time kernel built */
-	int64			kernel_version;             			/* version of this kernel */
+	char			kernel_name[B_FILE_NAME_LENGTH];
+	char			kernel_build_date[B_OS_NAME_LENGTH];
+	char			kernel_build_time[B_OS_NAME_LENGTH];
+	int64			kernel_version;
 
-	bigtime_t		_busy_wait_time;			/* reserved for whatever */
+	bigtime_t		_busy_wait_time;	/* reserved for whatever */
 	int32			cached_pages;
 
-	uint32			abi;						/* the system API */
+	uint32			abi;				/* the system API */
 
-	int32			pad[2];   	               	/* just in case... */
+	int32			pad[2];
 } system_info;
 
 /* system private, use macro instead */
-extern status_t _get_system_info(system_info *info, size_t size);
+extern status_t		_get_system_info(system_info *info, size_t size);
 
 #define get_system_info(info) \
-			_get_system_info((info), sizeof(*(info)))
+	_get_system_info((info), sizeof(*(info)))
 
-extern int32	is_computer_on(void);
-extern double	is_computer_on_fire(void);
+extern int32		is_computer_on(void);
+extern double		is_computer_on_fire(void);
 
 
 /* WARNING: Experimental API! */
@@ -758,9 +761,9 @@
    and B_EVENT_DISCONNECTED don't need to be specified. They will always be
    reported, when they occur. */
 
-extern ssize_t 	wait_for_objects(object_wait_info* infos, int numInfos);
-extern ssize_t 	wait_for_objects_etc(object_wait_info* infos, int numInfos,
-					uint32 flags, bigtime_t timeout);
+extern ssize_t		wait_for_objects(object_wait_info* infos, int numInfos);
+extern ssize_t		wait_for_objects_etc(object_wait_info* infos, int numInfos,
+						uint32 flags, bigtime_t timeout);
 
 
 #ifdef __cplusplus

Modified: haiku/branches/features/32bit-wchar_t/headers/private/bluetooth/bluetoothserver_p.h
===================================================================
--- haiku/branches/features/32bit-wchar_t/headers/private/bluetooth/bluetoothserver_p.h	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/headers/private/bluetooth/bluetoothserver_p.h	2009-07-03 16:14:11 UTC (rev 31395)
@@ -11,6 +11,7 @@
 #define BT_MSG_ACQUIRE_LOCAL_DEVICE     'btAd'
 #define BT_MSG_HANDLE_SIMPLE_REQUEST    'btsR'
 #define BT_MSG_ADD_DEVICE               'btDD'
+#define BT_MSG_REMOVE_DEVICE            'btrD'
 #define BT_MSG_GET_PROPERTY             'btgP'
 
 // Discovery

Modified: haiku/branches/features/32bit-wchar_t/headers/private/debug/debug_support.h
===================================================================
--- haiku/branches/features/32bit-wchar_t/headers/private/debug/debug_support.h	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/headers/private/debug/debug_support.h	2009-07-03 16:14:11 UTC (rev 31395)
@@ -62,6 +62,9 @@
 void debug_delete_symbol_lookup_context(
 			debug_symbol_lookup_context *lookupContext);
 
+status_t debug_get_symbol(debug_symbol_lookup_context* lookupContext,
+			image_id image, const char* name, int32 symbolType,
+			void** _symbolLocation, size_t* _symbolSize, int32* _symbolType);
 status_t debug_lookup_symbol_address(debug_symbol_lookup_context *lookupContext,
 			const void *address, void **baseAddress, char *symbolName,
 			int32 symbolNameSize, char *imageName, int32 imageNameSize,

Modified: haiku/branches/features/32bit-wchar_t/headers/private/interface/MenuWindow.h
===================================================================
--- haiku/branches/features/32bit-wchar_t/headers/private/interface/MenuWindow.h	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/headers/private/interface/MenuWindow.h	2009-07-03 16:14:11 UTC (rev 31395)
@@ -1,13 +1,13 @@
 /*
- * Copyright 2001-2006, Haiku, Inc.
+ * Copyright 2001-2009, Haiku, Inc.
  * Distributed under the terms of the MIT License.
  *
  * Authors:
  *		Marc Flerackers (<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">mflerackers at androme.be</A>)
  *		Stefano Ceccherini (<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">burton666 at libero.it</A>)
  */
-#ifndef __MENUWINDOW_H
-#define __MENUWINDOW_H
+#ifndef MENU_WINDOW_H
+#define MENU_WINDOW_H
 
 
 #include &lt;Window.h&gt;
@@ -22,34 +22,39 @@
 
 
 class BMenuWindow : public BWindow {
-	public:
-		BMenuWindow(const char *name);
-		virtual ~BMenuWindow();
+public:
+							BMenuWindow(const char* name);
+	virtual					~BMenuWindow();
 
-		virtual void DispatchMessage(BMessage *message, BHandler *handler);
-	
-		void AttachMenu(BMenu *menu);
-		void DetachMenu();
-	
-		void AttachScrollers();
-		void DetachScrollers();
+	virtual	void			DispatchMessage(BMessage* message,
+								BHandler* handler);
 
-		bool CheckForScrolling(const BPoint &amp;cursor);
-		bool TryScrollBy(const float &amp;step);
-	
-	private:
-		BMenu *fMenu;
-		BMenuFrame *fMenuFrame;
-		BMenuScroller *fUpperScroller;
-		BMenuScroller *fLowerScroller;
-		
-		float fValue;
-		float fLimit;
-		
-		bool _Scroll(const BPoint &amp;cursor);
-		void _ScrollBy(const float &amp;step);
+			void			AttachMenu(BMenu* menu);
+			void			DetachMenu();
+
+			void			AttachScrollers();
+			void			DetachScrollers();
+
+			void			SetSmallStep(float step);
+			void			GetSteps(float* _smallStep, float* _largeStep);
+			bool			HasScrollers() const;
+			bool			CheckForScrolling(const BPoint&amp; cursor);
+			bool			TryScrollBy(const float&amp; step);
+
+private:
+			bool			_Scroll(const BPoint&amp; cursor);
+			void			_ScrollBy(const float&amp; step);
+
+			BMenu*			fMenu;
+			BMenuFrame*		fMenuFrame;
+			BMenuScroller*	fUpperScroller;
+			BMenuScroller*	fLowerScroller;
+
+			float			fScrollStep;
+			float			fValue;
+			float			fLimit;
 };
 
 }	// namespace BPrivate
 
-#endif	// __MENUWINDOW_H
+#endif	// MENU_WINDOW_H

Modified: haiku/branches/features/32bit-wchar_t/headers/private/shared/Referenceable.h
===================================================================
--- haiku/branches/features/32bit-wchar_t/headers/private/shared/Referenceable.h	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/headers/private/shared/Referenceable.h	2009-07-03 16:14:11 UTC (rev 31395)
@@ -1,5 +1,5 @@
 /*
- * Copyright 2004-2007, Ingo Weinhold, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">bonefish at users.sf.net.</A> All rights reserved.
+ * Copyright 2004-2009, Ingo Weinhold, <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">ingo_weinhold at gmx.de.</A>
  * Distributed under the terms of the MIT License.
  */
 #ifndef _REFERENCEABLE_H
@@ -15,21 +15,46 @@
 public:
 								Referenceable(
 									bool deleteWhenUnreferenced = true);
+										// TODO: The parameter is deprecated.
+										// Override LastReferenceReleased()
+										// instead!
 	virtual						~Referenceable();
 
-			void				AddReference()
-									{ atomic_add(&amp;fReferenceCount, 1); }
+			void				AcquireReference();
+			bool				ReleaseReference();
+									// returns true after last
 
-			bool				RemoveReference();	// returns true after last
-
 			int32				CountReferences() const
 									{ return fReferenceCount; }
 
+			// deprecate aliases
+	inline	void				AddReference();
+	inline	bool				RemoveReference();
+
 protected:
+	virtual	void				FirstReferenceAcquired();
+	virtual	void				LastReferenceReleased();
+
+protected:
 			vint32				fReferenceCount;
 			bool				fDeleteWhenUnreferenced;
 };
 
+
+void
+Referenceable::AddReference()
+{
+	AcquireReference();
+}
+
+
+bool
+Referenceable::RemoveReference()
+{
+	return ReleaseReference();
+}
+
+
 // Reference
 template&lt;typename Type = BPrivate::Referenceable&gt;
 class Reference {

Modified: haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_dac.c
===================================================================
--- haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_dac.c	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_dac.c	2009-07-03 16:14:11 UTC (rev 31395)
@@ -1,6 +1,6 @@
 /* program the DAC */
 /* Author:
-   Rudolf Cornelissen 12/2003-6/2009
+   Rudolf Cornelissen 12/2003-7/2009
 */
 
 #define MODULE_BIT 0x00010000
@@ -222,7 +222,7 @@
 
 	if (si-&gt;ps.ext_pll) {
 		dividers2 = DACR(PIXPLLC2);
-		if (dividers2 &amp; 0x8000000) {
+		if (dividers2 &amp; 0x80000000) {
 			/* the extended PLL part is enabled */
 			m2 = (dividers2 &amp; 0x000000ff);
 			n2 = (dividers2 &amp; 0x0000ff00) &gt;&gt; 8;

Modified: haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_dac2.c
===================================================================
--- haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_dac2.c	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_dac2.c	2009-07-03 16:14:11 UTC (rev 31395)
@@ -1,6 +1,6 @@
 /* program the secondary DAC */
 /* Author:
-   Rudolf Cornelissen 12/2003-6/2009
+   Rudolf Cornelissen 12/2003-7/2009
 */
 
 #define MODULE_BIT 0x00001000
@@ -225,7 +225,7 @@
 
 	if (si-&gt;ps.ext_pll) {
 		dividers2 = DAC2R(PIXPLLC2);
-		if (dividers2 &amp; 0x8000000) {
+		if (dividers2 &amp; 0x80000000) {
 			/* the extended PLL part is enabled */
 			m2 = (dividers2 &amp; 0x000000ff);
 			n2 = (dividers2 &amp; 0x0000ff00) &gt;&gt; 8;

Modified: haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_info.c
===================================================================
--- haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_info.c	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/src/add-ons/accelerants/nvidia/engine/nv_info.c	2009-07-03 16:14:11 UTC (rev 31395)
@@ -1,7 +1,7 @@
 /* Read initialisation information from card */
 /* some bits are hacks, where PINS is not known */
 /* Author:
-   Rudolf Cornelissen 7/2003-6/2009
+   Rudolf Cornelissen 7/2003-7/2009
 */
 
 #define MODULE_BIT 0x00002000
@@ -2623,16 +2623,16 @@
 		 * Also the BIOS might have programmed for a lower mode than EDID reports:
 		 * which limits our use of the panel (LVDS link setup too slow). */
 		if(si-&gt;ps.monitors &amp; CRTC2_TMDS) {
-			si-&gt;ps.crtc2_screen.timing.pixel_clock = si-&gt;ps.p1_timing.pixel_clock;
-			si-&gt;ps.crtc2_screen.timing.h_display = si-&gt;ps.p1_timing.h_display;
-			si-&gt;ps.crtc2_screen.timing.h_sync_start = si-&gt;ps.p1_timing.h_sync_start;
-			si-&gt;ps.crtc2_screen.timing.h_sync_end = si-&gt;ps.p1_timing.h_sync_end;
-			si-&gt;ps.crtc2_screen.timing.h_total = si-&gt;ps.p1_timing.h_total;
-			si-&gt;ps.crtc2_screen.timing.v_display = si-&gt;ps.p1_timing.h_display;
-			si-&gt;ps.crtc2_screen.timing.v_sync_start = si-&gt;ps.p1_timing.v_sync_start;
-			si-&gt;ps.crtc2_screen.timing.v_sync_end = si-&gt;ps.p1_timing.v_sync_end;
-			si-&gt;ps.crtc2_screen.timing.v_total = si-&gt;ps.p1_timing.v_total;
-			si-&gt;ps.crtc2_screen.timing.flags = si-&gt;ps.p1_timing.flags;
+			si-&gt;ps.crtc2_screen.timing.pixel_clock = si-&gt;ps.p2_timing.pixel_clock;
+			si-&gt;ps.crtc2_screen.timing.h_display = si-&gt;ps.p2_timing.h_display;
+			si-&gt;ps.crtc2_screen.timing.h_sync_start = si-&gt;ps.p2_timing.h_sync_start;
+			si-&gt;ps.crtc2_screen.timing.h_sync_end = si-&gt;ps.p2_timing.h_sync_end;
+			si-&gt;ps.crtc2_screen.timing.h_total = si-&gt;ps.p2_timing.h_total;
+			si-&gt;ps.crtc2_screen.timing.v_display = si-&gt;ps.p2_timing.h_display;
+			si-&gt;ps.crtc2_screen.timing.v_sync_start = si-&gt;ps.p2_timing.v_sync_start;
+			si-&gt;ps.crtc2_screen.timing.v_sync_end = si-&gt;ps.p2_timing.v_sync_end;
+			si-&gt;ps.crtc2_screen.timing.v_total = si-&gt;ps.p2_timing.v_total;
+			si-&gt;ps.crtc2_screen.timing.flags = si-&gt;ps.p2_timing.flags;
 			si-&gt;ps.crtc2_screen.have_edid = true;
 			si-&gt;ps.crtc2_screen.aspect =
 				(si-&gt;ps.p2_timing.h_display / ((float)si-&gt;ps.p2_timing.v_display));

Modified: haiku/branches/features/32bit-wchar_t/src/add-ons/media/plugins/Jamfile
===================================================================
--- haiku/branches/features/32bit-wchar_t/src/add-ons/media/plugins/Jamfile	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/src/add-ons/media/plugins/Jamfile	2009-07-03 16:14:11 UTC (rev 31395)
@@ -3,27 +3,24 @@
 SetSubDirSupportedPlatformsBeOSCompatible ;
 
 SubInclude HAIKU_TOP src add-ons media plugins aiff_reader ;
+SubInclude HAIKU_TOP src add-ons media plugins ape_reader ;
+SubInclude HAIKU_TOP src add-ons media plugins asf_reader ;
 SubInclude HAIKU_TOP src add-ons media plugins au_reader ;
 SubInclude HAIKU_TOP src add-ons media plugins avi_reader ;
-SubInclude HAIKU_TOP src add-ons media plugins mp3_reader ;
-SubInclude HAIKU_TOP src add-ons media plugins wav_reader ;
-SubInclude HAIKU_TOP src add-ons media plugins ape_reader ;
-
+SubInclude HAIKU_TOP src add-ons media plugins ffmpeg ;
 SubInclude HAIKU_TOP src add-ons media plugins matroska ;
+SubInclude HAIKU_TOP src add-ons media plugins mov_reader ;
+SubInclude HAIKU_TOP src add-ons media plugins mp3_decoder ;
+SubInclude HAIKU_TOP src add-ons media plugins mp3_reader ;
+SubInclude HAIKU_TOP src add-ons media plugins mp4_reader ;
 SubInclude HAIKU_TOP src add-ons media plugins musepack ;
 SubInclude HAIKU_TOP src add-ons media plugins ogg ;
-
-SubInclude HAIKU_TOP src add-ons media plugins mp3_decoder ;
 SubInclude HAIKU_TOP src add-ons media plugins raw_decoder ;
-
-SubInclude HAIKU_TOP src add-ons media plugins avcodec ;
-SubInclude HAIKU_TOP src add-ons media plugins vorbis ;
 SubInclude HAIKU_TOP src add-ons media plugins speex ;
-SubInclude HAIKU_TOP src add-ons media plugins mov_reader ;
-SubInclude HAIKU_TOP src add-ons media plugins mp4_reader ;
+#SubInclude HAIKU_TOP src add-ons media plugins theora ;
+SubInclude HAIKU_TOP src add-ons media plugins vorbis ;
+SubInclude HAIKU_TOP src add-ons media plugins wav_reader ;
 
-SubInclude HAIKU_TOP src add-ons media plugins asf_reader ;
-
 # The following add-ons are GPL licensed, and can only be used with
 # software whose license is GPL compatible. To include these GPL
 # licensed add-ons, you need to run configure with the --include-gpl-addons

Copied: haiku/branches/features/32bit-wchar_t/src/add-ons/media/plugins/ffmpeg (from rev 31392, haiku/trunk/src/add-ons/media/plugins/ffmpeg)

Modified: haiku/branches/features/32bit-wchar_t/src/add-ons/media/plugins/ffmpeg/Jamfile
===================================================================
--- haiku/trunk/src/add-ons/media/plugins/ffmpeg/Jamfile	2009-07-03 14:20:27 UTC (rev 31392)
+++ haiku/branches/features/32bit-wchar_t/src/add-ons/media/plugins/ffmpeg/Jamfile	2009-07-03 16:14:11 UTC (rev 31395)
@@ -29,6 +29,7 @@
 	be
 	libmedia.so
 	libz.a
+	$(TARGET_LIBSUPC++)
 ;
 
 SubInclude HAIKU_TOP src add-ons media plugins ffmpeg libavcodec ;

Deleted: haiku/branches/features/32bit-wchar_t/src/apps/debugger/Array.h

Modified: haiku/branches/features/32bit-wchar_t/src/apps/debugger/Jamfile
===================================================================
--- haiku/branches/features/32bit-wchar_t/src/apps/debugger/Jamfile	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/src/apps/debugger/Jamfile	2009-07-03 16:14:11 UTC (rev 31395)
@@ -11,9 +11,11 @@
 SEARCH_SOURCE += [ FDirName $(SUBDIR) debug_info ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) debugger_interface ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) elf ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) files ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) gui team_window ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) model ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) types ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) util ] ;
 
 local debugAnalyzerSources
 	= [ FDirName $(HAIKU_TOP) src apps debuganalyzer ] ;
@@ -68,6 +70,13 @@
 	# elf
 	ElfFile.cpp
 
+	# files
+	FileManager.cpp
+	LocatableDirectory.cpp
+	LocatableEntry.cpp
+	LocatableFile.cpp
+	SourceFile.cpp
+
 	# gui/team_window
 	ImageFunctionsView.cpp
 	ImageListView.cpp
@@ -80,6 +89,7 @@
 	# model
 	Breakpoint.cpp
 	DisassembledCode.cpp
+	FileSourceCode.cpp
 	Image.cpp
 	ImageInfo.cpp
 	SourceCode.cpp
@@ -96,6 +106,9 @@
 	# types
 	TargetAddressRangeList.cpp
 
+	# util
+	StringUtils.cpp
+
 	:
 	&lt;nogrist&gt;Debugger_demangler.o
 	&lt;nogrist&gt;Debugger_disasm_x86.o

Modified: haiku/branches/features/32bit-wchar_t/src/apps/debugger/Jobs.cpp
===================================================================
--- haiku/branches/features/32bit-wchar_t/src/apps/debugger/Jobs.cpp	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/src/apps/debugger/Jobs.cpp	2009-07-03 16:14:11 UTC (rev 31395)
@@ -253,7 +253,7 @@
 	// create the debug info
 	ImageDebugInfo* debugInfo;
 	status_t error = fImage-&gt;GetTeam()-&gt;DebugInfo()-&gt;LoadImageDebugInfo(
-		imageInfo, debugInfo);
+		imageInfo, fImage-&gt;ImageFile(), debugInfo);
 
 	// set the result
 	locker.Lock();

Modified: haiku/branches/features/32bit-wchar_t/src/apps/debugger/MessageCodes.h
===================================================================
--- haiku/branches/features/32bit-wchar_t/src/apps/debugger/MessageCodes.h	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/src/apps/debugger/MessageCodes.h	2009-07-03 16:14:11 UTC (rev 31395)
@@ -19,6 +19,7 @@
 	MSG_THREAD_CPU_STATE_CHANGED		= 'tcsc',
 	MSG_THREAD_STACK_TRACE_CHANGED		= 'tstc',
 	MSG_IMAGE_DEBUG_INFO_CHANGED		= 'idic',
+	MSG_IMAGE_FILE_CHANGED				= 'ifch',
 	MSG_FUNCTION_SOURCE_CODE_CHANGED	= 'fnsc',
 	MSG_USER_BREAKPOINT_CHANGED			= 'ubrc',
 	MSG_DEBUGGER_EVENT					= 'dbge',

Modified: haiku/branches/features/32bit-wchar_t/src/apps/debugger/TeamDebugger.cpp
===================================================================
--- haiku/branches/features/32bit-wchar_t/src/apps/debugger/TeamDebugger.cpp	2009-07-03 14:46:10 UTC (rev 31394)
+++ haiku/branches/features/32bit-wchar_t/src/apps/debugger/TeamDebugger.cpp	2009-07-03 16:14:11 UTC (rev 31395)
@@ -20,13 +20,95 @@
 #include &quot;BreakpointManager.h&quot;
 #include &quot;CpuState.h&quot;
 #include &quot;DebuggerInterface.h&quot;
+#include &quot;FileManager.h&quot;
 #include &quot;Jobs.h&quot;
+#include &quot;LocatableFile.h&quot;
 #include &quot;MessageCodes.h&quot;
+#include &quot;SymbolInfo.h&quot;
 #include &quot;Statement.h&quot;
 #include &quot;TeamDebugInfo.h&quot;
 #include &quot;TeamDebugModel.h&quot;
 
+// #pragma mark - ImageHandler
 
+
+struct TeamDebugger::ImageHandler : public Referenceable,
+		public HashTableLink&lt;ImageHandler&gt;, private LocatableFile::Listener {
+public:
+	ImageHandler(TeamDebugger* teamDebugger, Image* image)
+		:
+		fTeamDebugger(teamDebugger),
+		fImage(image)
+	{
+		fImage-&gt;AcquireReference();
+		if (fImage-&gt;ImageFile() != NULL)
+			fImage-&gt;ImageFile()-&gt;AddListener(this);
+	}
+
+	~ImageHandler()
+	{
+		if (fImage-&gt;ImageFile() != NULL)
+			fImage-&gt;ImageFile()-&gt;RemoveListener(this);
+		fImage-&gt;ReleaseReference();
+	}
+
+	Image* GetImage() const
+	{
+		return fImage;
+	}
+
+	image_id ImageID() const
+	{
+		return fImage-&gt;ID();
+	}
+
+private:
+	// LocatableFile::Listener
+	virtual void LocatableFileChanged(LocatableFile* file)
+	{
+		BMessage message(MSG_IMAGE_FILE_CHANGED);
+		message.AddInt32(&quot;image&quot;, fImage-&gt;ID());
+		fTeamDebugger-&gt;PostMessage(&amp;message);
+	}
+
+private:
+	TeamDebugger*	fTeamDebugger;
+	Image*			fImage;
+};
+
+
+// #pragma mark - ImageHandlerHashDefinition
+
+
+struct TeamDebugger::ImageHandlerHashDefinition {

[... truncated: 5748 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="017691.html">[Haiku-commits] r31394 - haiku/trunk/src/apps/debugger/files
</A></li>
	<LI>Next message: <A HREF="017698.html">[Haiku-commits] r31396 -	haiku/trunk/src/add-ons/kernel/network/protocols/ipv4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#17695">[ date ]</a>
              <a href="thread.html#17695">[ thread ]</a>
              <a href="subject.html#17695">[ subject ]</a>
              <a href="author.html#17695">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
