<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r31791 - in haiku/trunk: headers/private/kernel	headers/private/kernel/util headers/private/userlandfs/shared	src/add-ons/kernel/bus_managers/agp_gart	src/add-ons/kernel/file_systems/userlandfs/kernel_add_on	src/add-ons/kernel/file_systems/userlandfs/server/fuse	src/add-ons/kernel/file_systems/userlandfs/server/haiku	src/add-ons/kernel/network/protocols/ipv4	src/add-ons/kernel/network/protocols/tcp	src/add-ons/kernel/network/protocols/udp	src/add-ons/kernel/network/protocols/unix src/apps/debuganalyzer/gui	src/apps/debuganalyzer/model_loader src/apps/debugger	src/apps/debugger/debug_info src/apps/debugger/dwarf	src/apps/debugger/files src/apps/debugger/model	src/servers/app src/system/kernel src/system/kernel/debug	src/system/kernel/device_manager src/system/kernel/fs	src/system/kernel/posix src/system/kernel/slab	src/system/kernel/vm src/tests/add-ons/kernel/kernelland_emu
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-July/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r31791%20-%20in%20haiku/trunk%3A%20headers/private/kernel%0A%09headers/private/kernel/util%20headers/private/userlandfs/shared%0A%09src/add-ons/kernel/bus_managers/agp_gart%0A%09src/add-ons/kernel/file_systems/userlandfs/kernel_add_on%0A%09src/add-ons/kernel/file_systems/userlandfs/server/fuse%0A%09src/add-ons/kernel/file_systems/userlandfs/server/haiku%0A%09src/add-ons/kernel/network/protocols/ipv4%0A%09src/add-ons/kernel/network/protocols/tcp%0A%09src/add-ons/kernel/network/protocols/udp%0A%09src/add-ons/kernel/network/protocols/unix%20src/apps/debuganalyzer/gui%0A%09src/apps/debuganalyzer/model_loader%20src/apps/debugger%0A%09src/apps/debugger/debug_info%20src/apps/debugger/dwarf%0A%09src/apps/debugger/files%20src/apps/debugger/model%0A%09src/servers/app%20src/system/kernel%20src/system/kernel/debug%0A%09src/system/kernel/device_manager%20src/system/kernel/fs%0A%09src/system/kernel/posix%20src/system/kernel/slab%0A%09src/system/kernel/vm%20src/tests/add-ons/kernel/kernelland_emu&In-Reply-To=%3C200907270039.n6R0dfCQ014138%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="018310.html">
   <LINK REL="Next"  HREF="018298.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r31791 - in haiku/trunk: headers/private/kernel	headers/private/kernel/util headers/private/userlandfs/shared	src/add-ons/kernel/bus_managers/agp_gart	src/add-ons/kernel/file_systems/userlandfs/kernel_add_on	src/add-ons/kernel/file_systems/userlandfs/server/fuse	src/add-ons/kernel/file_systems/userlandfs/server/haiku	src/add-ons/kernel/network/protocols/ipv4	src/add-ons/kernel/network/protocols/tcp	src/add-ons/kernel/network/protocols/udp	src/add-ons/kernel/network/protocols/unix src/apps/debuganalyzer/gui	src/apps/debuganalyzer/model_loader src/apps/debugger	src/apps/debugger/debug_info src/apps/debugger/dwarf	src/apps/debugger/files src/apps/debugger/model	src/servers/app src/system/kernel src/system/kernel/debug	src/system/kernel/device_manager src/system/kernel/fs	src/system/kernel/posix src/system/kernel/slab	src/system/kernel/vm src/tests/add-ons/kernel/kernelland_emu</H1>
    <B>stippi at mail.berlios.de</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r31791%20-%20in%20haiku/trunk%3A%20headers/private/kernel%0A%09headers/private/kernel/util%20headers/private/userlandfs/shared%0A%09src/add-ons/kernel/bus_managers/agp_gart%0A%09src/add-ons/kernel/file_systems/userlandfs/kernel_add_on%0A%09src/add-ons/kernel/file_systems/userlandfs/server/fuse%0A%09src/add-ons/kernel/file_systems/userlandfs/server/haiku%0A%09src/add-ons/kernel/network/protocols/ipv4%0A%09src/add-ons/kernel/network/protocols/tcp%0A%09src/add-ons/kernel/network/protocols/udp%0A%09src/add-ons/kernel/network/protocols/unix%20src/apps/debuganalyzer/gui%0A%09src/apps/debuganalyzer/model_loader%20src/apps/debugger%0A%09src/apps/debugger/debug_info%20src/apps/debugger/dwarf%0A%09src/apps/debugger/files%20src/apps/debugger/model%0A%09src/servers/app%20src/system/kernel%20src/system/kernel/debug%0A%09src/system/kernel/device_manager%20src/system/kernel/fs%0A%09src/system/kernel/posix%20src/system/kernel/slab%0A%09src/system/kernel/vm%20src/tests/add-ons/kernel/kernelland_emu&In-Reply-To=%3C200907270039.n6R0dfCQ014138%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r31791 - in haiku/trunk: headers/private/kernel	headers/private/kernel/util headers/private/userlandfs/shared	src/add-ons/kernel/bus_managers/agp_gart	src/add-ons/kernel/file_systems/userlandfs/kernel_add_on	src/add-ons/kernel/file_systems/userlandfs/server/fuse	src/add-ons/kernel/file_systems/userlandfs/server/haiku	src/add-ons/kernel/network/protocols/ipv4	src/add-ons/kernel/network/protocols/tcp	src/add-ons/kernel/network/protocols/udp	src/add-ons/kernel/network/protocols/unix src/apps/debuganalyzer/gui	src/apps/debuganalyzer/model_loader src/apps/debugger	src/apps/debugger/debug_info src/apps/debugger/dwarf	src/apps/debugger/files src/apps/debugger/model	src/servers/app src/system/kernel src/system/kernel/debug	src/system/kernel/device_manager src/system/kernel/fs	src/system/kernel/posix src/system/kernel/slab	src/system/kernel/vm src/tests/add-ons/kernel/kernelland_emu">stippi at mail.berlios.de
       </A><BR>
    <I>Mon Jul 27 02:39:41 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="018310.html">[Haiku-commits] r31790 - in haiku/trunk: headers/os/drivers/usb	src/add-ons/kernel/drivers/input/usb_hid
</A></li>
        <LI>Next message: <A HREF="018298.html">[Haiku-commits] r31791 - in haiku/trunk: headers/private/kernel	headers/private/kernel/util headers/private/userlandfs/shared	src/add-ons/kernel/bus_managers/agp_gart	src/add-ons/kernel/file_systems/userlandfs/kernel_add_on	src/add-ons/kernel/fil
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18297">[ date ]</a>
              <a href="thread.html#18297">[ thread ]</a>
              <a href="subject.html#18297">[ subject ]</a>
              <a href="author.html#18297">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: stippi
Date: 2009-07-27 02:39:12 +0200 (Mon, 27 Jul 2009)
New Revision: 31791
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=31791&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=31791&amp;view=rev</A>

Modified:
   haiku/trunk/headers/private/kernel/Notifications.h
   haiku/trunk/headers/private/kernel/condition_variable.h
   haiku/trunk/headers/private/kernel/kimage.h
   haiku/trunk/headers/private/kernel/util/MultiHashTable.h
   haiku/trunk/headers/private/kernel/util/OpenHashTable.h
   haiku/trunk/headers/private/userlandfs/shared/HashMap.h
   haiku/trunk/src/add-ons/kernel/bus_managers/agp_gart/agp_gart.cpp
   haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/FileSystem.cpp
   haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/FileSystem.h
   haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/Volume.cpp
   haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/fuse/FUSEEntry.h
   haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelFileSystem.cpp
   haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelIORequest.h
   haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelNode.h
   haiku/trunk/src/add-ons/kernel/network/protocols/ipv4/ipv4.cpp
   haiku/trunk/src/add-ons/kernel/network/protocols/ipv4/multicast.h
   haiku/trunk/src/add-ons/kernel/network/protocols/tcp/EndpointManager.cpp
   haiku/trunk/src/add-ons/kernel/network/protocols/tcp/EndpointManager.h
   haiku/trunk/src/add-ons/kernel/network/protocols/tcp/TCPEndpoint.h
   haiku/trunk/src/add-ons/kernel/network/protocols/udp/udp.cpp
   haiku/trunk/src/add-ons/kernel/network/protocols/unix/UnixAddressManager.h
   haiku/trunk/src/add-ons/kernel/network/protocols/unix/UnixEndpoint.h
   haiku/trunk/src/apps/debuganalyzer/gui/SubWindow.h
   haiku/trunk/src/apps/debuganalyzer/gui/SubWindowManager.h
   haiku/trunk/src/apps/debuganalyzer/model_loader/ModelLoader.cpp
   haiku/trunk/src/apps/debuganalyzer/model_loader/ModelLoader.h
   haiku/trunk/src/apps/debugger/TeamDebugger.cpp
   haiku/trunk/src/apps/debugger/TeamDebugger.h
   haiku/trunk/src/apps/debugger/ThreadHandler.h
   haiku/trunk/src/apps/debugger/Worker.cpp
   haiku/trunk/src/apps/debugger/Worker.h
   haiku/trunk/src/apps/debugger/debug_info/DwarfInterfaceFactory.cpp
   haiku/trunk/src/apps/debugger/debug_info/DwarfInterfaceFactory.h
   haiku/trunk/src/apps/debugger/debug_info/Function.h
   haiku/trunk/src/apps/debugger/debug_info/TeamDebugInfo.cpp
   haiku/trunk/src/apps/debugger/debug_info/TeamDebugInfo.h
   haiku/trunk/src/apps/debugger/dwarf/AbbreviationTable.h
   haiku/trunk/src/apps/debugger/files/FileManager.cpp
   haiku/trunk/src/apps/debugger/files/FileManager.h
   haiku/trunk/src/apps/debugger/files/LocatableEntry.h
   haiku/trunk/src/apps/debugger/model/StackFrameValues.cpp
   haiku/trunk/src/apps/debugger/model/StackFrameValues.h
   haiku/trunk/src/servers/app/FontCacheEntry.cpp
   haiku/trunk/src/servers/app/FontCacheEntry.h
   haiku/trunk/src/system/kernel/condition_variable.cpp
   haiku/trunk/src/system/kernel/debug/system_profiler.cpp
   haiku/trunk/src/system/kernel/device_manager/IOScheduler.cpp
   haiku/trunk/src/system/kernel/device_manager/IOScheduler.h
   haiku/trunk/src/system/kernel/device_manager/legacy_drivers.cpp
   haiku/trunk/src/system/kernel/fs/node_monitor.cpp
   haiku/trunk/src/system/kernel/fs/vfs.cpp
   haiku/trunk/src/system/kernel/image.cpp
   haiku/trunk/src/system/kernel/module.cpp
   haiku/trunk/src/system/kernel/posix/realtime_sem.cpp
   haiku/trunk/src/system/kernel/posix/xsi_message_queue.cpp
   haiku/trunk/src/system/kernel/posix/xsi_semaphore.cpp
   haiku/trunk/src/system/kernel/slab/Slab.cpp
   haiku/trunk/src/system/kernel/vm/VMAnonymousCache.cpp
   haiku/trunk/src/tests/add-ons/kernel/kernelland_emu/condition_variable.cpp
Log:
headers/private/kernel/util/OpenHashTable.h, Hugo's version, is a bit nicer than
Tracker's OpenHashTable.h which it should eventually replace. We've renamed the
class to BOpenHashTable and changed the interface slightly so that HashTableLink
became superfluous.
Adapted all the code that used it. Since the OpenHashTables no longer clash,
this should fix the GCC4 build.


Modified: haiku/trunk/headers/private/kernel/Notifications.h
===================================================================
--- haiku/trunk/headers/private/kernel/Notifications.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/headers/private/kernel/Notifications.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -108,11 +108,11 @@
 									NotificationListener&amp; listener) = 0;
 
 	virtual const char*			Name() = 0;
-			HashTableLink&lt;NotificationService&gt;&amp;
+			NotificationService*&amp;
 								Link() { return fLink; }
 
 private:
-			HashTableLink&lt;NotificationService&gt; fLink;
+			NotificationService* fLink;
 };
 
 struct default_listener : public DoublyLinkedListLinkImpl&lt;default_listener&gt; {
@@ -226,11 +226,11 @@
 			{ return hash_hash_string(service-&gt;Name()); }
 		bool Compare(const char* key, NotificationService* service) const
 			{ return !strcmp(key, service-&gt;Name()); }
-		HashTableLink&lt;NotificationService&gt;* GetLink(
+		NotificationService*&amp; GetLink(
 				NotificationService* service) const
-			{ return &amp;service-&gt;Link(); }
+			{ return service-&gt;Link(); }
 	};
-	typedef OpenHashTable&lt;HashDefinition&gt; ServiceHash;
+	typedef BOpenHashTable&lt;HashDefinition&gt; ServiceHash;
 
 	static	NotificationManager	sManager;
 

Modified: haiku/trunk/headers/private/kernel/condition_variable.h
===================================================================
--- haiku/trunk/headers/private/kernel/condition_variable.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/headers/private/kernel/condition_variable.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -46,7 +46,7 @@
 };
 
 
-struct ConditionVariable : protected HashTableLink&lt;ConditionVariable&gt; {
+struct ConditionVariable {
 public:
 			void				Init(const void* object,
 									const char* objectType);
@@ -81,6 +81,7 @@
 			const void*			fObject;
 			const char*			fObjectType;
 			EntryList			fEntries;
+			ConditionVariable*	fNext;
 
 			friend struct ConditionVariableEntry;
 			friend struct ConditionVariableHashDefinition;

Modified: haiku/trunk/headers/private/kernel/kimage.h
===================================================================
--- haiku/trunk/headers/private/kernel/kimage.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/headers/private/kernel/kimage.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -18,7 +18,7 @@
 struct image {
 	struct image*			next;
 	struct image*			prev;
-	HashTableLink&lt;image&gt;	hash_link;
+	struct image*			hash_link;
 	image_info				info;
 	team_id					team;
 };

Modified: haiku/trunk/headers/private/kernel/util/MultiHashTable.h
===================================================================
--- haiku/trunk/headers/private/kernel/util/MultiHashTable.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/headers/private/kernel/util/MultiHashTable.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -21,10 +21,10 @@
 
 template&lt;typename Definition, bool AutoExpand = true,
 	bool CheckDuplicates = false&gt;
-class MultiHashTable : private OpenHashTable&lt;Definition,
+class MultiHashTable : private BOpenHashTable&lt;Definition,
 	AutoExpand, CheckDuplicates&gt; {
 public:
-	typedef OpenHashTable&lt;Definition, AutoExpand, CheckDuplicates&gt; HashTable;
+	typedef BOpenHashTable&lt;Definition, AutoExpand, CheckDuplicates&gt; HashTable;
 	typedef MultiHashTable&lt;Definition, AutoExpand, CheckDuplicates&gt; MultiTable;
 
 	typedef typename HashTable::Iterator Iterator;
@@ -116,7 +116,7 @@
 		while (slot) {
 			if (HashTable::fDefinition.Compare(key, slot))
 				break;
-			slot = HashTable::_Link(slot)-&gt;fNext;
+			slot = HashTable::_Link(slot);
 		}
 
 		if (slot == NULL)
@@ -140,18 +140,18 @@
 		// group values with the same key
 		for (previous = table[index]; previous
 				&amp;&amp; !HashTable::fDefinition.CompareValues(previous, value);
-				previous = HashTable::_Link(previous)-&gt;fNext);
+				previous = HashTable::_Link(previous));
 
 		if (previous) {
-			_Link(value)-&gt;fNext = _Link(previous)-&gt;fNext;
-			_Link(previous)-&gt;fNext = value;
+			_Link(value) = _Link(previous);
+			_Link(previous) = value;
 		} else {
-			_Link(value)-&gt;fNext = table[index];
+			_Link(value) = table[index];
 			table[index] = value;
 		}
 	}
 
-	// TODO use OpenHashTable's _Resize
+	// TODO use BOpenHashTable's _Resize
 	bool _Resize(size_t newSize)
 	{
 		ValueType **newTable = new ValueType *[newSize];
@@ -165,7 +165,7 @@
 			for (size_t i = 0; i &lt; HashTable::fTableSize; i++) {
 				ValueType *bucket = HashTable::fTable[i];
 				while (bucket) {
-					ValueType *next = _Link(bucket)-&gt;fNext;
+					ValueType *next = _Link(bucket);
 					_Insert(newTable, newSize, bucket);
 					bucket = next;
 				}

Modified: haiku/trunk/headers/private/kernel/util/OpenHashTable.h
===================================================================
--- haiku/trunk/headers/private/kernel/util/OpenHashTable.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/headers/private/kernel/util/OpenHashTable.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -21,10 +21,10 @@
 	`Compare' and `GetLink;. It must also define several types as shown in the
 	following example:
 
-	struct Foo : HashTableLink&lt;Foo&gt; {
+	struct Foo {
 		int bar;
 
-		HashTableLink&lt;Foo&gt; otherLink;
+		Foo* fNext;
 	};
 
 	struct HashTableDefinition {
@@ -34,22 +34,18 @@
 		HashTableDefinition(const HashTableDefinition&amp;) {}
 
 		size_t HashKey(int key) const { return key &gt;&gt; 1; }
-		size_t Hash(Foo *value) const { return HashKey(value-&gt;bar); }
-		bool Compare(int key, Foo *value) const { return value-&gt;bar == key; }
-		HashTableLink&lt;Foo&gt; *GetLink(Foo *value) const { return value; }
+		size_t Hash(Foo* value) const { return HashKey(value-&gt;bar); }
+		bool Compare(int key, Foo* value) const { return value-&gt;bar == key; }
+		Foo*&amp; GetLink(Foo* value) const { return value-&gt;fNext; }
 	};
 */
 
-template&lt;typename Type&gt;
-struct HashTableLink {
-	Type *fNext;
-};
 
 template&lt;typename Definition, bool AutoExpand = true,
 	bool CheckDuplicates = false&gt;
-class OpenHashTable {
+class BOpenHashTable {
 public:
-	typedef OpenHashTable&lt;Definition, AutoExpand, CheckDuplicates&gt; HashTable;
+	typedef BOpenHashTable&lt;Definition, AutoExpand, CheckDuplicates&gt; HashTable;
 	typedef typename Definition::KeyType	KeyType;
 	typedef typename Definition::ValueType	ValueType;
 
@@ -62,7 +58,7 @@
 	// regrowth factor: 200 / 256 = 78.125%
 	//                   50 / 256 = 19.53125%
 
-	OpenHashTable()
+	BOpenHashTable()
 		:
 		fTableSize(0),
 		fItemCount(0),
@@ -70,7 +66,7 @@
 	{
 	}
 
-	OpenHashTable(const Definition&amp; definition)
+	BOpenHashTable(const Definition&amp; definition)
 		:
 		fDefinition(definition),
 		fTableSize(0),
@@ -79,7 +75,7 @@
 	{
 	}
 
-	~OpenHashTable()
+	~BOpenHashTable()
 	{
 		free(fTable);
 	}
@@ -101,24 +97,24 @@
 		return fItemCount;
 	}
 
-	ValueType *Lookup(const KeyType &amp;key) const
+	ValueType* Lookup(const KeyType&amp; key) const
 	{
 		if (fTableSize == 0)
 			return NULL;
 
 		size_t index = fDefinition.HashKey(key) &amp; (fTableSize - 1);
-		ValueType *slot = fTable[index];
+		ValueType* slot = fTable[index];
 
 		while (slot) {
 			if (fDefinition.Compare(key, slot))
 				break;
-			slot = _Link(slot)-&gt;fNext;
+			slot = _Link(slot);
 		}
 
 		return slot;
 	}
 
-	status_t Insert(ValueType *value)
+	status_t Insert(ValueType* value)
 	{
 		if (fTableSize == 0) {
 			if (!_Resize(kMinimumSize))
@@ -130,7 +126,7 @@
 		return B_OK;
 	}
 
-	void InsertUnchecked(ValueType *value)
+	void InsertUnchecked(ValueType* value)
 	{
 		if (CheckDuplicates &amp;&amp; _ExhaustiveSearch(value)) {
 #ifdef _KERNEL_MODE
@@ -146,7 +142,7 @@
 
 	// TODO: a ValueType* Remove(const KeyType&amp; key) method is missing
 
-	bool Remove(ValueType *value)
+	bool Remove(ValueType* value)
 	{
 		if (!RemoveUnchecked(value))
 			return false;
@@ -158,17 +154,18 @@
 		return true;
 	}
 
-	bool RemoveUnchecked(ValueType *value)
+	bool RemoveUnchecked(ValueType* value)
 	{
 		size_t index = fDefinition.Hash(value) &amp; (fTableSize - 1);
-		ValueType *previous = NULL, *slot = fTable[index];
+		ValueType* previous = NULL;
+		ValueType* slot = fTable[index];
 
 		while (slot) {
-			ValueType *next = _Link(slot)-&gt;fNext;
+			ValueType* next = _Link(slot);
 
 			if (value == slot) {
 				if (previous)
-					_Link(previous)-&gt;fNext = next;
+					_Link(previous) = next;
 				else
 					fTable[index] = next;
 				break;
@@ -217,7 +214,7 @@
 					// update nextPointer to point to the fNext of the last
 					// element in the bucket
 					while (element != NULL) {
-						nextPointer = &amp;_Link(element)-&gt;fNext;
+						nextPointer = &amp;_Link(element);
 						element = *nextPointer;
 					}
 				}
@@ -274,20 +271,20 @@
 
 	class Iterator {
 	public:
-		Iterator(const HashTable *table)
+		Iterator(const HashTable* table)
 			: fTable(table)
 		{
 			Rewind();
 		}
 
-		Iterator(const HashTable *table, size_t index, ValueType *value)
+		Iterator(const HashTable* table, size_t index, ValueType* value)
 			: fTable(table), fIndex(index), fNext(value) {}
 
 		bool HasNext() const { return fNext != NULL; }
 
-		ValueType *Next()
+		ValueType* Next()
 		{
-			ValueType *current = fNext;
+			ValueType* current = fNext;
 			_GetNext();
 			return current;
 		}
@@ -306,15 +303,15 @@
 		void _GetNext()
 		{
 			if (fNext)
-				fNext = fTable-&gt;_Link(fNext)-&gt;fNext;
+				fNext = fTable-&gt;_Link(fNext);
 
 			while (fNext == NULL &amp;&amp; fIndex &lt; fTable-&gt;fTableSize)
 				fNext = fTable-&gt;fTable[fIndex++];
 		}
 
-		const HashTable *fTable;
+		const HashTable* fTable;
 		size_t fIndex;
-		ValueType *fNext;
+		ValueType* fNext;
 	};
 
 	Iterator GetIterator() const { return Iterator(this); }
@@ -323,11 +320,11 @@
 	// for g++ 2.95
 	friend class Iterator;
 
-	void _Insert(ValueType **table, size_t tableSize, ValueType *value)
+	void _Insert(ValueType** table, size_t tableSize, ValueType* value)
 	{
 		size_t index = fDefinition.Hash(value) &amp; (tableSize - 1);
 
-		_Link(value)-&gt;fNext = table[index];
+		_Link(value) = table[index];
 		table[index] = value;
 	}
 
@@ -349,9 +346,9 @@
 
 		if (fTable) {
 			for (size_t i = 0; i &lt; fTableSize; i++) {
-				ValueType *bucket = fTable[i];
+				ValueType* bucket = fTable[i];
 				while (bucket) {
-					ValueType *next = _Link(bucket)-&gt;fNext;
+					ValueType* next = _Link(bucket);
 					_Insert(newTable, newSize, bucket);
 					bucket = next;
 				}
@@ -364,28 +361,29 @@
 		fTable = newTable;
 	}
 
-	HashTableLink&lt;ValueType&gt; *_Link(ValueType *bucket) const
+	ValueType*&amp; _Link(ValueType* bucket) const
 	{
 		return fDefinition.GetLink(bucket);
 	}
 
-	bool _ExhaustiveSearch(ValueType *value) const
+	bool _ExhaustiveSearch(ValueType* value) const
 	{
 		for (size_t i = 0; i &lt; fTableSize; i++) {
-			ValueType *bucket = fTable[i];
+			ValueType* bucket = fTable[i];
 			while (bucket) {
 				if (bucket == value)
 					return true;
-				bucket = _Link(bucket)-&gt;fNext;
+				bucket = _Link(bucket);
 			}
 		}
 
 		return false;
 	}
 
-	Definition fDefinition;
-	size_t fTableSize, fItemCount;
-	ValueType **fTable;
+	Definition		fDefinition;
+	size_t			fTableSize;
+	size_t			fItemCount;
+	ValueType**		fTable;
 };
 
 #endif	// _KERNEL_UTIL_OPEN_HASH_TABLE_H

Modified: haiku/trunk/headers/private/userlandfs/shared/HashMap.h
===================================================================
--- haiku/trunk/headers/private/userlandfs/shared/HashMap.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/headers/private/userlandfs/shared/HashMap.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -15,7 +15,7 @@
 
 // HashMapElement
 template&lt;typename Key, typename Value&gt;
-class HashMapElement : public HashTableLink&lt;HashMapElement&lt;Key, Value&gt; &gt; {
+class HashMapElement {
 private:
 	typedef HashMapElement&lt;Key, Value&gt; Element;
 
@@ -34,8 +34,9 @@
 	{
 	}
 
-	Key		fKey;
-	Value	fValue;
+	Key				fKey;
+	Value			fValue;
+	HashMapElement*	fNext;
 };
 
 
@@ -51,8 +52,8 @@
 		{ return HashKey(value-&gt;fKey); }
 	bool Compare(const KeyType&amp; key, const ValueType* value) const
 		{ return value-&gt;fKey == key; }
-	HashTableLink&lt;ValueType&gt;* GetLink(ValueType* value) const
-		{ return value; }
+	ValueType*&amp; GetLink(ValueType* value) const
+		{ return value-&gt;fNext; }
 };
 
 
@@ -128,7 +129,8 @@
 
 	private:
 		friend class HashMap&lt;Key, Value&gt;;
-		typedef OpenHashTable&lt;HashMapTableDefinition&lt;Key, Value&gt; &gt; ElementTable;
+		typedef BOpenHashTable&lt;HashMapTableDefinition&lt;Key, Value&gt; &gt;
+			ElementTable;
 
 		HashMap&lt;Key, Value&gt;*			fMap;
 		typename ElementTable::Iterator	fIterator;
@@ -152,7 +154,7 @@
 	Iterator GetIterator();
 
 protected:
-	typedef OpenHashTable&lt;HashMapTableDefinition&lt;Key, Value&gt; &gt; ElementTable;
+	typedef BOpenHashTable&lt;HashMapTableDefinition&lt;Key, Value&gt; &gt; ElementTable;
 	typedef HashMapElement&lt;Key, Value&gt;	Element;
 	friend class Iterator;
 

Modified: haiku/trunk/src/add-ons/kernel/bus_managers/agp_gart/agp_gart.cpp
===================================================================
--- haiku/trunk/src/add-ons/kernel/bus_managers/agp_gart/agp_gart.cpp	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/bus_managers/agp_gart/agp_gart.cpp	2009-07-27 00:39:12 UTC (rev 31791)
@@ -74,8 +74,9 @@
 #define BIND_APERTURE				0x20000000
 #define APERTURE_PUBLIC_FLAGS_MASK	0x0000ffff
 
-struct aperture_memory : HashTableLink&lt;aperture_memory&gt; {
+struct aperture_memory {
 	aperture_memory *next;
+	aperture_memory *hash_link;
 	addr_t		base;
 	size_t		size;
 	uint32		flags;
@@ -104,21 +105,21 @@
 		{ return (memory-&gt;base - fInfo.base) / B_PAGE_SIZE; }
 	bool Compare(const KeyType &amp;base, aperture_memory *memory) const
 		{ return base == memory-&gt;base; }
-	HashTableLink&lt;aperture_memory&gt; *GetLink(aperture_memory *memory) const
-		{ return memory; }
+	aperture_memory *&amp;GetLink(aperture_memory *memory) const
+		{ return memory-&gt;hash_link; }
 
 private:
 	aperture_info	&fInfo;
 };
 
-typedef OpenHashTable&lt;MemoryHashDefinition&gt; MemoryHashTable;
+typedef BOpenHashTable&lt;MemoryHashDefinition&gt; MemoryHashTable;
 
 struct agp_device_info {
 	uint8		address;	/* location of AGP interface in PCI capabilities */
 	agp_info	info;
 };
 
-class Aperture : public HashTableLink&lt;Aperture&gt; {
+class Aperture {
 public:
 	Aperture(agp_gart_bus_module_info *module, void *aperture);
 	~Aperture();
@@ -156,6 +157,9 @@
 	MemoryHashTable				fHashTable;
 	aperture_memory				*fFirstMemory;
 	void						*fPrivateAperture;
+
+public:
+	Aperture					*fNext;
 };
 
 class ApertureHashDefinition {
@@ -169,11 +173,11 @@
 		{ return aperture-&gt;ID(); }
 	bool Compare(const KeyType &amp;id, Aperture *aperture) const
 		{ return id == aperture-&gt;ID(); }
-	HashTableLink&lt;Aperture&gt; *GetLink(Aperture *aperture) const
-		{ return aperture; }
+	Aperture *&amp;GetLink(Aperture *aperture) const
+		{ return aperture-&gt;fNext; }
 };
 
-typedef OpenHashTable&lt;ApertureHashDefinition&gt; ApertureHashTable;
+typedef BOpenHashTable&lt;ApertureHashDefinition&gt; ApertureHashTable;
 
 
 static agp_device_info sDeviceInfos[MAX_DEVICES];

Modified: haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/FileSystem.cpp
===================================================================
--- haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/FileSystem.cpp	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/FileSystem.cpp	2009-07-27 00:39:12 UTC (rev 31791)
@@ -76,7 +76,7 @@
 	int32 count = 0;
 	while (ops != NULL) {
 		count++;
-		VNodeOps* next = ops-&gt;fNext;
+		VNodeOps* next = ops-&gt;hash_link;
 		free(ops);
 		ops = next;
 	}

Modified: haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/FileSystem.h
===================================================================
--- haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/FileSystem.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/FileSystem.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -25,10 +25,11 @@
 class Volume;
 
 
-struct VNodeOps : HashTableLink&lt;VNodeOps&gt; {
+struct VNodeOps {
 	int32				refCount;
 	FSVNodeCapabilities	capabilities;
 	fs_vnode_ops*		ops;
+	VNodeOps*			hash_link;
 
 	VNodeOps(const FSVNodeCapabilities&amp; capabilities, fs_vnode_ops* ops)
 		:
@@ -55,8 +56,8 @@
 		{ return HashKey(value-&gt;capabilities); }
 	bool Compare(const FSVNodeCapabilities&amp; key, const VNodeOps* value) const
 		{ return value-&gt;capabilities == key; }
-	HashTableLink&lt;VNodeOps&gt;* GetLink(VNodeOps* value) const
-		{ return value; }
+	VNodeOps*&amp; GetLink(VNodeOps* value) const
+		{ return value-&gt;hash_link; }
 };
 
 
@@ -109,7 +110,7 @@
 			friend class KernelDebug;
 			struct SelectSyncEntry;
 			struct SelectSyncMap;
-			typedef OpenHashTable&lt;VNodeOpsHashDefinition&gt; VNodeOpsMap;
+			typedef BOpenHashTable&lt;VNodeOpsHashDefinition&gt; VNodeOpsMap;
 
 			Vector&lt;Volume*&gt;		fVolumes;
 			mutex				fVolumeLock;

Modified: haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/Volume.cpp
===================================================================
--- haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/Volume.cpp	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/kernel_add_on/Volume.cpp	2009-07-27 00:39:12 UTC (rev 31791)
@@ -47,7 +47,7 @@
 
 
 // VNode
-struct Volume::VNode : HashTableLink&lt;VNode&gt; {
+struct Volume::VNode {
 	ino_t		id;
 	void*		clientNode;
 	void*		fileCache;
@@ -55,6 +55,7 @@
 	int32		useCount;
 	bool		valid;
 	bool		published;
+	VNode*		hash_link;
 
 	VNode(ino_t id, void* clientNode, VNodeOps* ops)
 		:
@@ -98,14 +99,14 @@
 		{ return HashKey(value-&gt;id); }
 	bool Compare(ino_t key, const VNode* value) const
 		{ return value-&gt;id == key; }
-	HashTableLink&lt;VNode&gt;* GetLink(VNode* value) const
-		{ return value; }
+	VNode*&amp; GetLink(VNode* value) const
+		{ return value-&gt;hash_link; }
 };
 
 
 // VNodeMap
 struct Volume::VNodeMap
-	: public OpenHashTable&lt;VNodeHashDefinition&gt; {
+	: public BOpenHashTable&lt;VNodeHashDefinition&gt; {
 };
 
 
@@ -114,8 +115,8 @@
 	io_request*						request;
 	int32							id;
 
-	HashTableLink&lt;IORequestInfo&gt;	idLink;
-	HashTableLink&lt;IORequestInfo&gt;	structLink;
+	IORequestInfo*					idLink;
+	IORequestInfo*					structLink;
 
 	IORequestInfo(io_request* request, int32 id)
 		:
@@ -137,8 +138,8 @@
 		{ return HashKey(value-&gt;id); }
 	bool Compare(int32 key, const IORequestInfo* value) const
 		{ return value-&gt;id == key; }
-	HashTableLink&lt;IORequestInfo&gt;* GetLink(IORequestInfo* value) const
-		{ return &amp;value-&gt;idLink; }
+	IORequestInfo*&amp; GetLink(IORequestInfo* value) const
+		{ return value-&gt;idLink; }
 };
 
 
@@ -153,20 +154,20 @@
 		{ return HashKey(value-&gt;request); }
 	bool Compare(io_request* key, const IORequestInfo* value) const
 		{ return value-&gt;request == key; }
-	HashTableLink&lt;IORequestInfo&gt;* GetLink(IORequestInfo* value) const
-		{ return &amp;value-&gt;structLink; }
+	IORequestInfo*&amp; GetLink(IORequestInfo* value) const
+		{ return value-&gt;structLink; }
 };
 
 
 // IORequestIDMap
 struct Volume::IORequestIDMap
-	: public OpenHashTable&lt;IORequestIDHashDefinition&gt; {
+	: public BOpenHashTable&lt;IORequestIDHashDefinition&gt; {
 };
 
 
 // IORequestStructMap
 struct Volume::IORequestStructMap
-	: public OpenHashTable&lt;IORequestStructHashDefinition&gt; {
+	: public BOpenHashTable&lt;IORequestStructHashDefinition&gt; {
 };
 
 
@@ -802,7 +803,7 @@
 		if (fVNodes != NULL) {
 			VNode* node = fVNodes-&gt;Clear(true);
 			while (node != NULL) {
-				VNode* nextNode = node-&gt;fNext;
+				VNode* nextNode = node-&gt;hash_link;
 				node-&gt;Delete(this);
 				node = nextNode;
 			}
@@ -820,7 +821,7 @@
 		if (fIORequestInfosByStruct != NULL) {
 			IORequestInfo* info = fIORequestInfosByStruct-&gt;Clear(true);
 			while (info != NULL) {
-				IORequestInfo* nextInfo = info-&gt;structLink.fNext;
+				IORequestInfo* nextInfo = info-&gt;structLink;
 				delete info;
 				info = nextInfo;
 			}

Modified: haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/fuse/FUSEEntry.h
===================================================================
--- haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/fuse/FUSEEntry.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/fuse/FUSEEntry.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -35,11 +35,11 @@
 };
 
 
-struct FUSEEntry : public HashTableLink&lt;FUSEEntry&gt;,
-		DoublyLinkedListLinkImpl&lt;FUSEEntry&gt; {
+struct FUSEEntry : DoublyLinkedListLinkImpl&lt;FUSEEntry&gt; {
 	FUSENode*	parent;
 	char*		name;
 	FUSENode*	node;
+	FUSEEntry*	hashLink;
 
 	FUSEEntry()
 		:
@@ -77,12 +77,13 @@
 typedef DoublyLinkedList&lt;FUSEEntry&gt; FUSEEntryList;
 
 
-struct FUSENode : RWLockable, HashTableLink&lt;FUSENode&gt; {
+struct FUSENode : RWLockable {
 	ino_t			id;
 	FUSEEntryList	entries;
 	int				type;
 	int32			refCount;
 	bool			dirty;
+	FUSENode*		hashLink;
 
 	FUSENode(ino_t id, int type)
 		:
@@ -113,8 +114,8 @@
 	bool Compare(const FUSEEntryRef&amp; key, const FUSEEntry* value) const
 		{ return value-&gt;parent-&gt;id == key.parentID
 			&amp;&amp; strcmp(value-&gt;name, key.name) == 0; }
-	HashTableLink&lt;FUSEEntry&gt;* GetLink(FUSEEntry* value) const
-		{ return value; }
+	FUSEEntry*&amp; GetLink(FUSEEntry* value) const
+		{ return value-&gt;hashLink; }
 };
 
 
@@ -128,13 +129,13 @@
 		{ return HashKey(value-&gt;id); }
 	bool Compare(ino_t key, const FUSENode* value) const
 		{ return value-&gt;id == key; }
-	HashTableLink&lt;FUSENode&gt;* GetLink(FUSENode* value) const
-		{ return value; }
+	FUSENode*&amp; GetLink(FUSENode* value) const
+		{ return value-&gt;hashLink; }
 };
 
 
-typedef OpenHashTable&lt;FUSEEntryHashDefinition&gt; FUSEEntryTable;
-typedef OpenHashTable&lt;FUSENodeHashDefinition&gt; FUSENodeTable;
+typedef BOpenHashTable&lt;FUSEEntryHashDefinition&gt; FUSEEntryTable;
+typedef BOpenHashTable&lt;FUSENodeHashDefinition&gt; FUSENodeTable;
 
 
 }	// namespace UserlandFS

Modified: haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelFileSystem.cpp
===================================================================
--- haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelFileSystem.cpp	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelFileSystem.cpp	2009-07-27 00:39:12 UTC (rev 31791)
@@ -32,15 +32,14 @@
 		{ return value-&gt;id; }
 	bool Compare(int32 key, const HaikuKernelIORequest* value) const
 		{ return value-&gt;id == key; }
-	HashTableLink&lt;HaikuKernelIORequest&gt;*
-		GetLink(HaikuKernelIORequest* value) const
-			{ return value; }
+	HaikuKernelIORequest*&amp; GetLink(HaikuKernelIORequest* value) const
+			{ return value-&gt;hashLink; }
 };
 
 
 // IORequestTable
 struct HaikuKernelFileSystem::IORequestTable
-	: public OpenHashTable&lt;IORequestHashDefinition&gt; {
+	: public BOpenHashTable&lt;IORequestHashDefinition&gt; {
 	typedef int32					KeyType;
 	typedef	HaikuKernelIORequest	ValueType;
 
@@ -50,9 +49,8 @@
 		{ return value-&gt;id; }
 	bool Compare(int32 key, const HaikuKernelIORequest* value) const
 		{ return value-&gt;id == key; }
-	HashTableLink&lt;HaikuKernelIORequest&gt;*
-		GetLink(HaikuKernelIORequest* value) const
-			{ return value; }
+	HaikuKernelIORequest*&amp; GetLink(HaikuKernelIORequest* value) const
+			{ return value-&gt;hashLink; }
 };
 
 
@@ -67,14 +65,14 @@
 		{ return HashKey(value-&gt;ops); }
 	bool Compare(fs_vnode_ops* key, const ValueType* value) const
 		{ return value-&gt;ops == key; }
-	HashTableLink&lt;ValueType&gt;* GetLink(ValueType* value) const
-		{ return value; }
+	ValueType*&amp; GetLink(ValueType* value) const
+		{ return value-&gt;hashLink; }
 };
 
 
 // NodeCapabilitiesTable
 struct HaikuKernelFileSystem::NodeCapabilitiesTable
-	: public OpenHashTable&lt;NodeCapabilitiesHashDefinition&gt; {
+	: public BOpenHashTable&lt;NodeCapabilitiesHashDefinition&gt; {
 };
 
 

Modified: haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelIORequest.h
===================================================================
--- haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelIORequest.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelIORequest.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -16,11 +16,11 @@
 
 class HaikuKernelVolume;
 
-struct HaikuKernelIORequest : HashTableLink&lt;HaikuKernelIORequest&gt;,
-	IORequestInfo {
+struct HaikuKernelIORequest : IORequestInfo {
 
-	HaikuKernelVolume*	volume;
-	int32				refCount;
+	HaikuKernelVolume*		volume;
+	int32					refCount;
+	HaikuKernelIORequest*	hashLink;
 
 	HaikuKernelIORequest(HaikuKernelVolume* volume, const IORequestInfo&amp; info)
 		:

Modified: haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelNode.h
===================================================================
--- haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelNode.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/file_systems/userlandfs/server/haiku/HaikuKernelNode.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -41,10 +41,11 @@
 };
 
 
-struct HaikuKernelNode::Capabilities : HashTableLink&lt;Capabilities&gt; {
+struct HaikuKernelNode::Capabilities {
 	int32				refCount;
 	fs_vnode_ops*		ops;
 	FSVNodeCapabilities	capabilities;
+	Capabilities*		hashLink;
 
 	Capabilities(fs_vnode_ops* ops, FSVNodeCapabilities	capabilities)
 		:

Modified: haiku/trunk/src/add-ons/kernel/network/protocols/ipv4/ipv4.cpp
===================================================================
--- haiku/trunk/src/add-ons/kernel/network/protocols/ipv4/ipv4.cpp	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/network/protocols/ipv4/ipv4.cpp	2009-07-27 00:39:12 UTC (rev 31791)
@@ -150,7 +150,7 @@
 	bool CompareValues(ValueType* value1, ValueType* value2) const
 		{ return value1-&gt;Interface()-&gt;index == value2-&gt;Interface()-&gt;index
 			&amp;&amp; value1-&gt;Address().s_addr == value2-&gt;Address().s_addr; }
-	HashTableLink&lt;ValueType&gt;* GetLink(ValueType* value) const { return value; }
+	ValueType*&amp; GetLink(ValueType* value) const { return value-&gt;HashLink(); }
 };
 
 

Modified: haiku/trunk/src/add-ons/kernel/network/protocols/ipv4/multicast.h
===================================================================
--- haiku/trunk/src/add-ons/kernel/network/protocols/ipv4/multicast.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/network/protocols/ipv4/multicast.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -126,11 +126,9 @@
 
 
 template&lt;typename Addressing&gt;
-class MulticastGroupInterface
-	: public HashTableLink&lt; MulticastGroupInterface&lt;Addressing&gt; &gt; {
+class MulticastGroupInterface {
 public:
 	typedef MulticastGroupInterface&lt;Addressing&gt; ThisType;
-	typedef HashTableLink&lt;ThisType&gt; HashLink;
 	typedef typename Addressing::AddressType AddressType;
 	typedef MulticastFilter&lt;Addressing&gt; Filter;
 	typedef ::AddressSet&lt;AddressType&gt; AddressSet;
@@ -176,9 +174,12 @@
 		bool Compare(const KeyType &amp;key, ValueType *value) const
 			{ return value-&gt;Interface()-&gt;index == key.second
 				&amp;&amp; value-&gt;Address().s_addr == key.first-&gt;s_addr; }
-		HashLink  *GetLink(ValueType *value) const { return &amp;value-&gt;fLink; }
+		MulticastGroupInterface*&amp; GetLink(ValueType *value) const
+			{ return value-&gt;HashLink(); }
 	};
 
+	MulticastGroupInterface*&amp; HashLink() { return fLink; }
+
 private:
 	// for g++ 2.95
 	friend class HashDefinition;
@@ -188,7 +189,7 @@
 	net_interface *fInterface;
 	FilterMode fFilterMode;
 	AddressSet fAddresses;
-	HashLink fLink;
+	MulticastGroupInterface* fLink;
 };
 
 template&lt;typename Addressing&gt;
@@ -209,7 +210,7 @@
 
 private:
 	typedef typename GroupInterface::HashDefinition HashDefinition;
-	typedef OpenHashTable&lt;HashDefinition&gt; States;
+	typedef BOpenHashTable&lt;HashDefinition&gt; States;
 
 	void _ReturnState(GroupInterface *state);
 

Modified: haiku/trunk/src/add-ons/kernel/network/protocols/tcp/EndpointManager.cpp
===================================================================
--- haiku/trunk/src/add-ons/kernel/network/protocols/tcp/EndpointManager.cpp	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/network/protocols/tcp/EndpointManager.cpp	2009-07-27 00:39:12 UTC (rev 31791)
@@ -165,10 +165,10 @@
 }
 
 
-HashTableLink&lt;TCPEndpoint&gt;*
+TCPEndpoint*&amp;
 ConnectionHashDefinition::GetLink(TCPEndpoint* endpoint) const
 {
-	return &amp;endpoint-&gt;fConnectionHashLink;
+	return endpoint-&gt;fConnectionHashLink;
 }
 
 
@@ -204,10 +204,10 @@
 }
 
 
-HashTableLink&lt;TCPEndpoint&gt;*
+TCPEndpoint*&amp;
 EndpointHashDefinition::GetLink(TCPEndpoint* endpoint) const
 {
-	return &amp;endpoint-&gt;fEndpointHashLink;
+	return endpoint-&gt;fEndpointHashLink;
 }
 
 

Modified: haiku/trunk/src/add-ons/kernel/network/protocols/tcp/EndpointManager.h
===================================================================
--- haiku/trunk/src/add-ons/kernel/network/protocols/tcp/EndpointManager.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/network/protocols/tcp/EndpointManager.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -45,7 +45,7 @@
 			size_t			Hash(TCPEndpoint* endpoint) const;
 			bool			Compare(const KeyType&amp; key,
 								TCPEndpoint* endpoint) const;
-			HashTableLink&lt;TCPEndpoint&gt;* GetLink(TCPEndpoint* endpoint) const;
+			TCPEndpoint*&amp; GetLink(TCPEndpoint* endpoint) const;
 
 private:
 	EndpointManager*		fManager;
@@ -62,7 +62,7 @@
 			bool			Compare(uint16 port, TCPEndpoint* endpoint) const;
 			bool			CompareValues(TCPEndpoint* first,
 								TCPEndpoint* second) const;
-			HashTableLink&lt;TCPEndpoint&gt;* GetLink(TCPEndpoint* endpoint) const;
+			TCPEndpoint*&amp;	GetLink(TCPEndpoint* endpoint) const;
 };
 
 
@@ -104,7 +104,7 @@
 			status_t		_BindToEphemeral(TCPEndpoint* endpoint,
 								const sockaddr* address);
 
-	typedef OpenHashTable&lt;ConnectionHashDefinition&gt; ConnectionTable;
+	typedef BOpenHashTable&lt;ConnectionHashDefinition&gt; ConnectionTable;
 	typedef MultiHashTable&lt;EndpointHashDefinition&gt; EndpointTable;
 
 	rw_lock					fLock;

Modified: haiku/trunk/src/add-ons/kernel/network/protocols/tcp/TCPEndpoint.h
===================================================================
--- haiku/trunk/src/add-ons/kernel/network/protocols/tcp/TCPEndpoint.h	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/network/protocols/tcp/TCPEndpoint.h	2009-07-27 00:39:12 UTC (rev 31791)
@@ -133,8 +133,8 @@
 							void* _endpoint);
 
 private:
-	HashTableLink&lt;TCPEndpoint&gt; fConnectionHashLink;
-	HashTableLink&lt;TCPEndpoint&gt; fEndpointHashLink;
+	TCPEndpoint*	fConnectionHashLink;
+	TCPEndpoint*	fEndpointHashLink;
 	friend class EndpointManager;
 	friend class ConnectionHashDefinition;
 	friend class EndpointHashDefinition;

Modified: haiku/trunk/src/add-ons/kernel/network/protocols/udp/udp.cpp
===================================================================
--- haiku/trunk/src/add-ons/kernel/network/protocols/udp/udp.cpp	2009-07-27 00:35:21 UTC (rev 31790)
+++ haiku/trunk/src/add-ons/kernel/network/protocols/udp/udp.cpp	2009-07-27 00:39:12 UTC (rev 31791)
@@ -96,15 +96,15 @@
 	bool					IsActive() const { return fActive; }
 	void					SetActive(bool newValue) { fActive = newValue; }
 
-	::HashTableLink&lt;UdpEndpoint&gt; *HashTableLink() { return &fLink; }
+	UdpEndpoint				*&amp;HashTableLink() { return fLink; }
 
 private:
 	UdpDomainSupport		*fManager;
 	bool					fActive;
-								// an active UdpEndpoint is part of the endpoint 
+								// an active UdpEndpoint is part of the endpoint
 								// hash (and it is bound and optionally connected)
 
-	::HashTableLink&lt;UdpEndpoint&gt; fLink;
+	UdpEndpoint				*fLink;
 };
 
 
@@ -143,7 +143,7 @@
 			&amp;&amp; endpoint-&gt;PeerAddress().EqualTo(key.second, true);
 	}
 
-	::HashTableLink&lt;UdpEndpoint&gt; *GetLink(UdpEndpoint *endpoint) const
+	UdpEndpoint *&amp;GetLink(UdpEndpoint *endpoint) const
 	{
 		return endpoint-&gt;HashTableLink();
 	}

[... truncated: 1329 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="018310.html">[Haiku-commits] r31790 - in haiku/trunk: headers/os/drivers/usb	src/add-ons/kernel/drivers/input/usb_hid
</A></li>
	<LI>Next message: <A HREF="018298.html">[Haiku-commits] r31791 - in haiku/trunk: headers/private/kernel	headers/private/kernel/util headers/private/userlandfs/shared	src/add-ons/kernel/bus_managers/agp_gart	src/add-ons/kernel/file_systems/userlandfs/kernel_add_on	src/add-ons/kernel/fil
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18297">[ date ]</a>
              <a href="thread.html#18297">[ thread ]</a>
              <a href="subject.html#18297">[ subject ]</a>
              <a href="author.html#18297">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
