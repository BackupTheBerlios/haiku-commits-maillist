<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r28723 - in haiku/trunk: headers/libs/png	src/libs/png
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r28723%20-%20in%20haiku/trunk%3A%20headers/libs/png%0A%09src/libs/png&In-Reply-To=%3C200811231402.mANE23Gs016920%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013628.html">
   <LINK REL="Next"  HREF="013629.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r28723 - in haiku/trunk: headers/libs/png	src/libs/png</H1>
    <B>korli at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r28723%20-%20in%20haiku/trunk%3A%20headers/libs/png%0A%09src/libs/png&In-Reply-To=%3C200811231402.mANE23Gs016920%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r28723 - in haiku/trunk: headers/libs/png	src/libs/png">korli at mail.berlios.de
       </A><BR>
    <I>Sun Nov 23 15:02:03 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="013628.html">[Haiku-commits] r28722 - haiku/trunk/src/bin
</A></li>
        <LI>Next message: <A HREF="013629.html">[Haiku-commits] r28724 -	haiku/trunk/src/add-ons/kernel/drivers/audio/hda
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13627">[ date ]</a>
              <a href="thread.html#13627">[ thread ]</a>
              <a href="subject.html#13627">[ subject ]</a>
              <a href="author.html#13627">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: korli
Date: 2008-11-23 15:02:02 +0100 (Sun, 23 Nov 2008)
New Revision: 28723
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=28723&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=28723&amp;view=rev</A>

Modified:
   haiku/trunk/headers/libs/png/png.h
   haiku/trunk/headers/libs/png/pngconf.h
   haiku/trunk/src/libs/png/LICENSE
   haiku/trunk/src/libs/png/png.c
   haiku/trunk/src/libs/png/pngrutil.c
Log:
updated libpng to 1.2.33


Modified: haiku/trunk/headers/libs/png/png.h
===================================================================
--- haiku/trunk/headers/libs/png/png.h	2008-11-23 01:00:26 UTC (rev 28722)
+++ haiku/trunk/headers/libs/png/png.h	2008-11-23 14:02:02 UTC (rev 28723)
@@ -1,6 +1,6 @@
 /* png.h - header file for PNG reference library
  *
- * libpng version 1.2.32 - September 18, 2008
+ * libpng version 1.2.33 - October 31, 2008
  * Copyright (c) 1998-2008 Glenn Randers-Pehrson
  * (Version 0.96 Copyright (c) 1996, 1997 Andreas Dilger)
  * (Version 0.88 Copyright (c) 1995, 1996 Guy Eric Schalnat, Group 42, Inc.)
@@ -8,7 +8,7 @@
  * Authors and maintainers:
  *  libpng versions 0.71, May 1995, through 0.88, January 1996: Guy Schalnat
  *  libpng versions 0.89c, June 1996, through 0.96, May 1997: Andreas Dilger
- *  libpng versions 0.97, January 1998, through 1.2.32 - September 18, 2008: Glenn
+ *  libpng versions 0.97, January 1998, through 1.2.33 - October 31, 2008: Glenn
  *  See also &quot;Contributing Authors&quot;, below.
  *
  * Note about libpng version numbers:
@@ -207,6 +207,11 @@
  *    1.2.32rc01              13    10232  12.so.0.32[.0]
  *    1.0.40                  10    10040  10.so.0.40[.0]
  *    1.2.32                  13    10232  12.so.0.32[.0]
+ *    1.2.33beta01-02         13    10233  12.so.0.33[.0]
+ *    1.2.33rc01-02           13    10233  12.so.0.33[.0]
+ *    1.0.41rc01              10    10041  10.so.0.41[.0]
+ *    1.2.33                  13    10233  12.so.0.33[.0]
+ *    1.0.41                  10    10041  10.so.0.41[.0]
  *
  *    Henceforth the source version will match the shared-library major
  *    and minor numbers; the shared-library major version number will be
@@ -236,7 +241,7 @@
  * If you modify libpng you may insert additional notices immediately following
  * this sentence.
  *
- * libpng versions 1.2.6, August 15, 2004, through 1.2.32, September 18, 2008, are
+ * libpng versions 1.2.6, August 15, 2004, through 1.2.33, October 31, 2008, are
  * Copyright (c) 2004, 2006-2008 Glenn Randers-Pehrson, and are
  * distributed according to the same disclaimer and license as libpng-1.2.5
  * with the following individual added to the list of Contributing Authors:
@@ -348,13 +353,13 @@
  * Y2K compliance in libpng:
  * =========================
  *
- *    September 18, 2008
+ *    October 31, 2008
  *
  *    Since the PNG Development group is an ad-hoc body, we can't make
  *    an official declaration.
  *
  *    This is your unofficial assurance that libpng from version 0.71 and
- *    upward through 1.2.32 are Y2K compliant.  It is my belief that earlier
+ *    upward through 1.2.33 are Y2K compliant.  It is my belief that earlier
  *    versions were also Y2K compliant.
  *
  *    Libpng only has three year fields.  One is a 2-byte unsigned integer
@@ -410,9 +415,9 @@
  */
 
 /* Version information for png.h - this should match the version in png.c */
-#define PNG_LIBPNG_VER_STRING &quot;1.2.32&quot;
+#define PNG_LIBPNG_VER_STRING &quot;1.2.33&quot;
 #define PNG_HEADER_VERSION_STRING \
-   &quot; libpng version 1.2.32 - September 18, 2008\n&quot;
+   &quot; libpng version 1.2.33 - October 31, 2008\n&quot;
 
 #define PNG_LIBPNG_VER_SONUM   0
 #define PNG_LIBPNG_VER_DLLNUM  13
@@ -420,7 +425,7 @@
 /* These should match the first 3 components of PNG_LIBPNG_VER_STRING: */
 #define PNG_LIBPNG_VER_MAJOR   1
 #define PNG_LIBPNG_VER_MINOR   2
-#define PNG_LIBPNG_VER_RELEASE 32
+#define PNG_LIBPNG_VER_RELEASE 33
 /* This should match the numeric part of the final component of
  * PNG_LIBPNG_VER_STRING, omitting any leading zero: */
 
@@ -448,7 +453,7 @@
  * Versions 0.7 through 1.0.0 were in the range 0 to 100 here (only
  * version 1.0.0 was mis-numbered 100 instead of 10000).  From
  * version 1.0.1 it's    xxyyzz, where x=major, y=minor, z=release */
-#define PNG_LIBPNG_VER 10232 /* 1.2.32 */
+#define PNG_LIBPNG_VER 10233 /* 1.2.33 */
 
 #ifndef PNG_VERSION_INFO_ONLY
 /* include the compression library's header */
@@ -1469,7 +1474,7 @@
 /* This triggers a compiler error in png.c, if png.c and png.h
  * do not agree upon the version number.
  */
-typedef png_structp version_1_2_32;
+typedef png_structp version_1_2_33;
 
 typedef png_struct FAR * FAR * png_structpp;
 

Modified: haiku/trunk/headers/libs/png/pngconf.h
===================================================================
--- haiku/trunk/headers/libs/png/pngconf.h	2008-11-23 01:00:26 UTC (rev 28722)
+++ haiku/trunk/headers/libs/png/pngconf.h	2008-11-23 14:02:02 UTC (rev 28723)
@@ -1,7 +1,7 @@
 
 /* pngconf.h - machine configurable file for libpng
  *
- * libpng version 1.2.32 - September 18, 2008
+ * libpng version 1.2.33 - October 31, 2008
  * For conditions of distribution and use, see copyright notice in png.h
  * Copyright (c) 1998-2008 Glenn Randers-Pehrson
  * (Version 0.96 Copyright (c) 1996, 1997 Andreas Dilger)

Modified: haiku/trunk/src/libs/png/LICENSE
===================================================================
--- haiku/trunk/src/libs/png/LICENSE	2008-11-23 01:00:26 UTC (rev 28722)
+++ haiku/trunk/src/libs/png/LICENSE	2008-11-23 14:02:02 UTC (rev 28723)
@@ -8,8 +8,8 @@
 If you modify libpng you may insert additional notices immediately following
 this sentence.
 
-libpng versions 1.2.6, August 15, 2004, through 1.2.22, October 13, 2007, are
-Copyright (c) 2004, 2006-2007 Glenn Randers-Pehrson, and are
+libpng versions 1.2.6, August 15, 2004, through 1.2.33, October 31, 2008, are
+Copyright (c) 2004, 2006-2008 Glenn Randers-Pehrson, and are
 distributed according to the same disclaimer and license as libpng-1.2.5
 with the following individual added to the list of Contributing Authors
 
@@ -106,4 +106,4 @@
 
 Glenn Randers-Pehrson
 glennrp at users.sourceforge.net
-October 13, 2007
+October 31, 2008

Modified: haiku/trunk/src/libs/png/png.c
===================================================================
--- haiku/trunk/src/libs/png/png.c	2008-11-23 01:00:26 UTC (rev 28722)
+++ haiku/trunk/src/libs/png/png.c	2008-11-23 14:02:02 UTC (rev 28723)
@@ -13,7 +13,7 @@
 #include &quot;png.h&quot;
 
 /* Generate a compiler error if there is an old png.h in the search path. */
-typedef version_1_2_32 Your_png_h_is_not_version_1_2_32;
+typedef version_1_2_33 Your_png_h_is_not_version_1_2_33;
 
 /* Version information for C files.  This had better match the version
  * string defined in png.h.  */
@@ -694,7 +694,7 @@
 png_get_copyright(png_structp png_ptr)
 {
    png_ptr = png_ptr;  /* silence compiler warning about unused png_ptr */
-   return ((png_charp) &quot;\n libpng version 1.2.32 - September 18, 2008\n\
+   return ((png_charp) &quot;\n libpng version 1.2.33 - October 31, 2008\n\
    Copyright (c) 1998-2008 Glenn Randers-Pehrson\n\
    Copyright (c) 1996-1997 Andreas Dilger\n\
    Copyright (c) 1995-1996 Guy Eric Schalnat, Group 42, Inc.\n&quot;);

Modified: haiku/trunk/src/libs/png/pngrutil.c
===================================================================
--- haiku/trunk/src/libs/png/pngrutil.c	2008-11-23 01:00:26 UTC (rev 28722)
+++ haiku/trunk/src/libs/png/pngrutil.c	2008-11-23 14:02:02 UTC (rev 28723)
@@ -1,7 +1,7 @@
 
 /* pngrutil.c - utilities to read a PNG file
  *
- * Last changed in libpng 1.2.31 [August 19, 2008]
+ * Last changed in libpng 1.2.33 [October 31, 2008]
  * For conditions of distribution and use, see copyright notice in png.h
  * Copyright (c) 1998-2008 Glenn Randers-Pehrson
  * (Version 0.96 Copyright (c) 1996, 1997 Andreas Dilger)
@@ -1940,21 +1940,24 @@
    }
 #endif
 
-   key = (png_charp)png_malloc_warn(png_ptr, length + 1);
-   if (key == NULL)
+   png_free(png_ptr, png_ptr-&gt;chunkdata);
+   png_ptr-&gt;chunkdata = (png_charp)png_malloc_warn(png_ptr, length + 1);
+   if (png_ptr-&gt;chunkdata == NULL)
    {
      png_warning(png_ptr, &quot;No memory to process text chunk.&quot;);
      return;
    }
    slength = (png_size_t)length;
-   png_crc_read(png_ptr, (png_bytep)key, slength);
+   png_crc_read(png_ptr, (png_bytep)png_ptr-&gt;chunkdata, slength);
 
    if (png_crc_finish(png_ptr, skip))
    {
-      png_free(png_ptr, key);
+      png_free(png_ptr, png_ptr-&gt;chunkdata);
+      png_ptr-&gt;chunkdata = NULL;
       return;
    }
 
+   key = png_ptr-&gt;chunkdata;
    key[slength] = 0x00;
 
    for (text = key; *text; text++)
@@ -1968,7 +1971,8 @@
    if (text_ptr == NULL)
    {
      png_warning(png_ptr, &quot;Not enough memory to process text chunk.&quot;);
-     png_free(png_ptr, key);
+     png_free(png_ptr, png_ptr-&gt;chunkdata);
+     png_ptr-&gt;chunkdata = NULL;
      return;
    }
    text_ptr-&gt;compression = PNG_TEXT_COMPRESSION_NONE;
@@ -1983,7 +1987,8 @@
 
    ret = png_set_text_2(png_ptr, info_ptr, text_ptr, 1);
 
-   png_free(png_ptr, key);
+   png_free(png_ptr, png_ptr-&gt;chunkdata);
+   png_ptr-&gt;chunkdata = NULL;
    png_free(png_ptr, text_ptr);
    if (ret)
      png_warning(png_ptr, &quot;Insufficient memory to process text chunk.&quot;);
@@ -2019,7 +2024,7 @@
    }
 #endif
 
-   png_free(png_ptr,png_ptr-&gt;chunkdata);
+   png_free(png_ptr, png_ptr-&gt;chunkdata);
    png_ptr-&gt;chunkdata = (png_charp)png_malloc_warn(png_ptr, length + 1);
    if (png_ptr-&gt;chunkdata == NULL)
    {


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013628.html">[Haiku-commits] r28722 - haiku/trunk/src/bin
</A></li>
	<LI>Next message: <A HREF="013629.html">[Haiku-commits] r28724 -	haiku/trunk/src/add-ons/kernel/drivers/audio/hda
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13627">[ date ]</a>
              <a href="thread.html#13627">[ thread ]</a>
              <a href="subject.html#13627">[ subject ]</a>
              <a href="author.html#13627">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
