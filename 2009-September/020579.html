<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r33088 - in haiku/branches/components/gallium3d:	headers/libs/drm headers/private/opengl/GL/internal	src/kits/opengl/mesa src/kits/opengl/mesa/drivers	src/kits/opengl/mesa/drivers/dri	src/kits/opengl/mesa/drivers/dri/common	src/kits/opengl/mesa/drivers/dri/common/xmlpool	src/kits/opengl/mesa/gallium	src/kits/opengl/mesa/gallium/state_trackers	src/kits/opengl/mesa/gallium/state_trackers/dri
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-September/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r33088%20-%20in%20haiku/branches/components/gallium3d%3A%0A%09headers/libs/drm%20headers/private/opengl/GL/internal%0A%09src/kits/opengl/mesa%20src/kits/opengl/mesa/drivers%0A%09src/kits/opengl/mesa/drivers/dri%0A%09src/kits/opengl/mesa/drivers/dri/common%0A%09src/kits/opengl/mesa/drivers/dri/common/xmlpool%0A%09src/kits/opengl/mesa/gallium%0A%09src/kits/opengl/mesa/gallium/state_trackers%0A%09src/kits/opengl/mesa/gallium/state_trackers/dri&In-Reply-To=%3C200909121109.n8CB9TYE027158%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020578.html">
   <LINK REL="Next"  HREF="020580.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r33088 - in haiku/branches/components/gallium3d:	headers/libs/drm headers/private/opengl/GL/internal	src/kits/opengl/mesa src/kits/opengl/mesa/drivers	src/kits/opengl/mesa/drivers/dri	src/kits/opengl/mesa/drivers/dri/common	src/kits/opengl/mesa/drivers/dri/common/xmlpool	src/kits/opengl/mesa/gallium	src/kits/opengl/mesa/gallium/state_trackers	src/kits/opengl/mesa/gallium/state_trackers/dri</H1>
    <B>aljen at mail.berlios.de</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r33088%20-%20in%20haiku/branches/components/gallium3d%3A%0A%09headers/libs/drm%20headers/private/opengl/GL/internal%0A%09src/kits/opengl/mesa%20src/kits/opengl/mesa/drivers%0A%09src/kits/opengl/mesa/drivers/dri%0A%09src/kits/opengl/mesa/drivers/dri/common%0A%09src/kits/opengl/mesa/drivers/dri/common/xmlpool%0A%09src/kits/opengl/mesa/gallium%0A%09src/kits/opengl/mesa/gallium/state_trackers%0A%09src/kits/opengl/mesa/gallium/state_trackers/dri&In-Reply-To=%3C200909121109.n8CB9TYE027158%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r33088 - in haiku/branches/components/gallium3d:	headers/libs/drm headers/private/opengl/GL/internal	src/kits/opengl/mesa src/kits/opengl/mesa/drivers	src/kits/opengl/mesa/drivers/dri	src/kits/opengl/mesa/drivers/dri/common	src/kits/opengl/mesa/drivers/dri/common/xmlpool	src/kits/opengl/mesa/gallium	src/kits/opengl/mesa/gallium/state_trackers	src/kits/opengl/mesa/gallium/state_trackers/dri">aljen at mail.berlios.de
       </A><BR>
    <I>Sat Sep 12 13:09:29 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020578.html">[Haiku-commits] r33087 - in	haiku/branches/components/gallium3d/src/libs/drm: . intel
</A></li>
        <LI>Next message: <A HREF="020580.html">[Haiku-commits] r33089 - in	haiku/branches/components/gallium3d/src/add-ons/opengl: . i915
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20579">[ date ]</a>
              <a href="thread.html#20579">[ thread ]</a>
              <a href="subject.html#20579">[ subject ]</a>
              <a href="author.html#20579">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: aljen
Date: 2009-09-12 13:09:08 +0200 (Sat, 12 Sep 2009)
New Revision: 33088
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=33088&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=33088&amp;view=rev</A>

Added:
   haiku/branches/components/gallium3d/headers/libs/drm/drm_sarea.h
   haiku/branches/components/gallium3d/headers/private/opengl/GL/internal/dri_interface.h
   haiku/branches/components/gallium3d/headers/private/opengl/GL/internal/sarea.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/depthtmp.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/dri_metaops.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/dri_metaops.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/dri_util.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/dri_util.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/drirenderbuffer.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/drirenderbuffer.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/extension_helper.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/memops.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/mmio.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/mmx.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/spantmp.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/spantmp2.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/spantmp_common.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/stenciltmp.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/texmem.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/texmem.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/utils.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/utils.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/vblank.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/vblank.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/xmlconfig.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/xmlconfig.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/xmlpool.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/xmlpool/
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/xmlpool/options.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/xmlpool/t_options.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/dri/
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/dri/dri_context.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/dri/dri_context.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/dri/dri_drawable.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/dri/dri_drawable.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/dri/dri_extensions.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/dri/dri_screen.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/dri/dri_screen.h
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/dri/dri_util.c
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/gallium/state_trackers/dri/dri_util.h
Modified:
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/Jamfile
Log:
Added gallium dri state_tracker and mesa dri common drivers code


Added: haiku/branches/components/gallium3d/headers/libs/drm/drm_sarea.h
===================================================================
--- haiku/branches/components/gallium3d/headers/libs/drm/drm_sarea.h	2009-09-12 10:13:42 UTC (rev 33087)
+++ haiku/branches/components/gallium3d/headers/libs/drm/drm_sarea.h	2009-09-12 11:09:08 UTC (rev 33088)
@@ -0,0 +1,84 @@
+/**
+ * \file drm_sarea.h
+ * \brief SAREA definitions
+ *
+ * \author Michel D&#65533;zer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">michel at daenzer.net</A>&gt;
+ */
+
+/*
+ * Copyright 2002 Tungsten Graphics, Inc., Cedar Park, Texas.
+ * All Rights Reserved.
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a
+ * copy of this software and associated documentation files (the &quot;Software&quot;),
+ * to deal in the Software without restriction, including without limitation
+ * the rights to use, copy, modify, merge, publish, distribute, sublicense,
+ * and/or sell copies of the Software, and to permit persons to whom the
+ * Software is furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice (including the next
+ * paragraph) shall be included in all copies or substantial portions of the
+ * Software.
+ *
+ * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
+ * TUNGSTEN GRAPHICS AND/OR ITS SUPPLIERS BE LIABLE FOR ANY CLAIM, DAMAGES OR
+ * OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
+ * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
+ * OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+#ifndef _DRM_SAREA_H_
+#define _DRM_SAREA_H_
+
+#include &quot;drm.h&quot;
+
+/* SAREA area needs to be at least a page */
+#if defined(__alpha__)
+#define SAREA_MAX                       0x2000
+#elif defined(__ia64__)
+#define SAREA_MAX                       0x10000	/* 64kB */
+#else
+/* Intel 830M driver needs at least 8k SAREA */
+#define SAREA_MAX                       0x2000UL
+#endif
+
+/** Maximum number of drawables in the SAREA */
+#define SAREA_MAX_DRAWABLES		256
+
+#define SAREA_DRAWABLE_CLAIMED_ENTRY    0x80000000
+
+/** SAREA drawable */
+struct drm_sarea_drawable {
+	unsigned int stamp;
+	unsigned int flags;
+};
+
+/** SAREA frame */
+struct drm_sarea_frame {
+	unsigned int x;
+	unsigned int y;
+	unsigned int width;
+	unsigned int height;
+	unsigned int fullscreen;
+};
+
+/** SAREA */
+struct drm_sarea {
+    /** first thing is always the DRM locking structure */
+	struct drm_hw_lock lock;
+    /** \todo Use readers/writer lock for drm_sarea::drawable_lock */
+	struct drm_hw_lock drawable_lock;
+	struct drm_sarea_drawable drawableTable[SAREA_MAX_DRAWABLES];	/**&lt; drawables */
+	struct drm_sarea_frame frame;	/**&lt; frame */
+	drm_context_t dummy_context;
+};
+
+#ifndef __KERNEL__
+typedef struct drm_sarea_drawable drm_sarea_drawable_t;
+typedef struct drm_sarea_frame drm_sarea_frame_t;
+typedef struct drm_sarea drm_sarea_t;
+#endif
+
+#endif				/* _DRM_SAREA_H_ */

Added: haiku/branches/components/gallium3d/headers/private/opengl/GL/internal/dri_interface.h
===================================================================
--- haiku/branches/components/gallium3d/headers/private/opengl/GL/internal/dri_interface.h	2009-09-12 10:13:42 UTC (rev 33087)
+++ haiku/branches/components/gallium3d/headers/private/opengl/GL/internal/dri_interface.h	2009-09-12 11:09:08 UTC (rev 33088)
@@ -0,0 +1,737 @@
+/*
+ * Copyright 1998-1999 Precision Insight, Inc., Cedar Park, Texas.
+ * Copyright 2007-2008 Red Hat, Inc.
+ * (C) Copyright IBM Corporation 2004
+ * All Rights Reserved.
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a
+ * copy of this software and associated documentation files (the &quot;Software&quot;),
+ * to deal in the Software without restriction, including without limitation
+ * on the rights to use, copy, modify, merge, publish, distribute, sub
+ * license, and/or sell copies of the Software, and to permit persons to whom
+ * the Software is furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice (including the next
+ * paragraph) shall be included in all copies or substantial portions of the
+ * Software.
+ *
+ * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT.  IN NO EVENT SHALL
+ * THE COPYRIGHT HOLDERS AND/OR THEIR SUPPLIERS BE LIABLE FOR ANY CLAIM,
+ * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
+ * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
+ * USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+/**
+ * \file dri_interface.h
+ *
+ * This file contains all the types and functions that define the interface
+ * between a DRI driver and driver loader.  Currently, the most common driver
+ * loader is the XFree86 libGL.so.  However, other loaders do exist, and in
+ * the future the server-side libglx.a will also be a loader.
+ * 
+ * \author Kevin E. Martin &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">kevin at precisioninsight.com</A>&gt;
+ * \author Ian Romanick &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">idr at us.ibm.com</A>&gt;
+ * \author Kristian H&#248;gsberg &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">krh at redhat.com</A>&gt;
+ */
+
+#ifndef DRI_INTERFACE_H
+#define DRI_INTERFACE_H
+
+/* For archs with no drm.h */
+#if !defined(__APPLE__) &amp;&amp; !defined(__CYGWIN__) &amp;&amp; !defined(__GNU__)
+#include &lt;drm.h&gt;
+#else
+typedef unsigned int drm_context_t;
+typedef unsigned int drm_drawable_t;
+typedef struct drm_clip_rect drm_clip_rect_t;
+#endif
+
+/**
+ * \name DRI interface structures
+ *
+ * The following structures define the interface between the GLX client
+ * side library and the DRI (direct rendering infrastructure).
+ */
+/*@{*/
+typedef struct __DRIdisplayRec		__DRIdisplay;
+typedef struct __DRIscreenRec		__DRIscreen;
+typedef struct __DRIcontextRec		__DRIcontext;
+typedef struct __DRIdrawableRec		__DRIdrawable;
+typedef struct __DRIconfigRec		__DRIconfig;
+typedef struct __DRIframebufferRec	__DRIframebuffer;
+typedef struct __DRIversionRec		__DRIversion;
+
+typedef struct __DRIcoreExtensionRec		__DRIcoreExtension;
+typedef struct __DRIextensionRec		__DRIextension;
+typedef struct __DRIcopySubBufferExtensionRec	__DRIcopySubBufferExtension;
+typedef struct __DRIswapControlExtensionRec	__DRIswapControlExtension;
+typedef struct __DRIallocateExtensionRec	__DRIallocateExtension;
+typedef struct __DRIframeTrackingExtensionRec	__DRIframeTrackingExtension;
+typedef struct __DRImediaStreamCounterExtensionRec	__DRImediaStreamCounterExtension;
+typedef struct __DRItexOffsetExtensionRec	__DRItexOffsetExtension;
+typedef struct __DRItexBufferExtensionRec	__DRItexBufferExtension;
+typedef struct __DRIlegacyExtensionRec		__DRIlegacyExtension;
+typedef struct __DRIswrastExtensionRec		__DRIswrastExtension;
+typedef struct __DRIbufferRec			__DRIbuffer;
+typedef struct __DRIdri2ExtensionRec		__DRIdri2Extension;
+typedef struct __DRIdri2LoaderExtensionRec	__DRIdri2LoaderExtension;
+typedef struct __DRI2flushExtensionRec	__DRI2flushExtension;
+
+/*@}*/
+
+
+/**
+ * Extension struct.  Drivers 'inherit' from this struct by embedding
+ * it as the first element in the extension struct.
+ *
+ * We never break API in for a DRI extension.  If we need to change
+ * the way things work in a non-backwards compatible manner, we
+ * introduce a new extension.  During a transition period, we can
+ * leave both the old and the new extension in the driver, which
+ * allows us to move to the new interface without having to update the
+ * loader(s) in lock step.
+ *
+ * However, we can add entry points to an extension over time as long
+ * as we don't break the old ones.  As we add entry points to an
+ * extension, we increase the version number.  The corresponding
+ * #define can be used to guard code that accesses the new entry
+ * points at compile time and the version field in the extension
+ * struct can be used at run-time to determine how to use the
+ * extension.
+ */
+struct __DRIextensionRec {
+    const char *name;
+    int version;
+};
+
+/**
+ * The first set of extension are the screen extensions, returned by
+ * __DRIcore::getExtensions().  This entry point will return a list of
+ * extensions and the loader can use the ones it knows about by
+ * casting them to more specific extensions and advertising any GLX
+ * extensions the DRI extensions enables.
+ */
+
+/**
+ * Used by drivers to indicate support for setting the read drawable.
+ */
+#define __DRI_READ_DRAWABLE &quot;DRI_ReadDrawable&quot;
+#define __DRI_READ_DRAWABLE_VERSION 1
+
+/**
+ * Used by drivers that implement the GLX_MESA_copy_sub_buffer extension.
+ */
+#define __DRI_COPY_SUB_BUFFER &quot;DRI_CopySubBuffer&quot;
+#define __DRI_COPY_SUB_BUFFER_VERSION 1
+struct __DRIcopySubBufferExtensionRec {
+    __DRIextension base;
+    void (*copySubBuffer)(__DRIdrawable *drawable, int x, int y, int w, int h);
+};
+
+/**
+ * Used by drivers that implement the GLX_SGI_swap_control or
+ * GLX_MESA_swap_control extension.
+ */
+#define __DRI_SWAP_CONTROL &quot;DRI_SwapControl&quot;
+#define __DRI_SWAP_CONTROL_VERSION 1
+struct __DRIswapControlExtensionRec {
+    __DRIextension base;
+    void (*setSwapInterval)(__DRIdrawable *drawable, unsigned int inteval);
+    unsigned int (*getSwapInterval)(__DRIdrawable *drawable);
+};
+
+/**
+ * Used by drivers that implement the GLX_MESA_allocate_memory.
+ */
+#define __DRI_ALLOCATE &quot;DRI_Allocate&quot;
+#define __DRI_ALLOCATE_VERSION 1
+struct __DRIallocateExtensionRec {
+    __DRIextension base;
+
+    void *(*allocateMemory)(__DRIscreen *screen, GLsizei size,
+			    GLfloat readfreq, GLfloat writefreq,
+			    GLfloat priority);
+   
+    void (*freeMemory)(__DRIscreen *screen, GLvoid *pointer);
+   
+    GLuint (*memoryOffset)(__DRIscreen *screen, const GLvoid *pointer);
+};
+
+/**
+ * Used by drivers that implement the GLX_MESA_swap_frame_usage extension.
+ */
+#define __DRI_FRAME_TRACKING &quot;DRI_FrameTracking&quot;
+#define __DRI_FRAME_TRACKING_VERSION 1
+struct __DRIframeTrackingExtensionRec {
+    __DRIextension base;
+
+    /**
+     * Enable or disable frame usage tracking.
+     * 
+     * \since Internal API version 20030317.
+     */
+    int (*frameTracking)(__DRIdrawable *drawable, GLboolean enable);
+
+    /**
+     * Retrieve frame usage information.
+     * 
+     * \since Internal API version 20030317.
+     */
+    int (*queryFrameTracking)(__DRIdrawable *drawable,
+			      int64_t * sbc, int64_t * missedFrames,
+			      float * lastMissedUsage, float * usage);
+};
+
+
+/**
+ * Used by drivers that implement the GLX_SGI_video_sync extension.
+ */
+#define __DRI_MEDIA_STREAM_COUNTER &quot;DRI_MediaStreamCounter&quot;
+#define __DRI_MEDIA_STREAM_COUNTER_VERSION 1
+struct __DRImediaStreamCounterExtensionRec {
+    __DRIextension base;
+
+    /**
+     * Wait for the MSC to equal target_msc, or, if that has already passed,
+     * the next time (MSC % divisor) is equal to remainder.  If divisor is
+     * zero, the function will return as soon as MSC is greater than or equal
+     * to target_msc.
+     */
+    int (*waitForMSC)(__DRIdrawable *drawable,
+		      int64_t target_msc, int64_t divisor, int64_t remainder,
+		      int64_t * msc, int64_t * sbc);
+
+    /**
+     * Get the number of vertical refreshes since some point in time before
+     * this function was first called (i.e., system start up).
+     */
+    int (*getDrawableMSC)(__DRIscreen *screen, __DRIdrawable *drawable,
+			  int64_t *msc);
+};
+
+
+#define __DRI_TEX_OFFSET &quot;DRI_TexOffset&quot;
+#define __DRI_TEX_OFFSET_VERSION 1
+struct __DRItexOffsetExtensionRec {
+    __DRIextension base;
+
+    /**
+     * Method to override base texture image with a driver specific 'offset'.
+     * The depth passed in allows e.g. to ignore the alpha channel of texture
+     * images where the non-alpha components don't occupy a whole texel.
+     *
+     * For GLX_EXT_texture_from_pixmap with AIGLX.
+     */
+    void (*setTexOffset)(__DRIcontext *pDRICtx, GLint texname,
+			 unsigned long long offset, GLint depth, GLuint pitch);
+};
+
+
+#define __DRI_TEX_BUFFER &quot;DRI_TexBuffer&quot;
+#define __DRI_TEX_BUFFER_VERSION 2
+struct __DRItexBufferExtensionRec {
+    __DRIextension base;
+
+    /**
+     * Method to override base texture image with the contents of a
+     * __DRIdrawable. 
+     *
+     * For GLX_EXT_texture_from_pixmap with AIGLX.  Deprecated in favor of
+     * setTexBuffer2 in version 2 of this interface
+     */
+    void (*setTexBuffer)(__DRIcontext *pDRICtx,
+			 GLint target,
+			 __DRIdrawable *pDraw);
+
+    /**
+     * Method to override base texture image with the contents of a
+     * __DRIdrawable, including the required texture format attribute.
+     *
+     * For GLX_EXT_texture_from_pixmap with AIGLX.
+     */
+    void (*setTexBuffer2)(__DRIcontext *pDRICtx,
+			  GLint target,
+			  GLint format,
+			  __DRIdrawable *pDraw);
+};
+
+/**
+ * Used by drivers that implement DRI2
+ */
+#define __DRI2_FLUSH &quot;DRI2_Flush&quot;
+#define __DRI2_FLUSH_VERSION 1
+struct __DRI2flushExtensionRec {
+    __DRIextension base;
+    void (*flush)(__DRIdrawable *drawable);
+};
+
+
+/**
+ * XML document describing the configuration options supported by the
+ * driver.
+ */
+extern const char __driConfigOptions[];
+
+/*@}*/
+
+/**
+ * The following extensions describe loader features that the DRI
+ * driver can make use of.  Some of these are mandatory, such as the
+ * getDrawableInfo extension for DRI and the DRI Loader extensions for
+ * DRI2, while others are optional, and if present allow the driver to
+ * expose certain features.  The loader pass in a NULL terminated
+ * array of these extensions to the driver in the createNewScreen
+ * constructor.
+ */
+
+typedef struct __DRIgetDrawableInfoExtensionRec __DRIgetDrawableInfoExtension;
+typedef struct __DRIsystemTimeExtensionRec __DRIsystemTimeExtension;
+typedef struct __DRIdamageExtensionRec __DRIdamageExtension;
+typedef struct __DRIloaderExtensionRec __DRIloaderExtension;
+typedef struct __DRIswrastLoaderExtensionRec __DRIswrastLoaderExtension;
+
+
+/**
+ * Callback to getDrawableInfo protocol
+ */
+#define __DRI_GET_DRAWABLE_INFO &quot;DRI_GetDrawableInfo&quot;
+#define __DRI_GET_DRAWABLE_INFO_VERSION 1
+struct __DRIgetDrawableInfoExtensionRec {
+    __DRIextension base;
+
+    /**
+     * This function is used to get information about the position, size, and
+     * clip rects of a drawable.
+     */
+    GLboolean (* getDrawableInfo) ( __DRIdrawable *drawable,
+	unsigned int * index, unsigned int * stamp,
+        int * x, int * y, int * width, int * height,
+        int * numClipRects, drm_clip_rect_t ** pClipRects,
+        int * backX, int * backY,
+	int * numBackClipRects, drm_clip_rect_t ** pBackClipRects,
+	void *loaderPrivate);
+};
+
+/**
+ * Callback to get system time for media stream counter extensions.
+ */
+#define __DRI_SYSTEM_TIME &quot;DRI_SystemTime&quot;
+#define __DRI_SYSTEM_TIME_VERSION 1
+struct __DRIsystemTimeExtensionRec {
+    __DRIextension base;
+
+    /**
+     * Get the 64-bit unadjusted system time (UST).
+     */
+    int (*getUST)(int64_t * ust);
+
+    /**
+     * Get the media stream counter (MSC) rate.
+     * 
+     * Matching the definition in GLX_OML_sync_control, this function returns
+     * the rate of the &quot;media stream counter&quot;.  In practical terms, this is
+     * the frame refresh rate of the display.
+     */
+    GLboolean (*getMSCRate)(__DRIdrawable *draw,
+			    int32_t * numerator, int32_t * denominator,
+			    void *loaderPrivate);
+};
+
+/**
+ * Damage reporting
+ */
+#define __DRI_DAMAGE &quot;DRI_Damage&quot;
+#define __DRI_DAMAGE_VERSION 1
+struct __DRIdamageExtensionRec {
+    __DRIextension base;
+
+    /**
+     * Reports areas of the given drawable which have been modified by the
+     * driver.
+     *
+     * \param drawable which the drawing was done to.
+     * \param rects rectangles affected, with the drawable origin as the
+     *	      origin.
+     * \param x X offset of the drawable within the screen (used in the
+     *	      front_buffer case)
+     * \param y Y offset of the drawable within the screen.
+     * \param front_buffer boolean flag for whether the drawing to the
+     * 	      drawable was actually done directly to the front buffer (instead
+     *	      of backing storage, for example)
+     * \param loaderPrivate the data passed in at createNewDrawable time
+     */
+    void (*reportDamage)(__DRIdrawable *draw,
+			 int x, int y,
+			 drm_clip_rect_t *rects, int num_rects,
+			 GLboolean front_buffer,
+			 void *loaderPrivate);
+};
+
+#define __DRI_SWRAST_IMAGE_OP_DRAW	1
+#define __DRI_SWRAST_IMAGE_OP_CLEAR	2
+#define __DRI_SWRAST_IMAGE_OP_SWAP	3
+
+/**
+ * SWRast Loader extension.
+ */
+#define __DRI_SWRAST_LOADER &quot;DRI_SWRastLoader&quot;
+#define __DRI_SWRAST_LOADER_VERSION 1
+struct __DRIswrastLoaderExtensionRec {
+    __DRIextension base;
+
+    /*
+     * Drawable position and size
+     */
+    void (*getDrawableInfo)(__DRIdrawable *drawable,
+			    int *x, int *y, int *width, int *height,
+			    void *loaderPrivate);
+
+    /**
+     * Put image to drawable
+     */
+    void (*putImage)(__DRIdrawable *drawable, int op,
+		     int x, int y, int width, int height, char *data,
+		     void *loaderPrivate);
+
+    /**
+     * Get image from drawable
+     */
+    void (*getImage)(__DRIdrawable *drawable,
+		     int x, int y, int width, int height, char *data,
+		     void *loaderPrivate);
+};
+
+/**
+ * The remaining extensions describe driver extensions, immediately
+ * available interfaces provided by the driver.  To start using the
+ * driver, dlsym() for the __DRI_DRIVER_EXTENSIONS symbol and look for
+ * the extension you need in the array.
+ */
+#define __DRI_DRIVER_EXTENSIONS &quot;__driDriverExtensions&quot;
+
+/**
+ * Tokens for __DRIconfig attribs.  A number of attributes defined by
+ * GLX or EGL standards are not in the table, as they must be provided
+ * by the loader.  For example, FBConfig ID or visual ID, drawable type.
+ */
+
+#define __DRI_ATTRIB_BUFFER_SIZE		 1
+#define __DRI_ATTRIB_LEVEL			 2
+#define __DRI_ATTRIB_RED_SIZE			 3
+#define __DRI_ATTRIB_GREEN_SIZE			 4
+#define __DRI_ATTRIB_BLUE_SIZE			 5
+#define __DRI_ATTRIB_LUMINANCE_SIZE		 6
+#define __DRI_ATTRIB_ALPHA_SIZE			 7
+#define __DRI_ATTRIB_ALPHA_MASK_SIZE		 8
+#define __DRI_ATTRIB_DEPTH_SIZE			 9
+#define __DRI_ATTRIB_STENCIL_SIZE		10
+#define __DRI_ATTRIB_ACCUM_RED_SIZE		11
+#define __DRI_ATTRIB_ACCUM_GREEN_SIZE		12
+#define __DRI_ATTRIB_ACCUM_BLUE_SIZE		13
+#define __DRI_ATTRIB_ACCUM_ALPHA_SIZE		14
+#define __DRI_ATTRIB_SAMPLE_BUFFERS		15
+#define __DRI_ATTRIB_SAMPLES			16
+#define __DRI_ATTRIB_RENDER_TYPE		17
+#define __DRI_ATTRIB_CONFIG_CAVEAT		18
+#define __DRI_ATTRIB_CONFORMANT			19
+#define __DRI_ATTRIB_DOUBLE_BUFFER		20
+#define __DRI_ATTRIB_STEREO			21
+#define __DRI_ATTRIB_AUX_BUFFERS		22
+#define __DRI_ATTRIB_TRANSPARENT_TYPE		23
+#define __DRI_ATTRIB_TRANSPARENT_INDEX_VALUE	24
+#define __DRI_ATTRIB_TRANSPARENT_RED_VALUE	25
+#define __DRI_ATTRIB_TRANSPARENT_GREEN_VALUE	26
+#define __DRI_ATTRIB_TRANSPARENT_BLUE_VALUE	27
+#define __DRI_ATTRIB_TRANSPARENT_ALPHA_VALUE	28
+#define __DRI_ATTRIB_FLOAT_MODE			29
+#define __DRI_ATTRIB_RED_MASK			30
+#define __DRI_ATTRIB_GREEN_MASK			31
+#define __DRI_ATTRIB_BLUE_MASK			32
+#define __DRI_ATTRIB_ALPHA_MASK			33
+#define __DRI_ATTRIB_MAX_PBUFFER_WIDTH		34
+#define __DRI_ATTRIB_MAX_PBUFFER_HEIGHT		35
+#define __DRI_ATTRIB_MAX_PBUFFER_PIXELS		36
+#define __DRI_ATTRIB_OPTIMAL_PBUFFER_WIDTH	37
+#define __DRI_ATTRIB_OPTIMAL_PBUFFER_HEIGHT	38
+#define __DRI_ATTRIB_VISUAL_SELECT_GROUP	39
+#define __DRI_ATTRIB_SWAP_METHOD		40
+#define __DRI_ATTRIB_MAX_SWAP_INTERVAL		41
+#define __DRI_ATTRIB_MIN_SWAP_INTERVAL		42
+#define __DRI_ATTRIB_BIND_TO_TEXTURE_RGB	43
+#define __DRI_ATTRIB_BIND_TO_TEXTURE_RGBA	44
+#define __DRI_ATTRIB_BIND_TO_MIPMAP_TEXTURE	45
+#define __DRI_ATTRIB_BIND_TO_TEXTURE_TARGETS	46
+#define __DRI_ATTRIB_YINVERTED			47
+
+/* __DRI_ATTRIB_RENDER_TYPE */
+#define __DRI_ATTRIB_RGBA_BIT			0x01	
+#define __DRI_ATTRIB_COLOR_INDEX_BIT		0x02
+#define __DRI_ATTRIB_LUMINANCE_BIT		0x04
+
+/* __DRI_ATTRIB_CONFIG_CAVEAT */
+#define __DRI_ATTRIB_SLOW_BIT			0x01
+#define __DRI_ATTRIB_NON_CONFORMANT_CONFIG	0x02
+
+/* __DRI_ATTRIB_TRANSPARENT_TYPE */
+#define __DRI_ATTRIB_TRANSPARENT_RGB		0x00
+#define __DRI_ATTRIB_TRANSPARENT_INDEX		0x01
+
+/* __DRI_ATTRIB_BIND_TO_TEXTURE_TARGETS	 */
+#define __DRI_ATTRIB_TEXTURE_1D_BIT		0x01
+#define __DRI_ATTRIB_TEXTURE_2D_BIT		0x02
+#define __DRI_ATTRIB_TEXTURE_RECTANGLE_BIT	0x04
+
+/**
+ * This extension defines the core DRI functionality.
+ */
+#define __DRI_CORE &quot;DRI_Core&quot;
+#define __DRI_CORE_VERSION 1
+
+struct __DRIcoreExtensionRec {
+    __DRIextension base;
+
+    __DRIscreen *(*createNewScreen)(int screen, int fd,
+				    unsigned int sarea_handle,
+				    const __DRIextension **extensions,
+				    const __DRIconfig ***driverConfigs,
+				    void *loaderPrivate);
+
+    void (*destroyScreen)(__DRIscreen *screen);
+
+    const __DRIextension **(*getExtensions)(__DRIscreen *screen);
+
+    int (*getConfigAttrib)(const __DRIconfig *config,
+			   unsigned int attrib,
+			   unsigned int *value);
+
+    int (*indexConfigAttrib)(const __DRIconfig *config, int index,
+			     unsigned int *attrib, unsigned int *value);
+
+    __DRIdrawable *(*createNewDrawable)(__DRIscreen *screen,
+					const __DRIconfig *config,
+					unsigned int drawable_id,
+					unsigned int head,
+					void *loaderPrivate);
+
+    void (*destroyDrawable)(__DRIdrawable *drawable);
+
+    void (*swapBuffers)(__DRIdrawable *drawable);
+
+    __DRIcontext *(*createNewContext)(__DRIscreen *screen,
+				      const __DRIconfig *config,
+				      __DRIcontext *shared,
+				      void *loaderPrivate);
+
+    int (*copyContext)(__DRIcontext *dest,
+		       __DRIcontext *src,
+		       unsigned long mask);
+
+    void (*destroyContext)(__DRIcontext *context);
+
+    int (*bindContext)(__DRIcontext *ctx,
+		       __DRIdrawable *pdraw,
+		       __DRIdrawable *pread);
+
+    int (*unbindContext)(__DRIcontext *ctx);
+};
+
+/**
+ * Stored version of some component (i.e., server-side DRI module, kernel-side
+ * DRM, etc.).
+ * 
+ * \todo
+ * There are several data structures that explicitly store a major version,
+ * minor version, and patch level.  These structures should be modified to
+ * have a \c __DRIversionRec instead.
+ */
+struct __DRIversionRec {
+    int    major;        /**&lt; Major version number. */
+    int    minor;        /**&lt; Minor version number. */
+    int    patch;        /**&lt; Patch-level. */
+};
+
+/**
+ * Framebuffer information record.  Used by libGL to communicate information
+ * about the framebuffer to the driver's \c __driCreateNewScreen function.
+ * 
+ * In XFree86, most of this information is derrived from data returned by
+ * calling \c XF86DRIGetDeviceInfo.
+ *
+ * \sa XF86DRIGetDeviceInfo __DRIdisplayRec::createNewScreen
+ *     __driUtilCreateNewScreen CallCreateNewScreen
+ *
+ * \bug This structure could be better named.
+ */
+struct __DRIframebufferRec {
+    unsigned char *base;    /**&lt; Framebuffer base address in the CPU's
+			     * address space.  This value is calculated by
+			     * calling \c drmMap on the framebuffer handle
+			     * returned by \c XF86DRIGetDeviceInfo (or a
+			     * similar function).
+			     */
+    int size;               /**&lt; Framebuffer size, in bytes. */
+    int stride;             /**&lt; Number of bytes from one line to the next. */
+    int width;              /**&lt; Pixel width of the framebuffer. */
+    int height;             /**&lt; Pixel height of the framebuffer. */
+    int dev_priv_size;      /**&lt; Size of the driver's dev-priv structure. */
+    void *dev_priv;         /**&lt; Pointer to the driver's dev-priv structure. */
+};
+
+
+/**
+ * This extension provides alternative screen, drawable and context
+ * constructors for legacy DRI functionality.  This is used in
+ * conjunction with the core extension.
+ */
+#define __DRI_LEGACY &quot;DRI_Legacy&quot;
+#define __DRI_LEGACY_VERSION 1
+
+struct __DRIlegacyExtensionRec {
+    __DRIextension base;
+
+    __DRIscreen *(*createNewScreen)(int screen,
+				    const __DRIversion *ddx_version,
+				    const __DRIversion *dri_version,
+				    const __DRIversion *drm_version,
+				    const __DRIframebuffer *frame_buffer,
+				    void *pSAREA, int fd, 
+				    const __DRIextension **extensions,
+				    const __DRIconfig ***driver_configs,
+				    void *loaderPrivate);
+
+    __DRIdrawable *(*createNewDrawable)(__DRIscreen *screen,
+					const __DRIconfig *config,
+					drm_drawable_t hwDrawable,
+					int renderType, const int *attrs,
+					void *loaderPrivate);
+
+    __DRIcontext *(*createNewContext)(__DRIscreen *screen,
+				      const __DRIconfig *config,
+				      int render_type,
+				      __DRIcontext *shared,
+				      drm_context_t hwContext,
+				      void *loaderPrivate);
+};
+
+/**
+ * This extension provides alternative screen, drawable and context
+ * constructors for swrast DRI functionality.  This is used in
+ * conjunction with the core extension.
+ */
+#define __DRI_SWRAST &quot;DRI_SWRast&quot;
+#define __DRI_SWRAST_VERSION 1
+
+struct __DRIswrastExtensionRec {
+    __DRIextension base;
+
+    __DRIscreen *(*createNewScreen)(int screen,
+				    const __DRIextension **extensions,
+				    const __DRIconfig ***driver_configs,
+				    void *loaderPrivate);
+
+    __DRIdrawable *(*createNewDrawable)(__DRIscreen *screen,
+					const __DRIconfig *config,
+					void *loaderPrivate);
+};
+
+/**
+ * DRI2 Loader extension.
+ */
+#define __DRI_BUFFER_FRONT_LEFT		0
+#define __DRI_BUFFER_BACK_LEFT		1
+#define __DRI_BUFFER_FRONT_RIGHT	2
+#define __DRI_BUFFER_BACK_RIGHT		3
+#define __DRI_BUFFER_DEPTH		4
+#define __DRI_BUFFER_STENCIL		5
+#define __DRI_BUFFER_ACCUM		6
+#define __DRI_BUFFER_FAKE_FRONT_LEFT	7
+#define __DRI_BUFFER_FAKE_FRONT_RIGHT	8
+#define __DRI_BUFFER_DEPTH_STENCIL	9  /**&lt; Only available with DRI2 1.1 */
+
+struct __DRIbufferRec {
+    unsigned int attachment;
+    unsigned int name;
+    unsigned int pitch;
+    unsigned int cpp;
+    unsigned int flags;
+};
+
+#define __DRI_DRI2_LOADER &quot;DRI_DRI2Loader&quot;
+#define __DRI_DRI2_LOADER_VERSION 3
+struct __DRIdri2LoaderExtensionRec {
+    __DRIextension base;
+
+    __DRIbuffer *(*getBuffers)(__DRIdrawable *driDrawable,
+			       int *width, int *height,
+			       unsigned int *attachments, int count,
+			       int *out_count, void *loaderPrivate);
+
+    /**
+     * Flush pending front-buffer rendering
+     *
+     * Any rendering that has been performed to the
+     * \c __DRI_BUFFER_FAKE_FRONT_LEFT will be flushed to the
+     * \c __DRI_BUFFER_FRONT_LEFT.
+     *
+     * \param driDrawable    Drawable whose front-buffer is to be flushed
+     * \param loaderPrivate  Loader's private data that was previously passed
+     *                       into __DRIdri2ExtensionRec::createNewDrawable
+     */
+    void (*flushFrontBuffer)(__DRIdrawable *driDrawable, void *loaderPrivate);
+
+
+    /**
+     * Get list of buffers from the server
+     *
+     * Gets a list of buffer for the specified set of attachments.  Unlike
+     * \c ::getBuffers, this function takes a list of attachments paired with
+     * opaque \c unsigned \c int value describing the format of the buffer.
+     * It is the responsibility of the caller to know what the service that
+     * allocates the buffers will expect to receive for the format.
+     *
+     * \param driDrawable    Drawable whose buffers are being queried.
+     * \param width          Output where the width of the buffers is stored.
+     * \param height         Output where the height of the buffers is stored.
+     * \param attachments    List of pairs of attachment ID and opaque format
+     *                       requested for the drawable.
+     * \param count          Number of attachment / format pairs stored in
+     *                       \c attachments.
+     * \param loaderPrivate  Loader's private data that was previously passed
+     *                       into __DRIdri2ExtensionRec::createNewDrawable.
+     */
+    __DRIbuffer *(*getBuffersWithFormat)(__DRIdrawable *driDrawable,
+					 int *width, int *height,
+					 unsigned int *attachments, int count,
+					 int *out_count, void *loaderPrivate);
+};
+
+/**
+ * This extension provides alternative screen, drawable and context
+ * constructors for DRI2.
+ */
+#define __DRI_DRI2 &quot;DRI_DRI2&quot;
+#define __DRI_DRI2_VERSION 1
+
+struct __DRIdri2ExtensionRec {
+    __DRIextension base;
+
+    __DRIscreen *(*createNewScreen)(int screen, int fd,
+				    const __DRIextension **extensions,
+				    const __DRIconfig ***driver_configs,
+				    void *loaderPrivate);
+
+    __DRIdrawable *(*createNewDrawable)(__DRIscreen *screen,
+					const __DRIconfig *config,
+					void *loaderPrivate);
+
+    __DRIcontext *(*createNewContext)(__DRIscreen *screen,
+				      const __DRIconfig *config,
+				      __DRIcontext *shared,
+				      void *loaderPrivate);
+
+};
+
+#endif

Added: haiku/branches/components/gallium3d/headers/private/opengl/GL/internal/sarea.h
===================================================================
--- haiku/branches/components/gallium3d/headers/private/opengl/GL/internal/sarea.h	2009-09-12 10:13:42 UTC (rev 33087)
+++ haiku/branches/components/gallium3d/headers/private/opengl/GL/internal/sarea.h	2009-09-12 11:09:08 UTC (rev 33088)
@@ -0,0 +1,92 @@
+/**
+ * \file sarea.h 
+ * SAREA definitions.
+ * 
+ * \author Kevin E. Martin &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">kevin at precisioninsight.com</A>&gt;
+ * \author Jens Owen &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">jens at tungstengraphics.com</A>&gt;
+ * \author Rickard E. (Rik) Faith &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">faith at valinux.com</A>&gt;
+ */
+
+/*
+ * Copyright 1998-1999 Precision Insight, Inc., Cedar Park, Texas.
+ * Copyright 2000 VA Linux Systems, Inc.
+ * All Rights Reserved.
+ * 
+ * Permission is hereby granted, free of charge, to any person obtaining a
+ * copy of this software and associated documentation files (the
+ * &quot;Software&quot;), to deal in the Software without restriction, including
+ * without limitation the rights to use, copy, modify, merge, publish,
+ * distribute, sub license, and/or sell copies of the Software, and to
+ * permit persons to whom the Software is furnished to do so, subject to
+ * the following conditions:
+ * 
+ * The above copyright notice and this permission notice (including the
+ * next paragraph) shall be included in all copies or substantial portions
+ * of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS
+ * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+ * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT.
+ * IN NO EVENT SHALL PRECISION INSIGHT AND/OR ITS SUPPLIERS BE LIABLE FOR
+ * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
+ * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
+ * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+
+#ifndef _SAREA_H_
+#define _SAREA_H_
+
+#include &quot;xf86drm.h&quot;
+
+/* SAREA area needs to be at least a page */
+#if defined(__alpha__)
+#define SAREA_MAX 			0x2000
+#elif defined(__ia64__)
+#define SAREA_MAX			0x10000		/* 64kB */
+#else
+/* Intel 830M driver needs at least 8k SAREA */
+#define SAREA_MAX			0x2000
+#endif
+
+#define SAREA_MAX_DRAWABLES 		256
+
+#define SAREA_DRAWABLE_CLAIMED_ENTRY	0x80000000
+
+/**
+ * SAREA per drawable information.
+ *
+ * \sa _XF86DRISAREA.
+ */
+typedef struct _XF86DRISAREADrawable {
+    unsigned int	stamp;
+    unsigned int	flags;
+} XF86DRISAREADrawableRec, *XF86DRISAREADrawablePtr;
+
+/**
+ * SAREA frame information.
+ *
+ * \sa  _XF86DRISAREA.
+ */
+typedef struct _XF86DRISAREAFrame {
+    unsigned int        x;
+    unsigned int        y;
+    unsigned int        width;
+    unsigned int        height;
+    unsigned int        fullscreen;
+} XF86DRISAREAFrameRec, *XF86DRISAREAFramePtr;
+
+/**
+ * SAREA definition.
+ */
+typedef struct _XF86DRISAREA {
+    /** first thing is always the DRM locking structure */
+    drmLock			lock;
+    /** \todo Use readers/writer lock for drawable_lock */
+    drmLock			drawable_lock;
+    XF86DRISAREADrawableRec	drawableTable[SAREA_MAX_DRAWABLES];
+    XF86DRISAREAFrameRec        frame;
+    drm_context_t			dummy_context;
+} XF86DRISAREARec, *XF86DRISAREAPtr;
+
+#endif

Modified: haiku/branches/components/gallium3d/src/kits/opengl/mesa/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/kits/opengl/mesa/Jamfile	2009-09-12 10:13:42 UTC (rev 33087)
+++ haiku/branches/components/gallium3d/src/kits/opengl/mesa/Jamfile	2009-09-12 11:09:08 UTC (rev 33088)
@@ -11,11 +11,14 @@
 DEBUG = 0 ;
 
 UsePrivateHeaders opengl ;
+UseLibraryHeaders drm expat ;
 
+UseHeaders [ FDirName $(SUBDIR) drivers dri common ] ;
 UseHeaders [ FDirName $(SUBDIR) main ] ;
 UseHeaders [ FDirName $(SUBDIR) glapi ] ;
 UseHeaders [ FDirName $(SUBDIR) gallium auxiliary ] ;
 UseHeaders [ FDirName $(SUBDIR) gallium include ] ;
+UseHeaders [ FDirName $(SUBDIR) gallium state_trackers dri ] ;
 UseHeaders [ FDirName $(SUBDIR) math ] ;
 UseHeaders [ FDirName $(SUBDIR) tnl ] ;
 UseHeaders [ FDirName $(SUBDIR) shader ] ;
@@ -26,8 +29,11 @@
 UseHeaders [ FDirName $(SUBDIR) swrast_setup ] ;
 UseHeaders [ FDirName $(SUBDIR) vbo ] ;
 UseHeaders [ FDirName $(SUBDIR) vf ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) headers compatibility bsd ] : true ;
+UseHeaders [ FDirName $(HAIKU_TOP) src libs drm ] : true ;
 
 SEARCH_SOURCE += [ FDirName $(SUBDIR) drivers common ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) drivers dri common ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) glapi ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) main ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) math ] ;
@@ -50,6 +56,7 @@
 SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary tgsi ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary translate ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary util ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium state_trackers dri ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) $(TARGET_ARCH) ] ;
 
 UsePublicObjectHeaders gen_matypes : opengl ;
@@ -71,25 +78,23 @@
 	$(2) &gt; $(1) ;
 }
 
+local defines ;
+defines = BEOS_THREADS GNU_ASSEMBLER HAVE_POSIX_MEMALIGN IN_DRI_DRIVER ;
 
-{
-	local defines ;
-	defines = BEOS_THREADS GNU_ASSEMBLER HAVE_POSIX_MEMALIGN ;
+if $(TARGET_ARCH) = x86 {
+	defines += USE_X86_ASM USE_MMX_ASM USE_3DNOW_ASM USE_SSE_ASM ;
+} else if $(TARGET_ARCH) = ppc {
+	# Not yet supported, as current Mesa3D PPC assembly is Linux-dependent!
+	# defines += USE_PPC_ASM ;
+} else if $(TARGET_ARCH) = sparc {
+	defines += USE_SPARC_ASM ;
+}
 
-	if $(TARGET_ARCH) = x86 {
-		defines += USE_X86_ASM USE_MMX_ASM USE_3DNOW_ASM USE_SSE_ASM ;
-	} else if $(TARGET_ARCH) = ppc {
-		# Not yet supported, as current Mesa3D PPC assembly is Linux-dependent!
-		# defines += USE_PPC_ASM ;
-	} else if $(TARGET_ARCH) = sparc {
-		defines += USE_SPARC_ASM ;
-	}
+defines = [ FDefines $(defines) ] ;
+SubDirCcFlags $(defines) ;
+SubDirC++Flags $(defines) ;

[... truncated: 19772 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020578.html">[Haiku-commits] r33087 - in	haiku/branches/components/gallium3d/src/libs/drm: . intel
</A></li>
	<LI>Next message: <A HREF="020580.html">[Haiku-commits] r33089 - in	haiku/branches/components/gallium3d/src/add-ons/opengl: . i915
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20579">[ date ]</a>
              <a href="thread.html#20579">[ thread ]</a>
              <a href="subject.html#20579">[ subject ]</a>
              <a href="author.html#20579">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
