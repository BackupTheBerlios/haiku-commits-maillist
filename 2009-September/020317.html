<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r32920 - in haiku/branches/releases/r1alpha1:	build/jam docs/userguide/en docs/userguide/en/applications	headers/os/drivers src/apps/installer src/kits/interface
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-September/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r32920%20-%20in%20haiku/branches/releases/r1alpha1%3A%0A%09build/jam%20docs/userguide/en%20docs/userguide/en/applications%0A%09headers/os/drivers%20src/apps/installer%20src/kits/interface&In-Reply-To=%3C200909031050.n83AoH8c020216%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020316.html">
   <LINK REL="Next"  HREF="020322.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r32920 - in haiku/branches/releases/r1alpha1:	build/jam docs/userguide/en docs/userguide/en/applications	headers/os/drivers src/apps/installer src/kits/interface</H1>
    <B>stippi at mail.berlios.de</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r32920%20-%20in%20haiku/branches/releases/r1alpha1%3A%0A%09build/jam%20docs/userguide/en%20docs/userguide/en/applications%0A%09headers/os/drivers%20src/apps/installer%20src/kits/interface&In-Reply-To=%3C200909031050.n83AoH8c020216%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r32920 - in haiku/branches/releases/r1alpha1:	build/jam docs/userguide/en docs/userguide/en/applications	headers/os/drivers src/apps/installer src/kits/interface">stippi at mail.berlios.de
       </A><BR>
    <I>Thu Sep  3 12:50:17 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020316.html">[Haiku-commits] r32919 - haiku/trunk/build/jam
</A></li>
        <LI>Next message: <A HREF="020322.html">[Haiku-commits] r32921 -	haiku/trunk/src/add-ons/kernel/generic/ata_adapter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20317">[ date ]</a>
              <a href="thread.html#20317">[ thread ]</a>
              <a href="subject.html#20317">[ subject ]</a>
              <a href="author.html#20317">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: stippi
Date: 2009-09-03 12:49:55 +0200 (Thu, 03 Sep 2009)
New Revision: 32920
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=32920&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=32920&amp;view=rev</A>

Modified:
   haiku/branches/releases/r1alpha1/build/jam/OptionalPackages
   haiku/branches/releases/r1alpha1/docs/userguide/en/applications/drivesetup.html
   haiku/branches/releases/r1alpha1/docs/userguide/en/bootloader.html
   haiku/branches/releases/r1alpha1/docs/userguide/en/queries.html
   haiku/branches/releases/r1alpha1/docs/userguide/en/workshop-filetypes+attributes.html
   haiku/branches/releases/r1alpha1/headers/os/drivers/USB_printer.h
   haiku/branches/releases/r1alpha1/headers/os/drivers/USB_rle.h
   haiku/branches/releases/r1alpha1/headers/os/drivers/USB_spec.h
   haiku/branches/releases/r1alpha1/headers/os/drivers/bus_manager.h
   haiku/branches/releases/r1alpha1/headers/os/drivers/midi_driver.h
   haiku/branches/releases/r1alpha1/src/apps/installer/CopyEngine.cpp
   haiku/branches/releases/r1alpha1/src/kits/interface/Window.cpp
Log:
Merged r32893, r32895, r32901, r32902, r32909, r32910 and r32918.


Modified: haiku/branches/releases/r1alpha1/build/jam/OptionalPackages
===================================================================
--- haiku/branches/releases/r1alpha1/build/jam/OptionalPackages	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/build/jam/OptionalPackages	2009-09-03 10:49:55 UTC (rev 32920)
@@ -261,7 +261,7 @@
 
 
 # Curl
-if [ IsOptionalHaikuImagePackageAdded Expat ] {
+if [ IsOptionalHaikuImagePackageAdded Curl ] {
 	if $(TARGET_ARCH) != x86 {
 		Echo &quot;No optional package Curl available for $(TARGET_ARCH)&quot; ;
 	} else {

Modified: haiku/branches/releases/r1alpha1/docs/userguide/en/applications/drivesetup.html
===================================================================
--- haiku/branches/releases/r1alpha1/docs/userguide/en/applications/drivesetup.html	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/docs/userguide/en/applications/drivesetup.html	2009-09-03 10:49:55 UTC (rev 32920)
@@ -44,7 +44,10 @@
 &lt;tr&gt;&lt;td&gt;Settings:&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;span class=&quot;path&quot;&gt;~/config/settings/DriveSetup&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;
 &lt;/table&gt;
 &lt;p&gt;&lt;br/&gt;&lt;/p&gt;
-&lt;p&gt;Documentation is still missing. If you want to work on it, please announce it on the &lt;a href=&quot;<A HREF="http://www.freelists.org/list/haiku-doc">http://www.freelists.org/list/haiku-doc</A>&quot;&gt;Documentation mailing list&lt;/a&gt; to avoid duplication.&lt;/p&gt;
+&lt;p&gt;DriveSetup is a tool to create, delete and initialize partitions. At this time it can't resize or move existing partitions, so that you'll either need an unpartitioned volume (perhaps an external USB drive or another harddisk) or do the initial setup with a tool like the &lt;a href=&quot;<A HREF="http://gparted.sourceforge.net/livecd.php">http://gparted.sourceforge.net/livecd.php</A>&quot;&gt;GParted LiveCD&lt;/a&gt; to provide the space for another partition.&lt;/p&gt;
+&lt;img src=&quot;../images/apps-images/drivesetup.png&quot; alt=&quot;drivesetup.png&quot; /&gt;
+&lt;p&gt;At the top is a graphical representation of all partitions inside the device chosen in the list below it. Besides a maximum of 4 primary partitions, each of those can contain a number of extended/logical partitions. You may have to expand such a list with the widget that appears in that case in front of that device to see the details of every logical partition.&lt;/p&gt;
+&lt;p&gt;You can mount and unmount volumes from the &lt;span class=&quot;menu&quot;&gt;Partition&lt;/span&gt; menu.&lt;/p&gt;
 
 &lt;/div&gt;
 &lt;!--

Modified: haiku/branches/releases/r1alpha1/docs/userguide/en/bootloader.html
===================================================================
--- haiku/branches/releases/r1alpha1/docs/userguide/en/bootloader.html	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/docs/userguide/en/bootloader.html	2009-09-03 10:49:55 UTC (rev 32920)
@@ -26,9 +26,9 @@
 
 &lt;div class=&quot;topnav&quot;&gt;
 	&lt;p&gt;
-		&#171;&#160;&#160;&lt;a href=&quot;installation.html&quot;&gt;Installing Haiku&lt;/a&gt;
+&lt;!--		&#171;&#160;&#160;&lt;a href=&quot;installation.html&quot;&gt;Installing Haiku&lt;/a&gt;
 		&#160;&#160;::&#160;&#160;
-		&lt;a href=&quot;contents.html&quot; class=&quot;uplink&quot;&gt;Contents&lt;/a&gt;
+--&gt;		&lt;a href=&quot;contents.html&quot; class=&quot;uplink&quot;&gt;Contents&lt;/a&gt;
 		&#160;&#160;::&#160;&#160;
 		&lt;a href=&quot;filesystem-layout.html&quot;&gt;Filesystem layout&lt;/a&gt;&#160;&#160;&#187;
 	&lt;/p&gt;
@@ -54,6 +54,8 @@
 - Don't call the BIOS&lt;br /&gt;
 - Disable APM&lt;br /&gt;
 - Disable ACPI&lt;br /&gt;
+- Disable IO-APIC&lt;br /&gt;
+- Enable serial debug output&lt;/i&gt;
 - Enable on screen debug output&lt;/i&gt;
 &lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td class=&quot;onelinetop&quot;&gt;&lt;b&gt;Select fail safe video mode&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&#160;&lt;/td&gt;&lt;td&gt;If you had to activate the option &lt;i&gt;Use fail-safe video mode&lt;/i&gt;, you can set resolution and color depth.&lt;/td&gt;&lt;/tr&gt;
@@ -78,9 +80,9 @@
 
 &lt;div class=&quot;bottomnav&quot;&gt;
 	&lt;p&gt;
-		&#171;&#160;&#160;&lt;a href=&quot;installation.html&quot;&gt;Installing Haiku&lt;/a&gt;
+&lt;!--		&#171;&#160;&#160;&lt;a href=&quot;installation.html&quot;&gt;Installing Haiku&lt;/a&gt;
 		&#160;&#160;::&#160;&#160;
-		&lt;a href=&quot;contents.html&quot; class=&quot;uplink&quot;&gt;Contents&lt;/a&gt;
+--&gt;		&lt;a href=&quot;contents.html&quot; class=&quot;uplink&quot;&gt;Contents&lt;/a&gt;
 		&#160;&#160;::&#160;&#160;
 		&lt;a href=&quot;filesystem-layout.html&quot;&gt;Filesystem layout&lt;/a&gt;&#160;&#160;&#187;
 	&lt;/p&gt;

Modified: haiku/branches/releases/r1alpha1/docs/userguide/en/queries.html
===================================================================
--- haiku/branches/releases/r1alpha1/docs/userguide/en/queries.html	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/docs/userguide/en/queries.html	2009-09-03 10:49:55 UTC (rev 32920)
@@ -121,8 +121,8 @@
 &lt;li&gt;&lt;p&gt;With &lt;span class=&quot;menu&quot;&gt;File | Edit Query&lt;/span&gt; or &lt;span class=&quot;key&quot;&gt;ALT&lt;/span&gt;&#160;&lt;span class=&quot;key&quot;&gt;G&lt;/span&gt; you get back to your Find window to refine your query.&lt;/p&gt;&lt;/li&gt;
 &lt;li&gt;&lt;p&gt;A query is live, i.e. if a file that matches your search criteria appears or disappears from your system, this change is reflected in your results in real-time.&lt;/p&gt;&lt;/li&gt;
 &lt;/ul&gt;
-&lt;p&gt;You can assign a sensible attribute layout for query results of a specific filetype. Open a folder containing files of the filetype you'd like to create a template for and arrange the attributes how you'd like to have query results presented. Copy this layout with &lt;span class=&quot;menu&quot;&gt;Attributes | Copy Attributes&lt;/span&gt;.&lt;/p&gt;
-&lt;p&gt;Open &lt;span class=&quot;path&quot;&gt;/boot/home/config/settings/Tracker/DefaultQueryTemplates&lt;/span&gt;, create a new folder and rename it to &lt;i&gt;group/filetype&lt;/i&gt;, replacing slashes with underscores, e.g.&quot;audio_x-mp3&quot;. Open the new folder and paste in the layout with &lt;span class=&quot;menu&quot;&gt;Attributes | Paste Attributes&lt;/span&gt;.&lt;/p&gt;
+&lt;p&gt;You can assign a sensible attribute layout for query results of a specific filetype. Open a folder containing files of the filetype you'd like to create a template for and arrange the attributes how you'd like to have query results presented. Copy this layout with &lt;span class=&quot;menu&quot;&gt;Attributes | Copy Layout&lt;/span&gt;.&lt;/p&gt;
+&lt;p&gt;Open &lt;span class=&quot;path&quot;&gt;/boot/home/config/settings/Tracker/DefaultQueryTemplates&lt;/span&gt;, create a new folder and rename it to &lt;i&gt;group/filetype&lt;/i&gt;, replacing slashes with underscores, e.g.&quot;audio_x-mp3&quot;. Open the new folder and paste in the layout with &lt;span class=&quot;menu&quot;&gt;Attributes | Paste Layout&lt;/span&gt;.&lt;/p&gt;
 
 &lt;/div&gt;
 

Modified: haiku/branches/releases/r1alpha1/docs/userguide/en/workshop-filetypes+attributes.html
===================================================================
--- haiku/branches/releases/r1alpha1/docs/userguide/en/workshop-filetypes+attributes.html	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/docs/userguide/en/workshop-filetypes+attributes.html	2009-09-03 10:49:55 UTC (rev 32920)
@@ -194,9 +194,9 @@
 &lt;a id=&quot;query-db&quot; name=&quot;query-db&quot;&gt;Querying the database&lt;/a&gt;&lt;/h1&gt;
 &lt;p&gt;Several hours of grunt work later, we have a nice little database that you can query to find all your Christina Ricci movies that have a 7+ rating...  :)&lt;/p&gt;
 &lt;p&gt;You can assign a sensible attribute layout for query results of a specific filetype.&lt;br /&gt;
-Open the folder containing your DVDdb files and arrange the attributes how you'd like to have query results presented. Copy this layout with &lt;span class=&quot;menu&quot;&gt;Attributes | Copy Attributes&lt;/span&gt;.&lt;/p&gt;
+Open the folder containing your DVDdb files and arrange the attributes how you'd like to have query results presented. Copy this layout with &lt;span class=&quot;menu&quot;&gt;Attributes | Copy Layout&lt;/span&gt;.&lt;/p&gt;
 &lt;p&gt;Open &lt;span class=&quot;path&quot;&gt;/boot/home/config/settings/Tracker/DefaultQueryTemplates&lt;/span&gt;, create a new folder and rename it to &lt;i&gt;group/filetype&lt;/i&gt;, replacing slashes with underscores; in our case &quot;applications_DVDdb&quot;.&lt;/p&gt;
-&lt;p&gt;Open the new folder and paste in the layout with &lt;span class=&quot;menu&quot;&gt;Attributes | Paste Attributes&lt;/span&gt;. Voil&#224;:&lt;/p&gt;
+&lt;p&gt;Open the new folder and paste in the layout with &lt;span class=&quot;menu&quot;&gt;Attributes | Paste Layout&lt;/span&gt;. Voil&#224;:&lt;/p&gt;
 &lt;img src=&quot;images/workshop-filetypes+attributes-images/query-dvddb.png&quot; alt=&quot;query-dvddb.png&quot; /&gt;
 
 &lt;/div&gt;

Modified: haiku/branches/releases/r1alpha1/headers/os/drivers/USB_printer.h
===================================================================
--- haiku/branches/releases/r1alpha1/headers/os/drivers/USB_printer.h	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/headers/os/drivers/USB_printer.h	2009-09-03 10:49:55 UTC (rev 32920)
@@ -1,36 +1,20 @@
-/* 
-** USB_printer.h
-**
-** Copyright 1999, Be Incorporated. All Rights Reserved.
-**
-*/
-
+/*
+ * Copyright 2009, Haiku Inc. All Rights Reserved.
+ * Distributed under the terms of the MIT License.
+ */
 #ifndef _USB_PRINTER_H
 #define _USB_PRINTER_H
 
+
 #include &lt;Drivers.h&gt;
 
-#ifdef __cplusplus
-extern &quot;C&quot; {
-#endif
 
-/* ioctl() opcodes for usb_printer driver */
-
-enum
-{
-	USB_PRINTER_GET_DEVICE_ID = B_DEVICE_OP_CODES_END+1
+enum {
+	USB_PRINTER_GET_DEVICE_ID = B_DEVICE_OP_CODES_END + 1
 };
 
-
-/* Maximum length of the DEVICE_ID. User MUST allocate this size
-when calling USB_PRINTER_GET_DEVICE_ID ioctl() */
-
 #define USB_PRINTER_DEVICE_ID_LENGTH	256
+	/* buffer size to be handed to above ioctl() call */
 
 
-
-#ifdef __cplusplus
-}
-#endif
-
-#endif
+#endif	/* _USB_PRINTER_H */

Modified: haiku/branches/releases/r1alpha1/headers/os/drivers/USB_rle.h
===================================================================
--- haiku/branches/releases/r1alpha1/headers/os/drivers/USB_rle.h	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/headers/os/drivers/USB_rle.h	2009-09-03 10:49:55 UTC (rev 32920)
@@ -1,82 +1,30 @@
-/* 
-** USB_rle.h
-**
-** Copyright 1999, Be Incorporated. All Rights Reserved.
-**
-*/
-
+/*
+ * Copyright 2009, Haiku Inc. All Rights Reserved.
+ * Distributed under the terms of the MIT License.
+ */
 #ifndef _USB_RLE_H
 #define _USB_RLE_H
 
-#ifdef __cplusplus
-extern &quot;C&quot; {
-#endif
 
-struct _usbd_param_hdr;
+#include &lt;SupportDefs.h&gt;
 
-/*
-Run Length encoding records for isochronous IN transfers.
 
-Run Length encoding records are used to identify which samples in
-the buffer are good which are bad and which are missing. 
-Bad bytes are not extracted from the buffer, but are padded to next
-nearest sample boundary.  The ultimate consumer of the buffer
-should also receive the RLE array.
+struct _usbd_param_hdr;
 
-RLE records are constructed based on the following rules:
 
-1.	an RLE record contains a sample count and a status 
-	(good, bad, missing or unknown). A buffer has
-	associated with it an array of rle records. The number of 
-	rle records available is specified in the RLE header. The
-	number used is also in the RLE header.
+/* Run length encoding for isochronous in transfers */
 
-2.	Within the scope of a buffer, successive packets with the
-	same completion status are represented with (1) rle record.
-	For example, after three transactions which have completion
-	status of success, the byte count in the rle record for this
-	position in the data stream represents the bytes received in
-	all three packets.
-
-3.	New rle records are initialized each time the status for a
-	given packet differs from that of the previous packet.
-
-*/
-
 #define RLE_GOOD       1
 #define RLE_BAD        2
 #define RLE_MISSING    3
 #define RLE_UNKNOWN    4
 
-/*
-Name:    rle
-Purpose: used to represent the state of a portion of a data buffer
-Fields:
-	rle_status		will contain only the values: RLE_GOOD, RLE_BAD, RLE_MISSING
-	sample_count	the number of usb samples in the buffer associated with this rle
-					record.
-Notes:
-	If the buffer length field in queue_buffer_single structure changes to an
-	uint32 from uin16, then the sample_count data type must 
-	track this change.
-*/
+/* data buffer state */
 typedef struct rle {
 	uint16	rle_status;
 	uint16	sample_count;
 } rle;
 
-
-/*
-Name:    rlea
-Purpose: used as the primary rle information data structure between the
-	USB driver stack and a consuming client.
-
-Fields:
-	length		the number of rle records available in this structure.
-	num_valid	filled in by the USB driver. indicates the number of valid 
-				records filled.
-	rles[]		unconstrained array of rle records.
-*/
 typedef struct rlea {
 	uint16	length;
 	uint16	num_valid;
@@ -84,8 +32,4 @@
 } rlea;
 
 
-#ifdef __cplusplus
-}
-#endif
-
-#endif
+#endif	/* _USB_RLE_H */

Modified: haiku/branches/releases/r1alpha1/headers/os/drivers/USB_spec.h
===================================================================
--- haiku/branches/releases/r1alpha1/headers/os/drivers/USB_spec.h	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/headers/os/drivers/USB_spec.h	2009-09-03 10:49:55 UTC (rev 32920)
@@ -1,152 +1,134 @@
-/* 
-** USB_spec.h
-**
-** Copyright 1999, Be Incorporated. All Rights Reserved.
-**
-** This file contains structures and constants based on the USB Specification 1.1
-**
-*/
-
+/*
+ * Copyright 2009, Haiku Inc. All Rights Reserved.
+ * Distributed under the terms of the MIT License.
+ */
 #ifndef _USB_SPEC_H
 #define _USB_SPEC_H
 
-#ifdef __cplusplus
-extern &quot;C&quot; {
-#endif
 
-/* request types (target &amp; direction) for  send_request() */
-/* cf USB Spec Rev 1.1, table 9-2, p 183 */
-#define USB_REQTYPE_DEVICE_IN         0x80
-#define USB_REQTYPE_DEVICE_OUT        0x00
-#define USB_REQTYPE_INTERFACE_IN      0x81
-#define USB_REQTYPE_INTERFACE_OUT     0x01
-#define USB_REQTYPE_ENDPOINT_IN       0x82
-#define USB_REQTYPE_ENDPOINT_OUT      0x02
-#define USB_REQTYPE_OTHER_OUT         0x03
-#define USB_REQTYPE_OTHER_IN          0x83
+#include &lt;SupportDefs.h&gt;
 
-/* request types for send_request() */
-/* cf USB Spec Rev 1.1, table 9-2, p 183 */
-#define USB_REQTYPE_STANDARD          0x00
-#define USB_REQTYPE_CLASS             0x20
-#define USB_REQTYPE_VENDOR            0x40
-#define USB_REQTYPE_RESERVED          0x60
-#define USB_REQTYPE_MASK              0x9F
 
-/* standard request values for send_request() */
-/* cf USB Spec Rev 1.1, table 9-4, p 187 */
-#define USB_REQUEST_GET_STATUS           0
-#define USB_REQUEST_CLEAR_FEATURE        1
-#define USB_REQUEST_SET_FEATURE          3
-#define USB_REQUEST_SET_ADDRESS          5
-#define USB_REQUEST_GET_DESCRIPTOR       6
-#define USB_REQUEST_SET_DESCRIPTOR       7
-#define USB_REQUEST_GET_CONFIGURATION    8
-#define USB_REQUEST_SET_CONFIGURATION    9
-#define USB_REQUEST_GET_INTERFACE       10
-#define USB_REQUEST_SET_INTERFACE       11
-#define USB_REQUEST_SYNCH_FRAME         12
+/* Request types (target/direction) for send_request() */
+#define USB_REQTYPE_DEVICE_IN				0x80
+#define USB_REQTYPE_DEVICE_OUT				0x00
+#define USB_REQTYPE_INTERFACE_IN			0x81
+#define USB_REQTYPE_INTERFACE_OUT			0x01
+#define USB_REQTYPE_ENDPOINT_IN				0x82
+#define USB_REQTYPE_ENDPOINT_OUT			0x02
+#define USB_REQTYPE_OTHER_OUT				0x03
+#define USB_REQTYPE_OTHER_IN				0x83
 
-/* used by {set,get}_descriptor() */
-/* cf USB Spec Rev 1.1, table 9-5, p 187 */
-#define USB_DESCRIPTOR_DEVICE            1
-#define USB_DESCRIPTOR_CONFIGURATION     2
-#define USB_DESCRIPTOR_STRING            3
-#define USB_DESCRIPTOR_INTERFACE         4
-#define USB_DESCRIPTOR_ENDPOINT          5
+/* Request types for send_request() */
+#define USB_REQTYPE_STANDARD				0x00
+#define USB_REQTYPE_CLASS					0x20
+#define USB_REQTYPE_VENDOR					0x40
+#define USB_REQTYPE_RESERVED				0x60
+#define USB_REQTYPE_MASK					0x9f
 
-/* used by {set,clear}_feature() */
-/* cf USB Spec Rev 1.1, table 9-6, p 188 */
+/* Standard request values for send_request() */
+#define USB_REQUEST_GET_STATUS				0
+#define USB_REQUEST_CLEAR_FEATURE			1
+#define USB_REQUEST_SET_FEATURE				3
+#define USB_REQUEST_SET_ADDRESS				5
+#define USB_REQUEST_GET_DESCRIPTOR			6
+#define USB_REQUEST_SET_DESCRIPTOR			7
+#define USB_REQUEST_GET_CONFIGURATION		8
+#define USB_REQUEST_SET_CONFIGURATION		9
+#define USB_REQUEST_GET_INTERFACE			10
+#define USB_REQUEST_SET_INTERFACE			11
+#define USB_REQUEST_SYNCH_FRAME				12
+
+/* Used by {set|get}_descriptor() */
+#define USB_DESCRIPTOR_DEVICE				1
+#define USB_DESCRIPTOR_CONFIGURATION		2
+#define USB_DESCRIPTOR_STRING				3
+#define USB_DESCRIPTOR_INTERFACE			4
+#define USB_DESCRIPTOR_ENDPOINT				5
+
+/* Used by {set|clear}_feature() */
 #define USB_FEATURE_DEVICE_REMOTE_WAKEUP	1
 #define USB_FEATURE_ENDPOINT_HALT			0
 
-#define USB_ENDPOINT_ATTR_CONTROL		0x00
-#define USB_ENDPOINT_ATTR_ISOCHRONOUS	0x01
-#define USB_ENDPOINT_ATTR_BULK			0x02 
-#define USB_ENDPOINT_ATTR_INTERRUPT		0x03 
-#define USB_ENDPOINT_ATTR_MASK			0x03 
+#define USB_ENDPOINT_ATTR_CONTROL			0x00
+#define USB_ENDPOINT_ATTR_ISOCHRONOUS		0x01
+#define USB_ENDPOINT_ATTR_BULK				0x02
+#define USB_ENDPOINT_ATTR_INTERRUPT			0x03
+#define USB_ENDPOINT_ATTR_MASK				0x03
 
-#define USB_ENDPOINT_ADDR_DIR_IN	 	0x80
-#define USB_ENDPOINT_ADDR_DIR_OUT		0x00
+#define USB_ENDPOINT_ADDR_DIR_IN			0x80
+#define USB_ENDPOINT_ADDR_DIR_OUT			0x00
 
 
-typedef struct { 
-	/* cf USB Spec Rev 1.1, table 9-7, p 197 */
-	uint8 length;
-	uint8 descriptor_type;          /* USB_DESCRIPTOR_DEVICE */
-	uint16 usb_version;             /* USB_DESCRIPTOR_DEVICE_LENGTH */
-	uint8 device_class;
-	uint8 device_subclass;
-	uint8 device_protocol;
-	uint8 max_packet_size_0;
-	uint16 vendor_id;
-	uint16 product_id;
-	uint16 device_version;
-	uint8 manufacturer;
-	uint8 product;
-	uint8 serial_number;
-	uint8 num_configurations;
+typedef struct usb_device_descriptor {
+	uint8	length;
+	uint8	descriptor_type;
+	uint16	usb_version;
+	uint8	device_class;
+	uint8	device_subclass;
+	uint8	device_protocol;
+	uint8	max_packet_size_0;
+	uint16	vendor_id;
+	uint16	product_id;
+	uint16	device_version;
+	uint8	manufacturer;
+	uint8	product;
+	uint8	serial_number;
+	uint8	num_configurations;
 } _PACKED usb_device_descriptor;
 
-typedef struct {
-	/* cf USB Spec Rev 1.1, table 9-8, p 199 */
-	uint8 length;
-	uint8 descriptor_type;          /* USB_DESCRIPTOR_CONFIGURATION */
-	uint16 total_length;            /* USB_DESCRIPTOR_CONFIGURATION_LENGTH */
-	uint8 number_interfaces;
-	uint8 configuration_value;
-	uint8 configuration;
-	uint8 attributes;
-	uint8 max_power;
+typedef struct usb_configuration_descriptor {
+	uint8	length;
+	uint8	descriptor_type;
+	uint16	total_length;
+	uint8	number_interfaces;
+	uint8	configuration_value;
+	uint8	configuration;
+	uint8	attributes;
+	uint8	max_power;
 } _PACKED usb_configuration_descriptor;
 
-typedef struct {
-	/* cf USB Spec Rev 1.1, table 9-9, p 202 */
-	uint8 length;
-	uint8 descriptor_type;          /* USB_DESCRIPTOR_INTERFACE */
-	uint8 interface_number;         /* USB_DESCRIPTOR_INTERFACE_LENGTH  */
-	uint8 alternate_setting;
-	uint8 num_endpoints;
-	uint8 interface_class;
-	uint8 interface_subclass;
-	uint8 interface_protocol;
-	uint8 interface;
+typedef struct usb_interface_descriptor {
+	uint8	length;
+	uint8	descriptor_type;
+	uint8	interface_number;
+	uint8	alternate_setting;
+	uint8	num_endpoints;
+	uint8	interface_class;
+	uint8	interface_subclass;
+	uint8	interface_protocol;
+	uint8	interface;
 } _PACKED usb_interface_descriptor;
 
-typedef struct {
-	/* cf USB Spec Rev 1.1, table 9-10, p 203 */
-	uint8 length;
-	uint8 descriptor_type;          /* USB_DESCRIPTOR_ENDPOINT */
-	uint8 endpoint_address;         /* USB_DESCRIPTOR_ENDPOINT_LENGTH */
-	uint8 attributes;
-	uint16 max_packet_size;
-	uint8 interval;
+typedef struct usb_endpoint_descriptor {
+	uint8	length;
+	uint8	descriptor_type;
+	uint8	endpoint_address;
+	uint8	attributes;
+	uint16	max_packet_size;
+	uint8	interval;
 } _PACKED usb_endpoint_descriptor;
 
-typedef struct {
-	/* cf USB Spec Rev 1.1, table 9-12, p 205 */
-	uint8 length;                   /* USB_DESCRIPTOR_STRING */
-	uint8 descriptor_type;
-	uchar string[1];
+typedef struct usb_string_descriptor {
+	uint8	length;
+	uint8	descriptor_type;
+	uchar	string[1];
 } _PACKED usb_string_descriptor;
 
-typedef struct {
-	uint8 length;
-	uint8 descriptor_type;
-	uint8 data[1];
+typedef struct usb_generic_descriptor {
+	uint8	length;
+	uint8	descriptor_type;
+	uint8	data[1];
 } _PACKED usb_generic_descriptor;
 
-typedef union {
-	usb_generic_descriptor generic;
-	usb_device_descriptor device;
-	usb_interface_descriptor interface;
-	usb_endpoint_descriptor endpoint;
-	usb_configuration_descriptor configuration;
-	usb_string_descriptor string;
+typedef union usb_descriptor {
+	usb_generic_descriptor			generic;
+	usb_device_descriptor			device;
+	usb_interface_descriptor		interface;
+	usb_endpoint_descriptor			endpoint;
+	usb_configuration_descriptor	configuration;
+	usb_string_descriptor			string;
 } usb_descriptor;
 
-#ifdef __cplusplus
-}
-#endif
 
-#endif
+#endif	/* _USB_SPEC_H */

Modified: haiku/branches/releases/r1alpha1/headers/os/drivers/bus_manager.h
===================================================================
--- haiku/branches/releases/r1alpha1/headers/os/drivers/bus_manager.h	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/headers/os/drivers/bus_manager.h	2009-09-03 10:49:55 UTC (rev 32920)
@@ -1,21 +1,13 @@
-/*******************************************************************************
-/
-/	File:			bus_managers.h
-/
-/	Description:	bus manager API
-/
-/	Copyright 1998, Be Incorporated, All Rights Reserved.
-/
-*******************************************************************************/
-
+/*
+ * Copyright 2009, Haiku Inc. All Rights Reserved.
+ * Distributed under the terms of the MIT License.
+ */
 #ifndef _BUS_MANAGER_H
 #define _BUS_MANAGER_H
 
+
 #include &lt;module.h&gt;
 
-#ifdef __cplusplus
-extern &quot;C&quot; {
-#endif
 
 typedef struct bus_manager_info bus_manager_info;
 
@@ -24,8 +16,5 @@
 	status_t		(*rescan)();
 };
 
-#ifdef __cplusplus
-}
-#endif
 
 #endif	/* _BUS_MANAGER_H */

Modified: haiku/branches/releases/r1alpha1/headers/os/drivers/midi_driver.h
===================================================================
--- haiku/branches/releases/r1alpha1/headers/os/drivers/midi_driver.h	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/headers/os/drivers/midi_driver.h	2009-09-03 10:49:55 UTC (rev 32920)
@@ -1,28 +1,16 @@
-/* ++++++++++
-	FILE:	midi_driver.h
-	REVS:	$Revision: 1.1 $
-	NAME:	herold
-	DATE:	Tue Jun  4 15:23:29 PDT 1996
-
-	Interface to /dev/midi, the midi driver
-+++++ */
 /*
-	Copyright 1999, Be Incorporated.   All Rights Reserved.
-	This file may be used under the terms of the Be Sample Code License.
-*/
-
+ * Copyright 2009, Haiku Inc. All Rights Reserved.
+ * Distributed under the terms of the MIT License.
+ */
 #ifndef _MIDI_DRIVER_H
 #define _MIDI_DRIVER_H
 
+
 #include &lt;Drivers.h&gt;
 #include &lt;module.h&gt;
 
-/* -----
-	ioctl codes
------ */
 
-/* the old opcodes are deprecated, and may or may not work 
-   in newer drivers */
+/* deprecated interface */
 enum {
 	B_MIDI_GET_READ_TIMEOUT = B_MIDI_DRIVER_BASE,
 	B_MIDI_SET_READ_TIMEOUT,
@@ -34,85 +22,49 @@
 	B_MIDI_SET_READ_TIMEOUT_OLD
 };
 
-/* the default timeout when you open a midi driver */
+
 #define B_MIDI_DEFAULT_TIMEOUT 1000000000000000LL
 
-/*	Usage:
-	To read, set &quot;data&quot; to a pointer to your buffer, and &quot;size&quot; to the 
-	maximum size of this buffer. On return, &quot;when&quot; will contain the time 
-	at which the data was received (first byte) and &quot;size&quot; will contain 
-	the actual amount of data read.
-	Call ioctl(fd, B_MIDI_TIMED_READ, &amp;midi_timed_data, sizeof(midi_timed_data));
-	To write, set &quot;when&quot; to when you want the first byte to go out the 
-	wire, set &quot;data&quot; to point to your data, and set &quot;size&quot; to the size 
-	of your data.
-	Call ioctl(fd, B_MIDI_TIMED_WRITE, &amp;midi_timed_data, sizeof(midi_timed_data));
-*/
 typedef struct {
-	bigtime_t when;
-	size_t size;
-	unsigned char * data;
+	bigtime_t	when;
+	size_t		size;
+	uint8*		data;
 } midi_timed_data;
 
 
-/* The MIDI parser returns the number of bytes that a message contains, given the */
-/* initial byte. For some messages, this is not known until the second byte is seen. */
-/* For such messages, a state &gt; 0 is returned as well as some count &gt; 0. When state */
-/* is &gt; 0, you should call (*parse) for the next byte as well, which might modify */
-/* the returned message size. Message size will always be returned with the current */
-/* byte being counted as byte 1. A return of 0 means that the byte initiates a new */
-/* message. SysX is handled by returning max_size until the end or next initial message */
-/* is seen. So your loop looks something like: */
-/* 
-  uint32 state = 0;	// Only set this to 0 the first time you call the parser.
-                  // preserve the 'state' between invocations of your read() hook.
-  int todo = 0;
-  unsigned char * end = in_buf+buf_size
-  unsigned char * out_buf = in_buf;
-  while (true) {
-    uchar byte = read_midi();
-    if (!todo || state) {
-      todo = (*parser-&gt;parse)(&amp;state, byte, end-out_buf);
-    }
-    if (todo &lt; 1) {
-      unput_midi(byte);
-    } else {
-      *(out_buf++) = byte;
-      todo--;
-    }
-    if (todo &lt; 1 || out_buf &gt;= end) {
-      received_midi_message(in_buf, out_buf-in_buf);
-      todo = 0;
-    }
-  }
-   */
-
 #define B_MIDI_PARSER_MODULE_NAME &quot;media/midiparser/v1&quot;
 
 typedef struct _midi_parser_module_info {
 	module_info	minfo;
-	int		(*parse)(uint32 * state, uchar byte, size_t max_size);
-	int		_reserved_;
+	int			(*parse)(uint32* state, uchar byte, size_t maxSize);
+	int			_reserved_;
 } midi_parser_module_info;
 
+
 #define B_MPU_401_MODULE_NAME &quot;generic/mpu401/v1&quot;
 
 enum {
 	B_MPU_401_ENABLE_CARD_INT = 1,
 	B_MPU_401_DISABLE_CARD_INT
 };
+
 typedef struct _generic_mpu401_module {
-	module_info minfo;
-	status_t (*create_device)(int port, void ** out_storage, uint32 workarounds, void (*interrupt_op)(int32 op, void * card), void * card);
-	status_t (*delete_device)(void * storage);
-	status_t (*open_hook)(void * storage, uint32 flags, void ** out_cookie);
-	status_t (*close_hook)(void * cookie);
-	status_t (*free_hook)(void * cookie);
-	status_t (*control_hook)(void * cookie, uint32 op, void * data, size_t len);
-	status_t (*read_hook)(void * cookie, off_t pos, void * data, size_t * len);
-	status_t (*write_hook)(void * cookie, off_t pos, const void * data, size_t * len);
-	bool (*interrupt_hook)(void * cookie);
-	int	_reserved_;
+	module_info	minfo;
+	status_t	(*create_device)(int port, void** _handle, uint32 workArounds,
+					void (*interruptOp)(int32 op, void* card), void* card);
+	status_t	(*delete_device)(void* handle);
+	status_t	(*open_hook)(void* storage, uint32 flags, void** _cookie);
+	status_t	(*close_hook)(void* cookie);
+	status_t	(*free_hook)(void* cookie);
+	status_t	(*control_hook)(void* cookie, uint32 op, void* data,
+					size_t length);
+	status_t	(*read_hook)(void* cookie, off_t pos, void* data,
+					size_t* _length);
+	status_t	(*write_hook)(void* cookie, off_t pos, const void* data,
+					size_t* _length);
+	bool		(*interrupt_hook)(void* cookie);
+	int			_reserved_;
 } generic_mpu401_module;
 
-#endif
+
+#endif	/* _MIDI_DRIVER_H */

Modified: haiku/branches/releases/r1alpha1/src/apps/installer/CopyEngine.cpp
===================================================================
--- haiku/branches/releases/r1alpha1/src/apps/installer/CopyEngine.cpp	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/src/apps/installer/CopyEngine.cpp	2009-09-03 10:49:55 UTC (rev 32920)
@@ -533,7 +533,21 @@
 			printf(&quot;ignoring '%s'.\n&quot;, name);
 			return false;
 		}
+		if (strcmp(&quot;rr_moved&quot;, name) == 0) {
+			printf(&quot;ignoring '%s'.\n&quot;, name);
+			return false;
+		}
 	}
+	if (level == 1 &amp;&amp; S_ISREG(statInfo.st_mode)) {
+		if (strcmp(&quot;boot.catalog&quot;, name) == 0) {
+			printf(&quot;ignoring '%s'.\n&quot;, name);
+			return false;
+		}
+		if (strcmp(&quot;haiku-boot-floppy.image&quot;, name) == 0) {
+			printf(&quot;ignoring '%s'.\n&quot;, name);
+			return false;
+		}
+	}
 	return true;
 }
 

Modified: haiku/branches/releases/r1alpha1/src/kits/interface/Window.cpp
===================================================================
--- haiku/branches/releases/r1alpha1/src/kits/interface/Window.cpp	2009-09-03 10:22:59 UTC (rev 32919)
+++ haiku/branches/releases/r1alpha1/src/kits/interface/Window.cpp	2009-09-03 10:49:55 UTC (rev 32920)
@@ -1983,6 +1983,10 @@
 bool
 BWindow::IsMinimized() const
 {
+	BAutolock locker(const_cast&lt;BWindow*&gt;(this));
+	if (!locker.IsLocked())
+		return false;
+
 	// Hiding takes precendence over minimization!!!
 	if (IsHidden())
 		return false;
@@ -2456,7 +2460,7 @@
 	// Set size limits now if needed
 	_CheckSizeLimits();
 
-	MoveTo(BLayoutUtils::AlignInFrame(rect, Size(), 
+	MoveTo(BLayoutUtils::AlignInFrame(rect, Size(),
 		BAlignment(B_ALIGN_HORIZONTAL_CENTER,
 			B_ALIGN_VERTICAL_CENTER)).LeftTop());
 }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020316.html">[Haiku-commits] r32919 - haiku/trunk/build/jam
</A></li>
	<LI>Next message: <A HREF="020322.html">[Haiku-commits] r32921 -	haiku/trunk/src/add-ons/kernel/generic/ata_adapter
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20317">[ date ]</a>
              <a href="thread.html#20317">[ thread ]</a>
              <a href="subject.html#20317">[ subject ]</a>
              <a href="author.html#20317">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
