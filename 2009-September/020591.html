<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r33098 - in	haiku/branches/components/gallium3d/src: add-ons/opengl/i915	add-ons/opengl/softpipe kits/opengl kits/opengl/gallium	kits/opengl/gallium/drivers/i915simple	kits/opengl/gallium/drivers/softpipe	kits/opengl/gallium/state_trackers/dri kits/opengl/glu	kits/opengl/glut kits/opengl/mesa	kits/opengl/mesa/drivers/dri/common
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-September/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r33098%20-%20in%0A%09haiku/branches/components/gallium3d/src%3A%20add-ons/opengl/i915%0A%09add-ons/opengl/softpipe%20kits/opengl%20kits/opengl/gallium%0A%09kits/opengl/gallium/drivers/i915simple%0A%09kits/opengl/gallium/drivers/softpipe%0A%09kits/opengl/gallium/state_trackers/dri%20kits/opengl/glu%0A%09kits/opengl/glut%20kits/opengl/mesa%0A%09kits/opengl/mesa/drivers/dri/common&In-Reply-To=%3C200909121537.n8CFbmOY002331%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="020589.html">
   <LINK REL="Next"  HREF="020592.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r33098 - in	haiku/branches/components/gallium3d/src: add-ons/opengl/i915	add-ons/opengl/softpipe kits/opengl kits/opengl/gallium	kits/opengl/gallium/drivers/i915simple	kits/opengl/gallium/drivers/softpipe	kits/opengl/gallium/state_trackers/dri kits/opengl/glu	kits/opengl/glut kits/opengl/mesa	kits/opengl/mesa/drivers/dri/common</H1>
    <B>aljen at mail.berlios.de</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r33098%20-%20in%0A%09haiku/branches/components/gallium3d/src%3A%20add-ons/opengl/i915%0A%09add-ons/opengl/softpipe%20kits/opengl%20kits/opengl/gallium%0A%09kits/opengl/gallium/drivers/i915simple%0A%09kits/opengl/gallium/drivers/softpipe%0A%09kits/opengl/gallium/state_trackers/dri%20kits/opengl/glu%0A%09kits/opengl/glut%20kits/opengl/mesa%0A%09kits/opengl/mesa/drivers/dri/common&In-Reply-To=%3C200909121537.n8CFbmOY002331%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r33098 - in	haiku/branches/components/gallium3d/src: add-ons/opengl/i915	add-ons/opengl/softpipe kits/opengl kits/opengl/gallium	kits/opengl/gallium/drivers/i915simple	kits/opengl/gallium/drivers/softpipe	kits/opengl/gallium/state_trackers/dri kits/opengl/glu	kits/opengl/glut kits/opengl/mesa	kits/opengl/mesa/drivers/dri/common">aljen at mail.berlios.de
       </A><BR>
    <I>Sat Sep 12 17:37:48 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="020589.html">[Haiku-commits] BOM (trunk/) r33069~33076 ...failed Cc	/storage/Build-o-Matic/haiku/haiku/generated.x86gcc4hybrid/objects/haiku/x86/release/bin/bash/builtins/builtins.o	...
</A></li>
        <LI>Next message: <A HREF="020592.html">[Haiku-commits] r33099 - in haiku/branches/components/gallium3d:	headers/private headers/private/drm src/add-ons/kernel	src/add-ons/kernel/drivers src/add-ons/kernel/drivers/drm	src/add-ons/kernel/drivers/drm/test src/add-ons/kernel/drm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20591">[ date ]</a>
              <a href="thread.html#20591">[ thread ]</a>
              <a href="subject.html#20591">[ subject ]</a>
              <a href="author.html#20591">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: aljen
Date: 2009-09-12 17:37:38 +0200 (Sat, 12 Sep 2009)
New Revision: 33098
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=33098&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=33098&amp;view=rev</A>

Added:
   haiku/branches/components/gallium3d/src/kits/opengl/gallium/Jamfile
   haiku/branches/components/gallium3d/src/kits/opengl/gallium/drivers/i915simple/Jamfile
   haiku/branches/components/gallium3d/src/kits/opengl/gallium/drivers/softpipe/Jamfile
   haiku/branches/components/gallium3d/src/kits/opengl/gallium/state_trackers/dri/Jamfile
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/Jamfile
Modified:
   haiku/branches/components/gallium3d/src/add-ons/opengl/i915/Jamfile
   haiku/branches/components/gallium3d/src/add-ons/opengl/softpipe/Jamfile
   haiku/branches/components/gallium3d/src/kits/opengl/Jamfile
   haiku/branches/components/gallium3d/src/kits/opengl/glu/Jamfile
   haiku/branches/components/gallium3d/src/kits/opengl/glut/Jamfile
   haiku/branches/components/gallium3d/src/kits/opengl/mesa/Jamfile
Log:
&quot;The Jamfiles from Another World&quot; aka separating &amp; clearing part two


Modified: haiku/branches/components/gallium3d/src/add-ons/opengl/i915/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/add-ons/opengl/i915/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/add-ons/opengl/i915/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -17,15 +17,8 @@
 
 UseHeaders [ FDirName $(HAIKU_TOP) headers compatibility bsd ] : true ;
 UseHeaders [ FDirName $(HAIKU_TOP) src add-ons opengl trace ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl hgl ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa main ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa gallium include ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa gallium auxiliary ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa glapi ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa tnl ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa x86 ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa ppc ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium include ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium auxiliary ] ;
 UseHeaders [ FDirName $(HAIKU_TOP) src libs drm intel ] : true ;
 UseHeaders [ FDirName $(HAIKU_TOP) src libs drm ] : true ;
 UseHeaders [ FDirName $(SUBDIR) gem ] : true ;
@@ -34,34 +27,7 @@
 SEARCH_SOURCE += [ FDirName $(SUBDIR) gem ] ;
 
 Addon i915 :
-    # intel gem
-    intel_drm_api.c
-    intel_drm_batchbuffer.c
-    intel_drm_buffer.c
-    intel_drm_fence.c
-
-    # driver
     i915PipeRenderer.cpp
-    i915_blit.c
-    i915_buffer.c
-    i915_clear.c
-    i915_context.c
-    i915_debug.c
-    i915_debug_fp.c
-    i915_flush.c
-    i915_fpc_emit.c
-    i915_fpc_translate.c
-    i915_prim_emit.c
-    i915_prim_vbuf.c
-    i915_screen.c
-    i915_state.c
-    i915_state_derived.c
-    i915_state_dynamic.c
-    i915_state_emit.c
-    i915_state_immediate.c
-    i915_state_sampler.c
-    i915_surface.c
-    i915_texture.c
-	: libGL.so libmesa.a be libdrm_intel.so $(TARGET_LIBSUPC++)
+	: libGL.so libmesa.a libi915simple.a libdrm_intel.so be $(TARGET_LIBSUPC++)
 ;
 

Modified: haiku/branches/components/gallium3d/src/add-ons/opengl/softpipe/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/add-ons/opengl/softpipe/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/add-ons/opengl/softpipe/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -2,39 +2,32 @@
 
 SetSubDirSupportedPlatformsBeOSCompatible ;
 
-if $(TARGET_PLATFORM) != haiku {
-	UseHeaders [ FDirName $(HAIKU_TOP) headers os opengl ] : true ;
-		# We need our public GL headers also when not compiling for Haiku.
-}
+local defines ;
+defines = BEOS_THREADS GNU_ASSEMBLER ;
 
-
-{
-	local defines ;
-	defines = BEOS_THREADS GNU_ASSEMBLER ;
-
-	if $(TARGET_ARCH) = x86 {
-		defines += USE_X86_ASM USE_MMX_ASM USE_3DNOW_ASM USE_SSE_ASM ; 
-	} else {
-		# Not yet supported, as current Mesa3D PPC assembly is Linux-dependent!
-		# defines += USE_PPC_ASM ;
-	}
-
-	SubDirC++Flags [ FDefines $(defines) ] ;
+if $(TARGET_ARCH) = x86 {
+	defines += USE_X86_ASM USE_MMX_ASM USE_3DNOW_ASM USE_SSE_ASM ; 
+} else {
+	# Not yet supported, as current Mesa3D PPC assembly is Linux-dependent!
+	# defines += USE_PPC_ASM ;
 }
 
+SubDirC++Flags [ FDefines $(defines) ] ;
+
 UsePrivateHeaders interface opengl ;
 
-UseHeaders [ FDirName $(HAIKU_TOP) src add-ons opengl trace ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl hgl ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium auxiliary ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium drivers softpipe ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium include ] ;
 UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa main ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa gallium include ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa gallium auxiliary ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa glapi ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa tnl ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa x86 ] ;
-UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa ppc ] ;
 
+#UseHeaders [ FDirName $(HAIKU_TOP) src add-ons opengl trace ] ;
+#UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa main ] ;
+#UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa glapi ] ;
+#UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa tnl ] ;
+#UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa x86 ] ;
+#UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa ppc ] ;
+
 Addon SoftPipe :
 	SoftPipeRenderer.cpp
 	hsp_bitmap_wrapper.cpp
@@ -43,43 +36,5 @@
 	hsp_device.c
 	hsp_framebuffer.c
 	hsp_getprocaddress.c
-#	hsp_pixelformat.c
-	sp_clear.c
-	sp_context.c
-	sp_draw_arrays.c
-	sp_flush.c
-	sp_fs_exec.c
-	sp_fs_llvm.c
-	sp_fs_sse.c
-	sp_prim_setup.c
-	sp_prim_vbuf.c
-	sp_quad_alpha_test.c
-	sp_quad_blend.c
-#	sp_quad_bufloop.c
-	sp_quad_colormask.c
-	sp_quad_coverage.c
-	sp_quad_depth_test.c
-	sp_quad_earlyz.c
-	sp_quad_fs.c
-	sp_quad_occlusion.c
-	sp_quad_output.c
-	sp_quad_pipe.c
-	sp_quad_stencil.c
-	sp_quad_stipple.c
-	sp_query.c
-	sp_screen.c
-	sp_setup.c
-	sp_state_blend.c
-	sp_state_clip.c
-	sp_state_derived.c
-	sp_state_fs.c
-	sp_state_rasterizer.c
-	sp_state_sampler.c
-	sp_state_surface.c
-	sp_state_vertex.c
-	sp_surface.c
-	sp_tex_sample.c
-	sp_texture.c
-	sp_tile_cache.c
-	: libGL.so libmesa.a be translation $(TARGET_LIBSUPC++)
+	: libGL.so libmesa.a libsoftpipe.a libgallium.a be translation $(TARGET_LIBSUPC++)
 ;

Modified: haiku/branches/components/gallium3d/src/kits/opengl/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/kits/opengl/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/kits/opengl/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -46,25 +46,20 @@
 	:
 
 	# Mesa GL API dispatching code
-	&lt;mesa&gt;glapi-dispatching.o
+	&lt;libGL&gt;glapi-dispatching.o
 
 	# GLU API is included in libGL.so under BeOS R5, not a separate libglu.so library
-	&lt;opengl&gt;sgi-glu.o
+	&lt;libGL&gt;sgi-glu.o
 
 	# GLUT API is included in libGL.so under Haiku, not a separate libglut.so library
-	&lt;opengl&gt;glut.o
-	
-	&lt;mesa&gt;dricommon.o
-	&lt;mesa&gt;drist.o
+	&lt;libGL&gt;glut.o
 
-	libmesa.a		# For GL API dispatching, mostly 
+#	&lt;libGL&gt;gallium.o
+#	&lt;libGL&gt;mesa.o		# For GL API dispatching, mostly 
 
 	# External libs:
 	be 
 	game			# BWindowScreen needed by BGLScreen stub class
-	libdrm.so
-	expat
-	bsd
 	$(TARGET_LIBSTDC++)
 ;
 
@@ -72,6 +67,7 @@
 	libGL.so : 
 	boot beos system lib ;
 
+SubInclude HAIKU_TOP src kits opengl gallium ;
 SubInclude HAIKU_TOP src kits opengl glu ;
 SubInclude HAIKU_TOP src kits opengl glut ;
 SubInclude HAIKU_TOP src kits opengl mesa ;

Added: haiku/branches/components/gallium3d/src/kits/opengl/gallium/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/kits/opengl/gallium/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/kits/opengl/gallium/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -0,0 +1,189 @@
+SubDir HAIKU_TOP src kits opengl gallium ;
+
+DEBUG = 0 ;
+
+UsePrivateHeaders opengl ;
+
+UseHeaders [ FDirName $(SUBDIR) auxiliary ] ;
+UseHeaders [ FDirName $(SUBDIR) include ] ;
+UseHeaders [ FDirName $(SUBDIR) state_trackers dri ] ;
+
+SEARCH_SOURCE += [ FDirName $(SUBDIR) auxiliary cso_cache ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) auxiliary draw ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) auxiliary gallivm ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) auxiliary indices ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) auxiliary pipebuffer ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) auxiliary rtasm ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) auxiliary sct ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) auxiliary tgsi ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) auxiliary translate ] ;
+SEARCH_SOURCE += [ FDirName $(SUBDIR) auxiliary util ] ;
+
+local defines ;
+defines = BEOS_THREADS GNU_ASSEMBLER HAVE_POSIX_MEMALIGN ;
+
+if $(TARGET_ARCH) = x86 {
+	defines += USE_X86_ASM USE_MMX_ASM USE_3DNOW_ASM USE_SSE_ASM ;
+} else if $(TARGET_ARCH) = ppc {
+	# Not yet supported, as current Mesa3D PPC assembly is Linux-dependent!
+	# defines += USE_PPC_ASM ;
+} else if $(TARGET_ARCH) = sparc {
+	defines += USE_SPARC_ASM ;
+}
+
+defines = [ FDefines $(defines) ] ;
+SubDirCcFlags $(defines) ;
+SubDirC++Flags $(defines) ;
+SubDirAsFlags $(defines) ;
+
+
+StaticLibrary libgallium.a :
+	# auxiliary/cso_cache
+	cso_cache.c
+	cso_context.c
+	cso_hash.c
+
+	# auxiliary/draw
+	draw_context.c
+	draw_pipe.c
+	draw_pipe_aaline.c
+	draw_pipe_aapoint.c
+	draw_pipe_clip.c
+	draw_pipe_cull.c
+	draw_pipe_flatshade.c
+	draw_pipe_offset.c
+	draw_pipe_pstipple.c
+	draw_pipe_stipple.c
+	draw_pipe_twoside.c
+	draw_pipe_unfilled.c
+	draw_pipe_util.c
+	draw_pipe_validate.c
+	draw_pipe_vbuf.c
+	draw_pipe_wide_line.c
+	draw_pipe_wide_point.c
+	draw_pt.c
+	draw_pt_elts.c
+	draw_pt_emit.c
+	draw_pt_fetch.c
+	draw_pt_fetch_emit.c
+	draw_pt_fetch_shade_emit.c
+	draw_pt_fetch_shade_pipeline.c
+	draw_pt_post_vs.c
+	draw_pt_util.c
+	draw_pt_varray.c
+	draw_pt_vcache.c
+	draw_vertex.c
+	draw_vs.c
+	draw_vs_aos.c
+	draw_vs_aos_io.c
+	draw_vs_aos_machine.c
+	draw_vs_exec.c
+	draw_vs_llvm.c
+	draw_vs_ppc.c
+	draw_vs_sse.c
+	draw_vs_varient.c
+
+	# auxiliary/gallivm
+#	gallivm.cpp
+#	gallivm_builtins.cpp
+#	gallivm_cpu.cpp
+#	instructions.cpp
+#	instructionssoa.cpp
+#	llvm_builtins.c
+#	loweringpass.cpp
+#	soabuiltins.c
+#	storage.cpp
+#	storagesoa.cpp
+#	tgsitollvm.cpp
+
+	# auxiliary/indices
+#	u_indices.c
+#	u_indices_gen.c
+#	u_unfilled_gen.c
+#	u_unfilled_indices.c
+
+	# auxiliary/pipebuffer
+	pb_buffer_fenced.c
+	pb_buffer_malloc.c
+	pb_bufmgr_alt.c
+	pb_bufmgr_cache.c
+	pb_bufmgr_debug.c
+	pb_bufmgr_fenced.c
+	pb_bufmgr_mm.c
+	pb_bufmgr_ondemand.c
+	pb_bufmgr_pool.c
+	pb_bufmgr_slab.c
+	pb_validate.c
+
+	# auxiliary/rtasm
+	rtasm_cpu.c
+	rtasm_execmem.c
+#	rtasm_ppc.c
+#	rtasm_ppc_spe.c
+	rtasm_x86sse.c
+
+	# auxiliary/sct
+	sct.c
+	usage.c
+
+	# auxiliary/tgsi
+	tgsi_build.c
+	tgsi_dump.c
+	tgsi_dump_c.c
+	tgsi_exec.c
+	tgsi_info.c
+	tgsi_iterate.c
+	tgsi_parse.c
+	tgsi_ppc.c
+	tgsi_sanity.c
+	tgsi_scan.c
+	tgsi_sse2.c
+	tgsi_text.c
+	tgsi_transform.c
+	tgsi_util.c
+    tgsi_ureg.c
+
+	# auxiliary/translate
+	translate.c
+	translate_cache.c
+	translate_generic.c
+	translate_sse.c
+
+	# auxiliary/util
+	u_bitmask.c
+	u_blit.c
+	u_cache.c
+	u_cpu_detect.c
+	u_debug.c
+    u_debug_dump.c
+	u_debug_memory.c
+	u_debug_profile.c
+	u_debug_stack.c
+	u_debug_symbol.c
+	u_draw_quad.c
+    u_format.c
+	u_gen_mipmap.c
+	u_handle_table.c
+	u_hash.c
+	u_hash_table.c
+	u_keymap.c
+	u_linear.c
+	u_math.c
+	u_mm.c
+	u_network.c
+	u_rect.c
+	u_simple_screen.c
+	u_simple_shaders.c
+	u_snprintf.c
+	u_stream_stdc.c
+	u_stream_wd.c
+	u_surface.c
+	u_tile.c
+	u_time.c
+	u_timed_winsys.c
+	u_upload_mgr.c
+;
+
+SubInclude HAIKU_TOP src kits opengl gallium drivers i915simple ;
+SubInclude HAIKU_TOP src kits opengl gallium drivers softpipe ;
+SubInclude HAIKU_TOP src kits opengl gallium state_trackers dri ;

Added: haiku/branches/components/gallium3d/src/kits/opengl/gallium/drivers/i915simple/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/kits/opengl/gallium/drivers/i915simple/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/kits/opengl/gallium/drivers/i915simple/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -0,0 +1,57 @@
+SubDir HAIKU_TOP src kits opengl gallium drivers i915simple ;
+
+local defines ;
+defines = BEOS_THREADS GNU_ASSEMBLER ;
+
+if $(TARGET_ARCH) = x86 {
+	defines += USE_X86_ASM USE_MMX_ASM USE_3DNOW_ASM USE_SSE_ASM ;
+} else {
+	# Not yet supported, as current Mesa3D PPC assembly is Linux-dependent!
+	# defines += USE_PPC_ASM ;
+}
+
+SubDirC++Flags [ FDefines $(defines) ] ;
+
+UsePrivateHeaders interface opengl ;
+UseLibraryHeaders drm ;
+
+UseHeaders [ FDirName $(HAIKU_TOP) headers compatibility bsd ] : true ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium include ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium auxiliary ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src libs drm intel ] : true ;
+UseHeaders [ FDirName $(HAIKU_TOP) src libs drm ] : true ;
+UseHeaders [ FDirName $(SUBDIR) gem ] : true ;
+UseHeaders [ FDirName $(SUBDIR) ] : true ;
+
+SEARCH_SOURCE += [ FDirName $(SUBDIR) gem ] ;
+
+StaticLibrary libi915simple.a :
+    # intel gem
+    intel_drm_api.c
+    intel_drm_batchbuffer.c
+    intel_drm_buffer.c
+    intel_drm_fence.c
+
+    # driver
+    i915_blit.c
+    i915_buffer.c
+    i915_clear.c
+    i915_context.c
+    i915_debug.c
+    i915_debug_fp.c
+    i915_flush.c
+    i915_fpc_emit.c
+    i915_fpc_translate.c
+    i915_prim_emit.c
+    i915_prim_vbuf.c
+    i915_screen.c
+    i915_state.c
+    i915_state_derived.c
+    i915_state_dynamic.c
+    i915_state_emit.c
+    i915_state_immediate.c
+    i915_state_sampler.c
+    i915_surface.c
+    i915_texture.c
+;

Added: haiku/branches/components/gallium3d/src/kits/opengl/gallium/drivers/softpipe/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/kits/opengl/gallium/drivers/softpipe/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/kits/opengl/gallium/drivers/softpipe/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -0,0 +1,56 @@
+SubDir HAIKU_TOP src kits opengl gallium drivers softpipe ;
+
+local defines ;
+defines = BEOS_THREADS GNU_ASSEMBLER ;
+
+if $(TARGET_ARCH) = x86 {
+	defines += USE_X86_ASM USE_MMX_ASM USE_3DNOW_ASM USE_SSE_ASM ; 
+} else {
+	# Not yet supported, as current Mesa3D PPC assembly is Linux-dependent!
+	# defines += USE_PPC_ASM ;
+}
+
+SubDirC++Flags [ FDefines $(defines) ] ;
+
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium include ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium auxiliary ] ;
+
+StaticLibrary libsoftpipe.a :
+	sp_clear.c
+	sp_context.c
+	sp_draw_arrays.c
+	sp_flush.c
+	sp_fs_exec.c
+	sp_fs_llvm.c
+	sp_fs_sse.c
+	sp_prim_setup.c
+	sp_prim_vbuf.c
+	sp_quad_alpha_test.c
+	sp_quad_blend.c
+#	sp_quad_bufloop.c
+	sp_quad_colormask.c
+	sp_quad_coverage.c
+	sp_quad_depth_test.c
+	sp_quad_earlyz.c
+	sp_quad_fs.c
+	sp_quad_occlusion.c
+	sp_quad_output.c
+	sp_quad_pipe.c
+	sp_quad_stencil.c
+	sp_quad_stipple.c
+	sp_query.c
+	sp_screen.c
+	sp_setup.c
+	sp_state_blend.c
+	sp_state_clip.c
+	sp_state_derived.c
+	sp_state_fs.c
+	sp_state_rasterizer.c
+	sp_state_sampler.c
+	sp_state_surface.c
+	sp_state_vertex.c
+	sp_surface.c
+	sp_tex_sample.c
+	sp_texture.c
+	sp_tile_cache.c
+;

Added: haiku/branches/components/gallium3d/src/kits/opengl/gallium/state_trackers/dri/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/kits/opengl/gallium/state_trackers/dri/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/kits/opengl/gallium/state_trackers/dri/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -0,0 +1,25 @@
+SubDir HAIKU_TOP src kits opengl gallium state_trackers dri ;
+
+UseHeaders [ FDirName $(HAIKU_TOP) headers compatibility bsd ] : true ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium auxiliary ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium include ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl gallium state_trackers dri ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa drivers dri common ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src libs drm ] : true ;
+
+UsePrivateHeaders opengl ;
+UseLibraryHeaders drm expat ;
+
+local defines;
+defines = [ FDefines IN_DRI_DRIVER ] ;
+SubDirCcFlags $(defines) ;
+SubDirC++Flags $(defines) ;
+
+StaticLibrary libdrist.a :
+    dri_context.c
+    dri_drawable.c
+    dri_extensions.c
+    dri_screen.c
+    dri_util.c
+;

Modified: haiku/branches/components/gallium3d/src/kits/opengl/glu/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/kits/opengl/glu/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/kits/opengl/glu/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -21,7 +21,7 @@
 SEARCH_SOURCE += [ FDirName $(SUBDIR) libnurbs internals ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) libnurbs nurbtess ] ;
 
-MergeObject &lt;opengl&gt;sgi-glu.o :
+MergeObject &lt;libGL&gt;sgi-glu.o :
 
 	# libutil
 	error.c 

Modified: haiku/branches/components/gallium3d/src/kits/opengl/glut/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/kits/opengl/glut/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/kits/opengl/glut/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -7,7 +7,7 @@
 		# We need our public GL headers also when not compiling for Haiku.
 }
 
-MergeObject &lt;opengl&gt;glut.o :
+MergeObject &lt;libGL&gt;glut.o :
 	# C++ sources
 	glutBlocker.cpp 
 	glutInit.cpp 

Modified: haiku/branches/components/gallium3d/src/kits/opengl/mesa/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/kits/opengl/mesa/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/kits/opengl/mesa/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -1,22 +1,14 @@
 SubDir HAIKU_TOP src kits opengl mesa ;
 
-SetSubDirSupportedPlatformsBeOSCompatible ;
-
-if $(TARGET_PLATFORM) != haiku {
-	UseHeaders [ FDirName $(HAIKU_TOP) headers os opengl ] : true ;
-		# We need our not platform one, public GL headers also when not compiling for Haiku.
-}
-
 # Don't compile libmesa.a with debugging.
 DEBUG = 0 ;
 
 UsePrivateHeaders opengl ;
 
+UseHeaders [ FDirName $(SUBDIR) $(DOTDOT) gallium auxiliary ] ;
+UseHeaders [ FDirName $(SUBDIR) $(DOTDOT) gallium include ] ;
 UseHeaders [ FDirName $(SUBDIR) main ] ;
 UseHeaders [ FDirName $(SUBDIR) glapi ] ;
-UseHeaders [ FDirName $(SUBDIR) gallium auxiliary ] ;
-UseHeaders [ FDirName $(SUBDIR) gallium include ] ;
-UseHeaders [ FDirName $(SUBDIR) gallium state_trackers dri ] ;
 UseHeaders [ FDirName $(SUBDIR) math ] ;
 UseHeaders [ FDirName $(SUBDIR) tnl ] ;
 UseHeaders [ FDirName $(SUBDIR) shader ] ;
@@ -41,16 +33,6 @@
 SEARCH_SOURCE += [ FDirName $(SUBDIR) tnl ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) vbo ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) vf ] ;
-SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary cso_cache ] ;
-SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary draw ] ;
-SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary gallivm ] ;
-SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary indices ] ;
-SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary pipebuffer ] ;
-SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary rtasm ] ;
-SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary sct ] ;
-SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary tgsi ] ;
-SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary translate ] ;
-SEARCH_SOURCE += [ FDirName $(SUBDIR) gallium auxiliary util ] ;
 SEARCH_SOURCE += [ FDirName $(SUBDIR) $(TARGET_ARCH) ] ;
 
 UsePublicObjectHeaders gen_matypes : opengl ;
@@ -99,8 +81,6 @@
 		common_x86.c
 		common_x86_asm.S
 
-		glapi_x86.S
-
 		x86_xform.c
 		x86_xform2.S
 		x86_xform3.S
@@ -153,7 +133,7 @@
 }
 
 
-StaticLibrary libmesa.a : 
+StaticLibrary libmesa.a :
 
 	# main
 	api_arrayelt.c
@@ -362,156 +342,6 @@
 	slang_vartable.c
 	slang_utility.c
 
-	# glapi
-	glapi.c
-	glapi_getproc.c
-	glthread.c
-
-	# gallium/auxiliary/cso_cache
-	cso_cache.c
-	cso_context.c
-	cso_hash.c
-
-	# gallium/auxiliary/draw
-	draw_context.c
-	draw_pipe.c
-	draw_pipe_aaline.c
-	draw_pipe_aapoint.c
-	draw_pipe_clip.c
-	draw_pipe_cull.c
-	draw_pipe_flatshade.c
-	draw_pipe_offset.c
-	draw_pipe_pstipple.c
-	draw_pipe_stipple.c
-	draw_pipe_twoside.c
-	draw_pipe_unfilled.c
-	draw_pipe_util.c
-	draw_pipe_validate.c
-	draw_pipe_vbuf.c
-	draw_pipe_wide_line.c
-	draw_pipe_wide_point.c
-	draw_pt.c
-	draw_pt_elts.c
-	draw_pt_emit.c
-	draw_pt_fetch.c
-	draw_pt_fetch_emit.c
-	draw_pt_fetch_shade_emit.c
-	draw_pt_fetch_shade_pipeline.c
-	draw_pt_post_vs.c
-	draw_pt_util.c
-	draw_pt_varray.c
-	draw_pt_vcache.c
-	draw_vertex.c
-	draw_vs.c
-	draw_vs_aos.c
-	draw_vs_aos_io.c
-	draw_vs_aos_machine.c
-	draw_vs_exec.c
-	draw_vs_llvm.c
-	draw_vs_ppc.c
-	draw_vs_sse.c
-	draw_vs_varient.c
-
-	# gallium/auxiliary/gallivm
-#	gallivm.cpp
-#	gallivm_builtins.cpp
-#	gallivm_cpu.cpp
-#	instructions.cpp
-#	instructionssoa.cpp
-#	llvm_builtins.c
-#	loweringpass.cpp
-#	soabuiltins.c
-#	storage.cpp
-#	storagesoa.cpp
-#	tgsitollvm.cpp
-
-	# gallium/auxiliary/indices
-#	u_indices.c
-#	u_indices_gen.c
-#	u_unfilled_gen.c
-#	u_unfilled_indices.c
-
-	# gallium/auxiliary/pipebuffer
-	pb_buffer_fenced.c
-	pb_buffer_malloc.c
-	pb_bufmgr_alt.c
-	pb_bufmgr_cache.c
-	pb_bufmgr_debug.c
-	pb_bufmgr_fenced.c
-	pb_bufmgr_mm.c
-	pb_bufmgr_ondemand.c
-	pb_bufmgr_pool.c
-	pb_bufmgr_slab.c
-	pb_validate.c
-
-	# gallium/auxiliary/rtasm
-	rtasm_cpu.c
-	rtasm_execmem.c
-#	rtasm_ppc.c
-#	rtasm_ppc_spe.c
-	rtasm_x86sse.c
-
-	# gallium/auxiliary/sct
-	sct.c
-	usage.c
-
-	# gallium/auxiliary/tgsi
-	tgsi_build.c
-	tgsi_dump.c
-	tgsi_dump_c.c
-	tgsi_exec.c
-	tgsi_info.c
-	tgsi_iterate.c
-	tgsi_parse.c
-	tgsi_ppc.c
-	tgsi_sanity.c
-	tgsi_scan.c
-	tgsi_sse2.c
-	tgsi_text.c
-	tgsi_transform.c
-	tgsi_util.c
-    tgsi_ureg.c
-
-	# gallium/auxiliary/translate
-	translate.c
-	translate_cache.c
-	translate_generic.c
-	translate_sse.c
-
-	# gallium/auxiliary/util
-	u_bitmask.c
-	u_blit.c
-	u_cache.c
-	u_cpu_detect.c
-	u_debug.c
-    u_debug_dump.c
-	u_debug_memory.c
-	u_debug_profile.c
-	u_debug_stack.c
-	u_debug_symbol.c
-	u_draw_quad.c
-    u_format.c
-	u_gen_mipmap.c
-	u_handle_table.c
-	u_hash.c
-	u_hash_table.c
-	u_keymap.c
-	u_linear.c
-	u_math.c
-	u_mm.c
-	u_network.c
-	u_rect.c
-	u_simple_screen.c
-	u_simple_shaders.c
-	u_snprintf.c
-	u_stream_stdc.c
-	u_stream_wd.c
-	u_surface.c
-	u_tile.c
-	u_time.c
-	u_timed_winsys.c
-	u_upload_mgr.c
-
 	# arch specific assembly optimization
 	$(arch_sources)
 ;
@@ -527,13 +357,13 @@
 	arch_sources = ;
 }
 
-MergeObject &lt;mesa&gt;glapi-dispatching.o :
+MergeObject &lt;libGL&gt;glapi-dispatching.o :
 
 	glapi.c
+	glapi_getproc.c
 	glthread.c
 
 	$(arch_sources)
 ;
 
 SubInclude HAIKU_TOP src kits opengl mesa drivers dri common ;
-SubInclude HAIKU_TOP src kits opengl mesa gallium state_trackers dri ;

Added: haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/Jamfile
===================================================================
--- haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/Jamfile	2009-09-12 14:36:38 UTC (rev 33097)
+++ haiku/branches/components/gallium3d/src/kits/opengl/mesa/drivers/dri/common/Jamfile	2009-09-12 15:37:38 UTC (rev 33098)
@@ -0,0 +1,23 @@
+SubDir HAIKU_TOP src kits opengl mesa drivers dri common ;
+
+UseHeaders [ FDirName $(HAIKU_TOP) headers compatibility bsd ] : true ;
+UseHeaders [ FDirName $(HAIKU_TOP) src kits opengl mesa ] ;
+UseHeaders [ FDirName $(HAIKU_TOP) src libs drm ] : true ;
+
+UsePrivateHeaders opengl ;
+UseLibraryHeaders drm expat ;
+
+local defines;
+defines = [ FDefines IN_DRI_DRIVER ] ;
+SubDirCcFlags $(defines) ;
+SubDirC++Flags $(defines) ;
+
+StaticLibrary libdricommon.a :
+#    dri_metaops.c
+#    drirenderbuffer.c
+#    dri_util.c
+#    texmem.c
+    utils.c
+#    vblank.c
+    xmlconfig.c
+;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="020589.html">[Haiku-commits] BOM (trunk/) r33069~33076 ...failed Cc	/storage/Build-o-Matic/haiku/haiku/generated.x86gcc4hybrid/objects/haiku/x86/release/bin/bash/builtins/builtins.o	...
</A></li>
	<LI>Next message: <A HREF="020592.html">[Haiku-commits] r33099 - in haiku/branches/components/gallium3d:	headers/private headers/private/drm src/add-ons/kernel	src/add-ons/kernel/drivers src/add-ons/kernel/drivers/drm	src/add-ons/kernel/drivers/drm/test src/add-ons/kernel/drm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20591">[ date ]</a>
              <a href="thread.html#20591">[ thread ]</a>
              <a href="subject.html#20591">[ subject ]</a>
              <a href="author.html#20591">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
