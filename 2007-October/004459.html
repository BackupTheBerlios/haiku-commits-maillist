<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r22701 - in	haiku/trunk/src/system/libroot/posix/glibc: arch arch/m68k	include/arch include/arch/m68k include/arch/m68k/bits
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2007-October/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r22701%20-%20in%0A%09haiku/trunk/src/system/libroot/posix/glibc%3A%20arch%20arch/m68k%0A%09include/arch%20include/arch/m68k%20include/arch/m68k/bits&In-Reply-To=%3C200710242254.l9OMsZ0C005989%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004469.html">
   <LINK REL="Next"  HREF="004460.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r22701 - in	haiku/trunk/src/system/libroot/posix/glibc: arch arch/m68k	include/arch include/arch/m68k include/arch/m68k/bits</H1>
    <B>mmu_man at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r22701%20-%20in%0A%09haiku/trunk/src/system/libroot/posix/glibc%3A%20arch%20arch/m68k%0A%09include/arch%20include/arch/m68k%20include/arch/m68k/bits&In-Reply-To=%3C200710242254.l9OMsZ0C005989%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r22701 - in	haiku/trunk/src/system/libroot/posix/glibc: arch arch/m68k	include/arch include/arch/m68k include/arch/m68k/bits">mmu_man at mail.berlios.de
       </A><BR>
    <I>Thu Oct 25 00:54:35 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="004469.html">[Haiku-commits] r22700 - haiku/trunk/src/kits/storage
</A></li>
        <LI>Next message: <A HREF="004460.html">[Haiku-commits] r22702 - haiku/trunk/src/apps/mail
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4459">[ date ]</a>
              <a href="thread.html#4459">[ thread ]</a>
              <a href="subject.html#4459">[ subject ]</a>
              <a href="author.html#4459">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: mmu_man
Date: 2007-10-25 00:54:33 +0200 (Thu, 25 Oct 2007)
New Revision: 22701
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=22701&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=22701&amp;view=rev</A>

Added:
   haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/
   haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/Jamfile
   haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/feholdexcpt.c
   haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fesetenv.c
   haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fesetround.c
   haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fraiseexcpt.c
   haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/ftestexcept.c
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/asm-syntax.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/byteswap.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/endian.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/fenv.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/fenvinline.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/huge_val.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/mathdef.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/mathinline.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/nan.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/wordsize.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/config.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/math_ldbl.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/stackinfo.h
   haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/sysdep.h
Log:
Start of math support from glibc.


Added: haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/Jamfile
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/Jamfile	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/Jamfile	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,148 @@
+SubDir HAIKU_TOP src system libroot posix glibc arch m68k ;
+
+SubDirSysHdrs $(HAIKU_TOP) src system libroot posix glibc include arch
+	$(TARGET_ARCH) ;
+SubDirSysHdrs $(HAIKU_TOP) src system libroot posix glibc include arch generic ;
+SubDirSysHdrs $(HAIKU_TOP) src system libroot posix glibc include ;
+SubDirSysHdrs $(HAIKU_TOP) src system libroot posix glibc stdlib ;
+SubDirSysHdrs $(HAIKU_TOP) src system libroot posix glibc math ;
+SubDirSysHdrs $(HAIKU_TOP) src system libroot posix glibc libio ;
+SubDirSysHdrs $(HAIKU_TOP) src system libroot posix glibc ;
+
+SubDirHdrs $(HAIKU_TOP) src system libroot posix glibc arch generic ;
+
+
+if $(OPTIM) = -O0 {
+	OPTIM = -O ;
+}
+
+# don't compile with debugging
+DEBUG = 0 ;
+
+SubDirCcFlags -D_GNU_SOURCE -D_IEEE_LIBM ;
+
+# Note: There is no *l() support yet. Our compiler says sizeof(long double) = 8,
+# while there are only 96 and 128 bit implementation in glibc.
+local genericSources =
+	branred.c
+	cmp.c dbl2mpn.c divrem.c
+	doasin.c dosincos.c
+	halfulp.c
+	mpa.c mpatan.c mpatan2.c mpexp.c mplog.c mpn2dbl.c
+	mpn2flt.c mpn2ldbl.c mpsqrt.c mptan.c
+	mul.c mul_n.c
+	sincos32.c
+	slowexp.c
+	slowpow.c
+
+	e_acos.c e_acosf.c # e_acosl.c
+	e_acosh.c e_acoshf.c # e_acoshl.c
+	e_asin.c e_asinf.c # e_asinl.c
+	e_atan2.c e_atan2f.c # e_atan2l.c
+	e_atanh.c e_atanhf.c # e_atanhl.c
+	e_cosh.c e_coshf.c # e_coshl.c
+	e_exp.c e_expf.c
+	e_fmod.c e_fmodf.c # e_fmodl.c
+	e_gamma_r.c e_gammaf_r.c
+	e_hypot.c e_hypotf.c # e_hypotl.c
+	e_j0.c e_j0f.c
+	e_j1.c e_j1f.c
+	e_jn.c e_jnf.c
+	e_lgamma_r.c e_lgammaf_r.c
+	e_log.c e_logf.c
+	e_log10.c e_log10f.c
+	e_pow.c e_powf.c # e_powl.c
+	e_rem_pio2f.c
+	e_remainder.c e_remainderf.c # e_remainderl.c
+	e_scalb.c e_scalbf.c # e_scalbl.c
+	e_sinh.c e_sinhf.c # e_sinhl.c
+	k_cos.c k_cosf.c
+	k_sin.c k_sinf.c
+	k_rem_pio2.c k_rem_pio2f.c # k_rem_pio2l.c
+	k_tan.c k_tanf.c
+	s_asinh.c s_asinhf.c # s_asinhl.c
+	s_atan.c s_atanf.c # s_atanl.c
+	s_cbrt.c s_cbrtf.c # s_cbrtl.c
+	s_ceil.c s_ceilf.c # s_ceill.c
+	s_cos.c s_cosf.c
+	s_erf.c s_erff.c # s_erfl.c
+	s_expm1f.c s_expm1.c
+	s_finite.c s_finitef.c # s_finitel.c
+	s_floor.c s_floorf.c # s_floorl.c
+	s_fpclassify.c s_fpclassifyf.c # s_fpclassifyl.c
+	s_frexp.c s_frexpf.c # s_frexpl.c
+	s_ilogb.c s_ilogbf.c
+	s_isinf.c s_isinff.c # s_isinfl.c
+	s_ldexp.c s_ldexpf.c # s_ldexpl.c
+	s_log1p.c s_log1pf.c
+	s_logb.c s_logbf.c # s_logbl.c
+	s_lround.c s_lroundf.c
+	s_modf.c s_modff.c # s_modfl.c
+	s_nan.c s_nanf.c # s_nanl.c
+	s_round.c s_roundf.c # s_roundl.c
+	s_scalbn.c s_scalbnf.c # s_scalbnl.c
+	s_signbit.c s_signbitf.c # s_signbitl.c
+	s_significand.c s_significandf.c
+	s_signgam.c
+	s_sin.c s_sinf.c # s_sinl.c
+	s_sincos.c s_sincosf.c
+	s_tan.c s_tanf.c
+	s_tanh.c s_tanhf.c
+	s_trunc.c s_truncf.c
+	t_exp.c
+	w_acos.c w_acosf.c # w_acosl.c
+	w_acosh.c w_acoshf.c # w_acoshl.c
+	w_atan2.c w_atan2f.c # w_atan2l.c
+	w_asin.c w_asinf.c # w_asinl.c
+	w_atanh.c w_atanhf.c # w_atanhl.c
+	w_cosh.c w_coshf.c # w_coshl.c
+	w_drem.c w_dremf.c # w_dreml.c
+	w_exp.c w_expf.c # w_expl.c
+	w_fmod.c w_fmodf.c # w_fmodl.c
+	w_hypot.c w_hypotf.c # w_hypotl.c
+	w_j0.c w_j0f.c
+	w_j1.c w_j1f.c
+	w_jn.c w_jnf.c
+	w_lgamma.c w_lgammaf.c
+	w_lgamma_r.c w_lgammaf_r.c 
+	w_log.c w_logf.c # w_logl.c
+	w_log10.c w_log10f.c # w_log10l.c
+	w_pow.c w_powf.c # w_powl.c
+	w_remainder.c w_remainderf.c # w_remainderl.c
+	w_scalb.c w_scalbf.c # w_scalbl.c
+	w_sinh.c w_sinhf.c # w_sinhl.c
+;
+
+MergeObject posix_gnu_arch_$(TARGET_ARCH)_generic.o :
+	$(genericSources)
+;
+
+MergeObject posix_gnu_arch_$(TARGET_ARCH)_other.o :
+
+#	add_n.S
+#	addmul_1.S
+	feholdexcpt.c fraiseexcpt.c fesetenv.c fesetround.c ftestexcept.c
+#	ldbl2mpn.c
+#	lshift.S rshift.S
+#	mul_1.S
+#	strlen.S
+#	sub_n.S
+#	submul_1.S
+#
+#	e_sqrt.c e_sqrtf.c # e_sqrtl.c
+#	s_copysign.S s_copysignf.S # s_copysignl.S
+#	s_fdim.c s_fdimf.c # s_fdiml.S
+#	s_fabs.S s_fabsf.S # s_fabsl.S
+#	s_isnan.c s_isnanf.S
+#	s_rint.c s_rintf.c # s_rintl.c
+#	t_sqrt.c
+#	w_sqrt.c w_sqrtf.c # w_sqrtl.c
+;
+	
+MergeObjectFromObjects posix_gnu_arch_$(TARGET_ARCH).o : :
+	posix_gnu_arch_$(TARGET_ARCH)_generic.o
+	posix_gnu_arch_$(TARGET_ARCH)_other.o
+;
+
+SEARCH on [ FGristFiles $(genericSources) ]
+	= [ FDirName $(HAIKU_TOP) src system libroot posix glibc arch generic ] ;

Added: haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/feholdexcpt.c
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/feholdexcpt.c	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/feholdexcpt.c	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,39 @@
+/* Store current floating-point environment and clear exceptions.
+   Copyright (C) 1997, 1999 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+   Contributed by Andreas Schwab &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">schwab at issan.informatik.uni-dortmund.de</A>&gt;
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#include &lt;fenv.h&gt;
+
+int
+feholdexcept (fenv_t *envp)
+{
+  fexcept_t fpcr, fpsr;
+
+  /* Store the environment.  */
+  __asm__ (&quot;fmovem%.l %/fpcr/%/fpsr/%/fpiar,%0&quot; : &quot;=m&quot; (*envp));
+
+  /* Now clear all exceptions.  */
+  fpsr = envp-&gt;__status_register &amp; ~FE_ALL_EXCEPT;
+  __asm__ __volatile__ (&quot;fmove%.l %0,%/fpsr&quot; : : &quot;dm&quot; (fpsr));
+  /* And set all exceptions to non-stop.  */
+  fpcr = envp-&gt;__control_register &amp; ~(FE_ALL_EXCEPT &lt;&lt; 6);
+  __asm__ __volatile__ (&quot;fmove%.l %0,%!&quot; : : &quot;dm&quot; (fpcr));
+
+  return 0;
+}

Added: haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fesetenv.c
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fesetenv.c	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fesetenv.c	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,59 @@
+/* Install given floating-point environment.
+   Copyright (C) 1997,99,2000,01 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+   Contributed by Andreas Schwab &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">schwab at issan.informatik.uni-dortmund.de</A>&gt;
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#include &lt;fenv.h&gt;
+
+int
+__fesetenv (const fenv_t *envp)
+{
+  fenv_t temp;
+
+  /* Install the environment specified by ENVP.  But there are a few
+     values which we do not want to come from the saved environment.
+     Therefore, we get the current environment and replace the values
+     we want to use from the environment specified by the parameter.  */
+  __asm__ (&quot;fmovem%.l %/fpcr/%/fpsr/%/fpiar,%0&quot; : &quot;=m&quot; (*&amp;temp));
+
+  temp.__status_register &amp;= ~FE_ALL_EXCEPT;
+  temp.__control_register &amp;= ~((FE_ALL_EXCEPT &lt;&lt; 6) | FE_UPWARD);
+  if (envp == FE_DFL_ENV)
+    ;
+  else if (envp == FE_NOMASK_ENV)
+    temp.__control_register |= FE_ALL_EXCEPT &lt;&lt; 6;
+  else
+    {
+      temp.__control_register |= (envp-&gt;__control_register
+				  &amp; ((FE_ALL_EXCEPT &lt;&lt; 6) | FE_UPWARD));
+      temp.__status_register |= envp-&gt;__status_register &amp; FE_ALL_EXCEPT;
+    }
+
+  __asm__ __volatile__ (&quot;fmovem%.l %0,%/fpcr/%/fpsr/%/fpiar&quot; : : &quot;m&quot; (*&amp;temp));
+
+  /* Success.  */
+  return 0;
+}
+
+#include &lt;shlib-compat.h&gt;
+#if SHLIB_COMPAT (libm, GLIBC_2_1, GLIBC_2_2)
+strong_alias (__fesetenv, __old_fesetenv)
+compat_symbol (libm, __old_fesetenv, fesetenv, GLIBC_2_1);
+#endif
+
+versioned_symbol (libm, __fesetenv, fesetenv, GLIBC_2_2);

Added: haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fesetround.c
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fesetround.c	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fesetround.c	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,38 @@
+/* Set current rounding direction.
+   Copyright (C) 1997 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+   Contributed by Andreas Schwab &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">schwab at issan.informatik.uni-dortmund.de</A>&gt;
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#include &lt;fenv.h&gt;
+
+int
+fesetround (int round)
+{
+  fexcept_t fpcr;
+
+  if (round &amp; ~FE_UPWARD)
+    /* ROUND is no valid rounding mode.  */
+    return 1;
+
+  __asm__ (&quot;fmove%.l %!,%0&quot; : &quot;=dm&quot; (fpcr));
+  fpcr &amp;= ~FE_UPWARD;
+  fpcr |= round;
+  __asm__ __volatile__ (&quot;fmove%.l %0,%!&quot; : : &quot;dm&quot; (fpcr));
+
+  return 0;
+}

Added: haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fraiseexcpt.c
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fraiseexcpt.c	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/fraiseexcpt.c	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,82 @@
+/* Raise given exceptions.
+   Copyright (C) 1997,99,2000,01 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+   Contributed by Andreas Schwab &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">schwab at issan.informatik.uni-dortmund.de</A>&gt;
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#include &lt;fenv.h&gt;
+#include &lt;float.h&gt;
+#include &lt;math.h&gt;
+
+int
+__feraiseexcept (int excepts)
+{
+  /* Raise exceptions represented by EXCEPTS.  But we must raise only one
+     signal at a time.  It is important that if the overflow/underflow
+     exception and the divide by zero exception are given at the same
+     time, the overflow/underflow exception follows the divide by zero
+     exception.  */
+
+  /* First: invalid exception.  */
+  if (excepts &amp; FE_INVALID)
+    {
+      /* One example of a invalid operation is 0 * Infinity.  */
+      double d = HUGE_VAL;
+      __asm__ __volatile__ (&quot;fmul%.s %#0r0,%0; fnop&quot; : &quot;=f&quot; (d) : &quot;0&quot; (d));
+    }
+
+  /* Next: division by zero.  */
+  if (excepts &amp; FE_DIVBYZERO)
+    {
+      double d = 1.0;
+      __asm__ __volatile__ (&quot;fdiv%.s %#0r0,%0; fnop&quot; : &quot;=f&quot; (d) : &quot;0&quot; (d));
+    }
+
+  /* Next: overflow.  */
+  if (excepts &amp; FE_OVERFLOW)
+    {
+      long double d = LDBL_MAX;
+
+      __asm__ __volatile__ (&quot;fmul%.x %0,%0; fnop&quot; : &quot;=f&quot; (d) : &quot;0&quot; (d));
+    }
+
+  /* Next: underflow.  */
+  if (excepts &amp; FE_UNDERFLOW)
+    {
+      long double d = -LDBL_MAX;
+
+      __asm__ __volatile__ (&quot;fetox%.x %0; fnop&quot; : &quot;=f&quot; (d) : &quot;0&quot; (d));
+    }
+
+  /* Last: inexact.  */
+  if (excepts &amp; FE_INEXACT)
+    {
+      long double d = 1.0;
+      __asm__ __volatile__ (&quot;fdiv%.s %#0r3,%0; fnop&quot; : &quot;=f&quot; (d) : &quot;0&quot; (d));
+    }
+
+  /* Success.  */
+  return 0;
+}
+
+#include &lt;shlib-compat.h&gt;
+#if SHLIB_COMPAT (libm, GLIBC_2_1, GLIBC_2_2)
+strong_alias (__feraiseexcept, __old_feraiseexcept)
+compat_symbol (libm, __old_feraiseexcept, feraiseexcept, GLIBC_2_1);
+#endif
+
+versioned_symbol (libm, __feraiseexcept, feraiseexcept, GLIBC_2_2);

Added: haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/ftestexcept.c
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/ftestexcept.c	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/arch/m68k/ftestexcept.c	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,32 @@
+/* Test exception in current environment.
+   Copyright (C) 1997 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+   Contributed by Andreas Schwab &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">schwab at issan.informatik.uni-dortmund.de</A>&gt;
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#include &lt;fenv.h&gt;
+
+int
+fetestexcept (int excepts)
+{
+  fexcept_t fpsr;
+
+  /* Get current exceptions.  */
+  __asm__ (&quot;fmove%.l %/fpsr,%0&quot; : &quot;=dm&quot; (fpsr));
+
+  return fpsr &amp; excepts &amp; FE_ALL_EXCEPT;
+}

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/asm-syntax.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/asm-syntax.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/asm-syntax.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,109 @@
+/* Definitions for 68k syntax variations.
+   Copyright (C) 1992, 1994, 1996, 1997 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.  Its master source is NOT part of
+   the C library, however.  The master source lives in the GNU MP Library.
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#ifdef HAVE_ELF
+
+/* ELF uses byte-counts for .align, most others use log2 of count of bytes.  */
+#define ALIGNARG(log2) 1&lt;&lt;log2
+/* For ELF we need the `.type' directive to make shared libs work right.  */
+#define PROLOG(name) .type <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">name, at function</A>
+#define EPILOG(name) .size name,.-name
+/* For ELF we need to prefix register names and local labels.  */
+#ifdef __STDC__
+#define R_(r) %##r
+#define R(r) R_(r)
+#define L(label) .##label
+#else
+#define R(r) %/**/r
+#define L(label) ./**/label
+#endif
+
+#else
+
+#define ALIGNARG(log2) log2
+#define PROLOG(name) /* Nothing.  */
+#define EPILOG(name) /* Nothing.  */
+#define R(r) r
+#define L(label) label
+
+#endif
+
+#ifdef MIT_SYNTAX
+#define MEM(base)R(base)@
+#define MEM_DISP(base,displacement)R(base)@(displacement)
+#define MEM_INDX(base,idx,size_suffix)R(base)@(R(idx):size_suffix)
+#define MEM_INDX1(base,idx,size_suffix,scale)R(base)@(R(idx):size_suffix:scale)
+#define MEM_PREDEC(memory_base)R(memory_base)@-
+#define MEM_POSTINC(memory_base)R(memory_base)@+
+#define TEXT .text
+#define ALIGN .even
+#define GLOBL .globl
+/* Use variable sized opcodes.  */
+#define bcc jcc
+#define bcs jcs
+#define bls jls
+#define beq jeq
+#define bne jne
+#define bra jra
+#endif
+
+#ifdef MOTOROLA_SYNTAX
+#define MEM(base)(R(base))
+#define MEM_DISP(base,displacement)(displacement,R(base))
+#define MEM_PREDEC(memory_base)-(R(memory_base))
+#define MEM_POSTINC(memory_base)(R(memory_base))+
+#ifdef __STDC__
+#define MEM_INDX_(base,idx,size_suffix)(R(base),R(idx##.##size_suffix))
+#define MEM_INDX(base,idx,size_suffix)MEM_INDX_(base,idx,size_suffix)
+#define MEM_INDX1_(base,idx,size_suffix,scale)(R(base),R(idx##.##size_suffix*scale))
+#define MEM_INDX1(base,idx,size_suffix,scale)MEM_INDX1_(base,idx,size_suffix,scale)
+#else
+#define MEM_INDX(base,idx,size_suffix)(R(base),R(idx).size_suffix)
+#define MEM_INDX1(base,idx,size_suffix,scale)(R(base),R(idx).size_suffix*scale)
+#endif
+#define TEXT .text
+#define ALIGN .align ALIGNARG(2)
+#define GLOBL .globl
+#define bcc jbcc
+#define bcs jbcs
+#define bls jbls
+#define beq jbeq
+#define bne jbne
+#define bra jbra
+#define movel move.l
+#define moveml movem.l
+#define moveql moveq.l
+#define cmpl cmp.l
+#define orl or.l
+#define clrl clr.l
+#define eorw eor.w
+#define lsrl lsr.l
+#define lsll lsl.l
+#define roxrl roxr.l
+#define roxll roxl.l
+#define addl add.l
+#define addxl addx.l
+#define addql addq.l
+#define subl sub.l
+#define subxl subx.l
+#define subql subq.l
+#define negl neg.l
+#define mulul mulu.l
+#endif

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/byteswap.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/byteswap.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/byteswap.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,67 @@
+/* Macros to swap the order of bytes in integer values.  m68k version.
+   Copyright (C) 1997, 2002 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#if !defined _BYTESWAP_H &amp;&amp; !defined _NETINET_IN_H
+# error &quot;Never use &lt;bits/byteswap.h&gt; directly; include &lt;byteswap.h&gt; instead.&quot;
+#endif
+
+#ifndef _BITS_BYTESWAP_H
+#define _BITS_BYTESWAP_H 1
+
+/* Swap bytes in 16 bit value.  We don't provide an assembler version
+   because GCC is smart enough to generate optimal assembler output, and
+   this allows for better cse.  */
+#define __bswap_16(x) \
+  ((((x) &gt;&gt; 8) &amp; 0xff) | (((x) &amp; 0xff) &lt;&lt; 8))
+
+/* Swap bytes in 32 bit value.  */
+#define __bswap_constant_32(x) \
+  ((((x) &amp; 0xff000000) &gt;&gt; 24) | (((x) &amp; 0x00ff0000) &gt;&gt;  8) | \
+   (((x) &amp; 0x0000ff00) &lt;&lt;  8) | (((x) &amp; 0x000000ff) &lt;&lt; 24))
+
+#if defined __GNUC__ &amp;&amp; __GNUC__ &gt;= 2
+# define __bswap_32(x) \
+  __extension__							\
+  ({ unsigned int __bswap_32_v;					\
+     if (__builtin_constant_p (x))				\
+       __bswap_32_v = __bswap_constant_32 (x);			\
+     else							\
+       __asm__ __volatile__ (&quot;ror%.w %#8, %0;&quot;			\
+			     &quot;swap %0;&quot;				\
+			     &quot;ror%.w %#8, %0&quot;			\
+			     : &quot;=d&quot; (__bswap_32_v)		\
+			     : &quot;0&quot; ((unsigned int) (x)));	\
+     __bswap_32_v; })
+#else
+# define __bswap_32(x) __bswap_constant_32 (x)
+#endif
+
+#if defined __GNUC__ &amp;&amp; __GNUC__ &gt;= 2
+/* Swap bytes in 64 bit value.  */
+# define __bswap_64(x) \
+  __extension__								\
+  ({ union { unsigned long long int __ll;				\
+	     unsigned long int __l[2]; } __bswap_64_v, __bswap_64_r;	\
+     __bswap_64_v.__ll = (x);						\
+     __bswap_64_r.__l[0] = __bswap_32 (__bswap_64_v.__l[1]);		\
+     __bswap_64_r.__l[1] = __bswap_32 (__bswap_64_v.__l[0]);		\
+     __bswap_64_r.__ll; })
+#endif
+
+#endif /* _BITS_BYTESWAP_H */

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/endian.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/endian.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/endian.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,7 @@
+/* m68k is big-endian.  */
+
+#ifndef _ENDIAN_H
+# error &quot;Never use &lt;bits/endian.h&gt; directly; include &lt;endian.h&gt; instead.&quot;
+#endif
+
+#define __BYTE_ORDER __BIG_ENDIAN

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/fenv.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/fenv.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/fenv.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,79 @@
+/* Copyright (C) 1997, 1998, 1999, 2000 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#ifndef _FENV_H
+# error &quot;Never use &lt;bits/fenv.h&gt; directly; include &lt;fenv.h&gt; instead.&quot;
+#endif
+
+
+/* Define bits representing the exception.  We use the bit positions of
+   the appropriate bits in the FPSR Accrued Exception Byte.  */
+enum
+  {
+    FE_INEXACT = 1 &lt;&lt; 3,
+#define FE_INEXACT	FE_INEXACT
+    FE_DIVBYZERO = 1 &lt;&lt; 4,
+#define FE_DIVBYZERO	FE_DIVBYZERO
+    FE_UNDERFLOW = 1 &lt;&lt; 5,
+#define FE_UNDERFLOW	FE_UNDERFLOW
+    FE_OVERFLOW = 1 &lt;&lt; 6,
+#define FE_OVERFLOW	FE_OVERFLOW
+    FE_INVALID = 1 &lt;&lt; 7
+#define FE_INVALID	FE_INVALID
+  };
+
+#define FE_ALL_EXCEPT \
+	(FE_INEXACT | FE_DIVBYZERO | FE_UNDERFLOW | FE_OVERFLOW | FE_INVALID)
+
+/* The m68k FPU supports all of the four defined rounding modes.  We use
+   the bit positions in the FPCR Mode Control Byte as the values for the
+   appropriate macros.  */
+enum
+  {
+    FE_TONEAREST = 0,
+#define FE_TONEAREST	FE_TONEAREST
+    FE_TOWARDZERO = 1 &lt;&lt; 4,
+#define FE_TOWARDZERO	FE_TOWARDZERO
+    FE_DOWNWARD = 2 &lt;&lt; 4,
+#define FE_DOWNWARD	FE_DOWNWARD
+    FE_UPWARD = 3 &lt;&lt; 4
+#define FE_UPWARD	FE_UPWARD
+  };
+
+
+/* Type representing exception flags.  */
+typedef unsigned int fexcept_t;
+
+
+/* Type representing floating-point environment.  This structure
+   corresponds to the layout of the block written by `fmovem'.  */
+typedef struct
+  {
+    unsigned int __control_register;
+    unsigned int __status_register;
+    unsigned int __instruction_address;
+  }
+fenv_t;
+
+/* If the default argument is used we use this value.  */
+#define FE_DFL_ENV	((__const fenv_t *) -1)
+
+#ifdef __USE_GNU
+/* Floating-point environment where none of the exceptions are masked.  */
+# define FE_NOMASK_ENV	((__const fenv_t *) -2)
+#endif

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/fenvinline.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/fenvinline.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/fenvinline.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,8 @@
+/* This file provides inline versions of floating-pint environment
+   handling functions.  If there were any.  */
+
+#ifndef __NO_MATH_INLINES
+
+/* Here is where the code would go.  */
+
+#endif

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/huge_val.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/huge_val.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/huge_val.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,92 @@
+/* `HUGE_VAL' constants for m68k (where it is infinity).
+   Used by &lt;stdlib.h&gt; and &lt;math.h&gt; functions for overflow.
+   Copyright (C) 1992, 1995, 1996, 1997, 1999, 2000 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#ifndef _MATH_H
+# error &quot;Never use &lt;bits/huge_val.h&gt; directly; include &lt;math.h&gt; instead.&quot;
+#endif
+
+
+#include &lt;features.h&gt;
+#include &lt;sys/cdefs.h&gt;
+
+/* IEEE positive infinity (-HUGE_VAL is negative infinity).  */
+
+#ifdef	__GNUC__
+
+# if __GNUC_PREREQ(2,96)
+
+#  define HUGE_VAL (__extension__ 0x1.0p2047)
+
+# else
+
+#  define HUGE_VAL					\
+  (__extension__					\
+   ((union { unsigned long long __l; double __d; })	\
+    { __l: 0x7ff0000000000000ULL }).__d)
+
+# endif
+
+#else /* not GCC */
+
+static union { unsigned char __c[8]; double __d; } __huge_val =
+  { { 0x7f, 0xf0, 0, 0, 0, 0, 0, 0 } };
+# define HUGE_VAL	(__huge_val.__d)
+
+#endif	/* GCC.  */
+
+
+/* ISO C 99 extensions: (float) HUGE_VALF and (long double) HUGE_VALL.  */
+
+#ifdef __USE_ISOC99
+
+# if __GNUC_PREREQ(2,96)
+
+#  define HUGE_VALF (__extension__ 0x1.0p255f)
+#  define HUGE_VALL (__extension__ 0x1.0p32767L)
+
+# else
+
+#  ifdef __GNUC__
+
+#   define HUGE_VALF					\
+  (__extension__					\
+   ((union { unsigned long __l; float __f; })		\
+    { __l: 0x7f800000UL }).__f)
+
+#   define HUGE_VALL					\
+  (__extension__					\
+   ((union { unsigned long __l[3]; long double __ld; })	\
+    { __l: { 0x7fff0000UL, 0x80000000UL, 0UL } }).__ld)
+
+#  else /* not GCC */
+
+static union { unsigned char __c[4]; float __f; } __huge_valf =
+  { { 0x7f, 0x80, 0, 0 } };
+#   define HUGE_VALF	(__huge_valf.__f)
+
+static union { unsigned char __c[12]; long double __ld; } __huge_vall =
+  { { 0x7f, 0xff, 0, 0, 0x80, 0, 0, 0, 0, 0, 0, 0 } };
+#   define HUGE_VALL	(__huge_vall.__ld)
+
+#  endif /* GCC.  */
+
+# endif /* GCC 2.95.  */
+
+#endif	/* __USE_ISOC99.  */

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/mathdef.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/mathdef.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/mathdef.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,41 @@
+/* Copyright (C) 1997, 1998, 1999, 2000 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#if !defined _MATH_H &amp;&amp; !defined _COMPLEX_H
+# error &quot;Never use &lt;bits/mathdef.h&gt; directly; include &lt;math.h&gt; instead&quot;
+#endif
+
+#if defined __USE_ISOC99 &amp;&amp; defined _MATH_H &amp;&amp; !defined _MATH_H_MATHDEF
+# define _MATH_H_MATHDEF	1
+
+/* The m68k FPUs evaluate all values in the 96 bit floating-point format
+   which is also available for the user as `long double'.  Therefore we
+   define: */
+typedef long double float_t;	/* `float' expressions are evaluated as
+				   `long double'.  */
+typedef long double double_t;	/* `double' expressions are evaluated as
+				   `long double'.  */
+
+/* Define `INFINITY' as value of type `float'.  */
+# define INFINITY	HUGE_VALF
+
+/* The values returned by `ilogb' for 0 and NaN respectively.  */
+# define FP_ILOGB0	(-2147483647 - 1)
+# define FP_ILOGBNAN	(2147483647)
+
+#endif	/* ISO C99 */

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/mathinline.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/mathinline.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/mathinline.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,3 @@
+/* We don't want any inlines when we might not have a 68881.  */
+/* mmu_man: should have them but it gets loads of warnings currently... sort it out */
+#warning M68K: replace with glibc-2.2.5/sysdeps/m68k/fpu/bits/mathinline.h someday!

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/nan.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/nan.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/nan.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,48 @@
+/* `NAN' constant for IEEE 754 machines.
+   Copyright (C) 1992, 1996, 1997, 1999 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#ifndef _MATH_H
+# error &quot;Never use &lt;bits/nan.h&gt; directly; include &lt;math.h&gt; instead.&quot;
+#endif
+
+
+/* IEEE Not A Number.  */
+
+#ifdef	__GNUC__
+
+# define NAN \
+  (__extension__                                                            \
+   ((union { unsigned __l __attribute__((__mode__(__SI__))); float __d; })  \
+    { __l: 0x7fc00000UL }).__d)
+
+#else
+
+# include &lt;endian.h&gt;
+
+# if __BYTE_ORDER == __BIG_ENDIAN
+#  define __nan_bytes		{ 0x7f, 0xc0, 0, 0 }
+# endif
+# if __BYTE_ORDER == __LITTLE_ENDIAN
+#  define __nan_bytes		{ 0, 0, 0xc0, 0x7f }
+# endif
+
+static union { unsigned char __c[4]; float __d; } __nan_union = { __nan_bytes };
+# define NAN	(__nan_union.__d)
+
+#endif	/* GCC.  */

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/wordsize.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/wordsize.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/bits/wordsize.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,19 @@
+/* Copyright (C) 1999 Free Software Foundation, Inc.
+   This file is part of the GNU C Library.
+
+   The GNU C Library is free software; you can redistribute it and/or
+   modify it under the terms of the GNU Lesser General Public
+   License as published by the Free Software Foundation; either
+   version 2.1 of the License, or (at your option) any later version.
+
+   The GNU C Library is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+   Lesser General Public License for more details.
+
+   You should have received a copy of the GNU Lesser General Public
+   License along with the GNU C Library; if not, write to the Free
+   Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
+   02111-1307 USA.  */
+
+#define __WORDSIZE	32

Added: haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/config.h
===================================================================
--- haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/config.h	2007-10-24 22:51:43 UTC (rev 22700)
+++ haiku/trunk/src/system/libroot/posix/glibc/include/arch/m68k/config.h	2007-10-24 22:54:33 UTC (rev 22701)
@@ -0,0 +1,250 @@
+//#if !defined __ASSEMBLER__ &amp;&amp; !defined _ISOMAC &amp;&amp; !defined __OPTIMIZE__
+//# error &quot;glibc cannot be compiled without optimization&quot;
+//#endif
+
+/* Another evil option when it comes to compiling the C library is
+   --ffast-math since it alters the ABI.  */
+#if defined __FAST_MATH__ &amp;&amp; !defined TEST_FAST_MATH
+# error &quot;glibc must not be compiled with -ffast-math&quot;
+#endif
+
+/* Define if using GNU ld, with support for weak symbols in a.out,
+   and for symbol set and warning messages extensions in a.out and ELF.
+   This implies HAVE_WEAK_SYMBOLS; set by --with-gnu-ld.  */
+#define	HAVE_GNU_LD 1
+
+/* Define if using ELF, which supports weak symbols.
+   This implies HAVE_ASM_WEAK_DIRECTIVE and NO_UNDERSCORES; set by
+   --with-elf.  */
+#define	HAVE_ELF 1
+
+/* Define if using XCOFF. Set by --with-xcoff.  */
+#undef	HAVE_XCOFF
+
+/* Define if C symbols are asm symbols.  Don't define if C symbols
+   have a `_' prepended to make the asm symbol.  */
+#define	NO_UNDERSCORES 1
+
+/* Define if weak symbols are available via the `.weak' directive.  */

[... truncated: 369 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004469.html">[Haiku-commits] r22700 - haiku/trunk/src/kits/storage
</A></li>
	<LI>Next message: <A HREF="004460.html">[Haiku-commits] r22702 - haiku/trunk/src/apps/mail
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4459">[ date ]</a>
              <a href="thread.html#4459">[ thread ]</a>
              <a href="subject.html#4459">[ subject ]</a>
              <a href="author.html#4459">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
