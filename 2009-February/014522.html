<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r29309 - haiku/trunk/src/servers/app
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2009-February/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r29309%20-%20haiku/trunk/src/servers/app&In-Reply-To=%3C200902241050.n1OAoncL018578%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014521.html">
   <LINK REL="Next"  HREF="014524.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r29309 - haiku/trunk/src/servers/app</H1>
    <B>stippi at mail.berlios.de</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r29309%20-%20haiku/trunk/src/servers/app&In-Reply-To=%3C200902241050.n1OAoncL018578%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r29309 - haiku/trunk/src/servers/app">stippi at mail.berlios.de
       </A><BR>
    <I>Tue Feb 24 11:50:49 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="014521.html">[Haiku-commits] r29308 - in	haiku/trunk/src/add-ons/media/plugins/avi_reader: . libOpenDML
</A></li>
        <LI>Next message: <A HREF="014524.html">[Haiku-commits] r29310 - haiku/trunk/src/kits/tracker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14522">[ date ]</a>
              <a href="thread.html#14522">[ thread ]</a>
              <a href="subject.html#14522">[ subject ]</a>
              <a href="author.html#14522">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: stippi
Date: 2009-02-24 11:50:47 +0100 (Tue, 24 Feb 2009)
New Revision: 29309
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=29309&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=29309&amp;view=rev</A>

Modified:
   haiku/trunk/src/servers/app/View.cpp
Log:
* When painting the view background bitmap, make sure to do
  this with a reasonable drawing mode. Otherwise the current
  graphics state setup may not be what we need.
* Automatic white space cleanup. 


Modified: haiku/trunk/src/servers/app/View.cpp
===================================================================
--- haiku/trunk/src/servers/app/View.cpp	2009-02-24 08:12:27 UTC (rev 29308)
+++ haiku/trunk/src/servers/app/View.cpp	2009-02-24 10:50:47 UTC (rev 29309)
@@ -333,7 +333,7 @@
 			count += child-&gt;CountChildren(deep);
 		}
 	}
-	return count;	
+	return count;
 }
 
 
@@ -490,7 +490,7 @@
 View::SetUserClipping(const BRegion* region)
 {
 	fDrawState-&gt;SetClippingRegion(region);
-	
+
 	// rebuild clipping (for just this view)
 	RebuildClipping(false);
 }
@@ -667,7 +667,7 @@
 		fScrollingOffset.y - fFrame.top);
 }
 
-//! converts a point from local to screen coordinate system 
+//! converts a point from local to screen coordinate system
 void
 View::ConvertToScreen(BPoint* pt) const
 {
@@ -678,7 +678,7 @@
 }
 
 
-//! converts a point from local to screen coordinate system 
+//! converts a point from local to screen coordinate system
 void
 View::ConvertToScreen(IntPoint* pt) const
 {
@@ -689,7 +689,7 @@
 }
 
 
-//! converts a rect from local to screen coordinate system 
+//! converts a rect from local to screen coordinate system
 void
 View::ConvertToScreen(BRect* rect) const
 {
@@ -700,7 +700,7 @@
 }
 
 
-//! converts a rect from local to screen coordinate system 
+//! converts a rect from local to screen coordinate system
 void
 View::ConvertToScreen(IntRect* rect) const
 {
@@ -711,7 +711,7 @@
 }
 
 
-//! converts a region from local to screen coordinate system 
+//! converts a region from local to screen coordinate system
 void
 View::ConvertToScreen(BRegion* region) const
 {
@@ -722,7 +722,7 @@
 }
 
 
-//! converts a point from screen to local coordinate system 
+//! converts a point from screen to local coordinate system
 void
 View::ConvertFromScreen(BPoint* pt) const
 {
@@ -733,7 +733,7 @@
 }
 
 
-//! converts a point from screen to local coordinate system 
+//! converts a point from screen to local coordinate system
 void
 View::ConvertFromScreen(IntPoint* pt) const
 {
@@ -744,7 +744,7 @@
 }
 
 
-//! converts a rect from screen to local coordinate system 
+//! converts a rect from screen to local coordinate system
 void
 View::ConvertFromScreen(BRect* rect) const
 {
@@ -755,7 +755,7 @@
 }
 
 
-//! converts a rect from screen to local coordinate system 
+//! converts a rect from screen to local coordinate system
 void
 View::ConvertFromScreen(IntRect* rect) const
 {
@@ -766,7 +766,7 @@
 }
 
 
-//! converts a region from screen to local coordinate system 
+//! converts a region from screen to local coordinate system
 void
 View::ConvertFromScreen(BRegion* region) const
 {
@@ -777,7 +777,7 @@
 }
 
 
-//! converts a point from local *drawing* to screen coordinate system 
+//! converts a point from local *drawing* to screen coordinate system
 void
 View::ConvertToScreenForDrawing(BPoint* point) const
 {
@@ -788,7 +788,7 @@
 }
 
 
-//! converts a rect from local *drawing* to screen coordinate system 
+//! converts a rect from local *drawing* to screen coordinate system
 void
 View::ConvertToScreenForDrawing(BRect* rect) const
 {
@@ -875,7 +875,7 @@
 }
 
 
-//! converts points from local *drawing* to screen coordinate system 
+//! converts points from local *drawing* to screen coordinate system
 void
 View::ConvertToScreenForDrawing(BPoint* dst, const BPoint* src, int32 num) const
 {
@@ -892,7 +892,7 @@
 }
 
 
-//! converts rects from local *drawing* to screen coordinate system 
+//! converts rects from local *drawing* to screen coordinate system
 void
 View::ConvertToScreenForDrawing(BRect* dst, const BRect* src, int32 num) const
 {
@@ -909,7 +909,7 @@
 }
 
 
-//! converts regions from local *drawing* to screen coordinate system 
+//! converts regions from local *drawing* to screen coordinate system
 void
 View::ConvertToScreenForDrawing(BRegion* dst, const BRegion* src, int32 num) const
 {
@@ -926,7 +926,7 @@
 }
 
 
-//! converts a point from screen to local coordinate system 
+//! converts a point from screen to local coordinate system
 void
 View::ConvertFromScreenForDrawing(BPoint* point) const
 {
@@ -1352,6 +1352,9 @@
 			if (rect.IsValid()/* &amp;&amp; drawingEngine-&gt;Lock()*/) {
 				drawingEngine-&gt;ConstrainClippingRegion(redraw);
 
+				drawing_mode oldMode;
+				drawingEngine-&gt;SetDrawingMode(B_OP_COPY, oldMode);
+
 				if (fBitmapOptions &amp; B_TILE_BITMAP) {
 					// tile across entire view
 
@@ -1398,6 +1401,8 @@
 					redraw-&gt;Exclude(rect);
 				}
 
+				drawingEngine-&gt;SetDrawingMode(oldMode);
+
 				// NOTE: It is ok not to reset the clipping, that
 				// would only waste time
 //				drawingEngine-&gt;Unlock();


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014521.html">[Haiku-commits] r29308 - in	haiku/trunk/src/add-ons/media/plugins/avi_reader: . libOpenDML
</A></li>
	<LI>Next message: <A HREF="014524.html">[Haiku-commits] r29310 - haiku/trunk/src/kits/tracker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14522">[ date ]</a>
              <a href="thread.html#14522">[ thread ]</a>
              <a href="subject.html#14522">[ subject ]</a>
              <a href="author.html#14522">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
