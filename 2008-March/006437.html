<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r24185 - in haiku/trunk: headers/os/interface	src/preferences/appearance
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2008-March/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r24185%20-%20in%20haiku/trunk%3A%20headers/os/interface%0A%09src/preferences/appearance&In-Reply-To=%3C200803010057.m210vJ9K001961%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006436.html">
   <LINK REL="Next"  HREF="006438.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r24185 - in haiku/trunk: headers/os/interface	src/preferences/appearance</H1>
    <B>anevilyak at BerliOS</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r24185%20-%20in%20haiku/trunk%3A%20headers/os/interface%0A%09src/preferences/appearance&In-Reply-To=%3C200803010057.m210vJ9K001961%40sheep.berlios.de%3E"
       TITLE="[Haiku-commits] r24185 - in haiku/trunk: headers/os/interface	src/preferences/appearance">anevilyak at mail.berlios.de
       </A><BR>
    <I>Sat Mar  1 01:57:19 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="006436.html">[Haiku-commits] r24184 - haiku/trunk/headers/build/os/support
</A></li>
        <LI>Next message: <A HREF="006438.html">[Haiku-commits] r24186 - haiku/trunk/src/preferences/appearance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6437">[ date ]</a>
              <a href="thread.html#6437">[ thread ]</a>
              <a href="subject.html#6437">[ subject ]</a>
              <a href="author.html#6437">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: anevilyak
Date: 2008-03-01 01:57:18 +0100 (Sat, 01 Mar 2008)
New Revision: 24185
ViewCVS: <A HREF="http://svn.berlios.de/viewcvs/haiku?rev=24185&amp;view=rev">http://svn.berlios.de/viewcvs/haiku?rev=24185&amp;view=rev</A>

Modified:
   haiku/trunk/headers/os/interface/GraphicsDefs.h
   haiku/trunk/src/preferences/appearance/APRView.cpp
   haiku/trunk/src/preferences/appearance/APRView.h
   haiku/trunk/src/preferences/appearance/ColorSet.cpp
   haiku/trunk/src/preferences/appearance/ColorSet.h
   haiku/trunk/src/preferences/appearance/ColorWhichItem.cpp
   haiku/trunk/src/preferences/appearance/ColorWhichItem.h
Log:
- Added operator = implementation to rgb_color for convenience.
- Major cleanup of Appearance prefs - colors are now dynamically
  read from the app_server, and updating them also works, but
  triggers a bug: the state of the current window somehow gets
  confused, i.e. if I update the panel background color, for some
  reason the color of the BButtons in the appearance pref change color
  and also the textviews begin misbehaving. Have not yet tracked down
  the cause of this, but newly created windows after making the change
  do show up with the updated color and behave properly. Also vastly
  simplified the pref and cleaned up some obsolete definitions.



Modified: haiku/trunk/headers/os/interface/GraphicsDefs.h
===================================================================
--- haiku/trunk/headers/os/interface/GraphicsDefs.h	2008-02-29 23:43:18 UTC (rev 24184)
+++ haiku/trunk/headers/os/interface/GraphicsDefs.h	2008-03-01 00:57:18 UTC (rev 24185)
@@ -101,6 +101,12 @@
 	{
 		return *(const uint32 *)this != *(const uint32 *)&other;
 	}
+	
+	inline rgb_color&amp;
+	operator=(const rgb_color&amp; other)
+	{
+		return set_to(other.red, other.green, other.blue, other.alpha);
+	}
 #endif
 } rgb_color;
 

Modified: haiku/trunk/src/preferences/appearance/APRView.cpp
===================================================================
--- haiku/trunk/src/preferences/appearance/APRView.cpp	2008-02-29 23:43:18 UTC (rev 24184)
+++ haiku/trunk/src/preferences/appearance/APRView.cpp	2008-03-01 00:57:18 UTC (rev 24185)
@@ -1,9 +1,10 @@
 /*
- * Copyright 2002-2006, Haiku. All rights reserved.
+ * Copyright 2002-2008, Haiku. All rights reserved.
  * Distributed under the terms of the MIT License.
  *
  * Authors:
  *		DarkWyrm (<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">darkwyrm at earthlink.net</A>)
+ *		Rene Gollent (<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">rene at gollent.com</A>)
  */
 #include &lt;OS.h&gt;
 #include &lt;Directory.h&gt;
@@ -33,6 +34,36 @@
 #define COLOR_DROPPED 'cldp'
 #define DECORATOR_CHANGED 'dcch'
 
+int32 sColorConsts[] = {
+	B_PANEL_BACKGROUND_COLOR,
+	B_PANEL_TEXT_COLOR,
+	B_DOCUMENT_BACKGROUND_COLOR,
+	B_DOCUMENT_TEXT_COLOR,
+	B_CONTROL_BACKGROUND_COLOR,
+	B_CONTROL_TEXT_COLOR,
+	B_CONTROL_BORDER_COLOR,
+	B_CONTROL_HIGHLIGHT_COLOR,
+	B_NAVIGATION_BASE_COLOR,
+	B_NAVIGATION_PULSE_COLOR,
+	B_SHINE_COLOR,
+	B_SHADOW_COLOR,
+	B_MENU_BACKGROUND_COLOR,
+	B_MENU_SELECTED_BACKGROUND_COLOR,
+	B_MENU_ITEM_TEXT_COLOR,
+	B_MENU_SELECTED_ITEM_TEXT_COLOR,
+	B_MENU_SELECTED_BORDER_COLOR,
+	B_TOOLTIP_BACKGROUND_COLOR,
+	B_TOOLTIP_TEXT_COLOR,
+	B_SUCCESS_COLOR,
+	B_FAILURE_COLOR,
+	B_WINDOW_TAB_COLOR,
+	B_WINDOW_TEXT_COLOR,
+	B_WINDOW_INACTIVE_TAB_COLOR,
+	B_WINDOW_INACTIVE_TEXT_COLOR,
+};
+
+const uint32 sColorCount = sizeof(sColorConsts) / sizeof(int32);
+
 namespace BPrivate
 {
 	int32 count_decorators(void);
@@ -99,32 +130,12 @@
 	
 	fAttrList-&gt;SetSelectionMessage(new BMessage(ATTRIBUTE_CHOSEN));
 
-	fAttrList-&gt;AddItem(new ColorWhichItem(B_PANEL_BACKGROUND_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_PANEL_TEXT_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_DOCUMENT_BACKGROUND_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_DOCUMENT_TEXT_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_CONTROL_BACKGROUND_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_CONTROL_TEXT_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_CONTROL_BORDER_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_CONTROL_HIGHLIGHT_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_NAVIGATION_BASE_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_NAVIGATION_PULSE_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_SHINE_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_SHADOW_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem(B_MENU_BACKGROUND_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_MENU_SELECTED_BACKGROUND_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem(B_MENU_ITEM_TEXT_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem(B_MENU_SELECTED_ITEM_TEXT_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_MENU_SELECTED_BORDER_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_TOOLTIP_BACKGROUND_COLOR));
-	
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_SUCCESS_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_FAILURE_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem(B_WINDOW_TAB_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_WINDOW_TAB_TEXT_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_INACTIVE_WINDOW_TAB_COLOR));
-	fAttrList-&gt;AddItem(new ColorWhichItem((color_which)B_INACTIVE_WINDOW_TAB_TEXT_COLOR));
+	printf(&quot;Color count: %lu\n&quot;, sColorCount);
 
+	for (uint32 i = 0; i &lt; sColorCount; i++) {
+		printf(&quot;Adding color item for which: %ld\n&quot;, sColorConsts[i]);
+		fAttrList-&gt;AddItem(new ColorWhichItem((color_which)sColorConsts[i]));
+	}
 
 	BRect wellrect(0,0,50,50);
 	wellrect.OffsetTo(rect.right + 30, rect.top +
@@ -201,6 +212,7 @@
 			fPicker-&gt;SetValue(*col);
 			fColorWell-&gt;SetColor(*col);
 			fColorWell-&gt;Invalidate();
+			UpdateCurrentColor();
 		}
 	}
 
@@ -220,10 +232,11 @@
 
 			fColorWell-&gt;SetColor(col);
 			fColorWell-&gt;Invalidate();
-			
+				
 			// Update current fAttribute in the settings
-			fCurrentSet.SetColor(fAttrString.String(),col);
-			
+			fCurrentSet.SetColor(fAttribute, col);
+			UpdateCurrentColor();				
+	
 			fDefaults-&gt;SetEnabled(fCurrentSet.IsDefaultable());
 			fRevert-&gt;SetEnabled(true);
 			
@@ -240,23 +253,26 @@
 			
 			fAttrString=whichitem-&gt;Text();
 			UpdateControlsFromAttr(whichitem-&gt;Text());
-
+			
 			fDefaults-&gt;SetEnabled(fCurrentSet.IsDefaultable());
 			break;
 		}
 		case REVERT_SETTINGS: {
 			fCurrentSet=fPrevSet;
 			UpdateControlsFromAttr(fAttrString.String());
+			UpdateAllColors();
 			
 			fRevert-&gt;SetEnabled(false);
 			
 			break;
 		}
 		case DEFAULT_SETTINGS: {
-			fCurrentSet.SetToDefaults();
+			fCurrentSet = ColorSet::DefaultColorSet();
 			fDefaults-&gt;SetEnabled(false);
 			
 			UpdateControlsFromAttr(fAttrString.String());
+			UpdateAllColors();
+
 			BMenuItem *item = fDecorMenu-&gt;FindItem(&quot;Default&quot;);
 			if (item)
 			{
@@ -275,21 +291,31 @@
 
 void APRView::LoadSettings(void)
 {
-	// Load the current GUI color settings from disk. This is done instead of
-	// getting them from the server at this point for testing purposes.
-	
-	// Query the server for the current settings
-	//BPrivate::get_system_colors(&amp;fCurrentSet);
-	
-	// TODO: remove this and enable the get_system_colors() call
-	if (ColorSet::LoadColorSet(&quot;/boot/home/config/settings/app_server/system_colors&quot;,&amp;fCurrentSet) != B_OK) {
-		fCurrentSet.SetToDefaults();
-		ColorSet::SaveColorSet(&quot;/boot/home/config/settings/app_server/system_colors&quot;,fCurrentSet);
+	printf(&quot;Max colors: %lu\n&quot;, sColorCount);
+	for (uint32 i = 0; i &lt; sColorCount; i++) {
+		printf(&quot;getting ui_color for index %lu, constant: %ld\n&quot;, i, sColorConsts[i]);
+		fCurrentSet.SetColor((color_which)sColorConsts[i], ui_color((color_which)sColorConsts[i]));
 	}
-	
+
+	fCurrentSet.PrintToStream();
+
 	fPrevSet = fCurrentSet;
 }
 
+void APRView::UpdateAllColors(void)
+{
+	for (uint32 i = 0; i &lt; sColorCount; i++)
+		set_ui_color((color_which)sColorConsts[i], 
+			fCurrentSet.AttributeToColor((color_which)sColorConsts[i]));
+}
+
+void APRView::UpdateCurrentColor(void)
+{
+	rgb_color col=fPicker-&gt;ValueAsColor();
+	ColorWhichItem *whichitem = (ColorWhichItem *)fAttrList-&gt;ItemAt(fAttrList-&gt;CurrentSelection());
+	set_ui_color(whichitem-&gt;GetAttribute(), col);
+}
+
 void APRView::UpdateControlsFromAttr(const char *string)
 {
 	if (!string)

Modified: haiku/trunk/src/preferences/appearance/APRView.h
===================================================================
--- haiku/trunk/src/preferences/appearance/APRView.h	2008-02-29 23:43:18 UTC (rev 24184)
+++ haiku/trunk/src/preferences/appearance/APRView.h	2008-03-01 00:57:18 UTC (rev 24185)
@@ -1,9 +1,10 @@
 /*
- * Copyright 2002-2006, Haiku. All rights reserved.
+ * Copyright 2002-2008, Haiku. All rights reserved.
  * Distributed under the terms of the MIT License.
  *
  * Authors:
  *		DarkWyrm (<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">darkwyrm at earthlink.net</A>)
+ *		Rene Gollent (<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">rene at gollent.com</A>)
  */
 #ifndef APR_VIEW_H_
 #define APR_VIEW_H_
@@ -43,6 +44,8 @@
 protected:
 
 	void	UpdateControlsFromAttr(const char *string);
+	void	UpdateCurrentColor();
+	void	UpdateAllColors();
 	
 	BColorControl	*fPicker;
 	

Modified: haiku/trunk/src/preferences/appearance/ColorSet.cpp
===================================================================
--- haiku/trunk/src/preferences/appearance/ColorSet.cpp	2008-02-29 23:43:18 UTC (rev 24184)
+++ haiku/trunk/src/preferences/appearance/ColorSet.cpp	2008-03-01 00:57:18 UTC (rev 24185)
@@ -1,10 +1,11 @@
 /*
- * Copyright 2001-2006, Haiku.
+ * Copyright 2001-2008, Haiku.
  * Distributed under the terms of the MIT License.
  *
  * Authors:
  *		DarkWyrm &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">bpmagic at columbus.rr.com</A>&gt;
  *		Stephan A&#223;mus &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">superstippi at gmx.de</A>&gt;
+ *		Rene Gollent &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">rene at gollent.com</A>&gt;
  */
 
 #include &lt;stdio.h&gt;
@@ -16,17 +17,10 @@
 #include &lt;String.h&gt;
 #include &quot;ColorSet.h&quot;
 
-static void
-set_rgb_color(rgb_color&amp; color, uint8 red, uint8 green, uint8 blue)
-{
-	color.red = red;
-	color.green = green;
-	color.blue = blue;
-	color.alpha = 255;
-}
+static ColorSet sDefaults = ColorSet::DefaultColorSet(); 
+static std::map&lt;color_which, BString&gt; sColorNames = ColorSet::DefaultColorNames();
 
-
-static bool
+bool 
 match_rgb_color(rgb_color&amp; color, uint8 red, uint8 green, uint8 blue)
 {
 	return color.red == red
@@ -71,148 +65,68 @@
 void
 ColorSet::SetColors(const ColorSet &amp;cs)
 {
-	panel_background=cs.panel_background;
-	panel_text=cs.panel_text;
-
-	document_background=cs.document_background;
-	document_text=cs.document_text;
-
-	control_background=cs.control_background;
-	control_text=cs.control_text;
-	control_highlight=cs.control_highlight;
-	control_border=cs.control_border;
-
-	tooltip_background=cs.tooltip_background;
-	tooltip_text=cs.tooltip_text;
-
-	menu_background=cs.menu_background;
-	menu_selected_background=cs.menu_selected_background;
-	menu_text=cs.menu_text;
-	menu_selected_text=cs.menu_selected_text;
-	menu_selected_border=cs.menu_selected_border;
-
-	keyboard_navigation_base=cs.keyboard_navigation_base;
-	keyboard_navigation_pulse=cs.keyboard_navigation_pulse;
-
-	success=cs.success;
-	failure=cs.failure;
-	shine=cs.shine;
-	shadow=cs.shadow;
-
-	window_tab=cs.window_tab;
-	window_tab_text=cs.window_tab_text;
-	inactive_window_tab=cs.inactive_window_tab;
-	inactive_window_tab_text=cs.inactive_window_tab_text;
+	fColors = cs.fColors;
 }
 
 //! Prints all color set elements to stdout
 void
 ColorSet::PrintToStream(void) const
 {
-	printf(&quot;panel_background &quot;); PrintMember(panel_background);
-	printf(&quot;panel_text &quot;); PrintMember(panel_text);
-
-	printf(&quot;document_background &quot;); PrintMember(document_background);
-	printf(&quot;document_text &quot;); PrintMember(document_text);
-
-	printf(&quot;control_background &quot;); PrintMember(control_background);
-	printf(&quot;control_text &quot;); PrintMember(control_text);
-	printf(&quot;control_highlight &quot;); PrintMember(control_highlight);
-	printf(&quot;control_border &quot;); PrintMember(control_border);
-
-	printf(&quot;tooltip_background &quot;); PrintMember(tooltip_background);
-	printf(&quot;tooltip_text &quot;); PrintMember(tooltip_text);
-
-	printf(&quot;menu_background &quot;); PrintMember(menu_background);
-	printf(&quot;menu_selected_background &quot;); PrintMember(menu_selected_background);
-	printf(&quot;menu_text &quot;); PrintMember(menu_text);
-	printf(&quot;menu_selected_text &quot;); PrintMember(menu_selected_text);
-	printf(&quot;menu_selected_border &quot;); PrintMember(menu_selected_border);
-
-	printf(&quot;keyboard_navigation_base &quot;); PrintMember(keyboard_navigation_base);
-	printf(&quot;keyboard_navigation_pulse &quot;); PrintMember(keyboard_navigation_pulse);
-
-	printf(&quot;success &quot;); PrintMember(success);
-	printf(&quot;failure &quot;); PrintMember(failure);
-	printf(&quot;shine &quot;); PrintMember(shine);
-	printf(&quot;shadow &quot;); PrintMember(shadow);
-
-	printf(&quot;window_tab &quot;); PrintMember(window_tab);
-	printf(&quot;window_tab_text &quot;); PrintMember(window_tab_text);
-
-	printf(&quot;inactive_window_tab &quot;); PrintMember(inactive_window_tab);
-	printf(&quot;inactive_window_tab_text &quot;); PrintMember(inactive_window_tab_text);
+	for (std::map&lt;color_which, BString&gt;::const_iterator it = sColorNames.begin(); it != sColorNames.end(); ++it) {
+		printf(&quot;%s &quot;, it-&gt;second.String());
+		PrintMember(it-&gt;first);
+		printf(&quot;\n&quot;);
+	}
 }
 
 /*!
 	\brief Assigns the default system colors to the passed ColorSet object
 	\param set The ColorSet object to set to defaults
 */
-void
-ColorSet::SetToDefaults(void)
+ColorSet
+ColorSet::DefaultColorSet(void)
 {
 #ifdef DEBUG_COLORSET
 printf(&quot;Initializing color settings to defaults\n&quot;);
 #endif
-	set_rgb_color(panel_background, 216, 216, 216);
-	set_rgb_color(panel_text, 0, 0, 0);
-	set_rgb_color(document_background, 255, 255, 255);
-	set_rgb_color(document_text, 0, 0, 0);
-	set_rgb_color(control_background, 245, 245, 245);
-	set_rgb_color(control_text, 0, 0, 0);
-	set_rgb_color(control_border, 0, 0, 0);
-	set_rgb_color(control_highlight, 102, 152, 203);
-	set_rgb_color(keyboard_navigation_base, 0, 0, 229);
-	set_rgb_color(keyboard_navigation_pulse, 0, 0, 0);
-	set_rgb_color(shine, 255, 255, 255);
-	set_rgb_color(shadow, 0, 0, 0);
-	set_rgb_color(menu_background, 216, 216, 216);
-	set_rgb_color(menu_selected_background, 115, 120, 184);
-	set_rgb_color(menu_text, 0, 0, 0);
-	set_rgb_color(menu_selected_text, 255, 255, 255);
-	set_rgb_color(menu_selected_border, 0, 0, 0);
-	set_rgb_color(tooltip_background, 255, 255, 0);
-	set_rgb_color(tooltip_text, 0, 0, 0);
-	set_rgb_color(success, 0, 255, 0);
-	set_rgb_color(failure, 255, 0, 0);
-	set_rgb_color(window_tab, 255, 203, 0);
-	set_rgb_color(window_tab_text, 0, 0, 0);
-	set_rgb_color(inactive_window_tab, 232, 232, 232);
-	set_rgb_color(inactive_window_tab_text, 80, 80, 80);
+	ColorSet set;
+	set.fColors[B_PANEL_BACKGROUND_COLOR] = make_color(216, 216, 216);
+	set.fColors[B_PANEL_TEXT_COLOR] = make_color(0, 0, 0);
+	set.fColors[B_DOCUMENT_BACKGROUND_COLOR] = make_color(255,255, 255);
+	set.fColors[B_DOCUMENT_TEXT_COLOR] = make_color(0, 0, 0);
+	set.fColors[B_CONTROL_BACKGROUND_COLOR] = make_color(245, 245, 245);
+	set.fColors[B_CONTROL_TEXT_COLOR] = make_color(0, 0, 0);
+	set.fColors[B_CONTROL_BORDER_COLOR] = make_color(0, 0, 0);
+	set.fColors[B_CONTROL_HIGHLIGHT_COLOR] = make_color(102, 152, 203);
+	set.fColors[B_NAVIGATION_BASE_COLOR] = make_color(0, 0, 229);
+	set.fColors[B_NAVIGATION_PULSE_COLOR] = make_color(0, 0, 0);
+	set.fColors[B_SHINE_COLOR] = make_color(255, 255, 255);
+	set.fColors[B_SHADOW_COLOR] = make_color(0, 0, 0);
+	set.fColors[B_MENU_BACKGROUND_COLOR] = make_color(216, 216, 216);
+	set.fColors[B_MENU_SELECTED_BACKGROUND_COLOR] = make_color(115, 120, 184);
+	set.fColors[B_MENU_ITEM_TEXT_COLOR] = make_color(0, 0, 0);
+	set.fColors[B_MENU_SELECTED_ITEM_TEXT_COLOR] = make_color(255, 255, 255);
+	set.fColors[B_MENU_SELECTED_BORDER_COLOR] = make_color(0, 0, 0);
+	set.fColors[B_TOOLTIP_BACKGROUND_COLOR] = make_color(255, 255, 0);
+	set.fColors[B_TOOLTIP_TEXT_COLOR] = make_color(0, 0, 0);
+	set.fColors[B_SUCCESS_COLOR] = make_color(0, 255, 0);
+	set.fColors[B_FAILURE_COLOR] = make_color(255, 0, 0);
+	set.fColors[B_WINDOW_TAB_COLOR] = make_color(255, 203, 0);
+	set.fColors[B_WINDOW_TEXT_COLOR] = make_color(0, 0, 0);
+	set.fColors[B_WINDOW_INACTIVE_TAB_COLOR] = make_color(232, 232, 232);
+	set.fColors[B_WINDOW_INACTIVE_TEXT_COLOR] = make_color(80, 80, 80);
+
+	return set;
 }
 
+
 /*!
 	\brief Checks if the ColorSet can be set to defaults.
 */
 bool
 ColorSet::IsDefaultable()
 {
-	// TODO: Move all the default color values into constants
-	return !match_rgb_color(panel_background, 216, 216, 216)
-		|| !match_rgb_color(panel_text, 0, 0, 0)
-		|| !match_rgb_color(document_background, 255, 255, 255)
-		|| !match_rgb_color(document_text, 0, 0, 0)
-		|| !match_rgb_color(control_background, 245, 245, 245)
-		|| !match_rgb_color(control_text, 0, 0, 0)
-		|| !match_rgb_color(control_border, 0, 0, 0)
-		|| !match_rgb_color(control_highlight, 102, 152, 203)
-		|| !match_rgb_color(keyboard_navigation_base, 0, 0, 229)
-		|| !match_rgb_color(keyboard_navigation_pulse, 0, 0, 0)
-		|| !match_rgb_color(shine, 255, 255, 255)
-		|| !match_rgb_color(shadow, 0, 0, 0)
-		|| !match_rgb_color(menu_background, 216, 216, 216)
-		|| !match_rgb_color(menu_selected_background, 115, 120, 184)
-		|| !match_rgb_color(menu_text, 0, 0, 0)
-		|| !match_rgb_color(menu_selected_text, 255, 255, 255)
-		|| !match_rgb_color(menu_selected_border, 0, 0, 0)
-		|| !match_rgb_color(tooltip_background, 255, 255, 0)
-		|| !match_rgb_color(tooltip_text, 0, 0, 0)
-		|| !match_rgb_color(success, 0, 255, 0)
-		|| !match_rgb_color(failure, 255, 0, 0)
-		|| !match_rgb_color(window_tab, 255, 203, 0)
-		|| !match_rgb_color(window_tab_text, 0, 0, 0)
-		|| !match_rgb_color(inactive_window_tab, 232, 232, 232)
-		|| !match_rgb_color(inactive_window_tab_text, 80, 80, 80);
+	return (*this == sDefaults);
 }
 
 /*!
@@ -226,46 +140,16 @@
 		return false;
 
 	msg-&gt;MakeEmpty();
-	
-	msg-&gt;AddData(&quot;Panel Background&quot;,(type_code)'RGBC',&amp;panel_background,
-				sizeof(rgb_color) );
-	msg-&gt;AddData(&quot;Panel Text&quot;,(type_code)'RGBC',&amp;panel_text,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Document Background&quot;,(type_code)'RGBC',&amp;document_background,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Document Text&quot;,(type_code)'RGBC',&amp;document_text,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Control Background&quot;,(type_code)'RGBC',&amp;control_background,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Control Text&quot;,(type_code)'RGBC',&amp;control_text,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Control Highlight&quot;,(type_code)'RGBC',&amp;control_highlight,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Control Border&quot;,(type_code)'RGBC',&amp;control_border,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Tooltip Background&quot;,(type_code)'RGBC',&amp;tooltip_background,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Tooltip Text&quot;,(type_code)'RGBC',&amp;tooltip_text,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Menu Background&quot;,(type_code)'RGBC',&amp;menu_background,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Selected Menu Item Background&quot;,(type_code)'RGBC',&amp;menu_selected_background,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Keyboard Navigation Base&quot;,(type_code)'RGBC',&amp;keyboard_navigation_base,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Keyboard Navigation Pulse&quot;,(type_code)'RGBC',
-				&amp;keyboard_navigation_pulse,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Menu Item Text&quot;,(type_code)'RGBC',&amp;menu_text,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Selected Menu Item Text&quot;,(type_code)'RGBC',&amp;menu_selected_text,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Selected Menu Item Border&quot;,(type_code)'RGBC',&amp;menu_selected_border,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Success&quot;,(type_code)'RGBC',&amp;success,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Failure&quot;,(type_code)'RGBC',&amp;failure,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Shine&quot;,(type_code)'RGBC',&amp;shine,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Shadow&quot;,(type_code)'RGBC',&amp;shadow,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Window Tab&quot;,(type_code)'RGBC',&amp;window_tab,sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Window Tab Text&quot;,(type_code)'RGBC',&amp;window_tab_text,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Inactive Window Tab&quot;,(type_code)'RGBC',&amp;inactive_window_tab,
-				sizeof(rgb_color));
-	msg-&gt;AddData(&quot;Inactive Window Tab Text&quot;,(type_code)'RGBC',
-				&amp;inactive_window_tab_text,sizeof(rgb_color));
+	rgb_color color;
+
+	for (std::map&lt;color_which, BString&gt;::const_iterator it = sColorNames.begin(); it != sColorNames.end(); ++it) {
+		std::map&lt;color_which, rgb_color&gt;::const_iterator cit = fColors.find(it-&gt;first);
+		if (cit != fColors.end())
+			msg-&gt;AddData(it-&gt;second.String(), (type_code)'RGBC', &amp;(cit-&gt;second), sizeof(rgb_color));
+		else
+			msg-&gt;AddData(it-&gt;second.String(), (type_code)'RGBC', &amp;color, sizeof(rgb_color));
+	}
+
 	return true;
 }
 
@@ -284,286 +168,114 @@
 	ssize_t size;
 	BString str;
 
-	if(msg-&gt;FindData(&quot;Panel Background&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		panel_background=*col;
-	if(msg-&gt;FindData(&quot;Panel Text&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		panel_text=*col;
-	if(msg-&gt;FindData(&quot;Document Background&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		document_background=*col;
-	if(msg-&gt;FindData(&quot;Document Text&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		document_text=*col;
-	if(msg-&gt;FindData(&quot;Control Background&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		control_background=*col;
-	if(msg-&gt;FindData(&quot;Control Text&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		control_text=*col;
-	if(msg-&gt;FindData(&quot;Control Highlight&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		control_highlight=*col;
-	if(msg-&gt;FindData(&quot;Control Border&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		control_border=*col;
-	if(msg-&gt;FindData(&quot;Tooltip Background&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		tooltip_background=*col;
-	if(msg-&gt;FindData(&quot;Tooltip Text&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		tooltip_text=*col;
-	if(msg-&gt;FindData(&quot;Menu Background&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		menu_background=*col;
-	if(msg-&gt;FindData(&quot;Selected Menu Item Background&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		menu_selected_background=*col;
-	if(msg-&gt;FindData(&quot;Navigation Base&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		keyboard_navigation_base=*col;
-	if(msg-&gt;FindData(&quot;Navigation Pulse&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		keyboard_navigation_pulse=*col;
-	if(msg-&gt;FindData(&quot;Menu Item Text&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		menu_text=*col;
-	if(msg-&gt;FindData(&quot;Selected Menu Item Text&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		menu_selected_text=*col;
-	if(msg-&gt;FindData(&quot;Selected Menu Item Border&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		menu_selected_border=*col;
-	if(msg-&gt;FindData(&quot;Success&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		success=*col;
-	if(msg-&gt;FindData(&quot;Failure&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		failure=*col;
-	if(msg-&gt;FindData(&quot;Shine&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		shine=*col;
-	if(msg-&gt;FindData(&quot;Shadow&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		shadow=*col;
-	if(msg-&gt;FindData(&quot;Window Tab&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		window_tab=*col;
-	if(msg-&gt;FindData(&quot;Window Tab Text&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		window_tab_text=*col;
-	if(msg-&gt;FindData(&quot;Inactive Window Tab&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		inactive_window_tab=*col;
-	if(msg-&gt;FindData(&quot;Inactive Window Tab Text&quot;,(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
-		inactive_window_tab_text=*col;
+	for (std::map&lt;color_which, BString&gt;::const_iterator it = sColorNames.begin(); 
+			it != sColorNames.end(); ++it) {
+		if (msg-&gt;FindData(it-&gt;second.String(),(type_code)'RGBC',(const void**)&amp;col,&amp;size)==B_OK)
+			fColors[it-&gt;first] = *col;
+	}
+	
 	return true;
 }
 
+std::map&lt;color_which, BString&gt;
+ColorSet::DefaultColorNames(void)
+{
+	std::map&lt;color_which, BString&gt; names;
+
+	names[B_PANEL_BACKGROUND_COLOR] = &quot;Panel Background&quot;;
+	names[B_PANEL_TEXT_COLOR] = &quot;Panel Text&quot;;
+	names[B_DOCUMENT_BACKGROUND_COLOR] = &quot;Document Background&quot;;
+	names[B_DOCUMENT_TEXT_COLOR] = &quot;Document Text&quot;;
+	names[B_CONTROL_BACKGROUND_COLOR] = &quot;Control Background&quot;;
+	names[B_CONTROL_TEXT_COLOR] = &quot;Control Text&quot;;
+	names[B_CONTROL_BORDER_COLOR] = &quot;Control Border&quot;;
+	names[B_CONTROL_HIGHLIGHT_COLOR] = &quot;Control Highlight&quot;;
+	names[B_NAVIGATION_BASE_COLOR] = &quot;Navigation Base&quot;;
+	names[B_NAVIGATION_PULSE_COLOR] = &quot;Navigation Pulse&quot;;
+	names[B_SHINE_COLOR] = &quot;Shine&quot;;
+	names[B_SHADOW_COLOR] = &quot;Shadow&quot;;
+	names[B_MENU_BACKGROUND_COLOR] = &quot;Menu Background&quot;;
+	names[B_MENU_SELECTED_BACKGROUND_COLOR] = &quot;Selected Menu Item Background&quot;;
+	names[B_MENU_ITEM_TEXT_COLOR] = &quot;Menu Item Text&quot;;
+	names[B_MENU_SELECTED_ITEM_TEXT_COLOR] = &quot;Selected Menu Item Text&quot;;
+	names[B_MENU_SELECTED_BORDER_COLOR] = &quot;Selected Menu Item Border&quot;;
+	names[B_TOOLTIP_BACKGROUND_COLOR] = &quot;Tooltip Background&quot;;
+	names[B_TOOLTIP_TEXT_COLOR] = &quot;Tooltip Text&quot;;
+	names[B_SUCCESS_COLOR] = &quot;Success&quot;;
+	names[B_FAILURE_COLOR] = &quot;Failure&quot;;
+	names[B_WINDOW_TAB_COLOR] = &quot;Window Tab&quot;;
+	names[B_WINDOW_TEXT_COLOR] = &quot;Window Tab Text&quot;;
+	names[B_WINDOW_INACTIVE_TAB_COLOR] = &quot;Inactive Window Tab&quot;;
+	names[B_WINDOW_INACTIVE_TEXT_COLOR] = &quot;Inactive Window Tab Text&quot;;
 	
+	return names;
+}
+	
 /*!
 	\brief Assigns a value to a named color member
 	\param string name of the color to receive the value
 	\param value An rgb_color which is the new value of the member
 */
 status_t
-ColorSet::SetColor(const char *string, rgb_color value)
+ColorSet::SetColor(color_which which, rgb_color value)
 {
-	if(!string)
-		return B_BAD_VALUE;
-	
-	rgb_color *col=StringToMember(string);
-	if(!col)
-		return B_NAME_NOT_FOUND;
-	*col=value;
+	fColors[which] = value;
 	return B_OK;
 }
 
 /*!
-	\brief Obtains a color based on a specified string
-	\param string name of the color to obtain
-	\return The set's color or (0,0,0,0) if not found
+	\brief Obtains the set's color member based on a specified string
+	\param string name of the color member to obtain
+	\return An RGBColor pointer or NULL if not found
 */
+
 rgb_color
-ColorSet::StringToColor(const char *string)
+ColorSet::StringToColor(const char *string) const
 {
-	rgb_color *col=StringToMember(string);
-	if(!col) {
-		rgb_color c;
-		return c;
+	rgb_color color;
+
+	if (!string)
+		return color;
+
+	color_which which = StringToWhich(string);
+	if (which != -1) {
+		std::map&lt;color_which, rgb_color&gt;::const_iterator it = fColors.find(which);
+		if (it != fColors.end())
+			return it-&gt;second;
 	}
-		
-	return *col;
+	
+	return color;
 }
 
-/*!
-	\brief Obtains the set's color member based on a specified string
-	\param string name of the color member to obtain
-	\return An RGBColor pointer or NULL if not found
-*/
-rgb_color *
-ColorSet::StringToMember(const char *string)
+color_which
+ColorSet::StringToWhich(const char *string) const
 {
 	if(!string)
-		return NULL;
+		return (color_which)-1;
 
-	if(strcmp(string,&quot;Panel Background&quot;)==0)
-		return &amp;panel_background;
-	if(strcmp(string,&quot;Panel Text&quot;)==0)
-		return &amp;panel_text;
-	if(strcmp(string,&quot;Document Background&quot;)==0)
-		return &amp;document_background;
-	if(strcmp(string,&quot;Document Text&quot;)==0)
-		return &amp;document_text;
-	if(strcmp(string,&quot;Control Background&quot;)==0)
-		return &amp;control_background;
-	if(strcmp(string,&quot;Control Text&quot;)==0)
-		return &amp;control_text;
-	if(strcmp(string,&quot;Control Highlight&quot;)==0)
-		return &amp;control_highlight;
-	if(strcmp(string,&quot;Control Border&quot;)==0)
-		return &amp;control_border;
-	if(strcmp(string,&quot;Tooltip Background&quot;)==0)
-		return &amp;tooltip_background;
-	if(strcmp(string,&quot;Tooltip Text&quot;)==0)
-		return &amp;tooltip_text;
-	if(strcmp(string,&quot;Menu Background&quot;)==0)
-		return &amp;menu_background;
-	if(strcmp(string,&quot;Selected Menu Item Background&quot;)==0)
-		return &amp;menu_selected_background;
-	if(strcmp(string,&quot;Navigation Base&quot;)==0)
-		return &amp;keyboard_navigation_base;
-	if(strcmp(string,&quot;Navigation Pulse&quot;)==0)
-		return &amp;keyboard_navigation_pulse;
-	if(strcmp(string,&quot;Menu Item Text&quot;)==0)
-		return &amp;menu_text;
-	if(strcmp(string,&quot;Selected Menu Item Text&quot;)==0)
-		return &amp;menu_selected_text;
-	if(strcmp(string,&quot;Selected Menu Item Border&quot;)==0)
-		return &amp;menu_selected_border;
-	if(strcmp(string,&quot;Success&quot;)==0)
-		return &success;
-	if(strcmp(string,&quot;Failure&quot;)==0)
-		return &failure;
-	if(strcmp(string,&quot;Shine&quot;)==0)
-		return &shine;
-	if(strcmp(string,&quot;Shadow&quot;)==0)
-		return &shadow;
-	if(strcmp(string,&quot;Window Tab&quot;)==0)
-		return &amp;window_tab;
-	if(strcmp(string,&quot;Window Tab Text&quot;)==0)
-		return &amp;window_tab_text;
-	if(strcmp(string,&quot;Inactive Window Tab&quot;)==0)
-		return &amp;inactive_window_tab;
-	if(strcmp(string,&quot;Inactive Window Tab Text&quot;)==0)
-		return &amp;inactive_window_tab_text;
+	for (std::map&lt;color_which, BString&gt;::const_iterator it = sColorNames.begin(); it != sColorNames.end(); ++it)
+		if (it-&gt;second == string)
+			return it-&gt;first;
 
-	return NULL;
+	return (color_which)-1;
 	
 }
 
 rgb_color
 ColorSet::AttributeToColor(int32 which)
 {
-	switch(which) {
-		case B_PANEL_BACKGROUND_COLOR: {
-			return panel_background;
-			break;
-		}
-		
-#ifndef HAIKU_TARGET_PLATFORM_BEOS
-		case B_PANEL_TEXT_COLOR: {
-			return panel_text;
-			break;
-		}
-		case B_DOCUMENT_BACKGROUND_COLOR: {
-			return document_background;
-			break;
-		}
-		case B_DOCUMENT_TEXT_COLOR: {
-			return document_text;
-			break;
-		}
-		case B_CONTROL_BACKGROUND_COLOR: {
-			return control_background;
-			break;
-		}
-		case B_CONTROL_TEXT_COLOR: {
-			return control_text;
-			break;
-		}
-		case B_CONTROL_BORDER_COLOR: {
-			return control_border;
-			break;
-		}
-		case B_CONTROL_HIGHLIGHT_COLOR: {
-			return control_highlight;
-			break;
-		}
-		case B_NAVIGATION_BASE_COLOR: {
-			return keyboard_navigation_base;
-			break;
-		}
-		case B_NAVIGATION_PULSE_COLOR: {
-			return keyboard_navigation_pulse;
-			break;
-		}
-		case B_SHINE_COLOR: {
-			return shine;
-			break;
-		}
-		case B_SHADOW_COLOR: {
-			return shadow;
-			break;
-		}
-		case B_MENU_SELECTED_BACKGROUND_COLOR: {
-			return menu_selected_background;
-			break;
-		}
-		case B_MENU_SELECTED_BORDER_COLOR: {
-			return menu_selected_border;
-			break;
-		}
-		case B_TOOLTIP_BACKGROUND_COLOR: {
-			return tooltip_background;
-			break;
-		}
-		case B_TOOLTIP_TEXT_COLOR: {
-			return tooltip_text;
-			break;
-		}
-		case B_SUCCESS_COLOR: {
-			return success;
-			break;
-		}
-		case B_FAILURE_COLOR: {
-			return failure;
-			break;
-		}
-#endif
-		case B_MENU_BACKGROUND_COLOR: {
-			return menu_background;
-			break;
-		}
-		case B_MENU_ITEM_TEXT_COLOR: {
-			return menu_text;
-			break;
-		}
-		case B_MENU_SELECTED_ITEM_TEXT_COLOR: {
-			return menu_selected_text;
-			break;
-		}
-		case B_WINDOW_TAB_COLOR: {
-			return window_tab;
-			break;
-		}
-		
-		// DANGER! DANGER, WILL ROBINSON!!
-		// These are magic numbers to work around compatibility difficulties while still keeping
-		// functionality. This __will__ break following R1
-		case 22: {
-			return window_tab_text;
-			break;
-		}
-		case 23: {
-			return inactive_window_tab;
-			break;
-		}
-		case 24: {
-			return inactive_window_tab_text;
-			break;
-		}
-		
-		default: {
-			rgb_color c;
-			return c;
-			break;
-		}
-	}
+	return fColors[(color_which)which];
 }
 
 void
-ColorSet::PrintMember(const rgb_color &amp;color) const
+ColorSet::PrintMember(color_which which) const
 {
-	printf(&quot;rgb_color(%d, %d, %d, %d)&quot;,color.red,color.green,color.blue,
-			color.alpha);
+	std::map&lt;color_which, rgb_color&gt;::const_iterator it = fColors.find(which);
+	if (it != fColors.end())
+		printf(&quot;rgb_color(%d, %d, %d, %d)&quot;, it-&gt;second.red,it-&gt;second.green,it-&gt;second.blue,
+			it-&gt;second.alpha);
+	else
+		printf(&quot;color (%d) not found\n&quot;, which);
 }
 
 
@@ -607,3 +319,4 @@
 
 	return msg.Flatten(&amp;file);	
 }
+

Modified: haiku/trunk/src/preferences/appearance/ColorSet.h
===================================================================
--- haiku/trunk/src/preferences/appearance/ColorSet.h	2008-02-29 23:43:18 UTC (rev 24184)
+++ haiku/trunk/src/preferences/appearance/ColorSet.h	2008-03-01 00:57:18 UTC (rev 24185)
@@ -1,9 +1,10 @@
 /*
- * Copyright 2001-2006, Haiku.
+ * Copyright 2001-2008, Haiku.
  * Distributed under the terms of the MIT License.
  *
  * Authors:
  *		DarkWyrm &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">bpmagic at columbus.rr.com</A>&gt;
+ *		Rene Gollent &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">rene at gollent.com</A>&gt;
  */
 #ifndef COLOR_SET_H
 #define COLOR_SET_H
@@ -14,6 +15,7 @@
 #include &lt;Message.h&gt;
 #include &lt;String.h&gt;
 
+#include &lt;map&gt;
 
 /*!
 	\class ColorSet ColorSet.h
@@ -31,56 +33,28 @@
 		bool		ConvertToMessage(BMessage *msg) const;
 		bool		ConvertFromMessage(const BMessage *msg);
 
-		void		SetToDefaults(void);
 		bool		IsDefaultable(void);
 
-		rgb_color 	StringToColor(const char *string);
+		rgb_color 	StringToColor(const char *string) const;
 		rgb_color	AttributeToColor(int32 which);
 
-		status_t	SetColor(const char *string, rgb_color value);
+		status_t	SetColor(color_which which, rgb_color value);
 
 		static status_t LoadColorSet(const char *path, ColorSet *set);
 		static status_t SaveColorSet(const char *path, const ColorSet &amp;set);
+		
+		static ColorSet	DefaultColorSet(void);
+		static std::map&lt;color_which, BString&gt; DefaultColorNames(void);
+	
+		inline bool operator==(const ColorSet &amp;other)
+		{
+			return (fColors == other.fColors);
+		}
 
-		rgb_color	panel_background,
-					panel_text,
-					
-					document_background,
-					document_text,
-					
-					control_background,
-					control_text,
-					control_highlight,
-					control_border,
-					
-					tooltip_background,
-					tooltip_text,
-					
-					menu_background,
-					menu_selected_background,
-					menu_text,
-					menu_selected_text,
-					menu_selected_border,
-					
-					keyboard_navigation_base,
-					keyboard_navigation_pulse,
-					
-					success,
-					failure,
-					shine,
-					shadow,
-					window_tab,
-					
-					// Not all of these guys do exist in InterfaceDefs.h,
-					// but we keep them as part of the color set anyway - 
-					// they're important nonetheless
-					window_tab_text,
-					inactive_window_tab,
-					inactive_window_tab_text;
-
 	private:
-		rgb_color	*StringToMember(const char *string);
-		void		PrintMember(const rgb_color &amp;color) const;
+		color_which	StringToWhich(const char *string) const;
+		void		PrintMember(color_which which) const;
+		std::map&lt;color_which, rgb_color&gt; fColors;
 };
 
 #endif	// COLOR_SET_H

Modified: haiku/trunk/src/preferences/appearance/ColorWhichItem.cpp
===================================================================
--- haiku/trunk/src/preferences/appearance/ColorWhichItem.cpp	2008-02-29 23:43:18 UTC (rev 24184)
+++ haiku/trunk/src/preferences/appearance/ColorWhichItem.cpp	2008-03-01 00:57:18 UTC (rev 24185)
@@ -1,9 +1,10 @@
 /*
- * Copyright 2002-2006, Haiku. All rights reserved.
+ * Copyright 2002-2008, Haiku. All rights reserved.
  * Distributed under the terms of the MIT License.
  *
  * Authors:
  *		DarkWyrm (<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">darkwyrm at earthlink.net</A>)
+ *		Rene Gollent (<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">rene at gollent.com</A>)
  */
 #include &quot;ColorWhichItem.h&quot;
 #include &lt;stdio.h&gt;
@@ -134,17 +135,17 @@
 			SetText(&quot;Window Tab&quot;);
 			break;
 		}
-		case B_WINDOW_TAB_TEXT_COLOR: {
+		case B_WINDOW_TEXT_COLOR: {
 			attribute=which;
-			SetText(&quot;Window Tab Text&quot;);
+			SetText(&quot;Window Text&quot;);
 			break;

[... truncated: 61 lines follow ...]

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006436.html">[Haiku-commits] r24184 - haiku/trunk/headers/build/os/support
</A></li>
	<LI>Next message: <A HREF="006438.html">[Haiku-commits] r24186 - haiku/trunk/src/preferences/appearance
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6437">[ date ]</a>
              <a href="thread.html#6437">[ thread ]</a>
              <a href="subject.html#6437">[ subject ]</a>
              <a href="author.html#6437">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
