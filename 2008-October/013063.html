<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Haiku-commits] r28342 - in haiku/trunk/src/add-ons/input_server/devices: keyboard mouse
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/haiku-commits/2008-October/index.html" >
   <LINK REL="made" HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r28342%20-%20in%0A%20haiku/trunk/src/add-ons/input_server/devices%3A%20keyboard%20mouse&In-Reply-To=%3C2223485856-BeMail%40zon%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013046.html">
   <LINK REL="Next"  HREF="013050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Haiku-commits] r28342 - in haiku/trunk/src/add-ons/input_server/devices: keyboard mouse</H1>
    <B>Axel D&#246;rfler</B> 
    <A HREF="mailto:haiku-commits%40lists.berlios.de?Subject=Re%3A%20%5BHaiku-commits%5D%20r28342%20-%20in%0A%20haiku/trunk/src/add-ons/input_server/devices%3A%20keyboard%20mouse&In-Reply-To=%3C2223485856-BeMail%40zon%3E"
       TITLE="[Haiku-commits] r28342 - in haiku/trunk/src/add-ons/input_server/devices: keyboard mouse">axeld at pinc-software.de
       </A><BR>
    <I>Tue Oct 28 11:44:41 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="013046.html">[Haiku-commits] r28342 - in haiku/trunk/src/add-ons/input_server/devices: keyboard mouse
</A></li>
        <LI>Next message: <A HREF="013050.html">[Haiku-commits] r28343 - haiku/trunk/build/jam
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13063">[ date ]</a>
              <a href="thread.html#13063">[ thread ]</a>
              <a href="subject.html#13063">[ subject ]</a>
              <a href="author.html#13063">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Stephan Assmus &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">superstippi at gmx.de</A>&gt; wrote:
&gt;<i> Axel D&#246;rfler wrote:
</I>&gt;<i> &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/haiku-commits">stippi at mail.berlios.de</A> wrote:
</I>&gt;<i> &gt; &gt;          if (ioctl(device-&gt;fd, KB_READ, &amp;buffer) != B_OK) {
</I>&gt;<i> &gt; &gt; -            device-&gt;device_watcher = -1;
</I>&gt;<i> &gt; &gt; -            device-&gt;owner-&gt;_RemoveDevice(device-&gt;path);
</I>&gt;<i> &gt; &gt; +            if (device-&gt;active) {
</I>&gt;<i> &gt; &gt; +                device-&gt;device_watcher = -1;
</I>&gt;<i> &gt; &gt; +                device-&gt;owner-&gt;_RemoveDevice(device-&gt;path);
</I>&gt;<i> &gt; &gt; +            } else {
</I>&gt;<i> &gt; Maybe it would be nicer to do this asynchronously by signaling the 
</I>&gt;<i> &gt; AddOnMonitor to do this?
</I>&gt;<i> But this is supposed to work for 3rd party add-ons that know nothing 
</I>&gt;<i> about 
</I>&gt;<i> how the input_server works internally. This way, the fix works with 
</I>&gt;<i> the 
</I>&gt;<i> internal logic of just the device add-on. If I'm not missing 
</I>&gt;<i> something. In 
</I>&gt;<i> another words, the problem existed in just the add-on without knowing 
</I>&gt;<i> anything about the input_server internals.
</I>
I'm not sure how it worked in the old input_server, but I would assume 
that all device functions were called from the same thread (as we do 
it). If there is any locking needed beyond that (ie. when you have your 
own thread), the input device is responsible for that (as it is now).
So even old add-ons must have solved this issue, it shouldn't matter a 
lot if we introduce a simple and clean version to solve it as well :-)

Bye,
   Axel.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013046.html">[Haiku-commits] r28342 - in haiku/trunk/src/add-ons/input_server/devices: keyboard mouse
</A></li>
	<LI>Next message: <A HREF="013050.html">[Haiku-commits] r28343 - haiku/trunk/build/jam
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13063">[ date ]</a>
              <a href="thread.html#13063">[ thread ]</a>
              <a href="subject.html#13063">[ subject ]</a>
              <a href="author.html#13063">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/haiku-commits">More information about the Haiku-commits
mailing list</a><br>
</body></html>
